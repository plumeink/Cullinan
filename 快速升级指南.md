# ğŸš€ Cullinan v0.7x å¿«é€Ÿå‡çº§æŒ‡å—

**5åˆ†é’Ÿå®Œæˆå‡çº§**

---

## âš ï¸ é‡è¦æç¤º

Cullinan v0.7xåˆ é™¤äº†ä»¥ä¸‹å¼ƒç”¨æ¨¡å—ï¼š
- `cullinan.registry`
- `cullinan.websocket`

**æ‚¨éœ€è¦æ›´æ–°å¯¼å…¥è¯­å¥ï¼**

---

## ğŸ“ å¿«é€Ÿæ£€æŸ¥æ¸…å•

### 1ï¸âƒ£ æ£€æŸ¥ä»£ç  (30ç§’)

åœ¨é¡¹ç›®ä¸­æœç´¢ä»¥ä¸‹å†…å®¹ï¼š
```bash
# Linux/Mac
grep -r "from cullinan.registry import" .
grep -r "from cullinan.websocket import" .

# Windows PowerShell
Select-String -Path . -Pattern "from cullinan.registry import" -Recurse
Select-String -Path . -Pattern "from cullinan.websocket import" -Recurse
```

### 2ï¸âƒ£ æ›´æ–°å¯¼å…¥ (3åˆ†é’Ÿ)

æŒ‰ç…§ä¸‹è¡¨æ›´æ–°ï¼š

| æŸ¥æ‰¾ | æ›¿æ¢ä¸º |
|------|--------|
| `from cullinan.registry import HandlerRegistry` | `from cullinan import HandlerRegistry` |
| `from cullinan.registry import get_handler_registry` | `from cullinan import get_handler_registry` |
| `from cullinan.registry import HeaderRegistry` | `from cullinan import HeaderRegistry` |
| `from cullinan.registry import get_header_registry` | `from cullinan import get_header_registry` |
| `from cullinan.websocket import websocket` | `from cullinan import websocket_handler` |
| `@websocket(` | `@websocket_handler(` |

### 3ï¸âƒ£ ç‰¹æ®Šå¤„ç†ï¼šreset_registries (1åˆ†é’Ÿ)

**æŸ¥æ‰¾**:
```python
from cullinan.registry import reset_registries
reset_registries()
```

**æ›¿æ¢ä¸º**:
```python
from cullinan.handler import reset_handler_registry
from cullinan import get_header_registry

reset_handler_registry()
get_header_registry().clear()
```

### 4ï¸âƒ£ æµ‹è¯• (1åˆ†é’Ÿ)

```bash
# è¿è¡Œæµ‹è¯•
python -m pytest

# æˆ–
python -m unittest discover
```

---

## ğŸ’¡ æœ€å¸¸è§çš„3ä¸ªæ›´æ–°

### âœ… æ›´æ–°1ï¼šHandlerRegistry
```python
# æ—§ä»£ç 
from cullinan.registry import get_handler_registry

# æ–°ä»£ç 
from cullinan import get_handler_registry
```

### âœ… æ›´æ–°2ï¼šWebSocket
```python
# æ—§ä»£ç 
from cullinan.websocket import websocket
@websocket(url='/ws/chat')

# æ–°ä»£ç 
from cullinan import websocket_handler
@websocket_handler(url='/ws/chat')
```

### âœ… æ›´æ–°3ï¼šæµ‹è¯•æ¸…ç†
```python
# æ—§ä»£ç 
from cullinan.registry import reset_registries
reset_registries()

# æ–°ä»£ç 
from cullinan.handler import reset_handler_registry
reset_handler_registry()
get_header_registry().clear()
```

---

## ğŸ†˜ é‡åˆ°é—®é¢˜ï¼Ÿ

### ImportError: cannot import name 'xxx' from 'cullinan.registry'

**åŸå› **: æ¨¡å—å·²è¢«åˆ é™¤  
**è§£å†³**: æŒ‰ç…§ä¸Šé¢çš„è¡¨æ ¼æ›´æ–°å¯¼å…¥

### AttributeError: module 'cullinan' has no attribute 'registry'

**åŸå› **: å°è¯•å¯¼å…¥å·²åˆ é™¤çš„æ¨¡å—  
**è§£å†³**: ä½¿ç”¨æ–°çš„å¯¼å…¥è·¯å¾„

### æˆ‘çš„ä»£ç å¤ªå¤šï¼Œæ‰‹åŠ¨æ”¹å¤ªæ…¢

**è§£å†³**: ä½¿ç”¨æ‰¹é‡æ›¿æ¢è„šæœ¬ï¼ˆè§ä¸‹æ–¹ï¼‰

---

## ğŸ”§ è‡ªåŠ¨åŒ–æ‰¹é‡æ›¿æ¢

### Pythonè„šæœ¬
```python
import os
import re

replacements = {
    'from cullinan.registry import HandlerRegistry': 'from cullinan import HandlerRegistry',
    'from cullinan.registry import get_handler_registry': 'from cullinan import get_handler_registry',
    'from cullinan.registry import HeaderRegistry': 'from cullinan import HeaderRegistry',
    'from cullinan.registry import get_header_registry': 'from cullinan import get_header_registry',
    'from cullinan.websocket import websocket': 'from cullinan import websocket_handler',
    '@websocket(': '@websocket_handler(',
}

for root, dirs, files in os.walk('.'):
    for file in files:
        if file.endswith('.py'):
            filepath = os.path.join(root, file)
            with open(filepath, 'r', encoding='utf-8') as f:
                content = f.read()
            
            modified = False
            for old, new in replacements.items():
                if old in content:
                    content = content.replace(old, new)
                    modified = True
            
            if modified:
                with open(filepath, 'w', encoding='utf-8') as f:
                    f.write(content)
                print(f'âœ“ Updated: {filepath}')

print('âœ“ Done!')
```

---

## âœ… å®Œæˆç¡®è®¤

å‡çº§å®Œæˆåï¼Œè¿è¡Œï¼š

```python
# æµ‹è¯•æ–°å¯¼å…¥
python -c "from cullinan import HandlerRegistry, HeaderRegistry, websocket_handler; print('âœ“ å‡çº§æˆåŠŸï¼')"
```

---

## ğŸ“š è¯¦ç»†æ–‡æ¡£

éœ€è¦æ›´å¤šä¿¡æ¯ï¼ŸæŸ¥çœ‹ï¼š
- [å®Œæ•´è¿ç§»æŒ‡å—](docs/API_MIGRATION_GUIDE.md)
- [æŠ€æœ¯æŠ¥å‘Š](å½»åº•åˆ é™¤å¼ƒç”¨æ–‡ä»¶å®ŒæˆæŠ¥å‘Š.md)

---

**é¢„è®¡æ—¶é—´**: 5-10åˆ†é’Ÿ  
**éš¾åº¦**: â­ ç®€å•  
**é£é™©**: â­ ä½ï¼ˆåªæ˜¯å¯¼å…¥è·¯å¾„å˜åŒ–ï¼‰

