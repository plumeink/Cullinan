{"config":{"lang":["en","zh"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Cullinan Documentation","text":"<p>Welcome \u2014 this site contains the Cullinan framework documentation.</p> <p>Version 0.90: The IoC/DI architecture has been redesigned. See Dependency Injection Guide and Migration Guide.</p> <p>Use the navigation to the left to get started. Key areas:</p> <ul> <li>Getting Started \u2014 quick start and minimal app examples</li> <li>Architecture \u2014 system overview and diagrams</li> <li>Wiki \u2014 injection, lifecycle, middleware, extensions</li> <li>Dependency Injection Guide \u2014 DI system documentation</li> <li>Migration Guide \u2014 upgrade from 0.83</li> <li>Modules \u2014 per-module API and examples</li> <li>Examples \u2014 runnable examples in the <code>examples/</code> directory</li> <li>API Reference \u2014 detailed API documentation</li> </ul> <p>For more information, visit our GitHub repository.</p>"},{"location":"api_reference/","title":"API Reference","text":"<p>Note (v0.90): The core module has been reorganized. For the new API structure, see Dependency Injection Guide and Import Migration Guide.</p> <p>This page provides an overview of the public API surface of Cullinan and acts as an entry point for generated or manually maintained per-module API pages. The recommended structure includes: a module index, the public symbols and signatures for each module, and a brief description of how to regenerate API documentation.</p>"},{"location":"api_reference/#module-index-example","title":"Module index (example)","text":"<p>The following module list is for illustration only. The concrete index should be derived from the actual code structure and/or automated generation results:</p> <ul> <li><code>cullinan.app</code> \u2014 Application creation and run entrypoints</li> <li><code>cullinan.application</code> \u2014 Application lifecycle and startup flow</li> <li><code>cullinan.core</code> \u2014 IoC/DI core (providers, registries, scopes, injection APIs)</li> <li><code>cullinan.controller</code> \u2014 Controllers and RESTful API decorators</li> <li><code>cullinan.service</code> \u2014 Service base class and the <code>@service</code> decorator</li> <li><code>cullinan.middleware</code> \u2014 Middleware base classes and extension points</li> </ul>"},{"location":"api_reference/#public-symbols-and-signatures-recommended-structure","title":"Public symbols and signatures (recommended structure)","text":"<p>For each module, the API reference is recommended to follow this structure:</p> <ul> <li>Module path, for example: <code>cullinan.controller</code></li> <li>Short description: primary responsibility and typical usage scenarios</li> <li>List of public classes and functions (example):</li> <li><code>@controller(...)</code> \u2014 Controller decorator, responsible for auto-registering controllers and their routes</li> <li><code>@get_api(url=..., query_params=..., body_params=..., headers=...)</code> \u2014 GET endpoint decorator</li> <li><code>@post_api(url=..., body_params=..., headers=...)</code> \u2014 POST endpoint decorator</li> <li><code>Inject</code>, <code>InjectByName</code> \u2014 Property/constructor injection markers</li> </ul> <p>A complete API reference can be populated using this structure, either via automated generation or by manual curation.</p>"},{"location":"api_reference/#regenerating-api-documentation-example-workflow","title":"Regenerating API documentation (example workflow)","text":"<p>When adding automation later, a static analysis script can be used to generate the API index and keep this page in sync with the source. A typical workflow might be:</p> <ol> <li>Maintain a script under <code>docs/work/</code> (for example <code>generate_api_reference.py</code>) that scans modules and emits Markdown fragments.</li> <li>Have the script produce a per-module API list (classes, functions, signatures, short descriptions) into <code>docs/work/api_modules.md</code> or update this page directly.</li> <li>Run the script periodically in CI or as part of local documentation build steps to ensure the API reference reflects the current codebase.</li> </ol> <p>The exact tooling and script implementation can be refined based on project conventions and the chosen documentation toolchain.</p>"},{"location":"architecture/","title":"Cullinan Framework Architecture (Updated)","text":"<p>Version: v0.90 Last Updated: 2025-12-25 Author: Plumeink Status: Updated</p>"},{"location":"architecture/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Architecture Overview</li> <li>Core Components</li> <li>IoC/DI 2.0 System</li> <li>Extension Mechanism</li> <li>Startup Flow</li> <li>Request Processing Flow</li> <li>Module Scanning</li> <li>Performance Optimization</li> <li>Migration from 0.83</li> </ol>"},{"location":"architecture/#architecture-overview","title":"Architecture Overview","text":"<p>Cullinan is a Tornado-based web framework that adopts the IoC/DI (Inversion of Control/Dependency Injection) design pattern and provides a decorator-driven development experience.</p>"},{"location":"architecture/#core-design-principles","title":"Core Design Principles","text":"<ul> <li>Non-invasive: Implement features through decorators and annotations without inheriting complex base classes</li> <li>Dependency Injection: Automatically manage component dependencies</li> <li>Extension-friendly: Unified extension point registration and discovery mechanism</li> <li>High Performance: Optimized startup and runtime performance</li> </ul>"},{"location":"architecture/#architecture-layers","title":"Architecture Layers","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502          Application Layer                           \u2502\n\u2502  - Business Logic (Controllers)                      \u2502\n\u2502  - Service Layer (Services)                          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                  \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502          Framework Layer                             \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                     \u2502\n\u2502  \u2502    Extension Mechanism      \u2502                     \u2502\n\u2502  \u2502  - Middleware               \u2502                     \u2502\n\u2502  \u2502  - Extension Points         \u2502                     \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                     \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                     \u2502\n\u2502  \u2502  IoC/DI 2.0 Container       \u2502                     \u2502\n\u2502  \u2502  - ApplicationContext       \u2502                     \u2502\n\u2502  \u2502  - Definition + Factory     \u2502                     \u2502\n\u2502  \u2502  - ScopeManager             \u2502                     \u2502\n\u2502  \u2502  - Structured Diagnostics   \u2502                     \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                     \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                     \u2502\n\u2502  \u2502    Core Foundation          \u2502                     \u2502\n\u2502  \u2502  - Lifecycle Management     \u2502                     \u2502\n\u2502  \u2502  - Request Context          \u2502                     \u2502\n\u2502  \u2502  - Module Scanner           \u2502                     \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                  \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502          Web Server Layer (Tornado)                  \u2502\n\u2502  - IOLoop                                            \u2502\n\u2502  - HTTP Server                                       \u2502\n\u2502  - Request Handler                                   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"architecture/#core-components","title":"Core Components","text":""},{"location":"architecture/#1-core-module-cullinancore","title":"1. Core Module (<code>cullinan/core/</code>)","text":"<p>Provides framework infrastructure.</p> <p>Main Components:</p>"},{"location":"architecture/#11-iocdi-20-container","title":"1.1 IoC/DI 2.0 Container","text":"<pre><code>ApplicationContext (Single Entry Point)\n    \u251c\u2500\u2500 Definition Registry (Immutable definitions)\n    \u251c\u2500\u2500 Factory (Instance creation)\n    \u2514\u2500\u2500 ScopeManager (Scope management)\n        \u251c\u2500\u2500 SingletonScope\n        \u251c\u2500\u2500 PrototypeScope\n        \u2514\u2500\u2500 RequestScope\n</code></pre> <p>Core Components (v0.90): - ApplicationContext: Single entry point for all container operations   - <code>register(Definition)</code> - Register dependency definition   - <code>get(name)</code> / <code>try_get(name)</code> - Resolve dependency   - <code>refresh()</code> - Freeze registry, initialize eager beans   - <code>shutdown()</code> - Clean up resources</p> <ul> <li>Definition: Immutable dependency definition</li> <li><code>name</code> - Unique identifier</li> <li><code>factory</code> - Instance creation function</li> <li><code>scope</code> - ScopeType (SINGLETON/PROTOTYPE/REQUEST)</li> <li> <p><code>source</code> - Source description for diagnostics</p> </li> <li> <p>Factory: Unified instance creation</p> </li> <li>Creates instances via Definition.factory</li> <li> <p>Delegates to ScopeManager for caching</p> </li> <li> <p>ScopeManager: Unified scope management</p> </li> <li><code>SINGLETON</code> - Application-level singleton (thread-safe)</li> <li><code>PROTOTYPE</code> - New instance per resolution</li> <li><code>REQUEST</code> - Request-scoped instances</li> </ul> <p>New Directory Structure (v0.90): <pre><code>cullinan/core/\n\u251c\u2500\u2500 container/      # IoC/DI 2.0 API\n\u2502   \u251c\u2500\u2500 context.py\n\u2502   \u251c\u2500\u2500 definitions.py\n\u2502   \u251c\u2500\u2500 factory.py\n\u2502   \u2514\u2500\u2500 scope.py\n\u251c\u2500\u2500 diagnostics/    # Exceptions + rendering\n\u251c\u2500\u2500 lifecycle/      # Lifecycle management\n\u251c\u2500\u2500 request/        # Request context\n\u2514\u2500\u2500 legacy/         # Deprecated 1.x components\n</code></pre></p>"},{"location":"architecture/#12-lifecycle-management","title":"1.2 Lifecycle Management","text":"<pre><code>class LifecycleManager:\n    - initialize()    # Initialization phase\n    - startup()       # Startup phase\n    - shutdown()      # Shutdown phase\n</code></pre> <p>Lifecycle Hooks: - <code>on_init()</code> - Execute after Service instantiation - <code>on_startup()</code> - Execute after all Services are ready - <code>on_shutdown()</code> - Execute during application shutdown</p>"},{"location":"architecture/#13-request-context","title":"1.3 Request Context","text":"<pre><code>class RequestContext:\n    - request_id: str\n    - start_time: float\n    - _metadata: Dict (lazy initialization)\n    - _cleanup_callbacks: List (lazy initialization)\n</code></pre> <p>Optimizations (v0.81+): - Lazy initialization: Save 20-55% memory - Performance: Initialization from 500ns \u2192 350ns</p>"},{"location":"architecture/#14-scope-system","title":"1.4 Scope System","text":"<ul> <li>SingletonScope: Singleton scope</li> <li>TransientScope: Transient scope (create new each time)</li> <li>RequestScope: Request scope</li> <li>Custom Scope: Support user extensions (e.g., SessionScope)</li> </ul>"},{"location":"architecture/#2-service-layer-cullinanservice","title":"2. Service Layer (<code>cullinan/service/</code>)","text":"<p>Manages application business services.</p> <p>Usage: <pre><code>from cullinan.service import service, Service\nfrom cullinan.core import Inject\n\n@service\nclass UserService(Service):\n    email_service: 'EmailService' = Inject()\n\n    def on_init(self):\n        # Initialize resources\n        self.db = connect_database()\n\n    def on_shutdown(self):\n        # Clean up resources\n        self.db.close()\n</code></pre></p> <p>Features: - Singleton pattern (application-level) - Automatic dependency injection - Lifecycle management - Startup error policies (strict/warn/ignore)</p>"},{"location":"architecture/#3-controller-layer-cullinancontroller","title":"3. Controller Layer (<code>cullinan/controller/</code>)","text":"<p>Handles HTTP requests.</p> <p>Usage: <pre><code>from cullinan.controller import controller, get_api\nfrom cullinan.core import Inject\n\n@controller('/api/users')\nclass UserController:\n    user_service: 'UserService' = Inject()\n\n    @get_api('/&lt;user_id&gt;')\n    def get_user(self, user_id: int):\n        return self.user_service.get_user(user_id)\n</code></pre></p> <p>Features: - RESTful route mapping - Automatic dependency injection - Request-level instances (new per request) - Automatic parameter parsing and validation</p>"},{"location":"architecture/#4-extension-mechanism","title":"4. Extension Mechanism","text":""},{"location":"architecture/#41-middleware-system","title":"4.1 Middleware System","text":"<pre><code>from cullinan.middleware import middleware, Middleware\n\n@middleware(priority=100)\nclass LoggingMiddleware(Middleware):\n    def process_request(self, handler):\n        logger.info(f\"Request: {handler.request.uri}\")\n        return handler\n\n    def process_response(self, handler, response):\n        logger.info(f\"Response: {response}\")\n        return response\n</code></pre> <p>Features: - Decorator-driven registration - Priority control (lower numbers execute first) - Bidirectional request/response interception - Support short-circuiting (return None to stop)</p>"},{"location":"architecture/#42-extension-point-discovery","title":"4.2 Extension Point Discovery","text":"<pre><code>from cullinan.extensions import list_extension_points\n\n# Query available extension points\npoints = list_extension_points(category='middleware')\nfor point in points:\n    print(f\"{point['name']}: {point['description']}\")\n</code></pre> <p>6 Extension Categories: 1. Middleware - Request/response interception 2. Lifecycle - Lifecycle hooks 3. Injection - Dependency injection extensions 4. Routing - Route handling 5. Configuration - Configuration management 6. Handler - Request handlers</p>"},{"location":"architecture/#iocdi-20-system","title":"IoC/DI 2.0 System","text":""},{"location":"architecture/#new-architecture-v090","title":"New Architecture (v0.90)","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   ApplicationContext (Entry Point)  \u2502\n\u2502  - register(Definition)             \u2502\n\u2502  - get(name) / try_get(name)        \u2502\n\u2502  - refresh() / shutdown()           \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                \u2502\n      \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n      \u25bc         \u25bc         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502Definition\u2502 \u2502 Factory \u2502 \u2502ScopeManager\u2502\n\u2502 Registry \u2502 \u2502         \u2502 \u2502            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"architecture/#key-improvements","title":"Key Improvements","text":"Feature 0.83 (Legacy) 0.90 (2.0) Entry Point Multiple (IoCFacade, Registries) Single (ApplicationContext) Definition Mutable Immutable (frozen) Registry Modifiable at runtime Frozen after refresh() Scopes Implicit Explicit ScopeType enum Diagnostics String-based errors Structured exceptions"},{"location":"architecture/#usage-patterns","title":"Usage Patterns","text":""},{"location":"architecture/#pattern-1-decorator-based-automatic-injection-recommended","title":"Pattern 1: Decorator-Based Automatic Injection (Recommended)","text":"<pre><code>from cullinan.service import service, Service\nfrom cullinan.core import Inject\n\n@service\nclass UserService(Service):\n    email_service: EmailService = Inject()  # Auto-inject\n\n    def on_init(self):\n        # Initialization logic\n        pass\n\n    def on_startup(self):\n        # Execute when service starts\n        pass\n</code></pre> <p>Features: - Decorators internally use the new IoC/DI 2.0 registration logic - Automatic dependency resolution and lifecycle management - Supports <code>Inject()</code> attribute injection</p>"},{"location":"architecture/#pattern-2-definition-based-registration-advanced","title":"Pattern 2: Definition-Based Registration (Advanced)","text":"<pre><code>from cullinan.core.container import ApplicationContext, Definition, ScopeType\n\nctx = ApplicationContext()\n\n# Register with explicit definition (for complex scenarios or third-party integration)\nctx.register(Definition(\n    name='UserService',\n    factory=lambda c: UserService(c.get('UserRepository')),\n    scope=ScopeType.SINGLETON,\n    source='service:UserService'\n))\n\nctx.refresh()  # Freeze registry\nuser_service = ctx.get('UserService')\n</code></pre> <p>Use Cases: - Custom instance creation logic required - Integrating third-party library components - Dynamic dependency registration needed</p>"},{"location":"architecture/#extension-mechanism","title":"Extension Mechanism","text":""},{"location":"architecture/#middleware-execution-flow","title":"Middleware Execution Flow","text":"<pre><code>Client Request\n  \u2193\nCorsMiddleware (priority=10)      \u2192 process_request\n  \u2193\nAuthMiddleware (priority=50)      \u2192 process_request\n  \u2193\nLoggingMiddleware (priority=100)  \u2192 process_request\n  \u2193\nHandler Processing\n  \u2193\nLoggingMiddleware (priority=100)  \u2192 process_response\n  \u2193\nAuthMiddleware (priority=50)      \u2192 process_response\n  \u2193\nCorsMiddleware (priority=10)      \u2192 process_response\n  \u2193\nClient Response\n</code></pre> <p>Priority Guidelines: - <code>0-50</code>: Critical middleware (CORS, security) - <code>51-100</code>: Standard middleware (logging, metrics) - <code>101-200</code>: Application-specific middleware</p>"},{"location":"architecture/#startup-flow","title":"Startup Flow","text":""},{"location":"architecture/#startup-sequence","title":"Startup Sequence","text":"<pre><code>1. configure(...)\n   \u2514\u2500\u2500 Load configuration\n\n2. Module Scanning\n   \u251c\u2500\u2500 Auto-scan mode\n   \u2502   \u251c\u2500\u2500 Detect packaging environment (development/nuitka/pyinstaller)\n   \u2502   \u251c\u2500\u2500 Scan user packages (user_packages)\n   \u2502   \u2514\u2500\u2500 Collect statistics (New in v0.81+)\n   \u2502\n   \u2514\u2500\u2500 Explicit registration mode (New in v0.81+)\n       \u2514\u2500\u2500 Skip scanning, use configured classes directly\n\n3. IoC Container Initialization\n   \u251c\u2500\u2500 Initialize IoCFacade\n   \u251c\u2500\u2500 Register Providers\n   \u2514\u2500\u2500 Configure InjectionRegistry\n\n4. Service Initialization\n   \u251c\u2500\u2500 Initialize in dependency order\n   \u251c\u2500\u2500 Call on_init() hooks\n   \u251c\u2500\u2500 Call on_startup() hooks\n   \u2514\u2500\u2500 Error handling (per startup_error_policy)\n\n5. Controller Registration\n   \u251c\u2500\u2500 Register routes\n   \u2514\u2500\u2500 Configure Handlers\n\n6. Middleware Chain Building\n   \u251c\u2500\u2500 Sort by priority\n   \u251c\u2500\u2500 Initialize middleware (on_init)\n   \u2514\u2500\u2500 Build processing chain\n\n7. Start Web Server\n   \u251c\u2500\u2500 Create Tornado Application\n   \u251c\u2500\u2500 Register signal handlers (SIGINT/SIGTERM)\n   \u2514\u2500\u2500 Start IOLoop\n</code></pre>"},{"location":"architecture/#startup-performance-v081-optimized","title":"Startup Performance (v0.81+ Optimized)","text":"Scenario Before After Improvement Explicit registration mode 69.56 ms 0.08 ms 902x Small project (10 modules) 50-100 ms 50-100 ms - Medium project (50 modules) 300-800 ms 150-300 ms 2x"},{"location":"architecture/#request-processing-flow","title":"Request Processing Flow","text":"<pre><code>1. Request arrives at Tornado\n   \u2514\u2500\u2500 IOLoop dispatches to Handler\n\n2. Create request context\n   \u251c\u2500\u2500 RequestContext.create()\n   \u251c\u2500\u2500 Set request_id\n   \u2514\u2500\u2500 Initialize request-level Scope\n\n3. Middleware processing (request phase)\n   \u251c\u2500\u2500 Execute process_request() by priority\n   \u251c\u2500\u2500 May short-circuit (e.g., auth failure)\n   \u2514\u2500\u2500 Pass to next middleware\n\n4. Controller instantiation\n   \u251c\u2500\u2500 Create Controller instance\n   \u251c\u2500\u2500 Inject dependencies (via InjectionRegistry)\n   \u2514\u2500\u2500 Parse request parameters\n\n5. Execute business logic\n   \u251c\u2500\u2500 Call Controller method\n   \u251c\u2500\u2500 Service layer processing\n   \u2514\u2500\u2500 Return response\n\n6. Middleware processing (response phase)\n   \u251c\u2500\u2500 Execute process_response() in reverse\n   \u251c\u2500\u2500 Can modify response\n   \u2514\u2500\u2500 Add response headers\n\n7. Clean up request context\n   \u251c\u2500\u2500 Execute cleanup callbacks\n   \u251c\u2500\u2500 Clear request-level dependencies\n   \u2514\u2500\u2500 Destroy RequestContext\n\n8. Return response to client\n</code></pre>"},{"location":"architecture/#module-scanning","title":"Module Scanning","text":""},{"location":"architecture/#scanning-strategy-multi-environment-support","title":"Scanning Strategy (Multi-environment Support)","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502    Detect Packaging Environment      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n           \u2502\n     \u250c\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n     \u25bc           \u25bc         \u25bc         \u25bc\nDevelopment  Nuitka   PyInstaller  Other\n     \u2502           \u2502         \u2502         \u2502\n     \u25bc           \u25bc         \u25bc         \u25bc\n  Standard   sys.modules  _MEIPASS  Fallback\n  Scanning\n</code></pre>"},{"location":"architecture/#scanning-statistics-new-in-v081","title":"Scanning Statistics (New in v0.81+)","text":"<pre><code>from cullinan.scan_stats import get_scan_stats_collector\n\ncollector = get_scan_stats_collector()\nstats = collector.get_aggregate_stats()\n\n# Output:\n# {\n#   'total_scans': 1,\n#   'avg_duration_ms': 66.06,\n#   'total_modules': 35,\n#   'fastest_scan_ms': 66.06,\n#   'slowest_scan_ms': 66.06\n# }\n</code></pre> <p>Collected Metrics: - Total duration (phased) - Module count (discovered/filtered/cached) - Scan mode (auto/explicit/cached) - Packaging environment (development/nuitka/pyinstaller) - Error recording</p>"},{"location":"architecture/#performance-optimization","title":"Performance Optimization","text":""},{"location":"architecture/#implemented-optimizations-v081","title":"Implemented Optimizations (v0.81+)","text":"Optimization Before After Improvement Module Scanning (Explicit) 69.56 ms 0.08 ms 902x RequestContext Init 500 ns 350 ns 30% RequestContext Memory 536 B 240 B 55% Dependency Resolution (Cached) - 0.26 \u03bcs Extremely Fast Logging Overhead (Production) 150 ns 100 ns 33%"},{"location":"architecture/#optimization-strategies","title":"Optimization Strategies","text":""},{"location":"architecture/#1-explicit-registration-mode","title":"1. Explicit Registration Mode","text":"<pre><code>from cullinan import configure\n\nconfigure(\n    explicit_services=[DatabaseService, CacheService],\n    explicit_controllers=[UserController, AdminController],\n    auto_scan=False  # Skip scanning\n)\n</code></pre> <p>Benefit: 902x startup speed improvement (test scenario)</p>"},{"location":"architecture/#2-lazy-initialization","title":"2. Lazy Initialization","text":"<ul> <li>RequestContext fields created on demand</li> <li>55% memory reduction</li> </ul>"},{"location":"architecture/#3-smart-caching","title":"3. Smart Caching","text":"<ul> <li>Module scanning result cache</li> <li>IoC dependency resolution cache (0.26 \u03bcs)</li> <li>Provider instance cache</li> </ul>"},{"location":"architecture/#4-structured-logging","title":"4. Structured Logging","text":"<ul> <li>Production log optimization</li> <li>Lazy evaluation reduces overhead</li> </ul>"},{"location":"architecture/#configuration-options","title":"Configuration Options","text":""},{"location":"architecture/#core-configuration","title":"Core Configuration","text":"<pre><code>from cullinan import configure\n\nconfigure(\n    # Basic configuration\n    port=8080,\n    debug=True,\n\n    # Performance optimization\n    explicit_services=[...],      # Explicit service registration\n    explicit_controllers=[...],   # Explicit controller registration\n    auto_scan=False,              # Disable auto-scanning\n    user_packages=['myapp'],      # Limit scan scope\n\n    # Startup behavior\n    startup_error_policy='strict', # 'strict'/'warn'/'ignore'\n\n    # Extension configuration\n    middlewares=[...],            # Custom middleware\n    handlers=[...],               # Custom Handler\n)\n</code></pre>"},{"location":"architecture/#best-practices","title":"Best Practices","text":""},{"location":"architecture/#1-dependency-injection","title":"1. Dependency Injection","text":"<p>\u2705 Recommended: Use type injection <pre><code>@service\nclass UserService(Service):\n    email_service: EmailService = Inject()\n</code></pre></p> <p>\u274c Avoid: Manually getting dependencies <pre><code># Not recommended\nregistry = get_service_registry()\nemail_service = registry.get_instance('EmailService')\n</code></pre></p>"},{"location":"architecture/#2-performance-optimization","title":"2. Performance Optimization","text":"<p>\u2705 Recommended: Use explicit registration (large projects) <pre><code>configure(\n    explicit_services=[...],\n    explicit_controllers=[...],\n    auto_scan=False\n)\n</code></pre></p> <p>\u2705 Recommended: Limit scan scope <pre><code>configure(\n    user_packages=['myapp', 'myapp.extensions'],\n    exclude_packages=['tests', '__pycache__']\n)\n</code></pre></p>"},{"location":"architecture/#3-middleware-design","title":"3. Middleware Design","text":"<p>\u2705 Recommended: Single responsibility <pre><code>@middleware(priority=50)\nclass AuthMiddleware(Middleware):  # Only handles auth\n    pass\n\n@middleware(priority=60)\nclass RoleMiddleware(Middleware):  # Only handles permissions\n    pass\n</code></pre></p> <p>\u274c Avoid: Mixed responsibilities <pre><code>@middleware(priority=50)\nclass AuthAndLoggingMiddleware(Middleware):  # Mixed\n    pass\n</code></pre></p>"},{"location":"architecture/#references","title":"References","text":"<ul> <li>Extension Development Guide</li> <li>API Reference</li> <li>Getting Started</li> <li>Migration Guide</li> </ul>"},{"location":"architecture/#migration-from-083","title":"Migration from 0.83","text":"<p>For migration from version 0.83 to 0.90, see the Import Migration Guide.</p> <p>Key changes: - <code>cullinan.core.application_context</code> \u2192 <code>cullinan.core.container</code> - <code>cullinan.core.definitions</code> \u2192 <code>cullinan.core.container</code> - <code>cullinan.core.exceptions</code> \u2192 <code>cullinan.core.diagnostics</code> - <code>cullinan.core.context</code> \u2192 <code>cullinan.core.request</code> - Legacy components moved to <code>cullinan.core.legacy/</code></p> <p>Version: v0.90 Author: Plumeink Last Updated: 2025-12-25</p>"},{"location":"build_run/","title":"Local Build &amp; Run","text":"<p>This page describes how to set up a local environment, install Cullinan in editable mode, run tests, and start example applications on Windows (PowerShell), Linux, and macOS.</p>"},{"location":"build_run/#prerequisites","title":"Prerequisites","text":"<ul> <li>Python 3.8 or newer</li> <li>Git</li> </ul>"},{"location":"build_run/#clone-the-repository","title":"Clone the repository","text":"<p>On all platforms:</p> <pre><code>git clone https://github.com/plumeink/Cullinan.git\ncd Cullinan\n</code></pre>"},{"location":"build_run/#create-and-activate-a-virtual-environment-optional-but-recommended","title":"Create and activate a virtual environment (optional but recommended)","text":"<p>On Windows (PowerShell):</p> <pre><code>python -m venv .venv\n.venv\\Scripts\\Activate.ps1\n</code></pre> <p>On Linux / macOS:</p> <pre><code>python -m venv .venv\nsource .venv/bin/activate\n</code></pre>"},{"location":"build_run/#install-dependencies-in-editable-mode","title":"Install dependencies in editable mode","text":"<p>On all platforms:</p> <pre><code>python -m pip install -U pip\npip install -e .\n</code></pre> <p>If you have additional development extras configured in <code>setup.py</code> or <code>pyproject.toml</code>, you can install them as needed, for example:</p> <pre><code>pip install -e .[dev]\n</code></pre>"},{"location":"build_run/#run-the-test-suite","title":"Run the test suite","text":"<p>On all platforms:</p> <pre><code>pytest -q\n</code></pre> <p>If your environment uses a different test runner, adapt the command accordingly (e.g. <code>python -m pytest</code>).</p>"},{"location":"build_run/#run-an-example-application","title":"Run an example application","text":""},{"location":"build_run/#hello-http-example","title":"Hello HTTP example","text":"<p>On Windows (PowerShell):</p> <pre><code>python examples\\hello_http.py\n</code></pre> <p>On Linux / macOS:</p> <pre><code>python examples/hello_http.py\n</code></pre> <p>Then open <code>http://localhost:4080/hello</code> in a browser to verify the server is running.</p>"},{"location":"build_run/#middleware-demo","title":"Middleware demo","text":"<p>On Windows (PowerShell):</p> <pre><code>python examples\\middleware_demo.py\n</code></pre> <p>On Linux / macOS:</p> <pre><code>python examples/middleware_demo.py\n</code></pre> <p>Refer to the middleware documentation for a description of the expected log output and behavior.</p>"},{"location":"contributing/","title":"Contributing","text":"<p>Placeholder: contribution guidelines, PR checklist, doc template, front-matter requirements, and review process.</p>"},{"location":"cullinan_documentation_plan/","title":"Cullinan \u6587\u6863\u7f16\u5199\u8ba1\u5212\u4e66","text":"<p>\u8bf4\u660e\uff1a\u672c\u8ba1\u5212\u57fa\u4e8e Cullinan \u6e90\u7801\uff08\u4ec5\u4ee5\u6e90\u7801\u5b9e\u73b0\u4e3a\u51c6\uff0c\u5ffd\u7565\u6ce8\u91ca\uff09\u8fdb\u884c\u8bbe\u8ba1\uff0c\u76ee\u6807\u662f\u4e3a\u9879\u76ee\u5efa\u7acb\u5b8c\u6574\u7684\u4e2d\u82f1\u53cc\u8bed\u6587\u6863\u4f53\u7cfb\uff08<code>docs/</code> \u4e0e <code>docs/zh/</code> 1:1 \u5bf9\u5e94\uff09\u3002</p>","tags":["plan","documentation"]},{"location":"cullinan_documentation_plan/#_1","title":"\u4efb\u52a1\u6536\u655b\u4e0e\u9ad8\u5c42\u8ba1\u5212","text":"<p>\u672c\u8ba1\u5212\u6587\u6863\u7528\u4e8e\u6536\u7eb3\u591a\u9636\u6bb5\u4efb\u52a1\u89c4\u5212\uff0c\u4fbf\u4e8e\u5728\u4ed3\u5e93\u4e2d\u4fdd\u7559\u89c4\u5212\u5185\u5bb9\uff0c\u4f9b\u56e2\u961f\u5ba1\u9605\u4e0e\u5206\u914d\u3002\u540e\u7eed\u64cd\u4f5c\u793a\u4f8b\uff1a</p> <ul> <li>\u521b\u5efa\u5e76\u63d0\u4ea4 Markdown \u8ba1\u5212\u6587\u4ef6\u5230 <code>docs/</code> \u76ee\u5f55\u3002</li> <li>\u8fd0\u884c\u9759\u6001\u68c0\u67e5\u4ee5\u786e\u4fdd\u6587\u4ef6\u6ca1\u6709\u8bed\u6cd5/\u683c\u5f0f\u9519\u8bef\uff08\u6587\u6863\u6587\u4ef6\u901a\u5e38\u4e0d\u4f1a\u4ea7\u751f\u4ee3\u7801\u7f16\u8bd1\u9519\u8bef\uff0c\u4f46\u4ecd\u5efa\u8bae\u8fdb\u884c\u57fa\u672c\u68c0\u67e5\uff09\u3002</li> </ul> <p>\u7b80\u8981\u9a8c\u6536\u6e05\u5355\uff08\u5728\u63d0\u4ea4\u524d\uff09\uff1a - [x] \u6587\u4ef6\u4ee5 UTF-8 \u7f16\u7801\u3001Markdown \u683c\u5f0f\u4fdd\u5b58\u3002 - [x] \u5305\u542b\u76ee\u6807\u3001\u8303\u56f4\u3001\u4efb\u52a1\u62c6\u5206\u3001\u65f6\u95f4\u9884\u4f30\u3001\u8d28\u91cf\u95e8\u4e0e\u793a\u4f8b\u547d\u4ee4\u8bf4\u660e\u3002 - [x] \u660e\u786e\u8981\u6c42 <code>docs/</code> \u4e0e <code>docs/zh/</code> \u5fc5\u987b 1:1 \u5bf9\u5e94\u3002</p> <p>TL;DR\uff1a\u4e3a Cullinan\uff08\u57fa\u4e8e Tornado \u7684 IoC/DI \u6846\u67b6\uff09\u7f16\u5199\u4e2d\u82f1\u53cc\u8bed\u6587\u6863\uff08<code>docs/</code> \u4e0e <code>docs/zh/</code> 1:1 \u5bf9\u5e94\uff09\uff0c\u5305\u62ec\u5165\u95e8\u3001\u793a\u4f8b\u3001Wiki\uff08\u67b6\u6784/\u7ec4\u4ef6/\u751f\u547d\u5468\u671f/\u6ce8\u5165/\u4e2d\u95f4\u4ef6/\u6269\u5c55\uff09\u3001API \u53c2\u8003\u3001\u8fc1\u79fb\u6307\u5357\u3001\u8d21\u732e\u6307\u5357\u3001\u6d4b\u8bd5\u4e0e\u672c\u5730\u8fd0\u884c\u8bf4\u660e\uff1b\u91c7\u7528\u6e90\u7801\u9a71\u52a8\uff08\u5ffd\u7565\u6ce8\u91ca\uff09\u7814\u7a76\u7b56\u7565\uff0c\u4fdd\u6301\u73b0\u6709 IoC/DI \u8bbe\u8ba1\u4e0d\u53d8\uff0c\u63d0\u4f9b\u5206\u5de5\u3001\u91cc\u7a0b\u7891\u3001\u8d28\u91cf\u95e8\u4e0e PowerShell \u7b49\u73af\u5883\u4e0b\u7684\u8fd0\u884c/\u9a8c\u8bc1\u547d\u4ee4\u793a\u4f8b\u3002</p>","tags":["plan","documentation"]},{"location":"cullinan_documentation_plan/#1","title":"1. \u76ee\u6807\u4e0e\u53d7\u4f17","text":"<ul> <li>\u76ee\u6807\uff1a\u4e3a Cullinan \u63d0\u4f9b\u6e05\u6670\u3001\u53ef\u6267\u884c\u3001\u53cc\u8bed\uff08\u82f1\u6587/\u4e2d\u6587\uff09\u6587\u6863\u5957\u4ef6\uff0c\u5e2e\u52a9\u65b0\u7528\u6237\u5feb\u901f\u4e0a\u624b\uff0c\u5e2e\u52a9\u8d21\u732e\u8005\u7406\u89e3\u5185\u90e8\u8bbe\u8ba1\u4e0e\u6ce8\u5165\u673a\u5236\uff0c\u63d0\u4f9b\u53ef\u8fd0\u884c\u7684\u793a\u4f8b\u4e0e\u6d4b\u8bd5\u9a8c\u8bc1\u6b65\u9aa4\u3002</li> <li>\u53d7\u4f17\uff1a\u5e93\u4f7f\u7528\u8005\uff08\u5e94\u7528\u5f00\u53d1\u8005\uff09\u3001\u6846\u67b6\u8d21\u732e\u8005/\u7ef4\u62a4\u8005\u3001\u4ee3\u7801\u5ba1\u67e5\u8005\u3001\u81ea\u52a8\u5316\u6d4b\u8bd5\u5de5\u7a0b\u5e08\u3002</li> </ul>","tags":["plan","documentation"]},{"location":"cullinan_documentation_plan/#2","title":"2. \u8303\u56f4\u4e0e\u4ea7\u7269\u6e05\u5355","text":"<p>\u5fc5\u987b\u4ea7\u51fa\uff08\u6bcf\u9879\u5747\u9700\u5728 <code>docs/</code> \u4e0e <code>docs/zh/</code> \u4e0b 1:1 \u5bf9\u5e94\uff09\uff1a</p> <ul> <li><code>Getting Started</code>\uff08\u5feb\u901f\u5165\u95e8\uff09 \u2014 <code>docs/getting_started.md</code> / <code>docs/zh/getting_started.md</code></li> <li><code>Examples</code>\uff08\u793a\u4f8b\uff09 \u2014 <code>docs/examples.md</code> / <code>docs/zh/examples.md</code>\uff08\u5e76\u5728\u4ed3\u5e93\u4fdd\u7559 <code>examples/</code> \u53ef\u8fd0\u884c\u4ee3\u7801\uff09</li> <li><code>Wiki</code>\uff08\u67b6\u6784/\u7ec4\u4ef6/\u751f\u547d\u5468\u671f/\u6ce8\u5165/\u4e2d\u95f4\u4ef6/\u6269\u5c55\uff09 \u2014 <code>docs/wiki/architecture.md</code>, <code>components.md</code>, <code>lifecycle.md</code>, <code>injection.md</code>, <code>middleware.md</code>, <code>extensions.md</code>\uff08\u548c <code>docs/zh/wiki/*</code>\uff09</li> <li><code>API Reference</code> \u2014 <code>docs/api_reference.md</code> / <code>docs/zh/api_reference.md</code>\uff08\u53ef\u9009\u62e9\u81ea\u52a8\u5316\u751f\u6210\uff09</li> <li><code>Migration Guide</code> \u2014 <code>docs/migration_guide.md</code> / <code>docs/zh/migration_guide.md</code></li> <li><code>Contributing</code> \u2014 <code>docs/contributing.md</code> / <code>docs/zh/contributing.md</code></li> <li><code>Testing &amp; Verification</code> \u2014 <code>docs/testing.md</code> / <code>docs/zh/testing.md</code></li> <li><code>Local Build &amp; Run</code> \u2014 <code>docs/build_run.md</code> / <code>docs/zh/build_run.md</code></li> <li>\u6587\u6863\u6a21\u677f\u548c\u6837\u4f8b\u9875\u9762\uff08front-matter\u3001\u793a\u4f8b\u4ee3\u7801\u7247\u6bb5\u89c4\u8303\u3001\u7ffb\u8bd1\u51c6\u5219\uff09</li> </ul> <p>\u9644\u52a0\u4ea7\u7269\uff08\u5efa\u8bae\uff09\uff1a</p> <ul> <li><code>examples/</code> \u53ef\u8fd0\u884c\u793a\u4f8b\u96c6\u5408\uff08\u8f7b\u91cf demo\uff09</li> <li>\u7b80\u8981 <code>README.md</code> \u66f4\u65b0\u94fe\u63a5 <code>docs/</code> \u9875\u9762</li> <li>\u6587\u6863 CI \u811a\u672c\uff08\u53ef\u9009\uff09</li> </ul>","tags":["plan","documentation"]},{"location":"cullinan_documentation_plan/#3","title":"3. \u7814\u7a76\u65b9\u6cd5\u4e0e\u4ee3\u7801\u9605\u8bfb\u7b56\u7565\uff08\u53ea\u8bfb\u6e90\u7801\uff0c\u5ffd\u7565\u6ce8\u91ca\uff09","text":"<p>\u7814\u7a76\u76ee\u6807\uff1a\u4ece\u6e90\u7801\u63a8\u65ad\u8bbe\u8ba1\u4e0e\u884c\u4e3a\uff08\u4e0d\u4f9d\u8d56\u6ce8\u91ca\uff09\uff0c\u5b9a\u4f4d\u5173\u952e\u6a21\u5757\u4e0e\u4f9d\u8d56\u5173\u7cfb\uff0c\u63d0\u53d6\u5916\u90e8 API\u3001\u751f\u547d\u5468\u671f\u548c\u6ce8\u5165\u884c\u4e3a\u3002</p> <p>\u7b56\u7565\u4e0e\u6b65\u9aa4\uff1a</p> <ol> <li>\u9ad8\u5c42\u76ee\u5f55\u626b\u63cf\uff1a\u5148\u786e\u8ba4\u9876\u5c42\u6a21\u5757\u4e0e\u5165\u53e3\u70b9\u3002\u4f18\u5148\u9605\u8bfb <code>cullinan/__init__.py</code>\u3001<code>app.py</code>\u3001<code>application.py</code>\u3001<code>config.py</code>\u3002</li> <li>\u6838\u5fc3\u5b50\u7cfb\u7edf\u5b9a\u4f4d\uff1a\u5b9a\u4f4d IoC/DI \u5b9e\u73b0\u4f4d\u7f6e\uff08\u901a\u5e38\u5728 <code>cullinan/core</code>\uff09\u3002\u91cd\u70b9\u9605\u8bfb <code>core/__init__.py</code>\u3001<code>core/provider.py</code>\u3001<code>core/registry.py</code>\u3001<code>core/scope.py</code> \u7b49\uff08\u5b9e\u9645\u6587\u4ef6\u540d\u8bf7\u6839\u636e <code>cullinan/core</code> \u76ee\u5f55\u6587\u4ef6\u5217\u8868\u8c03\u6574\uff09\u3002</li> <li>\u63a7\u5236\u5668/\u8def\u7531/\u4e2d\u95f4\u4ef6\uff1a\u67e5\u770b <code>controller/</code>\u3001<code>handler/</code>\u3001<code>middleware/</code> \u6587\u4ef6\uff0c\u627e\u5230\u8def\u7531\u6ce8\u518c\u3001\u5904\u7406\u6d41\u7a0b\u4e0e\u751f\u547d\u5468\u671f\u94a9\u5b50\u3002</li> <li>\u6a21\u5757\u626b\u63cf\u4e0e\u81ea\u52a8\u6ce8\u518c\uff1a\u9605\u8bfb <code>module_scanner.py</code>\u3001<code>websocket_registry.py</code> \u7b49\u4e86\u89e3\u81ea\u52a8\u53d1\u73b0\u673a\u5236\u4e0e\u6ce8\u518c\u65f6\u5e8f\u3002</li> <li>\u914d\u7f6e\u4e0e\u542f\u52a8\u6d41\u7a0b\uff1a\u8ffd\u8e2a <code>application.py</code> \u4e0e <code>app.py</code> \u4e2d\u7684 <code>main</code>\u3001<code>start</code>\u3001<code>initialize</code>\u3001<code>run</code> \u98ce\u683c\u51fd\u6570\uff0c\u5f62\u6210\u542f\u52a8\u5e8f\u5217\u56fe\uff08\u987a\u5e8f\u3001\u4f9d\u8d56\uff09\u3002</li> <li>\u6ce8\u5165\u70b9\u53d1\u73b0\uff1a\u5728\u6e90\u7801\u4e2d\u641c\u7d22\u5173\u952e\u8bcd\uff08<code>inject</code>, <code>provide</code>, <code>provider</code>, <code>register</code>, <code>scope</code>, <code>singleton</code>, <code>transient</code>\uff09\u4ee5\u5b9a\u4f4d\u6ce8\u5165 API \u4e0e\u7528\u6cd5\u3002</li> <li>\u4ee5\u6d4b\u8bd5\u4e3a\u53cd\u8bc1\uff1a\u5ba1\u9605 <code>tests/</code> \u4e0b\u5173\u952e\u6d4b\u8bd5\uff08\u5982 <code>test_core_injection.py</code>\u3001<code>test_controller_injection_fix.py</code>\u3001<code>test_registry.py</code> \u7b49\uff09\u6765\u7406\u89e3\u671f\u671b\u884c\u4e3a\u4e0e\u8fb9\u754c\u6761\u4ef6\uff08\u6d4b\u8bd5\u662f\u884c\u4e3a\u89c4\u8303\u7684\u6700\u6743\u5a01\u6765\u6e90\uff09\u3002</li> <li>\u4f9d\u8d56\u56fe\u6784\u5efa\uff1a\u4f7f\u7528\u9759\u6001\u8bfb\u53d6\uff08\u6216\u7b80\u5355\u811a\u672c\uff09\u5217\u51fa\u6a21\u5757\u4e4b\u95f4 import \u5173\u7cfb\uff0c\u7ed8\u5236\u7b80\u6613\u6a21\u5757\u4f9d\u8d56\u56fe\uff08\u5e2e\u52a9\u64b0\u5199\u67b6\u6784/\u7ec4\u4ef6\u8bf4\u660e\uff09\u3002</li> <li>\u8bb0\u5f55\u53d1\u73b0\uff1a\u4ee5\u201c\u4e8b\u5b9e\u9648\u8ff0\u201d\u8bb0\u5f55\u6bcf\u4e2a\u6a21\u5757\u7684\u804c\u8d23\u3001\u8f93\u5165\u8f93\u51fa\u3001\u751f\u547d\u5468\u671f\u3001\u9519\u8bef\u6a21\u5f0f\u3002\u4ec5\u57fa\u4e8e\u6e90\u7801\u884c\u4e3a\uff0c\u4e0d\u4f9d\u8d56\u6ce8\u91ca\u89e3\u91ca\u3002</li> </ol> <p>\u5de5\u5177\u4e0e\u65b9\u6cd5\uff1a</p> <ul> <li>\u4f7f\u7528\u4ed3\u5e93\u641c\u7d22\uff08\u901a\u8fc7 IDE \u6216 <code>rg</code>/<code>grep</code>\uff09\u5b9a\u4f4d\u7b26\u53f7\u548c\u5b57\u7b26\u4e32\u6a21\u5f0f\u3002</li> <li>\u9605\u8bfb\u5173\u952e\u6d4b\u8bd5\u7528\u4f8b\u4ee5\u8865\u5168\u7406\u89e3\u3002</li> <li>\u6784\u5efa\u5c0f\u7684\u95ee\u7b54\u5f0f\u7b14\u8bb0\uff08\u6a21\u5757 -&gt; \u8d23\u4efb -&gt; \u4e0e\u5176\u4ed6\u6a21\u5757\u7684\u4ea4\u4e92\uff09\u4f9b\u6587\u6863\u5199\u4f5c\u4f7f\u7528\u3002</li> </ul> <p>\u6ce8\u610f\uff1a\u4e0d\u8981\u5728\u6587\u6863\u4e2d\u6539\u53d8\u6216\u9f13\u52b1\u6539\u53d8\u73b0\u6709 IoC/DI \u8bbe\u8ba1\uff1b\u6587\u6863\u53ea\u63cf\u8ff0/\u8bf4\u660e\u3001\u53ef\u63d0\u51fa\u201c\u6539\u8fdb\u5efa\u8bae\u201d\u4f46\u987b\u4f5c\u4e3a\u9644\u5f55\u6216 issues\u3002</p>","tags":["plan","documentation"]},{"location":"cullinan_documentation_plan/#4","title":"4. \u4efb\u52a1\u62c6\u5206\u4e0e\u91cc\u7a0b\u7891\uff08\u4f18\u5148\u7ea7 + \u65f6\u95f4\u4f30\u7b97\uff09","text":"<p>\u603b\u4f53\u9884\u8ba1\u65f6\u957f\uff1a6 \u5468\uff08\u53ef\u6309\u8d44\u6e90\u5e76\u884c\u538b\u7f29\uff09\u3002\u65f6\u95f4\u5355\u4f4d\u4e3a\u4eba\u5929\uff08\u5de5\u4f5c\u65e5\uff09\u3002</p> <p>\u9636\u6bb5 A \u2014 \u53d1\u73b0\u4e0e\u5927\u7eb2\uff08\u4f18\u5148\u7ea7\uff1a\u9ad8\uff0c\u65f6\u957f\uff1a4 \u4eba\u65e5\uff09 - A1. \u6e90\u7801\u5feb\u901f\u626b\u63cf\u5e76\u751f\u6210\u6a21\u5757\u6620\u5c04\uff082 \u4eba\u65e5\uff09 - A2. \u57fa\u4e8e\u6620\u5c04\u8349\u62df\u6587\u6863\u603b\u7eb2\uff081 \u4eba\u65e5\uff09 - A3. \u786e\u8ba4\u8f93\u51fa\u683c\u5f0f\uff08Markdown \u7ed3\u6784\u3001\u76ee\u5f55\u3001\u7ffb\u8bd1\u6d41\u7a0b\u3001\u662f\u5426\u7528 Sphinx/ mkdocs \u7b49\uff09\uff081 \u4eba\u65e5\uff09</p> <p>\u91cc\u7a0b\u7891 A\uff1a\u63d0\u4ea4 <code>docs/outline.md</code> \u4e0e <code>docs/zh/outline.md</code>\uff0c\u5305\u542b\u6587\u4ef6\u6e05\u5355\u4e0e\u8d1f\u8d23\u4eba\u3002</p> <p>\u9636\u6bb5 B \u2014 \u5165\u95e8\u4e0e\u793a\u4f8b\uff08\u4f18\u5148\u7ea7\uff1a\u9ad8\uff0c\u65f6\u957f\uff1a6 \u4eba\u65e5\uff09 - B1. \u64b0\u5199 <code>Getting Started</code> \u82f1\u4e2d\u7248\u672c\uff082 \u4eba\u65e5\uff09 - B2. \u8bbe\u8ba1\u5e76\u5b9e\u73b0 2-3 \u4e2a\u6700\u5c0f\u53ef\u8fd0\u884c\u793a\u4f8b\u5230 <code>examples/</code>\uff083 \u4eba\u65e5\uff09 - B3. \u5c06\u793a\u4f8b\u96c6\u6210\u5230\u6587\u6863\u5e76\u9a8c\u8bc1\uff081 \u4eba\u65e5\uff09</p> <p>\u91cc\u7a0b\u7891 B\uff1a<code>docs/getting_started.md</code> \u4e0e <code>examples/</code> \u53ef\u88ab\u672c\u5730\u7528\u6237\u8fd0\u884c\u3002</p> <p>\u9636\u6bb5 C \u2014 \u6838\u5fc3 Wiki\uff08\u67b6\u6784/\u7ec4\u4ef6/\u751f\u547d\u5468\u671f/\u6ce8\u5165\u673a\u5236/\u4e2d\u95f4\u4ef6/\u6269\u5c55\uff09\uff08\u4f18\u5148\u7ea7\uff1a\u9ad8\uff0c\u65f6\u957f\uff1a10 \u4eba\u65e5\uff09 - C1. <code>architecture.md</code>\uff082 \u4eba\u65e5\uff09 - C2. <code>components.md</code>\uff082 \u4eba\u65e5\uff09 - C3. <code>lifecycle.md</code>\uff082 \u4eba\u65e5\uff09 - C4. <code>injection.md</code>\uff083 \u4eba\u65e5\uff09 - C5. <code>middleware.md</code> / <code>extensions.md</code>\uff081 \u4eba\u65e5\uff09</p> <p>\u91cc\u7a0b\u7891 C\uff1a\u6df1\u5ea6\u7406\u89e3\u5e76\u6587\u6863\u5316\u6838\u5fc3\u8bbe\u8ba1\uff0c\u540c\u884c\u8bc4\u5ba1\u901a\u8fc7\u3002</p> <p>\u9636\u6bb5 D \u2014 API \u53c2\u8003\u4e0e\u8fc1\u79fb\u6307\u5357\uff08\u4f18\u5148\u7ea7\uff1a\u4e2d\uff0c\u65f6\u957f\uff1a8 \u4eba\u65e5\uff09 - D1. \u51b3\u5b9a API \u53c2\u8003\u65b9\u5f0f\uff08\u81ea\u52a8 vs \u624b\u5de5\uff09\uff080.5 \u5929\uff09 - D2. \u751f\u6210\u6216\u624b\u5199\u6240\u6709\u516c\u5171\u6a21\u5757\u7684 API \u6458\u8981\uff085 \u4eba\u65e5\uff09 - D3. \u64b0\u5199\u8fc1\u79fb\u6307\u5357\uff08\u517c\u5bb9\u6027/\u7834\u574f\u6027\u53d8\u5316\u8bf4\u660e\uff09\uff082.5 \u4eba\u65e5\uff09</p> <p>\u91cc\u7a0b\u7891 D\uff1aAPI \u53c2\u8003\u5b8c\u6210\u5e76\u53ef\u7d22\u5f15\uff1b\u8fc1\u79fb\u6307\u5357\u8986\u76d6\u4e3b\u8981\u53d8\u66f4\u70b9\u3002</p> <p>\u9636\u6bb5 E \u2014 \u8d21\u732e/\u6d4b\u8bd5/\u8fd0\u884c\u8bf4\u660e\u4e0e\u672c\u5730\u6784\u5efa\uff08\u4f18\u5148\u7ea7\uff1a\u4e2d\uff0c\u65f6\u957f\uff1a4 \u4eba\u65e5\uff09 - E1. <code>contributing.md</code>\uff081 \u4eba\u65e5\uff09 - E2. <code>testing.md</code>\uff081 \u4eba\u65e5\uff09 \u2014 \u5305\u62ec\u5982\u4f55\u8fd0\u884c\u73b0\u6709\u6d4b\u8bd5\u3001\u5982\u4f55\u7f16\u5199\u6d4b\u8bd5\u3001CI \u8981\u6c42 - E3. <code>build_run.md</code>\uff082 \u4eba\u65e5\uff09 \u2014 \u5305\u542b Windows PowerShell \u6307\u4ee4\u548c\u865a\u62df\u73af\u5883\u6b65\u9aa4</p> <p>\u91cc\u7a0b\u7891 E\uff1a\u8d21\u732e\u6d41\u7a0b\u4e0e\u6d4b\u8bd5\u51c6\u5219\u5c31\u7eea\u3002</p> <p>\u9636\u6bb5 F \u2014 \u7ffb\u8bd1\u3001\u6821\u9a8c\u3001\u8d28\u91cf\u95e8\uff08\u4f18\u5148\u7ea7\uff1a\u9ad8\uff0c\u65f6\u957f\uff1a6 \u4eba\u65e5\uff09 - F1. \u7ffb\u8bd1\u6821\u5bf9\uff08\u82f1-&gt;\u4e2d\uff09\u5e76\u786e\u4fdd 1:1 \u6587\u4ef6\u7ed3\u6784\uff083 \u4eba\u65e5\uff09 - F2. \u6587\u6863\u5185\u90e8\u5ba1\u6821\uff08\u7ed3\u6784\u3001\u4e8b\u5b9e\u3001\u4e3e\u4f8b\u53ef\u8fd0\u884c\uff09\uff082 \u4eba\u65e5\uff09 - F3. \u6700\u7ec8\u8d28\u91cf\u95e8\uff08\u8fd0\u884c\u6d4b\u8bd5\u3001\u793a\u4f8b\u9a8c\u8bc1\u3001\u63d0\u4ea4 PR\uff09\uff081 \u4eba\u65e5\uff09</p> <p>\u91cc\u7a0b\u7891 F\uff1a\u53cc\u8bed\u6587\u6863 1:1 \u5bf9\u5e94\u901a\u8fc7 QA\u3002</p> <p>\u603b\u4f53\u91cc\u7a0b\u7891\u65f6\u95f4\u8868\uff08\u5e76\u884c\u53ef\u7f29\u77ed\uff09\uff1a - \u5468 1\uff1a\u9636\u6bb5 A \u5b8c\u6210 - \u5468 2\uff1a\u9636\u6bb5 B \u5f00\u59cb\u5e76\u5b8c\u6210 - \u5468 3-4\uff1a\u9636\u6bb5 C \u5b8c\u6210 - \u5468 5\uff1a\u9636\u6bb5 D \u4e0e E \u5b8c\u6210 - \u5468 6\uff1a\u9636\u6bb5 F \u9a8c\u6536\u3001\u53d1\u5e03</p>","tags":["plan","documentation"]},{"location":"cullinan_documentation_plan/#5","title":"5. \u4eba\u5458\u5206\u5de5\u5efa\u8bae\uff08\u793a\u4f8b\uff09","text":"<ul> <li>1 * \u6280\u672f\u4f5c\u8005\uff08\u4e3b\u6587\u6863\u64b0\u5199\uff09 \u2014 \u8d1f\u8d23\u5165\u95e8\u3001Wiki \u4e3b\u4f53\u3001\u793a\u4f8b\u6587\u672c</li> <li>1 * \u5f00\u53d1\u5de5\u7a0b\u5e08\uff08\u4ee3\u7801\u7814\u7a76\u4e0e\u793a\u4f8b\u5b9e\u73b0\uff09 \u2014 \u8d1f\u8d23\u6e90\u7801\u6620\u5c04\u3001\u53ef\u8fd0\u884c\u793a\u4f8b\u3001\u9a8c\u8bc1\u6d4b\u8bd5</li> <li>1 * \u7ffb\u8bd1/\u672c\u5730\u5316\uff08\u4e2d\u6587\u6821\u5bf9\uff09 \u2014 \u8d1f\u8d23 <code>docs/zh/</code> \u5bf9\u5e94\u7ffb\u8bd1\u4e0e\u8bed\u5883\u6821\u9a8c</li> <li>1 * \u8bc4\u5ba1/\u7ef4\u62a4\u8005\uff08\u67b6\u6784 &amp; CI \u5ba1\u6838\uff09 \u2014 \u8d1f\u8d23\u5ba1\u7a3f\u3001CI \u5408\u5e76\u3001\u8d28\u91cf\u95e8\u7b7e\u6536</li> </ul>","tags":["plan","documentation"]},{"location":"cullinan_documentation_plan/#6","title":"6. \u5199\u4f5c\u51c6\u5219\uff08\u5fc5\u9075\u5b88\uff09","text":"<ul> <li>\u6587\u4ef6\u7f16\u7801\uff1aUTF-8\u3002</li> <li>\u76ee\u5f55\u7ed3\u6784\uff1a<code>docs/</code> \u4e0e <code>docs/zh/</code> \u5fc5\u987b 1:1 \u5bf9\u5e94\uff0c\u6587\u4ef6\u540d\u4e0e\u76f8\u5bf9\u8def\u5f84\u4e00\u81f4\u3002</li> <li>\u8bed\u8a00\u4e0e\u98ce\u683c\uff1a\u7b80\u6d01\u3001\u4e8b\u5b9e\u9a71\u52a8\uff08\u4ee5\u6e90\u7801\u884c\u4e3a\u4e3a\u51c6\uff09\uff0c\u5c3d\u91cf\u63d0\u4f9b\u793a\u4f8b\u548c\u53ef\u590d\u5236\u6b65\u9aa4\u3002</li> <li>\u7981\u6b62\u5728\u65e5\u5fd7\u6216\u793a\u4f8b\u8f93\u51fa\u4e2d\u4f7f\u7528 emoji\uff08\u9879\u76ee\u89c4\u5b9a\uff09\u3002</li> <li>Windows PowerShell \u547d\u4ee4\u793a\u4f8b\u5e94\u7b26\u5408 Windows PowerShell v5.1 \u8bed\u6cd5\uff1b\u4e0d\u8981\u4f7f\u7528 <code>&amp;&amp;</code> \u8fde\u63a5\u547d\u4ee4\uff1b\u82e5\u9700\u8981\u5728\u4e00\u884c\u6267\u884c\u591a\u4e2a\u547d\u4ee4\uff0c\u4f7f\u7528\u5206\u53f7 <code>;</code>\u3002</li> <li>\u6587\u6863\u4e2d\u5f15\u7528\u6587\u4ef6\u6216\u7b26\u53f7\u65f6\u4f7f\u7528\u53cd\u5f15\u53f7\u5305\u88f9\uff08\u4f8b\u5982 <code>cullinan/core</code>\u3001<code>application.py</code>\uff09\u3002</li> <li>\u5bf9\u4e8e API \u53c2\u8003\uff0c\u660e\u786e\u6807\u6ce8\u201c\u516c\u6709 API\u201d\u4e0e\u201c\u5185\u90e8\u5b9e\u73b0\u201d\uff0c\u9f13\u52b1\u53ea\u5728\u516c\u6709 API \u4e0a\u5efa\u7acb\u4f7f\u7528\u793a\u4f8b\u3002</li> <li>\u7ffb\u8bd1\u7b56\u7565\uff1a\u5148\u5b8c\u6210\u82f1\u6587\u539f\u7a3f\u5e76\u8bc4\u5ba1\u901a\u8fc7\uff0c\u518d\u505a\u4e2d\u6587\u7ffb\u8bd1\uff1b\u59cb\u7ec8\u4fdd\u6301 1:1 \u5185\u5bb9\u4e00\u81f4\u6027\u3002</li> </ul>","tags":["plan","documentation"]},{"location":"cullinan_documentation_plan/#7-quality-gates","title":"7. \u6821\u9a8c / \u8d28\u91cf\u95e8\uff08Quality Gates\uff09","text":"<p>\u6bcf\u4e2a\u9636\u6bb5\u5fc5\u987b\u901a\u8fc7\u76f8\u5e94\u7684\u8d28\u91cf\u95e8\u624d\u80fd\u8fdb\u5165\u4e0b\u4e00\u9636\u6bb5\uff1a</p> <p>\u8d28\u91cf\u95e8\u793a\u4f8b\uff1a - \u4ee3\u7801\u7814\u7a76\u5b8c\u6210\uff1a\u63d0\u4ea4 <code>docs/outline.md</code>\uff0c\u5305\u542b\u6a21\u5757\u6620\u5c04\u4e0e\u5173\u952e\u51fd\u6570\u5217\u8868\uff1b\u81f3\u5c11\u4e24\u4f4d\u5de5\u7a0b\u5e08\u5ba1\u6838\u540c\u610f\uff08\u7b7e\u540d\u6216 PR \u8bc4\u8bba\uff09\u3002 - \u793a\u4f8b\u53ef\u8fd0\u884c\uff1a<code>examples/</code> \u4e2d\u793a\u4f8b\u53ef\u5728\u672c\u5730\u865a\u62df\u73af\u5883\u4e2d\u6210\u529f\u8fd0\u884c\uff08\u89c1\u9a8c\u8bc1\u547d\u4ee4\uff09\u3002 - \u5355\u5143/\u96c6\u6210\u6d4b\u8bd5\uff1a\u8fd0\u884c\u4ed3\u5e93\u73b0\u6709\u6d4b\u8bd5\u5e76\u786e\u4fdd\u65e0\u56de\u5f52\uff08\u89c1\u4e0b\u65b9\u547d\u4ee4\uff09\u3002\u5fc5\u987b\u81f3\u5c11\u5b9e\u73b0\u201c\u5f53\u524d\u4e3b\u5206\u652f\u76f8\u540c\u6216\u66f4\u597d\u201d\u7684\u901a\u8fc7\u7387\u3002 - \u6587\u6863\u5ba1\u6821\uff1a\u6bcf\u7bc7\u6587\u6863\u81f3\u5c11 1 \u6b21\u6280\u672f\u5ba1\u9605\u4e0e 1 \u6b21\u8bed\u8a00\u6821\u5bf9\uff08\u4e2d\u6587\uff09\u3002 - \u53d1\u5e03\u524d\uff1aCI \u901a\u8fc7\u3001\u6587\u6863\u94fe\u63a5\u5b8c\u6574\u6027\u68c0\u67e5\u3001\u793a\u4f8b\u5728 Windows PowerShell \u6d4b\u8bd5\u901a\u8fc7\u3002</p> <p>\u5173\u952e\u6821\u9a8c\u547d\u4ee4\uff08PowerShell \u8868\u793a\u6cd5\uff0c\u5355\u884c\u793a\u4f8b\u4f7f\u7528 <code>;</code> \u5206\u9694\uff09\uff1a - \u521b\u5efa\u865a\u62df\u73af\u5883\u5e76\u6fc0\u6d3b\uff08\u53ef\u9009\uff09\uff1a\u8bf7\u786e\u4fdd\u4f60\u6709\u4e00\u4e2a\u53ef\u7528\u7684 Python \u73af\u5883\uff08virtualenv/conda/system Python \u7b49\u5747\u53ef\uff09\uff0c\u65e0\u9700\u5728\u6587\u6863\u4e2d\u786c\u6027\u89c4\u5b9a\u6fc0\u6d3b\u547d\u4ee4\u3002 - \u5b89\u88c5\u5f00\u53d1\u4f9d\u8d56\u5e76\u5b89\u88c5\u672c\u5305\uff08\u53ef\u9009 extras\uff09\uff1a<code>pip install -U pip; pip install -e .[dev]</code> \u6216 <code>pip install -e .</code> - \u8fd0\u884c\u6d4b\u8bd5\uff1a<code>py -3 -m pytest -q</code>\uff08\u6216 <code>pytest -q</code>\uff09 - \u8fd0\u884c\u5355\u4e2a\u793a\u4f8b\uff08\u5728 <code>examples/</code> \u76ee\u5f55\uff09\uff1a<code>py example_script.py</code> \u6216 <code>python -m examples.demo</code>\uff08\u53d6\u51b3\u4e8e\u793a\u4f8b\u5b9e\u73b0\uff09 - \u68c0\u67e5\u6587\u6863\u94fe\u63a5/\u62fc\u5199\uff08\u82e5\u4f7f\u7528\u5de5\u5177\uff09\uff1a<code>pylint</code>/<code>flake8</code>\uff08\u4ee3\u7801\uff09\uff0c<code>markdownlint</code>\uff08\u6587\u6863\uff09\uff08\u6309\u9700\u5b89\u88c5\uff09</p>","tags":["plan","documentation"]},{"location":"cullinan_documentation_plan/#8","title":"8. \u9700\u8981\u521b\u5efa\u7684\u6587\u4ef6\u7ed3\u6784\u4e0e\u6a21\u677f\u793a\u4f8b","text":"<p>\u5efa\u8bae\u5728\u4ed3\u5e93\u4e2d\u65b0\u589e/\u586b\u5145\u4ee5\u4e0b\u6587\u4ef6\uff08<code>docs/</code> \u4e0e <code>docs/zh/</code> \u5fc5\u987b\u955c\u50cf\uff09\uff1a</p> <ul> <li><code>docs/README.md</code>\uff08\u6587\u6863\u4e3b\u9875/\u5bfc\u822a\uff09</li> <li><code>docs/getting_started.md</code>\uff08\u5feb\u901f\u5f00\u59cb - \u73af\u5883\u3001\u5b89\u88c5\u3001\u8fd0\u884c\u7b2c\u4e00\u4e2a\u5e94\u7528\uff09</li> <li><code>docs/examples.md</code>\uff08\u793a\u4f8b\u7d22\u5f15\u4e0e\u8bf4\u660e\uff09 + <code>examples/</code> \u76ee\u5f55\u653e\u793a\u4f8b\u4ee3\u7801</li> <li><code>docs/wiki/architecture.md</code>\uff08\u67b6\u6784\u603b\u89c8\uff09</li> <li><code>docs/wiki/components.md</code>\uff08\u7ec4\u4ef6\u8d23\u4efb &amp; API \u6458\u8981\uff09</li> <li><code>docs/wiki/lifecycle.md</code>\uff08\u5e94\u7528\u542f\u52a8/\u5173\u95ed/\u751f\u547d\u5468\u671f\u94a9\u5b50\uff09</li> <li><code>docs/wiki/injection.md</code>\uff08IoC/DI \u673a\u5236\u8be6\u89e3\uff09</li> <li><code>docs/wiki/middleware.md</code>\uff08\u4e2d\u95f4\u4ef6\u94fe\u4e0e\u6269\u5c55\u70b9\uff09</li> <li><code>docs/api_reference.md</code>\uff08\u6309\u6a21\u5757\u5217\u51fa\u7684\u516c\u6709 API\uff09</li> <li><code>docs/migration_guide.md</code>\uff08\u517c\u5bb9\u6027\u4e0e\u8fc1\u79fb\uff09</li> <li><code>docs/contributing.md</code>\uff08\u8d21\u732e\u8005\u6307\u5357\u3001\u4ee3\u7801\u98ce\u683c\u3001PR \u6d41\u7a0b\uff09</li> <li><code>docs/testing.md</code>\uff08\u5982\u4f55\u8fd0\u884c\u73b0\u6709 tests\u3001\u5199\u6d4b\u8bd5\u3001CI \u8981\u6c42\uff09</li> <li><code>docs/build_run.md</code>\uff08\u5728 Windows/Unix \u4e0b\u7684\u672c\u5730\u6784\u5efa/\u8fd0\u884c\u8bf4\u660e\uff09</li> <li><code>docs/templates/</code>\uff08\u9875\u9762\u6a21\u677f\uff1a\u6807\u9898\u3001\u6982\u8ff0\u3001\u793a\u4f8b\u7ed3\u6784\u3001API \u6761\u76ee\u683c\u5f0f\u3001\u7ffb\u8bd1\u5bf9\u7167\u8868\uff09</li> </ul> <p>\u6a21\u677f\u793a\u4f8b\uff08\u63cf\u8ff0\u800c\u975e\u4ee3\u7801\u5757\uff09\uff1a - \u6587\u6863\u9876\u90e8\u5e94\u5305\u542b\u7b80\u77ed \u201c\u76ee\u7684/\u8303\u56f4/\u524d\u63d0\u201d \u4e09\u6bb5\uff1b\u968f\u540e\u201c\u793a\u4f8b\u201d\u90e8\u5206\u6309\u201c\u793a\u4f8b\u8bf4\u660e / \u4ee3\u7801\u4f4d\u7f6e / \u8fd0\u884c\u6b65\u9aa4 / \u671f\u671b\u7ed3\u679c\u201d\u56db\u6bb5\u6a21\u677f\u6392\u5217\u3002 - API \u6761\u76ee\u6a21\u677f\uff1a\u6a21\u5757\u8def\u5f84 -&gt; \u7b80\u77ed\u63cf\u8ff0 -&gt; \u516c\u5f00\u7c7b/\u51fd\u6570\u5217\u8868\uff08\u6bcf\u9879\uff1a\u7b7e\u540d\u3001\u53c2\u6570\u8bf4\u660e\u3001\u8fd4\u56de\u503c\u3001\u5f02\u5e38 &amp; \u4f7f\u7528\u793a\u4f8b\u884c\u53f7\u5f15\u7528\uff09\u3002 - \u7ffb\u8bd1\u6a21\u677f\uff1a\u6bcf\u4e2a\u82f1\u6587\u6587\u4ef6\u5e94\u5e26\u6709\u4e00\u4efd\u5bf9\u7167\u6e05\u5355\u5217\u51fa\u201c\u5efa\u8bae\u672f\u8bed\u7ffb\u8bd1\u201d\uff08\u4f8b\u5982 IoC -&gt; \u63a7\u5236\u53cd\u8f6c, DI -&gt; \u4f9d\u8d56\u6ce8\u5165\uff09\u3002</p>","tags":["plan","documentation"]},{"location":"cullinan_documentation_plan/#9","title":"9. \u9a8c\u6536\u6807\u51c6\uff08\u9a8c\u6536\u68c0\u67e5\u8868\uff09","text":"<p>\u6bcf\u9879\u6587\u6863\u5728\u4ea4\u4ed8\u524d\u5fc5\u987b\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\uff1a - \u82f1\u6587\u4e0e\u4e2d\u6587\u6587\u4ef6 1:1 \u5bf9\u5e94\uff08\u8def\u5f84\u4e0e\u6587\u4ef6\u540d\u4e00\u81f4\uff0c\u5185\u5bb9\u7b49\u6548\uff09\u3002 - Getting Started\uff1a\u65b0\u7528\u6237\u6309\u6b65\u9aa4\u80fd\u5728 30 \u5206\u949f\u5185\u8fd0\u884c\u793a\u4f8b\u5e76\u8bbf\u95ee\u5e94\u7528\u3002 - Examples\uff1a\u81f3\u5c11\u5305\u542b 2 \u4e2a\u53ef\u8fd0\u884c\u793a\u4f8b\uff08\u6700\u5c0f\uff1aHello World HTTP\uff0c\u8fdb\u9636\uff1aController + DI + Middleware \u793a\u4f8b\uff09\u3002 - Wiki\uff1a\u8986\u76d6\u67b6\u6784\u56fe\u3001\u7ec4\u4ef6\u804c\u8d23\u3001\u6ce8\u5165\u751f\u547d\u5468\u671f\u4e0e\u9519\u8bef\u6a21\u578b\u3002 - API \u53c2\u8003\uff1a\u8986\u76d6\u6240\u6709\u516c\u5171\u6a21\u5757\u5e76\u63d0\u4f9b\u81f3\u5c11\u4e00\u4e2a\u4f7f\u7528\u793a\u4f8b\u3002 - Migration Guide\uff1a\u5217\u51fa\u6240\u6709\u7834\u574f\u6027\u53d8\u66f4\u4e0e\u8fc1\u79fb\u6b65\u9aa4\uff08\u82e5\u5b58\u5728\uff09\u3002 - Contributing\uff1a\u5305\u542b\u4ee3\u7801\u98ce\u683c\u3001PR \u6d41\u7a0b\u3001\u6d4b\u8bd5\u51c6\u5165\u95e8\u69db\u3002 - Testing\uff1a\u73b0\u6709\u6d4b\u8bd5\u5728\u5e72\u51c0\u73af\u5883\u4e0b <code>pytest</code> \u8fd0\u884c\u901a\u8fc7\uff08\u4e0e\u4e3b\u5206\u652f\u540c\u7b49\u6216\u66f4\u4f18\uff09\u3002 - \u6587\u6863\u5ba1\u9605\uff1a\u81f3\u5c11 2 \u540d\u6280\u672f\u8bc4\u5ba1\u4e0e 1 \u540d\u6587\u672c\u6821\u5bf9\u901a\u8fc7\u3002 - CI/\u53d1\u5e03\uff1a\u6587\u6863\u6784\u5efa\u6216\u9759\u6001\u68c0\u67e5\uff08\u82e5\u4f7f\u7528 mkdocs/sphinx\uff09\u901a\u8fc7\u3002</p>","tags":["plan","documentation"]},{"location":"cullinan_documentation_plan/#10","title":"10. \u98ce\u9669\u4e0e\u7f13\u89e3\u63aa\u65bd","text":"<p>\u98ce\u9669 1\uff1a\u6e90\u7801\u7406\u89e3\u504f\u5dee\uff08\u53ea\u8bfb\u6e90\u7801\u3001\u4e0d\u770b\u6ce8\u91ca\u53ef\u80fd\u4e22\u5931\u8bbe\u8ba1\u80cc\u666f\uff09 - \u7f13\u89e3\uff1a\u7528\u6d4b\u8bd5\u7528\u4f8b\u4f5c\u4e3a\u884c\u4e3a\u89c4\u8303\uff0c\u5fc5\u8981\u65f6\u5728\u5ba1\u9605\u9636\u6bb5\u5411\u539f\u4f5c\u8005\u786e\u8ba4\u8bbe\u8ba1\u610f\u56fe\u5e76\u8bb0\u5f55\u4e3a\u201c\u4f5c\u8005\u8bf4\u660e\u201d\u9644\u5f55\uff08\u975e\u4fee\u6539\u6e90\u7801\uff09\u3002</p> <p>\u98ce\u9669 2\uff1aIoC/DI \u8bbe\u8ba1\u590d\u6742\u3001\u96be\u4ee5\u76f4\u89c2\u8868\u8fbe - \u7f13\u89e3\uff1a\u7528\u6d41\u7a0b\u56fe\u3001\u987a\u5e8f\u56fe\u548c\u793a\u4f8b\u4ee3\u7801\u6f14\u793a\u6ce8\u5165\u65f6\u5e8f\uff1b\u5728 <code>docs/wiki/injection.md</code> \u4e2d\u589e\u52a0\u201c\u5e38\u89c1\u6a21\u5f0f/\u53cd\u6a21\u5f0f\u201d\u3002</p> <p>\u98ce\u9669 3\uff1a\u4e2d\u82f1\u7ffb\u8bd1\u4e0d\u4e00\u81f4\u6216\u672f\u8bed\u4e0d\u7edf\u4e00 - \u7f13\u89e3\uff1a\u7ef4\u62a4\u201c\u672f\u8bed\u5bf9\u7167\u8868\u201d\uff1b\u5148\u5b8c\u6210\u82f1\u6587\u5e76\u5ba1\u6821\uff0c\u518d\u7531\u7ffb\u8bd1\u8005\u5bf9\u7167\u9010\u6761\u7ffb\u8bd1\u5e76\u590d\u6838\u3002</p> <p>\u98ce\u9669 4\uff1a\u793a\u4f8b\u5728 Windows \u73af\u5883\u4e0d\u53ef\u8fd0\u884c - \u7f13\u89e3\uff1a\u5728 Windows PowerShell v5.1 \u4e0b\u6d4b\u8bd5\u6240\u6709\u793a\u4f8b\u5e76\u5728 <code>build_run.md</code> \u7ed9\u51fa PowerShell \u4e13\u7528\u547d\u4ee4\uff08\u4f7f\u7528\u5206\u53f7 <code>;</code>\uff0c\u907f\u514d <code>&amp;&amp;</code>\uff09\u3002</p> <p>\u98ce\u9669 5\uff1a\u81ea\u52a8\u751f\u6210 API \u5de5\u5177\u914d\u7f6e\u590d\u6742 - \u7f13\u89e3\uff1a\u5982\u81ea\u52a8\u5316\u6210\u672c\u8fc7\u9ad8\uff0c\u91c7\u7528\u534a\u81ea\u52a8\u5316\uff08\u811a\u672c\u63d0\u53d6\u516c\u6709\u7b26\u53f7\u5e76\u751f\u6210\u6a21\u677f\uff09\u6216\u624b\u5de5\u8865\u5168\u5173\u952e\u6a21\u5757\u3002</p>","tags":["plan","documentation"]},{"location":"cullinan_documentation_plan/#11-powershell-v51","title":"11. \u5fc5\u8981\u7684\u547d\u4ee4\u4e0e\u5de5\u5177\uff08PowerShell v5.1 \u793a\u4f8b\u8bf4\u660e\uff09","text":"<ul> <li>\u5efa\u8bae\u5f00\u53d1\u73af\u5883\u5de5\u5177\uff1aPython 3.8+\uff08\u9879\u76ee\u5f53\u524d\u8981\u6c42\u8bf7\u6838\u5bf9 <code>setup.py</code>\uff09\u3001pytest\u3001mkdocs/sphinx\u3001markdownlint\u3001typora/VSCode\uff08\u7528\u4e8e\u6821\u5bf9\uff09\u3001\u53ef\u9009\uff1agraphviz\uff08\u753b\u4f9d\u8d56\u56fe\uff09\u3002</li> <li>\u865a\u62df\u73af\u5883\uff08\u793a\u4f8b\u8bf4\u660e\uff09\uff1a\u5982\u9700\u5728\u672c\u5730\u521b\u5efa\u865a\u62df\u73af\u5883\uff0c\u8bf7\u53c2\u8003\u4f60\u7684\u5e73\u53f0\u548c\u504f\u597d\uff1b\u6587\u6863\u793a\u4f8b\u7edf\u4e00\u4f7f\u7528 <code>pip</code> \u547d\u4ee4\u5047\u5b9a\u5df2\u53ef\u7528\u7684 Python \u73af\u5883\u3002</li> <li>\u5b89\u88c5\u5f00\u53d1\u4f9d\u8d56\uff1a<code>pip install -U pip; pip install -e .[dev]</code>\uff08\u6216 <code>pip install -e .</code>\uff09</li> <li>\u8fd0\u884c\u6d4b\u8bd5\uff1a<code>py -3 -m pytest -q</code></li> <li>\u8fd0\u884c\u5355\u4e2a\u793a\u4f8b\uff08\u793a\u4f8b\u4f4d\u4e8e <code>examples/hello.py</code>\uff09\uff1a<code>py examples\\\\hello.py</code></li> <li>\u82e5\u4f7f\u7528 docs \u5de5\u5177\uff08mkdocs\uff09\u6784\u5efa\u672c\u5730\u9884\u89c8\uff1a<code>pip install mkdocs mkdocs-material; mkdocs serve</code>\uff08\u8bf7\u5728 docs \u6839\u76ee\u5f55\u6267\u884c\uff09</li> </ul>","tags":["plan","documentation"]},{"location":"cullinan_documentation_plan/#12","title":"12. \u4ea4\u4ed8\u7269\u63d0\u4ea4 / \u5408\u5e76\u6d41\u7a0b\u5efa\u8bae","text":"<ul> <li>\u6bcf\u4e2a\u9636\u6bb5\u5b8c\u6210\u540e\u63d0\u4ea4\u4e00\u4e2a\u5355\u72ec PR\uff08\u4f8b\u5982 <code>docs/getting-started</code>\u3001<code>docs/wiki-injection</code> \u7b49\uff09\uff0cPR \u5fc5\u987b\u5305\u542b\uff1a\u53d8\u66f4\u8bf4\u660e\u3001\u6d4b\u8bd5/\u793a\u4f8b\u9a8c\u8bc1\u6b65\u9aa4\u3001\u5ba1\u9605\u68c0\u67e5\u6e05\u5355\u3002</li> <li>\u5408\u5e76\u524d\u5fc5\u987b\u901a\u8fc7\u81f3\u5c11\u4e00\u540d\u4ee3\u7801/\u67b6\u6784\u5ba1\u9605\u8005\u4e0e\u4e00\u540d\u6587\u6863\u6821\u5bf9\u8005\u3002</li> <li>\u53d1\u5e03\u6587\u6863\u7248\u672c\uff08tag\uff09\u5e76\u5728 <code>README.MD</code> \u4e2d\u66f4\u65b0\u5230\u7248\u672c\u94fe\u63a5\u3002</li> </ul> <p>\u5982\u9700\u5c06\u672c\u8ba1\u5212\u62c6\u5206\u4e3a\u5177\u4f53\u7684 <code>docs/</code> \u6587\u4ef6\u6a21\u677f\u5e76\u4e3a\u6bcf\u4e2a\u6587\u4ef6\u751f\u6210\u521d\u59cb\u5360\u4f4d\u5185\u5bb9\uff08\u82f1\u6587 + \u4e2d\u6587\u5360\u4f4d\uff09\uff0c\u53ef\u7ee7\u7eed\u6267\u884c\u5e76\u521b\u5efa\u8fd9\u4e9b\u6587\u4ef6\u3002\u8bf7\u544a\u77e5\u662f\u5426\u9700\u8981\u81ea\u52a8\u521b\u5efa\u8fd9\u4e9b\u6a21\u677f\u6587\u4ef6\u4ee5\u53ca\u5bf9 API \u6587\u6863\u7684\u504f\u597d\uff08\u81ea\u52a8\u5316\u5de5\u5177 vs \u624b\u5de5\u7ef4\u62a4\uff09\u3002</p>","tags":["plan","documentation"]},{"location":"dependency_injection_guide/","title":"Cullinan Dependency Injection Guide","text":"<p>Version: v0.90 Author: Plumeink Last Updated: 2025-12-25</p>"},{"location":"dependency_injection_guide/#overview","title":"Overview","text":"<p>Cullinan provides a powerful Dependency Injection (DI) system that supports multiple injection methods. Version 0.90 introduces a unified injection model. This guide helps you understand and use these features.</p>"},{"location":"dependency_injection_guide/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Basic Concepts</li> <li>Three Injection Methods</li> <li>Unified Injection Model</li> <li>Advanced Features</li> <li>Best Practices</li> <li>Migration Guide</li> </ol>"},{"location":"dependency_injection_guide/#basic-concepts","title":"Basic Concepts","text":""},{"location":"dependency_injection_guide/#what-is-dependency-injection","title":"What is Dependency Injection?","text":"<p>Dependency Injection is a design pattern that implements Inversion of Control (IoC). Simply put, it allows the framework to automatically inject required dependencies into your classes, rather than manually creating them inside the class.</p>"},{"location":"dependency_injection_guide/#why-use-dependency-injection","title":"Why Use Dependency Injection?","text":"<p>\u2705 Loose Coupling: Clearer dependency relationships between classes \u2705 Testable: Easy to replace dependencies for unit testing \u2705 Maintainable: Centralized dependency management \u2705 Extensible: Easy to add new services and components</p>"},{"location":"dependency_injection_guide/#three-injection-methods","title":"Three Injection Methods","text":"<p>Cullinan supports three dependency injection methods, all unified under the new injection model.</p>"},{"location":"dependency_injection_guide/#1-inject-type-annotation-injection","title":"1. Inject() - Type Annotation Injection","text":"<p>Recommendation: \u2b50\u2b50\u2b50\u2b50\u2b50</p> <p>Uses type annotations, providing the best IDE support and type safety.</p> <pre><code>from cullinan.core import Inject\nfrom cullinan.service import service\n\n@service\nclass DatabaseService:\n    def query(self, sql: str):\n        return f\"Result: {sql}\"\n\n@service\nclass UserService:\n    # Use type annotation + Inject()\n    database: DatabaseService = Inject()\n\n    def get_user(self, user_id: int):\n        return self.database.query(f\"SELECT * FROM users WHERE id={user_id}\")\n</code></pre> <p>Features: - \u2705 IDE auto-completion - \u2705 Type checking - \u2705 Automatic dependency name inference - \u2705 Support for optional dependencies</p> <p>Optional Dependencies: <pre><code>class UserService:\n    database: DatabaseService = Inject()\n    cache: CacheService = Inject(required=False)  # Optional\n\n    def get_user(self, user_id: int):\n        # cache may be None\n        if self.cache:\n            return self.cache.get(f\"user_{user_id}\")\n        return self.database.query(...)\n</code></pre></p>"},{"location":"dependency_injection_guide/#2-injectbyname-string-name-injection","title":"2. InjectByName() - String Name Injection","text":"<p>Recommendation: \u2b50\u2b50\u2b50\u2b50</p> <p>Uses string names, no need to import dependency classes.</p> <pre><code>from cullinan.controller import controller\nfrom cullinan.core import InjectByName\n\n@controller(url='/api')\nclass UserController:\n    # Explicitly specify name\n    user_service = InjectByName('UserService')\n\n    # Auto-infer name (email_service \u2192 EmailService)\n    email_service = InjectByName()\n\n    def get_user(self, user_id: int):\n        return self.user_service.get_user(user_id)\n</code></pre> <p>Features: - \u2705 No need to import dependency classes - \u2705 Avoid circular imports - \u2705 Automatic name inference (snake_case \u2192 PascalCase) - \u2705 Support for optional dependencies</p> <p>Auto Name Inference Rules: <pre><code>user_service = InjectByName()  # \u2192 UserService\nemail_service = InjectByName()  # \u2192 EmailService\ncache_manager = InjectByName()  # \u2192 CacheManager\n</code></pre></p>"},{"location":"dependency_injection_guide/#3-injectable-decorator-batch-injection","title":"3. @injectable - Decorator Batch Injection","text":"<p>Recommendation: \u2b50\u2b50\u2b50\u2b50\u2b50</p> <p>Uses decorator approach, automatically injects all dependencies when the class is instantiated.</p> <pre><code>from cullinan.controller import controller\nfrom cullinan.core import injectable, Inject, InjectByName\n\n@injectable\n@controller(url='/api')\nclass UserController:\n    database: DatabaseService = Inject()\n    cache = InjectByName('CacheService')\n    logger = InjectByName('LogService', required=False)\n\n    def __init__(self):\n        # After __init__, all dependencies are automatically injected\n        pass\n\n    def get_user(self, user_id: int):\n        # database and cache are now available\n        result = self.database.query(...)\n        if self.cache:\n            self.cache.set(f\"user_{user_id}\", result)\n        return result\n</code></pre> <p>Features: - \u2705 Automatic batch injection - \u2705 Mix Inject and InjectByName - \u2705 Injection happens immediately after init - \u2705 Compatible with @service and @controller decorators</p>"},{"location":"dependency_injection_guide/#unified-injection-model","title":"Unified Injection Model","text":""},{"location":"dependency_injection_guide/#new-architecture-overview","title":"New Architecture Overview","text":"<p>Starting from v0.90, Cullinan introduces a unified injection model where all injection methods are based on the same underlying architecture:</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Application Layer (Inject / InjectByName / @injectable) \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                   \u2502\n                   \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  InjectionPoint (Unified Metadata Model) \u2502\n\u2502  - attr_name: Attribute name             \u2502\n\u2502  - dependency_name: Dependency name      \u2502\n\u2502  - required: Is required                 \u2502\n\u2502  - attr_type: Type annotation            \u2502\n\u2502  - resolve_strategy: Resolution strategy \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                   \u2502\n                   \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  InjectionExecutor (Unified Executor)    \u2502\n\u2502  - resolve_injection_point()             \u2502\n\u2502  - inject_instance()                     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                   \u2502\n                   \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  ServiceRegistry / ProviderRegistry      \u2502\n\u2502  (Service Providers)                     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"dependency_injection_guide/#resolution-strategies","title":"Resolution Strategies","text":"<p>The new model supports three resolution strategies:</p>"},{"location":"dependency_injection_guide/#auto-automatic-inference","title":"AUTO (Automatic Inference)","text":"<pre><code># Default strategy when using Inject()\nuser_service: UserService = Inject()\n# Strategy: Priority by type (UserService), fallback to name ('UserService')\n</code></pre>"},{"location":"dependency_injection_guide/#by_type-by-type","title":"BY_TYPE (By Type)","text":"<pre><code># Force resolution by type\nuser_service: UserService = Inject()\n# Only look for services of type UserService\n</code></pre>"},{"location":"dependency_injection_guide/#by_name-by-name","title":"BY_NAME (By Name)","text":"<pre><code># Strategy when using InjectByName\nuser_service = InjectByName('UserService')\n# Only look for services named 'UserService'\n</code></pre>"},{"location":"dependency_injection_guide/#performance-features","title":"Performance Features","text":"<p>The new unified model provides excellent performance:</p> <ul> <li>Caching: Injected dependencies are cached in instances, avoiding repeated resolution</li> <li>Lazy Injection: Dependencies are only resolved on first access</li> <li>Batch Injection: @injectable injects all dependencies at once, reducing overhead</li> </ul>"},{"location":"dependency_injection_guide/#advanced-features","title":"Advanced Features","text":""},{"location":"dependency_injection_guide/#1-nested-dependencies","title":"1. Nested Dependencies","text":"<p>Services can depend on other services, forming dependency chains:</p> <pre><code>@service\nclass DatabaseService:\n    pass\n\n@service\nclass CacheService:\n    pass\n\n@service\n@injectable\nclass DataAccessLayer:\n    database: DatabaseService = Inject()\n    cache: CacheService = Inject()\n\n    def fetch(self, key):\n        # Check cache first\n        if self.cache:\n            return self.cache.get(key)\n        # Then query database\n        return self.database.query(...)\n\n@injectable\nclass BusinessLogic:\n    dal: DataAccessLayer = Inject()\n\n    def process(self, key):\n        return self.dal.fetch(key)\n</code></pre>"},{"location":"dependency_injection_guide/#2-circular-dependency-detection","title":"2. Circular Dependency Detection","text":"<p>The framework automatically detects and prevents circular dependencies:</p> <pre><code>@service\n@injectable\nclass ServiceA:\n    b: ServiceB = Inject()\n\n@service\n@injectable\nclass ServiceB:\n    a: ServiceA = Inject()  # \u274c Raises CircularDependencyError\n</code></pre> <p>Solutions: 1. Redesign dependency relationships 2. Use lazy injection 3. Introduce an intermediate layer to break the cycle</p>"},{"location":"dependency_injection_guide/#3-string-annotation-support","title":"3. String Annotation Support","text":"<p>Supports string type annotations (to avoid circular imports):</p> <pre><code>from __future__ import annotations\n\n@injectable\nclass UserController:\n    # Use string annotation (Python 3.7+)\n    user_service: 'UserService' = Inject()\n</code></pre>"},{"location":"dependency_injection_guide/#4-test-mocking","title":"4. Test Mocking","text":"<p>All injection methods support manual setting (convenient for testing):</p> <pre><code>def test_user_controller():\n    controller = UserController()\n\n    # Manually inject mock object\n    controller.user_service = MockUserService()\n\n    # Test business logic\n    result = controller.get_user(123)\n    assert result == expected_value\n</code></pre>"},{"location":"dependency_injection_guide/#best-practices","title":"Best Practices","text":""},{"location":"dependency_injection_guide/#recommended-approaches","title":"\u2705 Recommended Approaches","text":""},{"location":"dependency_injection_guide/#1-prefer-inject-type-annotations","title":"1. Prefer Inject() + Type Annotations","text":"<pre><code>@injectable\nclass UserService:\n    database: DatabaseService = Inject()  # \u2705 Recommended\n    cache: CacheService = Inject()\n</code></pre>"},{"location":"dependency_injection_guide/#2-clearly-mark-optional-dependencies","title":"2. Clearly Mark Optional Dependencies","text":"<pre><code>class UserService:\n    database: DatabaseService = Inject()  # Required\n    cache: CacheService = Inject(required=False)  # Optional\n</code></pre>"},{"location":"dependency_injection_guide/#3-use-injectable-to-simplify-injection","title":"3. Use @injectable to Simplify Injection","text":"<pre><code>@injectable\nclass UserController:\n    user_service: UserService = Inject()\n    # Automatically injected, no manual call needed\n</code></pre>"},{"location":"dependency_injection_guide/#4-service-classes-use-service-decorator","title":"4. Service Classes Use @service Decorator","text":"<pre><code>@service  # Auto-register to ServiceRegistry\n@injectable  # Support dependency injection\nclass UserService:\n    database: DatabaseService = Inject()\n</code></pre>"},{"location":"dependency_injection_guide/#things-to-avoid","title":"\u274c Things to Avoid","text":""},{"location":"dependency_injection_guide/#1-avoid-accessing-dependencies-in-constructor","title":"1. Avoid Accessing Dependencies in Constructor","text":"<pre><code>@injectable\nclass UserService:\n    database: DatabaseService = Inject()\n\n    def __init__(self):\n        # \u274c database not yet injected\n        # self.database.query(...)  \n        pass\n\n    def get_user(self, user_id):\n        # \u2705 Safe to access now\n        return self.database.query(...)\n</code></pre>"},{"location":"dependency_injection_guide/#2-avoid-circular-dependencies","title":"2. Avoid Circular Dependencies","text":"<pre><code># \u274c Wrong: Circular dependency\n@service\nclass ServiceA:\n    b: ServiceB = Inject()\n\n@service\nclass ServiceB:\n    a: ServiceA = Inject()\n</code></pre>"},{"location":"dependency_injection_guide/#3-avoid-overusing-injectbyname","title":"3. Avoid Overusing InjectByName","text":"<pre><code># \u274c Not recommended: Lose type safety\nuser_service = InjectByName('UserService')\n\n# \u2705 Recommended: Type-safe\nuser_service: UserService = Inject()\n</code></pre>"},{"location":"dependency_injection_guide/#migration-guide","title":"Migration Guide","text":""},{"location":"dependency_injection_guide/#migrating-from-old-code","title":"Migrating from Old Code","text":"<p>If your code uses the old injection approach, no changes needed! The new unified model is fully backward compatible.</p>"},{"location":"dependency_injection_guide/#old-code-still-works","title":"Old Code Still Works","text":"<pre><code># Old code - still works\n@injectable\nclass UserService:\n    database: DatabaseService = Inject()\n\n# New code - exactly the same syntax\n@injectable\nclass UserService:\n    database: DatabaseService = Inject()\n</code></pre>"},{"location":"dependency_injection_guide/#backward-compatibility-mechanism","title":"Backward Compatibility Mechanism","text":"<p>The framework internally uses a backward compatibility mechanism: 1. Try new model first (InjectionExecutor) 2. Auto-fallback on failure to old logic (registry.inject()) 3. Completely transparent, users unaware</p> <p>These backward compatibility codes are marked in the source: <pre><code># BACKWARD_COMPAT: v0.8 - Keep old injection logic\n# Planned removal version: v1.0\n</code></pre></p>"},{"location":"dependency_injection_guide/#upgrade-recommendations","title":"Upgrade Recommendations","text":"<p>Although old code continues to work, it's recommended to:</p> <ol> <li>New projects: Use the new recommended patterns directly</li> <li>Existing projects: Migrate gradually, no need to change everything at once</li> <li>Monitor performance: New model performs better in most scenarios</li> </ol>"},{"location":"dependency_injection_guide/#faq","title":"FAQ","text":""},{"location":"dependency_injection_guide/#q-which-of-the-three-injection-methods-should-i-use","title":"Q: Which of the three injection methods should I use?","text":"<p>A: Recommended priority: 1. Inject() + type annotations: Most recommended, type-safe 2. @injectable + mixed use: Simplifies code 3. InjectByName: Use when avoiding circular imports</p>"},{"location":"dependency_injection_guide/#q-when-are-dependencies-injected","title":"Q: When are dependencies injected?","text":"<p>A:  - Inject/InjectByName: On first property access (lazy injection) - @injectable: After init method executes (batch injection)</p>"},{"location":"dependency_injection_guide/#q-how-to-handle-optional-dependencies","title":"Q: How to handle optional dependencies?","text":"<p>A:  <pre><code>cache: CacheService = Inject(required=False)\n\nif self.cache:  # Check if None\n    self.cache.set(key, value)\n</code></pre></p>"},{"location":"dependency_injection_guide/#q-how-to-avoid-circular-dependencies","title":"Q: How to avoid circular dependencies?","text":"<p>A: 1. Redesign dependency relationships 2. Use event system for decoupling 3. Introduce intermediate layer/Facade</p>"},{"location":"dependency_injection_guide/#q-what-about-performance","title":"Q: What about performance?","text":"<p>A: The new model performs excellently: - Cache hit: &lt; 1 \u03bcs - First resolution: 10-50 \u03bcs - On par with or better than old model</p>"},{"location":"dependency_injection_guide/#complete-examples","title":"Complete Examples","text":""},{"location":"dependency_injection_guide/#example-1-simple-three-tier-architecture","title":"Example 1: Simple Three-Tier Architecture","text":"<pre><code>from cullinan.core import Inject, injectable\nfrom cullinan.service import service\n\n# Data Access Layer\n@service\nclass DatabaseService:\n    def query(self, sql: str):\n        return f\"Query result: {sql}\"\n\n# Business Logic Layer\n@service\n@injectable\nclass UserService:\n    database: DatabaseService = Inject()\n\n    def get_user(self, user_id: int):\n        return self.database.query(\n            f\"SELECT * FROM users WHERE id={user_id}\"\n        )\n\n    def create_user(self, username: str):\n        return self.database.query(\n            f\"INSERT INTO users (username) VALUES ('{username}')\"\n        )\n\n# Controller Layer\n@injectable\nclass UserController:\n    user_service: UserService = Inject()\n\n    def get(self, user_id: int):\n        return self.user_service.get_user(user_id)\n\n    def post(self, username: str):\n        return self.user_service.create_user(username)\n</code></pre>"},{"location":"dependency_injection_guide/#example-2-complex-scenario-with-caching","title":"Example 2: Complex Scenario with Caching","text":"<pre><code>from cullinan.core import Inject, InjectByName, injectable\nfrom cullinan.service import service\n\n@service\nclass CacheService:\n    def get(self, key): pass\n    def set(self, key, value): pass\n\n@service\nclass LogService:\n    def log(self, message): pass\n\n@service\n@injectable\nclass UserService:\n    database: DatabaseService = Inject()\n    cache: CacheService = Inject(required=False)\n    logger = InjectByName('LogService', required=False)\n\n    def get_user(self, user_id: int):\n        # Try to get from cache\n        if self.cache:\n            cached = self.cache.get(f\"user_{user_id}\")\n            if cached:\n                if self.logger:\n                    self.logger.log(f\"Cache hit: user_{user_id}\")\n                return cached\n\n        # Query from database\n        result = self.database.query(\n            f\"SELECT * FROM users WHERE id={user_id}\"\n        )\n\n        # Write to cache\n        if self.cache:\n            self.cache.set(f\"user_{user_id}\", result)\n\n        return result\n</code></pre>"},{"location":"dependency_injection_guide/#references","title":"References","text":"<ul> <li>Architecture Documentation</li> <li>Extension Development Guide</li> <li>API Reference</li> </ul> <p>Changelog: - 2025-12-24: Document created, covering v0.9 unified injection model - Future: Continuous updates to best practices and examples</p>"},{"location":"examples/","title":"Examples and Demos","text":"<p>Note (v0.90): Some examples below use the legacy 1.x DI API. For the new 2.0 API examples, see Dependency Injection Guide. New projects should use <code>ApplicationContext</code> from <code>cullinan.core.container</code>.</p> <p>This page lists canonical runnable examples shipped with Cullinan. Each entry includes the example path, a short description, and how to run it on common platforms.</p>"},{"location":"examples/#hello-http","title":"Hello HTTP","text":"<ul> <li>Path: <code>examples/hello_http.py</code></li> <li>Description: Minimal HTTP server returning a greeting.</li> </ul>"},{"location":"examples/#how-to-run","title":"How to run","text":"<p>On Windows (PowerShell):</p> <pre><code>python examples\\hello_http.py\n</code></pre> <p>On Linux / macOS:</p> <pre><code>python examples/hello_http.py\n</code></pre> <p>Expected behavior:</p> <ul> <li>Starts an HTTP server.</li> <li>Serves a response on <code>http://localhost:4080/hello</code>.</li> </ul>"},{"location":"examples/#controller-di-middleware-demo","title":"Controller + DI + Middleware demo","text":"<ul> <li>Path: <code>examples/controller_di_middleware.py</code></li> <li>Description: Demonstrates integration between controllers, dependency injection, and middleware.</li> </ul>"},{"location":"examples/#how-to-run_1","title":"How to run","text":"<p>On Windows (PowerShell):</p> <pre><code>python examples\\controller_di_middleware.py\n</code></pre> <p>On Linux / macOS:</p> <pre><code>python examples/controller_di_middleware.py\n</code></pre> <p>Expected behavior:</p> <ul> <li>Logs request handling through middleware.</li> <li>Shows how injected services participate in the request pipeline.</li> </ul>"},{"location":"extension_development_guide/","title":"Cullinan Extension Development Guide","text":"<p>Version: v0.81+ Author: Plumeink Last Updated: 2025-12-16</p>"},{"location":"extension_development_guide/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Overview</li> <li>Extension Categories</li> <li>Middleware Extensions</li> <li>Dependency Injection Extensions</li> <li>Lifecycle Extensions</li> <li>Routing Extensions</li> <li>Best Practices</li> <li>FAQ</li> </ol>"},{"location":"extension_development_guide/#overview","title":"Overview","text":"<p>The Cullinan framework provides rich extension points, allowing developers to customize functionality without modifying the framework code. This guide introduces how to develop various types of extensions.</p>"},{"location":"extension_development_guide/#extension-philosophy","title":"Extension Philosophy","text":"<ul> <li>Non-invasive: Extend through decorators, interface implementations, etc.</li> <li>Unified Pattern: All extensions use consistent registration methods</li> <li>Discoverability: Extension points are queryable via API</li> <li>Backward Compatible: Maintain compatibility without breaking existing functionality</li> </ul>"},{"location":"extension_development_guide/#query-available-extension-points","title":"Query Available Extension Points","text":"<pre><code>from cullinan.extensions import list_extension_points\n\n# Query all extension points\nall_points = list_extension_points()\nfor point in all_points:\n    print(f\"{point['category']}: {point['name']}\")\n    print(f\"  {point['description']}\")\n\n# Query specific category\nmiddleware_points = list_extension_points(category='middleware')\n</code></pre>"},{"location":"extension_development_guide/#extension-categories","title":"Extension Categories","text":"<p>Cullinan provides 6 major categories of extension points:</p> Category Description Typical Use Cases Middleware Request/Response interception Authentication, Logging, CORS Lifecycle Lifecycle hooks Initialization, Startup, Shutdown Injection Dependency Injection Custom Scope, Provider Routing Route handling Custom Handler Configuration Configuration management Config source, Environment adaptation Handler Request handler Custom request processing logic"},{"location":"extension_development_guide/#middleware-extensions","title":"Middleware Extensions","text":""},{"location":"extension_development_guide/#basic-concepts","title":"Basic Concepts","text":"<p>Middleware are interceptors in the request processing pipeline that can: - Preprocess requests before they reach the Handler - Post-process responses before they are returned to the client - Short-circuit requests (e.g., return 401 on authentication failure)</p>"},{"location":"extension_development_guide/#creating-middleware","title":"Creating Middleware","text":""},{"location":"extension_development_guide/#method-1-decorator-registration-recommended","title":"Method 1: Decorator Registration (Recommended)","text":"<pre><code>from cullinan.middleware import middleware, Middleware\n\n@middleware(priority=100)\nclass LoggingMiddleware(Middleware):\n    \"\"\"Logging Middleware\"\"\"\n\n    def process_request(self, handler):\n        # Request preprocessing\n        print(f\"Request: {handler.request.uri}\")\n        return handler  # Return handler to continue processing\n\n    def process_response(self, handler, response):\n        # Response post-processing\n        print(f\"Response: {response}\")\n        return response\n</code></pre>"},{"location":"extension_development_guide/#method-2-manual-registration","title":"Method 2: Manual Registration","text":"<pre><code>from cullinan.middleware import Middleware, get_middleware_registry\n\nclass MyMiddleware(Middleware):\n    def process_request(self, handler):\n        return handler\n\n# Manual registration\nregistry = get_middleware_registry()\nregistry.register(MyMiddleware, priority=100)\n</code></pre>"},{"location":"extension_development_guide/#priority-rules","title":"Priority Rules","text":"<ul> <li>Lower numbers execute first</li> <li>Recommended ranges:</li> <li><code>0-50</code>: Critical middleware (CORS, security)</li> <li><code>51-100</code>: Standard middleware (logging, metrics)</li> <li><code>101-200</code>: Application-specific middleware</li> </ul>"},{"location":"extension_development_guide/#lifecycle-hooks","title":"Lifecycle Hooks","text":"<pre><code>@middleware(priority=100)\nclass DatabaseMiddleware(Middleware):\n    def on_init(self):\n        \"\"\"Execute during initialization (application startup)\"\"\"\n        self.pool = create_connection_pool()\n\n    def on_destroy(self):\n        \"\"\"Execute during destruction (application shutdown)\"\"\"\n        self.pool.close()\n\n    def process_request(self, handler):\n        # Get connection for each request\n        handler.db = self.pool.get_connection()\n        return handler\n\n    def process_response(self, handler, response):\n        # Return connection\n        if hasattr(handler, 'db'):\n            self.pool.return_connection(handler.db)\n        return response\n</code></pre>"},{"location":"extension_development_guide/#short-circuiting-requests","title":"Short-circuiting Requests","text":"<p>Returning <code>None</code> indicates short-circuit - subsequent middleware and Handler will not execute:</p> <pre><code>@middleware(priority=50)\nclass AuthMiddleware(Middleware):\n    def process_request(self, handler):\n        token = handler.request.headers.get('Authorization')\n        if not token:\n            # Authentication failed, short-circuit\n            handler.set_status(401)\n            handler.finish({'error': 'Unauthorized'})\n            return None  # Stop processing\n\n        # Authentication successful, continue\n        handler.current_user = validate_token(token)\n        return handler\n</code></pre>"},{"location":"extension_development_guide/#complete-example","title":"Complete Example","text":"<p>Reference: <code>examples/custom_auth_middleware.py</code></p>"},{"location":"extension_development_guide/#dependency-injection-extensions","title":"Dependency Injection Extensions","text":""},{"location":"extension_development_guide/#custom-scope","title":"Custom Scope","text":"<p>Scope defines the lifecycle of dependencies (singleton, request-level, session-level, etc.).</p> <pre><code>from cullinan.core.scope import Scope\nfrom typing import Any, Optional\n\nclass SessionScope(Scope):\n    \"\"\"Session-level scope\"\"\"\n\n    def __init__(self):\n        super().__init__('session')\n        self._instances = {}  # {session_id: {key: instance}}\n\n    def get(self, key: str) -&gt; Optional[Any]:\n        \"\"\"Get instance\"\"\"\n        session_id = self._get_current_session_id()\n        if session_id and session_id in self._instances:\n            return self._instances[session_id].get(key)\n        return None\n\n    def set(self, key: str, value: Any) -&gt; None:\n        \"\"\"Set instance\"\"\"\n        session_id = self._get_current_session_id()\n        if session_id:\n            if session_id not in self._instances:\n                self._instances[session_id] = {}\n            self._instances[session_id][key] = value\n\n    def clear(self) -&gt; None:\n        \"\"\"Clear current session\"\"\"\n        session_id = self._get_current_session_id()\n        if session_id and session_id in self._instances:\n            del self._instances[session_id]\n\n    def _get_current_session_id(self) -&gt; Optional[str]:\n        \"\"\"Get session ID from request context\"\"\"\n        from cullinan.core.context import get_current_context\n        try:\n            context = get_current_context()\n            return context.get('session_id')\n        except:\n            return None\n</code></pre>"},{"location":"extension_development_guide/#custom-provider","title":"Custom Provider","text":"<p>Provider is responsible for creating and managing dependency instances.</p>"},{"location":"extension_development_guide/#factory-pattern-provider","title":"Factory Pattern Provider","text":"<pre><code>from cullinan.core.provider import Provider\n\nclass FactoryProvider(Provider):\n    \"\"\"Create new instance every time\"\"\"\n\n    def __init__(self, factory: Callable[[], Any], name: str):\n        self.factory = factory\n        self.name = name\n\n    def get(self, key: str) -&gt; Optional[Any]:\n        return self.factory()\n\n    def set(self, key: str, value: Any) -&gt; None:\n        pass\n</code></pre>"},{"location":"extension_development_guide/#lazy-initialization-provider","title":"Lazy Initialization Provider","text":"<pre><code>class LazyProvider(Provider):\n    \"\"\"Initialize only on first access\"\"\"\n\n    def __init__(self, factory: Callable[[], Any], name: str):\n        self.factory = factory\n        self.name = name\n        self._instance = None\n        self._initialized = False\n\n    def get(self, key: str) -&gt; Optional[Any]:\n        if not self._initialized:\n            self._instance = self.factory()\n            self._initialized = True\n        return self._instance\n\n    def set(self, key: str, value: Any) -&gt; None:\n        self._instance = value\n        self._initialized = True\n</code></pre>"},{"location":"extension_development_guide/#register-custom-provider","title":"Register Custom Provider","text":"<pre><code>from cullinan.service import service, Service\nfrom cullinan.core.injection import get_injection_registry\n\n@service\nclass ProviderRegistryService(Service):\n    def on_init(self):\n        \"\"\"Register custom Providers during service initialization\"\"\"\n        registry = get_injection_registry()\n\n        # Register factory Provider\n        factory_provider = FactoryProvider(\n            factory=lambda: MyClass(),\n            name='MyClassFactory'\n        )\n        registry.register_provider('MyClass', factory_provider)\n\n        # Register lazy Provider\n        lazy_provider = LazyProvider(\n            factory=lambda: HeavyClass(),\n            name='HeavyClassLazy'\n        )\n        registry.register_provider('HeavyClass', lazy_provider)\n</code></pre>"},{"location":"extension_development_guide/#complete-example_1","title":"Complete Example","text":"<p>Reference: <code>examples/custom_provider_demo.py</code></p>"},{"location":"extension_development_guide/#lifecycle-extensions","title":"Lifecycle Extensions","text":""},{"location":"extension_development_guide/#service-lifecycle-hooks","title":"Service Lifecycle Hooks","text":"<pre><code>from cullinan.service import service, Service\n\n@service\nclass DatabaseService(Service):\n    def on_init(self):\n        \"\"\"Initialize resources (after Service instantiation)\"\"\"\n        self.connection = connect_to_database()\n        print(\"Database connected\")\n\n    def on_startup(self):\n        \"\"\"Execute after all Services are ready\"\"\"\n        self.connection.execute(\"SELECT 1\")  # Health check\n        print(\"Database ready\")\n\n    def on_shutdown(self):\n        \"\"\"Execute during application shutdown\"\"\"\n        self.connection.close()\n        print(\"Database disconnected\")\n</code></pre>"},{"location":"extension_development_guide/#async-hooks","title":"Async Hooks","text":"<pre><code>@service\nclass AsyncService(Service):\n    async def on_init(self):\n        \"\"\"Support async initialization\"\"\"\n        self.client = await create_async_client()\n\n    async def on_shutdown(self):\n        \"\"\"Support async cleanup\"\"\"\n        await self.client.close()\n</code></pre>"},{"location":"extension_development_guide/#hook-execution-order","title":"Hook Execution Order","text":"<ol> <li>on_init(): Execute immediately after Service instantiation</li> <li>on_startup(): Execute after all Services are initialized</li> <li>on_shutdown(): Execute during application shutdown (reverse order)</li> </ol>"},{"location":"extension_development_guide/#routing-extensions","title":"Routing Extensions","text":""},{"location":"extension_development_guide/#custom-tornado-handler","title":"Custom Tornado Handler","text":"<pre><code>import tornado.web\nfrom cullinan import configure, run\n\nclass CustomHandler(tornado.web.RequestHandler):\n    \"\"\"Custom request handler\"\"\"\n\n    def get(self):\n        self.write({\"message\": \"Custom handler\"})\n\n    def post(self):\n        data = self.get_json_argument()\n        self.write({\"received\": data})\n\n# Register custom Handler\nif __name__ == '__main__':\n    configure(\n        handlers=[\n            (r'/custom', CustomHandler),\n            (r'/custom/(?P&lt;id&gt;[0-9]+)', CustomHandler),\n        ]\n    )\n    run()\n</code></pre>"},{"location":"extension_development_guide/#mixed-use-with-controller","title":"Mixed Use with Controller","text":"<pre><code>from cullinan.controller import controller, get_api\n\n@controller('/api/users')\nclass UserController:\n    @get_api('/')\n    def list_users(self):\n        return {\"users\": []}\n\n# CustomHandler and UserController can coexist\nif __name__ == '__main__':\n    configure(\n        handlers=[\n            (r'/health', HealthCheckHandler),  # Custom\n        ]\n    )\n    run()  # UserController will be automatically registered\n</code></pre>"},{"location":"extension_development_guide/#best-practices","title":"Best Practices","text":""},{"location":"extension_development_guide/#1-middleware-design-principles","title":"1. Middleware Design Principles","text":"<p>\u2705 Single Responsibility: Each middleware does one thing <pre><code># Good design\n@middleware(priority=50)\nclass AuthMiddleware(Middleware):  # Only handles authentication\n    pass\n\n@middleware(priority=60)\nclass RoleMiddleware(Middleware):  # Only handles permission checks\n    pass\n</code></pre></p> <p>\u274c Avoid Mixed Responsibilities <pre><code># Bad design\n@middleware(priority=50)\nclass AuthAndLoggingMiddleware(Middleware):  # Mixed responsibilities\n    pass\n</code></pre></p>"},{"location":"extension_development_guide/#2-priority-planning","title":"2. Priority Planning","text":"<ul> <li>Sort by dependencies (later middleware depends on earlier results)</li> <li>Security-related middleware has highest priority</li> <li>Logging and monitoring middleware has moderate priority</li> </ul> <pre><code>@middleware(priority=10)   # CORS (executes first)\nclass CorsMiddleware(Middleware):\n    pass\n\n@middleware(priority=40)   # Rate limiting (before authentication)\nclass RateLimitMiddleware(Middleware):\n    pass\n\n@middleware(priority=50)   # Authentication\nclass AuthMiddleware(Middleware):\n    pass\n\n@middleware(priority=60)   # Permissions (depends on authentication result)\nclass RoleMiddleware(Middleware):\n    pass\n\n@middleware(priority=100)  # Logging (executes last)\nclass LoggingMiddleware(Middleware):\n    pass\n</code></pre>"},{"location":"extension_development_guide/#3-dependency-injection-principles","title":"3. Dependency Injection Principles","text":"<p>\u2705 Prefer type injection <pre><code>@service\nclass UserService(Service):\n    email_service: EmailService = Inject()  # Recommended\n</code></pre></p> <p>\u2705 Use name-based injection for special cases <pre><code>@service\nclass UserService(Service):\n    email_service = InjectByName('EmailService')  # Avoid circular imports\n</code></pre></p>"},{"location":"extension_development_guide/#4-lifecycle-management","title":"4. Lifecycle Management","text":"<ul> <li>on_init(): Initialize required resources</li> <li>on_startup(): Execute logic that depends on other services</li> <li>on_shutdown(): Always clean up resources</li> </ul> <pre><code>@service\nclass ResourceService(Service):\n    def on_init(self):\n        # Initialize independent resources\n        self.connection = create_connection()\n\n    def on_startup(self):\n        # Initialization depending on other services\n        self.cache = get_cache_service()\n\n    def on_shutdown(self):\n        # Cleanup (must implement)\n        if self.connection:\n            self.connection.close()\n</code></pre>"},{"location":"extension_development_guide/#5-error-handling","title":"5. Error Handling","text":"<p>\u2705 Always provide clear error messages <pre><code>@middleware(priority=50)\nclass AuthMiddleware(Middleware):\n    def process_request(self, handler):\n        try:\n            token = self._extract_token(handler)\n            user = self._validate_token(token)\n            handler.current_user = user\n            return handler\n        except TokenExpiredError:\n            handler.set_status(401)\n            handler.finish({\n                'error': 'TokenExpired',\n                'message': 'Your token has expired. Please login again.'\n            })\n            return None\n        except InvalidTokenError:\n            handler.set_status(401)\n            handler.finish({\n                'error': 'InvalidToken',\n                'message': 'Invalid authentication token.'\n            })\n            return None\n</code></pre></p>"},{"location":"extension_development_guide/#6-logging-standards","title":"6. Logging Standards","text":"<ul> <li>Use structured logging</li> <li>No emoji allowed</li> <li>Log critical operations and errors</li> </ul> <pre><code>import logging\n\nlogger = logging.getLogger(__name__)\n\n@middleware(priority=100)\nclass LoggingMiddleware(Middleware):\n    def process_request(self, handler):\n        logger.info(\n            \"Request started\",\n            extra={\n                'method': handler.request.method,\n                'path': handler.request.path,\n                'remote_ip': handler.request.remote_ip,\n            }\n        )\n        return handler\n</code></pre>"},{"location":"extension_development_guide/#faq","title":"FAQ","text":""},{"location":"extension_development_guide/#q1-how-to-access-dependency-injected-services-in-middleware","title":"Q1: How to access dependency-injected services in middleware?","text":"<p>A: Middleware doesn't support automatic injection, but you can manually retrieve:</p> <pre><code>@middleware(priority=100)\nclass ServiceAwareMiddleware(Middleware):\n    def on_init(self):\n        # Get service from ServiceRegistry\n        from cullinan.service import get_service_registry\n        registry = get_service_registry()\n        self.user_service = registry.get_instance('UserService')\n\n    def process_request(self, handler):\n        # Use service\n        user = self.user_service.get_user(123)\n        return handler\n</code></pre>"},{"location":"extension_development_guide/#q2-can-middleware-modify-responses","title":"Q2: Can middleware modify responses?","text":"<p>A: Yes, modify in <code>process_response</code>:</p> <pre><code>@middleware(priority=100)\nclass ResponseModifierMiddleware(Middleware):\n    def process_response(self, handler, response):\n        # Add response headers\n        handler.set_header('X-Custom-Header', 'value')\n\n        # Modify response body (if dict)\n        if isinstance(response, dict):\n            response['timestamp'] = time.time()\n\n        return response\n</code></pre>"},{"location":"extension_development_guide/#q3-how-to-implement-conditional-middleware-only-apply-to-specific-paths","title":"Q3: How to implement conditional middleware (only apply to specific paths)?","text":"<p>A: Check path in middleware:</p> <pre><code>@middleware(priority=50)\nclass ConditionalMiddleware(Middleware):\n    def process_request(self, handler):\n        # Only apply to /api/ paths\n        if not handler.request.path.startswith('/api/'):\n            return handler  # Skip\n\n        # Execute middleware logic\n        # ...\n        return handler\n</code></pre>"},{"location":"extension_development_guide/#q4-what-is-the-middleware-execution-order","title":"Q4: What is the middleware execution order?","text":"<p>A: Request and response order are different:</p> <ul> <li>Request Phase: By priority from small to large (10 \u2192 50 \u2192 100)</li> <li>Response Phase: By priority from large to small (100 \u2192 50 \u2192 10, reverse)</li> </ul> <pre><code>Client Request\n  \u2193\nMiddleware A (priority=10)  \u2192  process_request\n  \u2193\nMiddleware B (priority=50)  \u2192  process_request\n  \u2193\nMiddleware C (priority=100) \u2192  process_request\n  \u2193\nHandler Processing\n  \u2193\nMiddleware C (priority=100) \u2192  process_response\n  \u2193\nMiddleware B (priority=50)  \u2192  process_response\n  \u2193\nMiddleware A (priority=10)  \u2192  process_response\n  \u2193\nClient Response\n</code></pre>"},{"location":"extension_development_guide/#q5-how-to-test-custom-extensions","title":"Q5: How to test custom extensions?","text":"<p>A: Use Cullinan's testing tools:</p> <pre><code>from cullinan.testing import ServiceTestCase\n\nclass TestMyMiddleware(ServiceTestCase):\n    def test_process_request(self):\n        middleware = MyMiddleware()\n\n        # Mock handler\n        class MockHandler:\n            request = MockRequest()\n\n        handler = MockHandler()\n        result = middleware.process_request(handler)\n\n        self.assertIsNotNone(result)\n</code></pre>"},{"location":"extension_development_guide/#further-reading","title":"Further Reading","text":"<ul> <li>Wiki Extensions - Extension patterns and best practices</li> <li>Dependency Injection Guide - DI system documentation</li> <li>Quick Start Extensions - Quick start guide for extensions</li> </ul> <p>Note: Example files can be found in the <code>examples/</code> directory of the repository: - <code>examples/custom_auth_middleware.py</code> - Middleware example - <code>examples/custom_provider_demo.py</code> - Provider example - <code>examples/extension_registration_demo.py</code> - Extension registration demo</p>"},{"location":"extension_development_guide/#get-help","title":"Get Help","text":"<ul> <li>GitHub Issues: https://github.com/yourusername/cullinan/issues</li> <li>Example Code: <code>examples/</code> directory</li> <li>API Documentation: <code>docs/api_reference.md</code></li> </ul> <p>Version: v1.0 Author: Plumeink Last Updated: 2025-12-16</p>"},{"location":"getting_started/","title":"Getting Started with Cullinan","text":"<p>This page provides a minimal quick-start to install and run a small Cullinan application.</p>"},{"location":"getting_started/#prerequisites","title":"Prerequisites","text":"<ul> <li>Python 3.8+</li> <li>Git</li> </ul>"},{"location":"getting_started/#install","title":"Install","text":"<p>Before you start, make sure Python 3.8+ is installed and that <code>python</code> and <code>pip</code> are available on your PATH.</p> <p>On most systems, you can upgrade pip and install Cullinan with the following commands (valid on Windows, Linux, and macOS):</p> <pre><code>python -m pip install -U pip\npython -m pip install cullinan\n</code></pre>"},{"location":"getting_started/#quick-start","title":"Quick start","text":"<ol> <li>Create a new project directory and change into it:</li> </ol> <p>On all platforms:</p> <pre><code>mkdir my_cullinan_project\ncd my_cullinan_project\n</code></pre> <ol> <li>Ensure you have a Python environment (virtualenv, conda, system Python, etc.). Install the published package:</li> </ol> <pre><code>python -m pip install -U pip\npython -m pip install cullinan\n</code></pre> <ol> <li>Create a minimal application file <code>minimal_app.py</code> in your project with the following content:</li> </ol> <pre><code># minimal_app.py\nfrom cullinan import application\nfrom cullinan.controller import controller\n\n@controller(url='/hello')\ndef hello_handler(request):\n    \"\"\"Simple HTTP handler.\"\"\"\n    return {'message': 'Hello from Cullinan!'}\n\nif __name__ == '__main__':\n    # Start the framework application (no instantiation required)\n    application.run()\n</code></pre> <ol> <li>Run your app:</li> </ol> <p>On Windows (PowerShell):</p> <pre><code>python minimal_app.py\n</code></pre> <p>On Linux / macOS:</p> <pre><code>python minimal_app.py\n</code></pre> <p>Then open <code>http://localhost:4080/hello</code> in your browser to verify the server is running.</p>"},{"location":"getting_started/#sample-run-output","title":"Sample run output","text":"<p>The following log output illustrates a successful run of the example in a local environment (Windows PowerShell session). Timestamps and durations will vary between environments:</p> <pre><code>|||||||||||||||||||||||||||||||||||||||||||||||||\n|||                                           |||\n|||    _____      _ _ _                       |||\n|||   / ____|    | | (_)                      |||\n|||  | |    _   _| | |_ _ __   __ _ _ __      |||\n|||  | |   | | | | | | | '_ \\ / _` | '_ \\     |||\n|||  | |___| |_| | | | | | | | (_| | | | |    |||\n|||   \\_____\\__,_|_|_|_|_| |_|\\__,_|_| |_|    |||\n|||                                           |||\n|||||||||||||||||||||||||||||||||||||||||||||||||\n    |||\n\n2025-11-19 04:18:50,209 INFO cullinan.application: loading env...\n2025-11-19 04:18:50,210 INFO cullinan.application: \u2514---configuring dependency injection...\n2025-11-19 04:18:50,210 INFO cullinan.application: \u2514---dependency injection configured\n2025-11-19 04:18:50,210 INFO cullinan.application: \u2514---scanning services...\n2025-11-19 04:18:50,210 INFO cullinan.application: ...\n2025-11-19 04:18:50,223 INFO cullinan.application: \u2514---found 31 modules to scan\n2025-11-19 04:18:50,228 INFO cullinan.application: \u2514---scanning controllers...\n2025-11-19 04:18:50,260 INFO cullinan.application: \u2514---found 31 modules to scan\n2025-11-19 04:18:50,261 INFO cullinan.application: \u2514---initializing services...\n2025-11-19 04:18:50,261 INFO cullinan.application: \u2514---no services registered\n2025-11-19 04:18:50,261 INFO cullinan.application: \u2514---loading controller finish\n\n2025-11-19 04:18:50,261 INFO cullinan.application: loading env finish\n\n2025-11-19 04:18:50,262 INFO cullinan.application: server is starting\n2025-11-19 04:18:50,262 INFO cullinan.application: port is 4080\n</code></pre> <p>At this point, the server is running and listening on <code>http://localhost:4080</code>. Use Ctrl+C to gracefully stop the server.</p>"},{"location":"getting_started/#minimal-application-example","title":"Minimal application example","text":"<p>Here's a minimal Cullinan application that demonstrates the core framework features:</p> <pre><code># minimal_app.py\nfrom cullinan import application\nfrom cullinan.controller import controller\n\n@controller(url='/hello')\ndef hello_handler(request):\n    \"\"\"Simple HTTP handler.\"\"\"\n    return {'message': 'Hello from Cullinan!'}\n\nif __name__ == '__main__':\n    # Start the framework application (no instantiation required)\n    application.run()\n</code></pre> <p>To run this example:</p> <pre><code># Save the above code as minimal_app.py\npython minimal_app.py\n</code></pre> <p>Then visit <code>http://localhost:4080/hello</code> in your browser.</p>"},{"location":"getting_started/#understanding-the-basics","title":"Understanding the basics","text":""},{"location":"getting_started/#application-lifecycle","title":"Application lifecycle","text":"<ol> <li>Creation: <code>create_app()</code> initializes the application with default settings</li> <li>Registration: Controllers and services are discovered via module scanning or explicit registration</li> <li>Startup: <code>app.run()</code> starts the Tornado IOLoop and begins accepting requests</li> <li>Shutdown: Graceful shutdown on SIGINT/SIGTERM</li> </ol>"},{"location":"getting_started/#dependency-injection","title":"Dependency Injection","text":"<p>Cullinan provides built-in IoC/DI support. </p>"},{"location":"getting_started/#decorators-explained-injectable-vs-controller","title":"Decorators Explained: <code>@injectable</code> vs <code>@controller()</code>","text":"<p><code>@injectable</code> - General-purpose dependency injection decorator - Applicable to any class that needs dependency injection (Service, Repository, utility classes, etc.) - Must be manually applied, does not auto-register to any registry - Automatically injects marked dependencies after class instantiation - Use cases: Service layer, Repository layer, utility classes, etc.</p> <p><code>@controller()</code> - Controller-specific auto-registration decorator - Specifically for HTTP Controller classes - Automatically applies <code>@injectable</code>, no need to add manually - Auto-registers Controller and its routes to ControllerRegistry - Auto-scans methods decorated with <code>@get_api</code>, <code>@post_api</code>, etc. - Use cases: HTTP Controllers only</p> <pre><code>from cullinan.controller import controller, get_api\nfrom cullinan.service import Service, service\nfrom cullinan.core import injectable, InjectByName\n\n# Service uses @service (inherits from Service base class)\n@service\nclass UserService(Service):\n    def get_user(self, user_id):\n        return {'id': user_id, 'name': 'John'}\n\n# Repository uses @injectable\n@injectable\nclass UserRepository:\n    def find_by_id(self, user_id):\n        return {'id': user_id}\n\n# Controller uses @controller() - automatically includes @injectable\n@controller(url='/api/users')\nclass UserController:\n    # Dependency injection in Controller\n    user_service = InjectByName('UserService')\n\n    @get_api(url='/{user_id}')\n    def get_user(self, url_params):\n        # extract the path parameter from the url_params dict\n        user_id = url_params.get('user_id') if url_params else None\n        return self.user_service.get_user(user_id)\n</code></pre> <p>Important: Do not use <code>@injectable</code> on Controllers, as <code>@controller()</code> already includes it automatically.</p>"},{"location":"getting_started/#restful-api-decorators-quick-overview","title":"RESTful API decorators (quick overview)","text":"<p>Cullinan provides a set of REST-style decorators that bind controller methods to HTTP routes:</p> <ul> <li><code>get_api</code></li> <li><code>post_api</code></li> <li><code>patch_api</code></li> <li><code>delete_api</code></li> <li><code>put_api</code></li> </ul> <p>Key points:</p> <ul> <li>These decorators only accept keyword arguments (they are defined as <code>def get_api(**kwargs)</code> etc.).</li> <li><code>@get_api('/user')</code> is invalid and will raise a <code>TypeError</code> at import time.</li> <li>Always use the keyword form: <code>@get_api(url='/user')</code>.</li> <li>The <code>url</code> argument uses a lightweight template syntax with <code>{param}</code> placeholders, which are mapped to your method parameters. Use the singular dict-style parameter names in your handler to access captured values:</li> </ul> <pre><code>@controller(url='/api/users')\nclass UserController:\n    @get_api(url='/{user_id}')\n    def get_user(self, url_params):\n        user_id = url_params.get('user_id') if url_params else None\n        ...\n</code></pre> <p>Common options:</p> <ul> <li><code>url</code>: Route pattern (string). Supports <code>{param}</code> placeholders, e.g. <code>'/users/{user_id}'</code>.</li> <li><code>query_params</code>: Iterable of query parameter names, e.g. <code>('page', 'size')</code>. In handlers the query values are provided via a single <code>query_params</code> dict argument.</li> <li><code>body_params</code> (POST/PATCH only): Iterable of body field names for JSON/form parsing. In handlers the parsed fields are provided via a single <code>body_params</code> dict argument.</li> <li><code>file_params</code>: Iterable of file field names for file uploads.</li> <li><code>headers</code>: Iterable of required HTTP header names.</li> <li><code>get_request_body</code> (POST/PATCH only): If <code>True</code>, passes the raw request body to your method.</li> </ul> <p>Example combinations:</p> <pre><code>@controller(url='/api/users')\nclass UserController:\n    @get_api(url='/', query_params=('page', 'size'))\n    def list_users(self, query_params):\n        page = query_params.get('page') if query_params else None\n        size = query_params.get('size') if query_params else None\n        ...\n\n    @post_api(url='/', body_params=('name', 'email'))\n    def create_user(self, body_params):\n        name = body_params.get('name') if body_params else None\n        email = body_params.get('email') if body_params else None\n        ...\n</code></pre> <p>For a deeper dive into URL patterns and all decorator options, see <code>docs/wiki/restful_api.md</code>.</p>"},{"location":"getting_started/#recommended-dependency-injection-approaches","title":"Recommended Dependency Injection Approaches","text":"<p>Approach 1: InjectByName (Recommended, Simplest)</p> <p>Inject by name without importing dependencies, avoiding circular import issues:</p> <pre><code>from cullinan.service import Service, service\nfrom cullinan.core import injectable, InjectByName\n\n@service\nclass DatabaseService(Service):\n    def query(self, sql):\n        return f\"Results for: {sql}\"\n\n@injectable\nclass UserRepository:\n    # Recommended: InjectByName doesn't need type annotation, just use string name\n    db = InjectByName('DatabaseService')\n\n    def get_users(self):\n        return self.db.query(\"SELECT * FROM users\")\n</code></pre> <p>Approach 2: Inject + TYPE_CHECKING (IDE autocomplete support)</p> <p>If you need IDE autocomplete and type checking, use <code>Inject</code> with TYPE_CHECKING:</p> <pre><code>from typing import TYPE_CHECKING\nfrom cullinan.core import injectable, Inject\nfrom cullinan.service import Service, service\n\n# TYPE_CHECKING imports are not executed at runtime, avoiding circular imports\nif TYPE_CHECKING:\n    from cullinan.service import DatabaseService\n\n@service\nclass DatabaseService(Service):\n    def query(self, sql):\n        return f\"Results for: {sql}\"\n\n@injectable\nclass UserRepository:\n    # With TYPE_CHECKING import, you get IDE autocomplete support\n    db: 'DatabaseService' = Inject()\n\n    def get_users(self):\n        # IDE can suggest db.query method\n        return self.db.query(\"SELECT * FROM users\")\n</code></pre> <p>Approach 3: Inject + Pure String Annotation (No IDE autocomplete)</p> <p>If you don't need IDE autocomplete, use string annotations directly:</p> <pre><code>from cullinan.core import injectable, Inject\n\n@injectable\nclass UserRepository:\n    # Pure string annotation, no import needed, but no IDE autocomplete\n    db: 'DatabaseService' = Inject()\n\n    def get_users(self):\n        return self.db.query(\"SELECT * FROM users\")\n</code></pre> <p>Summary: - InjectByName: Recommended for most cases, simple and straightforward, no type annotation needed - Inject + TYPE_CHECKING: Best for development experience, provides IDE autocomplete - Inject + String annotation: Simplest but no IDE support</p> <p>For detailed information on injection patterns, see <code>docs/wiki/injection.md</code>.</p>"},{"location":"getting_started/#common-patterns","title":"Common patterns","text":""},{"location":"getting_started/#adding-middleware","title":"Adding middleware","text":"<pre><code>from cullinan.middleware import MiddlewareBase\n\nclass LoggingMiddleware(MiddlewareBase):\n    def process_request(self, request):\n        print(f\"Request: {request.method} {request.path}\")\n\n# Register during app initialization\napp.add_middleware(LoggingMiddleware())\n</code></pre>"},{"location":"getting_started/#configuration","title":"Configuration","text":"<pre><code>from cullinan.config import Config\n\nconfig = Config()\nconfig.set('database.url', 'postgresql://localhost/mydb')\nconfig.set('server.port', 8080)\n</code></pre>"},{"location":"getting_started/#troubleshooting","title":"Troubleshooting","text":"<ul> <li>If you encounter errors installing packages, ensure your Python and pip are up to date and that you have network access to PyPI.</li> </ul>"},{"location":"getting_started/#next-steps","title":"Next steps","text":"<ul> <li>Read <code>docs/wiki/injection.md</code> for IoC/DI details.</li> <li>Explore <code>examples/</code> for runnable samples.</li> </ul>"},{"location":"getting_started/#additional-resources","title":"Additional resources","text":"<ul> <li>Architecture: See <code>docs/architecture.md</code> for system design overview</li> <li>Components: Read <code>docs/wiki/components.md</code> for component responsibilities</li> <li>Lifecycle: Learn about application lifecycle in <code>docs/wiki/lifecycle.md</code></li> <li>Middleware: Understand middleware in <code>docs/wiki/middleware.md</code></li> <li>API Reference: Browse <code>docs/api_reference.md</code> for complete API documentation</li> <li>Examples: Explore <code>examples/</code> directory for more samples</li> </ul>"},{"location":"getting_started/#community-and-support","title":"Community and support","text":"<ul> <li>Issues: Report bugs at GitHub Issues</li> <li>Contributing: See <code>docs/contributing.md</code> for contribution guidelines</li> <li>Testing: Read <code>docs/testing.md</code> for testing best practices</li> </ul>"},{"location":"import_migration_090/","title":"Cullinan 0.90 Import Migration Guide","text":"<p>This guide helps you migrate your imports from the old structure to the new 0.90 structure.</p>"},{"location":"import_migration_090/#overview","title":"Overview","text":"<p>Cullinan 0.90 introduces a reorganized <code>core/</code> module with clear separation of concerns:</p> <ul> <li><code>container/</code> - IoC/DI container (ApplicationContext, Definition, Scope)</li> <li><code>diagnostics/</code> - Exceptions and error rendering</li> <li><code>lifecycle/</code> - Lifecycle management</li> <li><code>request/</code> - Request context</li> <li><code>legacy/</code> - Deprecated components (will be removed in 1.0)</li> </ul>"},{"location":"import_migration_090/#quick-migration-table","title":"Quick Migration Table","text":""},{"location":"import_migration_090/#core-container-20-api-recommended","title":"Core Container (2.0 API - Recommended)","text":"Old Import New Import <code>from cullinan.core.application_context import ApplicationContext</code> <code>from cullinan.core.container import ApplicationContext</code> <code>from cullinan.core.definitions import Definition, ScopeType</code> <code>from cullinan.core.container import Definition, ScopeType</code> <code>from cullinan.core.factory import Factory</code> <code>from cullinan.core.container import Factory</code> <code>from cullinan.core.scope_manager import ScopeManager</code> <code>from cullinan.core.container import ScopeManager</code>"},{"location":"import_migration_090/#exceptions","title":"Exceptions","text":"Old Import New Import <code>from cullinan.core.exceptions import RegistryFrozenError</code> <code>from cullinan.core.diagnostics import RegistryFrozenError</code> <code>from cullinan.core.exceptions import DependencyNotFoundError</code> <code>from cullinan.core.diagnostics import DependencyNotFoundError</code> <code>from cullinan.core.exceptions import CircularDependencyError</code> <code>from cullinan.core.diagnostics import CircularDependencyError</code> <code>from cullinan.core.exceptions import ScopeNotActiveError</code> <code>from cullinan.core.diagnostics import ScopeNotActiveError</code> <code>from cullinan.core.exceptions import ConditionNotMetError</code> <code>from cullinan.core.diagnostics import ConditionNotMetError</code> <code>from cullinan.core.exceptions import CreationError</code> <code>from cullinan.core.diagnostics import CreationError</code> <code>from cullinan.core.exceptions import LifecycleError</code> <code>from cullinan.core.diagnostics import LifecycleError</code>"},{"location":"import_migration_090/#diagnostics","title":"Diagnostics","text":"Old Import New Import <code>from cullinan.core.diagnostics import render_resolution_path</code> <code>from cullinan.core.diagnostics import render_resolution_path</code> <code>from cullinan.core.diagnostics import format_circular_dependency_error</code> <code>from cullinan.core.diagnostics import format_circular_dependency_error</code>"},{"location":"import_migration_090/#lifecycle","title":"Lifecycle","text":"Old Import New Import <code>from cullinan.core.lifecycle import LifecycleManager</code> <code>from cullinan.core.lifecycle import LifecycleManager</code> <code>from cullinan.lifecycle_hooks import LifecycleEvent</code> <code>from cullinan.core.lifecycle import LifecycleEvent</code> <code>from cullinan.lifecycle_hooks import LifecycleEventManager</code> <code>from cullinan.core.lifecycle import LifecycleEventManager</code>"},{"location":"import_migration_090/#request-context","title":"Request Context","text":"Old Import New Import <code>from cullinan.core.context import RequestContext</code> <code>from cullinan.core.request import RequestContext</code> <code>from cullinan.core.context import get_current_context</code> <code>from cullinan.core.request import get_current_context</code> <code>from cullinan.core.context import create_context</code> <code>from cullinan.core.request import create_context</code>"},{"location":"import_migration_090/#types","title":"Types","text":"Old Import New Import <code>from cullinan.core.types import LifecycleState</code> <code>from cullinan.core.diagnostics import LifecycleState</code> <code>from cullinan.core.types import LifecycleAware</code> <code>from cullinan.core.diagnostics import LifecycleAware</code>"},{"location":"import_migration_090/#top-level-files","title":"Top-Level Files","text":"Old File New File Description <code>cullinan/app.py</code> <code>cullinan/bootstrap.py</code> Application bootstrap <code>cullinan/application.py</code> <code>cullinan/scanner.py</code> Module scanner <code>cullinan/lifecycle_hooks.py</code> <code>cullinan/core/lifecycle/events.py</code> Lifecycle events <code>cullinan/extensions.py</code> <code>cullinan/core/extensions.py</code> Extension registry"},{"location":"import_migration_090/#legacy-imports-deprecated","title":"Legacy Imports (Deprecated)","text":"<p>The following imports are deprecated and will be removed in 1.0:</p> <pre><code># Deprecated - will be removed in 1.0\nfrom cullinan.core.injection import Inject, InjectByName, injectable\nfrom cullinan.core.provider import Provider, ProviderRegistry\nfrom cullinan.core.facade import IoCFacade, get_ioc_facade\nfrom cullinan.core.registry import Registry, SimpleRegistry\nfrom cullinan.core.scope import SingletonScope, TransientScope, RequestScope\n</code></pre> <p>These have been moved to <code>cullinan.core.legacy/</code> and will emit <code>DeprecationWarning</code>.</p>"},{"location":"import_migration_090/#code-examples","title":"Code Examples","text":""},{"location":"import_migration_090/#before-083","title":"Before (0.83)","text":"<pre><code>from cullinan.core.application_context import ApplicationContext\nfrom cullinan.core.definitions import Definition, ScopeType\nfrom cullinan.core.exceptions import (\n    RegistryFrozenError,\n    CircularDependencyError,\n    ScopeNotActiveError,\n)\nfrom cullinan.core.context import RequestContext\n\nctx = ApplicationContext()\nctx.register(Definition(\n    name='UserService',\n    factory=lambda c: UserService(),\n    scope=ScopeType.SINGLETON,\n    source='service:UserService'\n))\nctx.refresh()\n</code></pre>"},{"location":"import_migration_090/#after-090","title":"After (0.90)","text":"<pre><code>from cullinan.core.container import ApplicationContext, Definition, ScopeType\nfrom cullinan.core.diagnostics import (\n    RegistryFrozenError,\n    CircularDependencyError,\n    ScopeNotActiveError,\n)\nfrom cullinan.core.request import RequestContext\n\nctx = ApplicationContext()\nctx.register(Definition(\n    name='UserService',\n    factory=lambda c: UserService(),\n    scope=ScopeType.SINGLETON,\n    source='service:UserService'\n))\nctx.refresh()\n</code></pre>"},{"location":"import_migration_090/#batch-migration-script","title":"Batch Migration Script","text":"<p>You can use the following regex patterns to batch-update your imports:</p> <pre><code># Container imports\nsed -i 's/from cullinan\\.core\\.application_context import/from cullinan.core.container import/g' *.py\nsed -i 's/from cullinan\\.core\\.definitions import/from cullinan.core.container import/g' *.py\nsed -i 's/from cullinan\\.core\\.factory import/from cullinan.core.container import/g' *.py\nsed -i 's/from cullinan\\.core\\.scope_manager import/from cullinan.core.container import/g' *.py\n\n# Exception imports\nsed -i 's/from cullinan\\.core\\.exceptions import/from cullinan.core.diagnostics import/g' *.py\n\n# Request context imports\nsed -i 's/from cullinan\\.core\\.context import/from cullinan.core.request import/g' *.py\n</code></pre>"},{"location":"import_migration_090/#unchanged-imports","title":"Unchanged Imports","text":"<p>The following imports remain unchanged and work as before:</p> <pre><code># These still work the same way\nfrom cullinan import (\n    # Configuration\n    configure, get_config, CullinanConfig,\n\n    # Service layer\n    Service, ServiceRegistry, service, get_service_registry,\n\n    # Controller\n    ControllerRegistry, get_controller_registry,\n    get_api, post_api, patch_api, delete_api, put_api,\n    Handler, response,\n\n    # Middleware\n    Middleware, MiddlewareChain, middleware,\n\n    # WebSocket\n    WebSocketRegistry, websocket_handler,\n\n    # Testing\n    ServiceTestCase, MockService, TestRegistry,\n)\n</code></pre>"},{"location":"import_migration_090/#questions","title":"Questions?","text":"<ul> <li>See Dependency Injection Guide</li> <li>See Migration Guide</li> </ul>"},{"location":"migration_guide/","title":"Cullinan 2.0 Migration Guide","text":"<p>Version: v0.90 Author: Plumeink</p> <p>This guide helps you migrate from Cullinan 1.x to 2.0 (0.90).</p>"},{"location":"migration_guide/#breaking-changes","title":"Breaking Changes","text":""},{"location":"migration_guide/#1-single-entry-point","title":"1. Single Entry Point","text":"<p>Before (1.x): <pre><code>from cullinan.core import get_injection_registry, get_service_registry\n\nregistry = get_injection_registry()\nregistry.add_provider_source(my_source)\n</code></pre></p> <p>After (2.0): <pre><code>from cullinan.core.container import ApplicationContext, Definition, ScopeType\n\nctx = ApplicationContext()\nctx.register(Definition(\n    name='MyService',\n    factory=lambda c: MyService(),\n    scope=ScopeType.SINGLETON,\n    source='service:MyService'\n))\nctx.refresh()\n</code></pre></p>"},{"location":"migration_guide/#2-registry-freeze","title":"2. Registry Freeze","text":"<p>In 2.0, the registry is frozen after <code>refresh()</code>. Any attempt to register new dependencies will raise <code>RegistryFrozenError</code>.</p> <p>Before (1.x): <pre><code># Could register at any time\nregistry.register('NewService', NewService)\n</code></pre></p> <p>After (2.0): <pre><code>ctx = ApplicationContext()\nctx.register(...)  # OK before refresh\nctx.refresh()\nctx.register(...)  # RegistryFrozenError!\n</code></pre></p>"},{"location":"migration_guide/#3-scope-enforcement","title":"3. Scope Enforcement","text":"<p>Request-scoped dependencies now strictly require a <code>RequestContext</code>.</p> <p>Before (1.x): <pre><code># Might silently fail or return wrong instance\ninstance = registry.get('RequestScoped')\n</code></pre></p> <p>After (2.0): <pre><code>ctx.enter_request_context()\ntry:\n    instance = ctx.get('RequestScoped')  # OK\nfinally:\n    ctx.exit_request_context()\n\n# Without context:\nctx.get('RequestScoped')  # ScopeNotActiveError!\n</code></pre></p>"},{"location":"migration_guide/#4-structured-exceptions","title":"4. Structured Exceptions","text":"<p>All exceptions now carry structured diagnostic fields.</p> <p>Before (1.x): <pre><code>try:\n    registry.resolve('Missing')\nexcept Exception as e:\n    print(str(e))  # Generic message\n</code></pre></p> <p>After (2.0): <pre><code>from cullinan.core.diagnostics import DependencyNotFoundError\n\ntry:\n    ctx.get('Missing')\nexcept DependencyNotFoundError as e:\n    print(e.dependency_name)      # 'Missing'\n    print(e.resolution_path)      # ['ParentService', 'Missing']\n    print(e.candidate_sources)    # [{'source': '...', 'reason': '...'}]\n</code></pre></p>"},{"location":"migration_guide/#5-circular-dependency-detection","title":"5. Circular Dependency Detection","text":"<p>Circular dependencies now produce stable, ordered chains.</p> <p>Before (1.x): <pre><code># Unordered, inconsistent output\nCircularDependencyError: Circular dependency detected\n</code></pre></p> <p>After (2.0): <pre><code># Stable, ordered chain\nCircularDependencyError: Circular dependency detected: A -&gt; B -&gt; C -&gt; A\n</code></pre></p>"},{"location":"migration_guide/#migration-steps","title":"Migration Steps","text":""},{"location":"migration_guide/#step-1-update-imports","title":"Step 1: Update Imports","text":"<pre><code># Old imports (deprecated)\nfrom cullinan.core import get_injection_registry, Inject, InjectByName\n\n# New imports (2.0)\nfrom cullinan.core.container import ApplicationContext, Definition, ScopeType\n</code></pre>"},{"location":"migration_guide/#step-2-convert-service-registration","title":"Step 2: Convert Service Registration","text":"<pre><code># Old style\n@service\nclass UserService:\n    user_repo = Inject()\n\n# New style\nctx.register(Definition(\n    name='UserService',\n    factory=lambda c: UserService(user_repo=c.get('UserRepository')),\n    scope=ScopeType.SINGLETON,\n    source='service:UserService'\n))\n</code></pre>"},{"location":"migration_guide/#step-3-update-application-startup","title":"Step 3: Update Application Startup","text":"<pre><code># Old style (app.py)\nfrom cullinan.app import CullinanApplication\napp = CullinanApplication()\napp.run()\n\n# New style\nfrom cullinan.core.container import ApplicationContext\n\nctx = ApplicationContext()\n# ... register definitions ...\nctx.refresh()\n# ... run tornado ...\nctx.shutdown()\n</code></pre>"},{"location":"migration_guide/#step-4-handle-request-scope","title":"Step 4: Handle Request Scope","text":"<pre><code># In request handler\nclass MyHandler(RequestHandler):\n    def get(self):\n        ctx.enter_request_context()\n        try:\n            service = ctx.get('RequestScopedService')\n            # ... use service ...\n        finally:\n            ctx.exit_request_context()\n</code></pre>"},{"location":"migration_guide/#deprecated-apis","title":"Deprecated APIs","text":"<p>The following APIs are deprecated in 2.0 and will be removed in 3.0:</p> Deprecated API Replacement <code>get_injection_registry()</code> <code>ApplicationContext</code> <code>get_service_registry()</code> <code>ApplicationContext.register()</code> <code>@service</code> decorator with auto-inject Explicit Definition registration <code>Inject()</code> / <code>InjectByName()</code> factory with <code>ctx.get()</code> <code>DependencyInjector</code> <code>ApplicationContext</code>"},{"location":"migration_guide/#compatibility-mode","title":"Compatibility Mode","text":"<p>During migration, you can enable compatibility mode (deprecated, will be removed):</p> <pre><code>from cullinan.core.container import ApplicationContext\n\nctx = ApplicationContext()\nctx.set_strict_mode(False)  # Allow some legacy behaviors\n</code></pre> <p>Warning: Compatibility mode is for migration only. Always migrate to strict mode before production deployment.</p>"},{"location":"migration_guide/#testing-migration","title":"Testing Migration","text":"<p>Run all 2.0 tests to verify your migration:</p> <pre><code>python -m pytest tests/test_ioc_di_v2_*.py -v\n</code></pre>"},{"location":"migration_guide/#getting-help","title":"Getting Help","text":"<ul> <li>Dependency Injection Guide</li> <li>API Reference</li> <li>GitHub Issues</li> </ul>"},{"location":"quick_reference_di/","title":"Cullinan Dependency Injection Quick Reference","text":"<p>Version: v0.90 Author: Plumeink</p>"},{"location":"quick_reference_di/#basic-usage","title":"Basic Usage","text":""},{"location":"quick_reference_di/#1-define-a-service","title":"1. Define a Service","text":"<pre><code>from cullinan.service import service, Service\n\n@service\nclass UserService(Service):\n    def __init__(self):\n        super().__init__()\n        self.name = \"UserService\"\n\n    def get_user(self, user_id):\n        return {\"id\": user_id, \"name\": \"John\"}\n</code></pre>"},{"location":"quick_reference_di/#2-inject-service-into-controller","title":"2. Inject Service into Controller","text":"<pre><code>from cullinan.controller import controller, get_api\nfrom cullinan.core import Inject, InjectByName\n\n@controller(url='/api')\nclass UserController:\n    # Method 1: Type annotation (Recommended)\n    user_service: UserService = Inject()\n\n    # Method 2: Explicit name\n    auth_service = InjectByName('AuthService')\n\n    # Method 3: Optional dependency\n    cache_service = InjectByName('CacheService', required=False)\n</code></pre>"},{"location":"quick_reference_di/#3-use-injected-service","title":"3. Use Injected Service","text":"<pre><code>from cullinan.controller import controller, get_api\nfrom cullinan.core import Inject\n\n@controller(url='/api')\nclass UserController:\n    user_service: UserService = Inject()\n\n    @get_api('/users/&lt;user_id&gt;')\n    async def get_user(self, url_param):\n        user_id = url_param.get('user_id')\n        user = self.user_service.get_user(user_id)\n        return user\n</code></pre>"},{"location":"quick_reference_di/#packaging-configuration","title":"Packaging Configuration","text":""},{"location":"quick_reference_di/#using-explicit-registration-recommended","title":"Using Explicit Registration (Recommended)","text":"<pre><code>from cullinan import configure\nfrom my_app.service.user_service import UserService\nfrom my_app.service.auth_service import AuthService\nfrom my_app.controller.user_controller import UserController\n\n# Configure before run()\nconfigure(\n    explicit_services=[\n        UserService,\n        AuthService,\n    ],\n    explicit_controllers=[\n        UserController,\n    ]\n)\n\nfrom cullinan.application import run\nrun()\n</code></pre>"},{"location":"quick_reference_di/#pyinstaller-configuration","title":"PyInstaller Configuration","text":"<pre><code># your_app.spec\nhiddenimports=[\n    'my_app.service.user_service',\n    'my_app.service.auth_service',\n],\ndatas=[\n    ('my_app', 'my_app'),\n],\n</code></pre>"},{"location":"quick_reference_di/#nuitka-configuration","title":"Nuitka Configuration","text":"<pre><code>nuitka --include-package=my_app \\\n       --include-module=my_app.service.user_service \\\n       your_app.py\n</code></pre>"},{"location":"quick_reference_di/#troubleshooting","title":"Troubleshooting","text":"Problem Solution Dependency is None Ensure service uses <code>@service</code> decorator Service not found Check service name matches (case-sensitive) Circular dependency Use <code>InjectByName()</code> for lazy resolution Injection not working Ensure class extends <code>Service</code> or <code>Controller</code>"},{"location":"quick_reference_di/#see-also","title":"See Also","text":"<ul> <li>Dependency Injection Guide - Complete DI documentation</li> <li>Architecture - System architecture overview</li> <li>Migration Guide - Migration from older versions</li> </ul>"},{"location":"quick_start_extensions/","title":"Cullinan Extension Registration Quick Start","text":"<p>Version: v0.90 Feature: Unified Extension Registration and Discovery Pattern Author: Plumeink</p>"},{"location":"quick_start_extensions/#quick-start","title":"Quick Start","text":""},{"location":"quick_start_extensions/#1-middleware-registration-recommended","title":"1. Middleware Registration (Recommended)","text":"<p>Use the <code>@middleware</code> decorator to automatically register middleware:</p> <pre><code>from cullinan.middleware import middleware, Middleware\n\n@middleware(priority=100)\nclass LoggingMiddleware(Middleware):\n    \"\"\"Logging middleware - records all requests\"\"\"\n\n    def process_request(self, handler):\n        print(f\"\u2192 Request: {handler.request.uri}\")\n        return handler  # Return handler to continue processing\n\n    def process_response(self, handler, response):\n        print(f\"\u2190 Response: {response}\")\n        return response\n</code></pre>"},{"location":"quick_start_extensions/#2-priority-control","title":"2. Priority Control","text":"<p>Lower priority numbers execute first:</p> <pre><code>@middleware(priority=10)   # Executes first\nclass CorsMiddleware(Middleware):\n    pass\n\n@middleware(priority=50)   # Executes second\nclass AuthMiddleware(Middleware):\n    pass\n\n@middleware(priority=100)  # Executes third\nclass LoggingMiddleware(Middleware):\n    pass\n</code></pre> <p>Recommended Priority Ranges: - <code>0-50</code>: Critical middleware (CORS, security checks) - <code>51-100</code>: Standard middleware (logging, metrics) - <code>101-200</code>: Application-specific middleware</p>"},{"location":"quick_start_extensions/#3-extension-point-discovery","title":"3. Extension Point Discovery","text":"<p>Query available extension points:</p> <pre><code>from cullinan.extensions import list_extension_points\n\n# Query all extension points\nall_points = list_extension_points()\n\n# Query extension points by category\nmiddleware_points = list_extension_points(category='middleware')\nlifecycle_points = list_extension_points(category='lifecycle')\n\n# Display extension point info\nfor point in middleware_points:\n    print(f\"{point['name']}: {point['description']}\")\n</code></pre> <p>Example output: <pre><code>Middleware.process_request: Intercept and process requests before they reach handlers\nMiddleware.process_response: Intercept and process responses before they are sent\n</code></pre></p>"},{"location":"quick_start_extensions/#4-query-registered-middleware","title":"4. Query Registered Middleware","text":"<pre><code>from cullinan.middleware import get_middleware_registry\n\nregistry = get_middleware_registry()\nregistered = registry.get_registered_middleware()\n\nfor mw in registered:\n    print(f\"{mw['priority']:3d}: {mw['name']}\")\n</code></pre> <p>Example output: <pre><code> 10: CorsMiddleware\n 50: AuthMiddleware\n100: LoggingMiddleware\n</code></pre></p>"},{"location":"quick_start_extensions/#complete-example","title":"Complete Example","text":""},{"location":"quick_start_extensions/#scenario-building-an-authenticated-api","title":"Scenario: Building an Authenticated API","text":"<pre><code>from cullinan import configure, run\nfrom cullinan.middleware import middleware, Middleware\nfrom cullinan.controller import controller, get_api\nfrom cullinan.service import service, Service\nfrom cullinan.core import Inject\n\n# 1. Define middleware (auto-sorted by priority)\n\n@middleware(priority=10)\nclass CorsMiddleware(Middleware):\n    \"\"\"CORS middleware - executes first\"\"\"\n    def process_response(self, handler, response):\n        handler.set_header('Access-Control-Allow-Origin', '*')\n        return response\n\n\n@middleware(priority=50)\nclass AuthMiddleware(Middleware):\n    \"\"\"Auth middleware - executes after CORS\"\"\"\n    def process_request(self, handler):\n        token = handler.request.headers.get('Authorization')\n        if not token and handler.request.path.startswith('/api/'):\n            handler.set_status(401)\n            handler.finish({\"error\": \"Unauthorized\"})\n            return None  # Short-circuit, stop processing\n        return handler\n\n\n@middleware(priority=100)\nclass LoggingMiddleware(Middleware):\n    \"\"\"Logging middleware - executes last\"\"\"\n    def process_request(self, handler):\n        print(f\"[{handler.request.method}] {handler.request.path}\")\n        return handler\n\n\n# 2. Define services\n\n@service\nclass UserService(Service):\n    def get_user(self, user_id):\n        return {\"id\": user_id, \"name\": \"Alice\"}\n\n\n# 3. Define controllers\n\n@controller('/api/users')\nclass UserController:\n    user_service: 'UserService' = Inject()\n\n    @get_api('/&lt;user_id&gt;')\n    def get_user(self, user_id: int):\n        return self.user_service.get_user(user_id)\n\n\n# 4. Start application\n\nif __name__ == '__main__':\n    configure(\n        port=8080,\n        debug=True\n    )\n    run()\n</code></pre> <p>Execution Flow: <pre><code>Request arrives\n  \u2193\nCorsMiddleware (priority=10)\n  \u2193\nAuthMiddleware (priority=50) \n  \u2193\nLoggingMiddleware (priority=100)\n  \u2193\nUserController.get_user()\n  \u2193\nLoggingMiddleware (response, reverse order)\n  \u2193\nAuthMiddleware (response, reverse order)\n  \u2193\nCorsMiddleware (response, reverse order)\n  \u2193\nResponse sent\n</code></pre></p>"},{"location":"quick_start_extensions/#backward-compatibility","title":"Backward Compatibility","text":"<p>Manual registration is still supported:</p> <pre><code>from cullinan.middleware import Middleware, get_middleware_registry\n\nclass MyMiddleware(Middleware):\n    def process_request(self, handler):\n        return handler\n\n# Manual registration\nregistry = get_middleware_registry()\nregistry.register(MyMiddleware, priority=100)\n</code></pre> <p>Both methods can be used together, and the framework will automatically sort by priority.</p>"},{"location":"quick_start_extensions/#extension-point-categories","title":"Extension Point Categories","text":"<p>The framework provides 6 major extension point categories:</p> <ol> <li>Middleware</li> <li><code>Middleware.process_request</code></li> <li> <p><code>Middleware.process_response</code></p> </li> <li> <p>Lifecycle</p> </li> <li><code>Service.on_init</code></li> <li><code>Service.on_startup</code></li> <li> <p><code>Service.on_shutdown</code></p> </li> <li> <p>Injection</p> </li> <li><code>custom_scope</code></li> <li> <p><code>custom_provider</code></p> </li> <li> <p>Routing</p> </li> <li> <p><code>custom_handler</code></p> </li> <li> <p>Configuration</p> </li> <li> <p><code>config_provider</code></p> </li> <li> <p>Handler</p> </li> <li>Custom Tornado Handler</li> </ol>"},{"location":"quick_start_extensions/#faq","title":"FAQ","text":""},{"location":"quick_start_extensions/#q1-what-happens-when-middleware-returns-none","title":"Q1: What happens when middleware returns None?","text":"<p>A: Returning <code>None</code> short-circuits the chain, skipping subsequent middleware and handlers:</p> <pre><code>def process_request(self, handler):\n    if not_authorized:\n        handler.set_status(401)\n        handler.finish({\"error\": \"Unauthorized\"})\n        return None  # Short-circuit, stop processing\n    return handler  # Continue to next middleware\n</code></pre>"},{"location":"quick_start_extensions/#q2-how-to-view-middleware-execution-order","title":"Q2: How to view middleware execution order?","text":"<p>A: Use the registry query:</p> <pre><code>from cullinan.middleware import get_middleware_registry\n\nregistry = get_middleware_registry()\nfor mw in registry.get_registered_middleware():\n    print(f\"{mw['priority']}: {mw['name']}\")\n</code></pre>"},{"location":"quick_start_extensions/#q3-can-middleware-be-registered-dynamically","title":"Q3: Can middleware be registered dynamically?","text":"<p>A: Yes, but it's recommended to complete registration before application startup:</p> <pre><code># Register before startup\nregistry = get_middleware_registry()\nregistry.register(DynamicMiddleware, priority=150)\n\n# Then start the application\nrun()\n</code></pre>"},{"location":"quick_start_extensions/#q4-does-middleware-affect-performance","title":"Q4: Does middleware affect performance?","text":"<p>A: Decorator registration overhead is minimal (~1\u03bcs), with no runtime overhead. Middleware performance depends on your implementation logic.</p>"},{"location":"quick_start_extensions/#further-reading","title":"Further Reading","text":"<ul> <li>Example Code: <code>examples/extension_registration_demo.py</code></li> <li>Extension Development Guide: <code>docs/extension_development_guide.md</code></li> <li>Middleware Details: <code>docs/wiki/middleware.md</code></li> </ul>"},{"location":"quick_start_extensions/#feedback-support","title":"Feedback &amp; Support","text":"<p>For questions or suggestions: 1. Check example code: <code>examples/extension_registration_demo.py</code> 2. Submit an Issue or PR to the project repository</p>"},{"location":"testing/","title":"Testing &amp; Verification","text":"<p>This page describes how to run the existing test suite, add new tests, run example smoke tests, and integrate test execution into CI. Commands are shown for Windows (PowerShell), Linux, and macOS.</p>"},{"location":"testing/#prerequisites","title":"Prerequisites","text":"<ul> <li>Python 3.8 or newer</li> <li>Git</li> <li>A working Cullinan checkout (see <code>docs/build_run.md</code> for environment setup)</li> </ul>"},{"location":"testing/#running-the-test-suite","title":"Running the test suite","text":"<p>After installing Cullinan in editable mode (see <code>docs/build_run.md</code>), you can run the tests with <code>pytest</code>.</p> <p>On all platforms:</p> <pre><code>pytest -q\n</code></pre> <p>If your environment prefers invoking via the Python module interface, you can use:</p> <pre><code>python -m pytest -q\n</code></pre> <p>On Windows, it is also common to use the <code>py</code> launcher:</p> <pre><code>py -3 -m pytest -q\n</code></pre>"},{"location":"testing/#running-individual-test-modules","title":"Running individual test modules","text":"<p>To run a single test file (for example <code>tests/test_core_injection.py</code>):</p> <p>On all platforms:</p> <pre><code>pytest tests/test_core_injection.py -q\n</code></pre> <p>Or with the Python module interface:</p> <pre><code>python -m pytest tests/test_core_injection.py -q\n</code></pre>"},{"location":"testing/#adding-new-tests","title":"Adding new tests","text":"<p>When adding tests for new features or bug fixes:</p> <ol> <li>Place test files under the <code>tests/</code> directory.</li> <li>Use descriptive test names and group related tests in the same module.</li> <li>Prefer <code>pytest</code> style tests (functions and classes) to match the existing suite.</li> <li>Ensure tests are deterministic and do not depend on external services unless explicitly marked.</li> </ol>"},{"location":"testing/#smoke-tests-using-examples","title":"Smoke tests using examples","text":"<p>Cullinan includes runnable examples under the <code>examples/</code> directory that can be used as smoke tests.</p>"},{"location":"testing/#example-hello-http","title":"Example: Hello HTTP","text":"<p>On Windows (PowerShell):</p> <pre><code>python examples\\hello_http.py\n</code></pre> <p>On Linux / macOS:</p> <pre><code>python examples/hello_http.py\n</code></pre> <p>Then open <code>http://localhost:4080/hello</code> in a browser to verify that the server responds.</p>"},{"location":"testing/#example-middleware-demo","title":"Example: Middleware demo","text":"<p>On Windows (PowerShell):</p> <pre><code>python examples\\middleware_demo.py\n</code></pre> <p>On Linux / macOS:</p> <pre><code>python examples/middleware_demo.py\n</code></pre> <p>The log output illustrates how middleware and injected services participate in request handling. Exact timestamps and IDs may vary between runs.</p>"},{"location":"testing/#integrating-tests-into-ci","title":"Integrating tests into CI","text":"<p>In a CI pipeline, the following steps are typically required:</p> <ol> <li>Set up a Python environment.</li> <li>Install dependencies in editable mode (optionally with development extras).</li> <li>Run the test suite with <code>pytest</code>.</li> </ol> <p>Example sequence (bash-style, to be adapted to your CI system):</p> <pre><code>python -m pip install -U pip\npip install -e .[dev]\npytest -q\n</code></pre> <p>On Windows-based CI using PowerShell, the commands are analogous:</p> <pre><code>python -m pip install -U pip\npip install -e .[dev]\npy -3 -m pytest -q\n</code></pre> <p>Adjust the exact commands and options according to your CI provider and environment.</p>"},{"location":"modules/app/","title":"cullinan.app","text":"<p>Note (v0.90): The application lifecycle is now managed by <code>ApplicationContext</code>. For the new IoC/DI 2.0 lifecycle, see Dependency Injection Guide. Use <code>ApplicationContext.refresh()</code> and <code>ApplicationContext.shutdown()</code> for lifecycle management.</p> <p>Summary: placeholder for <code>cullinan.app</code> module documentation. Describe entry-points and how to create app instances.</p> <p>Public symbols to document: App, main (if present)</p>"},{"location":"modules/app/#public-api-auto-generated","title":"Public API (auto-generated)","text":""},{"location":"modules/app/#cullinanapp_1","title":"cullinan.app","text":"Name Kind Signature / Value <code>CullinanApplication</code> class <code>CullinanApplication(shutdown_timeout: int = 30)</code> <code>create_app</code> function <code>create_app(shutdown_timeout: int = 30) -&gt; cullinan.app.CullinanApplication</code>"},{"location":"modules/app/#example-create-and-run-an-application","title":"Example: create and run an application","text":"<pre><code># Quick (recommended): use the framework entrypoint in the process entry script\nfrom cullinan import application\n\nif __name__ == '__main__':\n    application.run()\n\n# Advanced (optional): programmatic control (e.g., tests or adding shutdown handlers)\nfrom cullinan.app import create_app\n\napplication_instance = create_app()\n# application_instance.startup()/application_instance.shutdown() or application_instance.add_shutdown_handler(...)\n# application_instance.run()  # call at the process entrypoint\n</code></pre>"},{"location":"modules/application/","title":"cullinan.application","text":"<p>Note (v0.90): For the new IoC/DI 2.0 architecture, see Dependency Injection Guide.</p> <p>Summary: placeholder for <code>cullinan.application</code> module documentation. Include public classes, typical usage, and links to related tests and examples.</p> <p>Public symbols to document (suggested): Application, start, stop</p> <p>Usage example:</p> <p>(placeholder for minimal code showing a typical Application usage)</p>"},{"location":"modules/application/#public-api-auto-generated","title":"Public API (auto-generated)","text":""},{"location":"modules/application/#cullinanapplication_1","title":"cullinan.application","text":"Name Kind Signature / Value <code>run</code> function <code>run(handlers=None)</code>"},{"location":"modules/controller/","title":"cullinan.controller","text":"<p>Note (v0.90): Controller DI is now managed by <code>ApplicationContext</code>. For the new IoC/DI 2.0 architecture, see Dependency Injection Guide.</p> <p>Summary: Controller registration, lifecycle, and injection into controller instances. Document usage patterns and common pitfalls.</p>"},{"location":"modules/controller/#public-api-auto-generated","title":"Public API (auto-generated)","text":""},{"location":"modules/controller/#cullinancontroller_1","title":"cullinan.controller","text":"Name Kind Signature / Value <code>controller</code> function <code>controller(**kwargs) -&gt; Callable</code> <code>get_controller_registry</code> function <code>get_controller_registry() -&gt; cullinan.controller.registry.ControllerRegistry</code> <code>get_header_registry</code> function <code>get_header_registry() -&gt; cullinan.controller.core.HeaderRegistry</code> <code>request_resolver</code> function <code>request_resolver(self, url_param_key_list: Optional[Sequence] = None, url_param_value_list: Optional[Sequence] = None, query_param_names: Optional[Sequence] = None, body_param_names: Optional[Sequence] = None, file_param_key_list: Optional[Sequence] = None) -&gt; Tuple[Optional[dict], Optional[dict], Optional[dict], Optional[dict]]</code> <code>reset_controller_registry</code> function <code>reset_controller_registry() -&gt; None</code> <code>response_build</code> function <code>response_build(**kwargs) -&gt; cullinan.controller.core.StatusResponse</code>"},{"location":"modules/controller/#example-register-a-simple-controller","title":"Example: register a simple controller","text":"<pre><code>from cullinan.controller import controller, get_controller_registry\n\n@controller(path='/hello')\ndef hello(request):\n    return {'status': 200, 'body': 'Hello World'}\n\n# Optionally register directly into registry (usually auto-discovered)\nregistry = get_controller_registry()\nregistry.register(r'/hello', hello)\n</code></pre> <p>Notes: - Use the <code>controller</code> decorator for route handlers; the framework supports automatic discovery via module scanning or explicit registry registration. - If handlers need DI, use <code>@injectable</code> classes or property injection and ensure providers are registered before app startup.</p>"},{"location":"modules/core/","title":"cullinan.core","text":"<p>Note (v0.90): The core module has been reorganized in version 0.90. For the new IoC/DI 2.0 API, see Dependency Injection Guide. New projects should use <code>ApplicationContext</code> from <code>cullinan.core.container</code>.</p> <p>New module structure: - <code>cullinan.core.container</code> - ApplicationContext, Definition, ScopeType - <code>cullinan.core.diagnostics</code> - Exceptions and error rendering - <code>cullinan.core.lifecycle</code> - Lifecycle management - <code>cullinan.core.request</code> - Request context</p> <p>Summary: Core IoC/DI primitives, provider, scope, registry, and lifecycle helpers. This page should reference concrete files in <code>cullinan/core/</code> and include usage examples.</p> <p>Public symbols to document: provider, registry, scope, injection APIs</p>"},{"location":"modules/core/#public-api-auto-generated","title":"Public API (auto-generated)","text":""},{"location":"modules/core/#cullinancore_1","title":"cullinan.core","text":"Name Kind Signature / Value <code>Inject</code> class <code>Inject(name: Optional[str] = None, required: bool = True)</code> <code>InjectByName</code> class <code>InjectByName(service_name: Optional[str] = None, required: bool = True)</code> <code>InjectionRegistry</code> class <code>InjectionRegistry()</code> <code>ProviderRegistry</code> class <code>ProviderRegistry()</code> <code>RequestScope</code> class <code>RequestScope(storage_key: str = '_scoped_instances')</code> <code>SingletonScope</code> class <code>SingletonScope()</code> <code>TransientScope</code> class <code>TransientScope()</code> <code>create_context</code> function <code>create_context() -&gt; cullinan.core.context.RequestContext</code> <code>destroy_context</code> function <code>destroy_context() -&gt; None</code> <code>get_context_value</code> function <code>get_context_value(key: str, default: Any = None) -&gt; Any</code> <code>get_current_context</code> function <code>get_current_context() -&gt; Optional[cullinan.core.context.RequestContext]</code> <code>get_injection_registry</code> function <code>get_injection_registry() -&gt; cullinan.core.injection.InjectionRegistry</code> <code>get_request_scope</code> function <code>get_request_scope() -&gt; cullinan.core.scope.RequestScope</code> <code>get_singleton_scope</code> function <code>get_singleton_scope() -&gt; cullinan.core.scope.SingletonScope</code> <code>get_transient_scope</code> function <code>get_transient_scope() -&gt; cullinan.core.scope.TransientScope</code> <code>inject_constructor</code> function <code>inject_constructor(cls: Optional[Type] = None)</code> <code>injectable</code> function <code>injectable(cls: Optional[Type] = None)</code> <code>reset_injection_registry</code> function <code>reset_injection_registry() -&gt; None</code> <code>set_context_value</code> function <code>set_context_value(key: str, value: Any) -&gt; None</code> <code>set_current_context</code> function <code>set_current_context(context: Optional[cullinan.core.context.RequestContext]) -&gt; None</code>"},{"location":"modules/core/#examples","title":"Examples","text":"<p>Property injection example (request-scoped provider):</p> <pre><code>from cullinan.core import (\n    ProviderRegistry, ScopedProvider, get_request_scope,\n    injectable, Inject, get_injection_registry, reset_injection_registry\n)\n\nclass Database:\n    def __init__(self):\n        self.id = object()\n\nreset_injection_registry()\nregistry = ProviderRegistry()\nrequest_scope = get_request_scope()\nregistry.register_provider('Database', ScopedProvider(lambda: Database(), request_scope, 'Database'))\nget_injection_registry().add_provider_registry(registry)\n\n@injectable\nclass Service:\n    db: Database = Inject()\n\ns = Service()\nassert s.db is not None\n</code></pre> <p>Constructor injection example:</p> <pre><code>from cullinan.core import inject_constructor, reset_injection_registry, ProviderRegistry, ScopedProvider, get_request_scope, get_injection_registry\n\nclass Config:\n    pass\n\nreset_injection_registry()\npr = ProviderRegistry()\npr.register_provider('Config', ScopedProvider(lambda: Config(), get_request_scope(), 'Config'))\nget_injection_registry().add_provider_registry(pr)\n\n@inject_constructor\nclass Controller:\n    def __init__(self, config: Config):\n        self.config = config\n\nc = Controller()\nassert c.config is not None\n</code></pre> <p>Notes: - Use <code>reset_injection_registry()</code> in tests/setup to ensure a clean injection state. - Prefer <code>@injectable</code> for property injection and <code>@inject_constructor</code> for constructor-based patterns. Ensure ProviderRegistry entries are available before resolving injections.</p>"},{"location":"modules/service/","title":"cullinan.service","text":"<p>Note (v0.90): Services can now be registered via <code>ApplicationContext</code>. For the new IoC/DI 2.0 architecture, see Dependency Injection Guide.</p> <p>Summary: Service registration and provider patterns. Document how services are provided, scoped, and injected.</p>"},{"location":"modules/service/#public-api-auto-generated","title":"Public API (auto-generated)","text":""},{"location":"modules/service/#cullinanservice_1","title":"cullinan.service","text":"Name Kind Signature / Value <code>Service</code> class <code>Service()</code> <code>ServiceRegistry</code> class <code>ServiceRegistry()</code> <code>get_service_registry</code> function <code>get_service_registry() -&gt; cullinan.service.registry.ServiceRegistry</code> <code>reset_service_registry</code> function <code>reset_service_registry() -&gt; None</code> <code>service</code> function <code>service(cls: Optional[Type[cullinan.service.base.Service]] = None, *, dependencies: Optional[List[str]] = None)</code>"},{"location":"modules/service/#example-register-and-use-a-service","title":"Example: register and use a service","text":"<pre><code>from cullinan.service import Service, service, get_service_registry\n\n@service\nclass DatabaseService(Service):\n    def __init__(self):\n        self.connection = \"db_connection_mock\"\n\n    def query(self, sql):\n        return f\"Result for: {sql}\"\n\n# Service is auto-registered via @service decorator\nregistry = get_service_registry()\ndb_service = registry.get('DatabaseService')\nresult = db_service.query(\"SELECT * FROM users\")\nprint(result)  # Output: Result for: SELECT * FROM users\n</code></pre> <p>Notes: - Use the <code>@service</code> decorator to register services automatically during module scanning or explicit initialization. - Services are typically long-lived (singleton-scoped by default unless configured otherwise). - Access services via <code>get_service_registry()</code> or through DI injection in controllers/handlers.</p>"},{"location":"wiki/components/","title":"Components","text":"<p>Note (v0.90): The Core (IoC/DI) component has been redesigned in version 0.90. For the new architecture, see Dependency Injection Guide. The new <code>ApplicationContext</code> from <code>cullinan.core.container</code> is now the recommended entry point.</p> <p>This page describes the primary components of Cullinan and their responsibilities, with pointers to the implementation in the <code>cullinan/</code> package. The goal is a concise reference that helps contributors and users understand where to look in the source for each subsystem.</p> <p>Components overview</p> <ul> <li>Router / URL resolver</li> <li>Responsibility: resolve URL patterns to controller handlers and dispatch requests.</li> <li>Key files: <code>cullinan/controller/core.py</code>, <code>cullinan/controller/registry.py</code>, <code>cullinan/controller/__init__.py</code>.</li> <li> <p>Public symbols: <code>controller</code> (decorator), <code>get_controller_registry</code>, <code>url_resolver</code>.</p> </li> <li> <p>Controller layer</p> </li> <li>Responsibility: define controller classes and handler methods; provide request/response abstractions and response pooling utilities.</li> <li>Key files: <code>cullinan/controller/core.py</code>, <code>cullinan/controller/registry.py</code>, <code>cullinan/controller/stateless_validator.py</code>.</li> <li> <p>Public symbols: <code>Handler</code>, <code>ControllerRegistry</code>, <code>response_build</code>, <code>request_resolver</code>.</p> </li> <li> <p>Request handler &amp; HTTP integration</p> </li> <li>Responsibility: adapt Tornado HTTPServerRequest to controller handlers, manage request parsing and header resolution.</li> <li>Key files: <code>cullinan/handler/*</code>, <code>cullinan/controller/core.py</code>.</li> <li> <p>Public symbols: <code>get_handler_registry</code>, <code>request_handler</code>.</p> </li> <li> <p>Middleware</p> </li> <li>Responsibility: provide interception points for request/response processing, such as auth, logging, or transformation.</li> <li>Key files: <code>cullinan/middleware/*</code>.</li> <li> <p>Notes: middleware is applied in a pipeline; see <code>middleware</code> folder for examples and ordering semantics.</p> </li> <li> <p>Service (business/service layer)</p> </li> <li>Responsibility: long-lived services that provide functionality to controllers (database access, caching, background jobs).</li> <li>Key files: <code>cullinan/service/*</code> (base, decorators, registry).</li> <li> <p>Public symbols: <code>Service</code>, <code>ServiceRegistry</code>, <code>service</code> (decorator), <code>get_service_registry</code>.</p> </li> <li> <p>Core (IoC / DI / lifecycle / providers / scopes)</p> </li> <li>Responsibility: dependency injection, provider registry, scopes (singleton/transient/request), lifecycle management.</li> <li>Key files: <code>cullinan/core/*</code> (<code>injection.py</code>, <code>provider.py</code>, <code>registry.py</code>, <code>scope.py</code>, <code>lifecycle*.py</code>).</li> <li> <p>Public symbols: <code>Inject</code>, <code>injectable</code>, <code>inject_constructor</code>, <code>InjectionRegistry</code>, <code>ProviderRegistry</code>, <code>SingletonScope</code>, <code>RequestScope</code>, <code>create_context</code>.</p> </li> <li> <p>Application / Startup</p> </li> <li>Responsibility: application lifecycle, service discovery and initialization, orderly startup/shutdown and signal handling.</li> <li>Key files: <code>cullinan/app.py</code>, <code>cullinan/application.py</code>.</li> <li>Public symbols: <code>create_app</code>, <code>CullinanApplication</code>, <code>run</code> (application entry points).</li> </ul> <p>Examples \u2014 quick reference</p> <p>Minimal controller registration example (conceptual):</p> <pre><code>from cullinan.controller import controller, get_controller_registry\n\n@controller(path='/hello')\ndef hello_handler(request):\n    return {'status': 200, 'body': 'Hello Cullinan'}\n\n# controllers are discovered or registered; the app will route /hello to hello_handler\n</code></pre> <p>Minimal service example (conceptual):</p> <pre><code>from cullinan.service import Service, service, get_service_registry\n\n@service\ndef MySvc():\n    # register service\n    pass\n\nsvc_registry = get_service_registry()\n</code></pre> <p>Where to look next</p> <ul> <li>Walk the tests in <code>tests/</code> (for real usage examples and expected behavior). Recommended starting points: <code>tests/test_core_injection.py</code>, <code>tests/test_controller_injection_fix.py</code>, <code>tests/test_provider_system.py</code>.</li> <li>Read <code>docs/wiki/injection.md</code> for detailed IoC/DI examples and runnable snippets.</li> </ul> <p>Next steps for documentation</p> <ul> <li>Expand each component subsection with sequence diagrams and concrete code samples extracted from tests.</li> <li>Add a small reference table mapping public symbols to file paths (for faster navigation).</li> </ul>"},{"location":"wiki/decorators/","title":"Decorators","text":"<p>Version: v0.90 Author: Plumeink</p> <p>This document describes the decorator-based component registration system in Cullinan 0.90.</p>"},{"location":"wiki/decorators/#overview","title":"Overview","text":"<p>Cullinan 0.90 introduces a powerful decorator system that provides a clean, declarative way to register components. This approach is consistent with Cullinan's original design philosophy while integrating with the new IoC/DI 2.0 architecture.</p>"},{"location":"wiki/decorators/#key-features","title":"Key Features","text":"<ul> <li>Simple Syntax: Use <code>@service</code>, <code>@controller</code>, <code>@component</code> without parentheses</li> <li>Two-Phase Registration: Decorators collect metadata \u2192 <code>refresh()</code> registers all</li> <li>Dependency Injection: Use <code>Inject</code>, <code>InjectByName</code>, <code>Lazy</code> markers</li> <li>Conditional Registration: Register components based on conditions</li> </ul>"},{"location":"wiki/decorators/#component-decorators","title":"Component Decorators","text":""},{"location":"wiki/decorators/#service","title":"@service","text":"<p>Marks a class as a service component. Services are singleton by default.</p> <pre><code>from cullinan.core import service\nfrom cullinan.core.decorators import Inject\n\n# Simple usage (no parentheses needed)\n@service\nclass UserService:\n    def get_user(self, id: int):\n        return {\"id\": id}\n\n# With parameters\n@service(name=\"customUserService\", scope=\"prototype\")\nclass UserService:\n    pass\n\n# With dependencies\n@service(dependencies=[\"EmailService\"])\nclass NotificationService:\n    email: EmailService = Inject()\n</code></pre> <p>Parameters:</p> Parameter Type Default Description <code>name</code> <code>str</code> Class name Custom component name <code>scope</code> <code>str</code> <code>\"singleton\"</code> Scope: <code>\"singleton\"</code>, <code>\"prototype\"</code>, <code>\"request\"</code> <code>dependencies</code> <code>list[str]</code> <code>None</code> Explicit dependencies for ordering"},{"location":"wiki/decorators/#controller","title":"@controller","text":"<p>Marks a class as a controller component. Controllers handle HTTP requests.</p> <pre><code>from cullinan.core import controller\nfrom cullinan.core.decorators import Inject\n\n# Simple usage\n@controller\nclass RootController:\n    pass\n\n# With URL prefix\n@controller(url=\"/api/users\")\nclass UserController:\n    user_service: UserService = Inject()\n\n    @get_api(url=\"\")\n    def list_users(self):\n        return {\"users\": []}\n\n    @get_api(url=\"/{id}\")\n    def get_user(self, url_params):\n        user_id = url_params.get(\"id\")\n        return self.user_service.get_user(user_id)\n</code></pre> <p>Parameters:</p> Parameter Type Default Description <code>url</code> <code>str</code> <code>\"\"</code> URL prefix for all routes"},{"location":"wiki/decorators/#component","title":"@component","text":"<p>Generic component decorator for classes that are neither services nor controllers.</p> <pre><code>from cullinan.core import component\n\n# Simple usage\n@component\nclass CacheManager:\n    pass\n\n# With scope\n@component(scope=\"prototype\")\nclass RequestHandler:\n    pass\n\n# With custom name\n@component(name=\"myHelper\")\nclass Helper:\n    pass\n</code></pre> <p>Parameters:</p> Parameter Type Default Description <code>name</code> <code>str</code> Class name Custom component name <code>scope</code> <code>str</code> <code>\"singleton\"</code> Scope: <code>\"singleton\"</code>, <code>\"prototype\"</code>, <code>\"request\"</code>"},{"location":"wiki/decorators/#provider","title":"@provider","text":"<p>Marks a class as a dependency provider (factory).</p> <pre><code>from cullinan.core.decorators import provider\n\n@provider\nclass DatabaseConnectionProvider:\n    def get(self):\n        return create_connection()\n\n@provider(name=\"customProvider\")\nclass CustomProvider:\n    pass\n</code></pre>"},{"location":"wiki/decorators/#injection-markers","title":"Injection Markers","text":""},{"location":"wiki/decorators/#inject","title":"Inject","text":"<p>Inject a dependency by type annotation.</p> <pre><code>from cullinan.core.decorators import Inject\n\n@service\nclass UserService:\n    # Required injection (default)\n    email_service: EmailService = Inject()\n\n    # Optional injection\n    cache: CacheService = Inject(required=False)\n</code></pre> <p>Parameters:</p> Parameter Type Default Description <code>required</code> <code>bool</code> <code>True</code> Raise error if dependency not found"},{"location":"wiki/decorators/#injectbyname","title":"InjectByName","text":"<p>Inject a dependency by explicit name.</p> <pre><code>from cullinan.core.decorators import InjectByName\n\n@service\nclass UserService:\n    # Explicit name\n    email = InjectByName(\"EmailService\")\n\n    # Auto-infer from attribute name (user_repo -&gt; UserRepo)\n    user_repo = InjectByName()\n</code></pre> <p>Parameters:</p> Parameter Type Default Description <code>name</code> <code>str</code> <code>None</code> Dependency name (auto-infer if None) <code>required</code> <code>bool</code> <code>True</code> Raise error if dependency not found"},{"location":"wiki/decorators/#lazy","title":"Lazy","text":"<p>Lazy injection - resolve dependency on first access. Useful for breaking circular dependencies.</p> <pre><code>from cullinan.core.decorators import Lazy\n\n@service\nclass ServiceA:\n    # Break circular dependency\n    service_b: 'ServiceB' = Lazy()\n\n@service\nclass ServiceB:\n    service_a: 'ServiceA' = Lazy()\n</code></pre> <p>Parameters:</p> Parameter Type Default Description <code>name</code> <code>str</code> <code>None</code> Optional explicit dependency name"},{"location":"wiki/decorators/#conditional-decorators","title":"Conditional Decorators","text":""},{"location":"wiki/decorators/#conditionalonproperty","title":"@ConditionalOnProperty","text":"<p>Register component based on configuration property.</p> <pre><code>from cullinan.core.decorators import service\nfrom cullinan.core.conditions import ConditionalOnProperty\n\n@service\n@ConditionalOnProperty(\"feature.email\", having_value=\"true\")\nclass EmailService:\n    pass\n\n@service\n@ConditionalOnProperty(\"cache.enabled\", match_if_missing=True)\nclass CacheService:\n    pass\n</code></pre>"},{"location":"wiki/decorators/#conditionalonclass","title":"@ConditionalOnClass","text":"<p>Register component only if a class/module is available.</p> <pre><code>from cullinan.core.conditions import ConditionalOnClass\n\n@service\n@ConditionalOnClass(\"redis.Redis\")\nclass RedisCacheService:\n    pass\n</code></pre>"},{"location":"wiki/decorators/#conditionalonmissingbean","title":"@ConditionalOnMissingBean","text":"<p>Register component only if specified bean is not already registered.</p> <pre><code>from cullinan.core.conditions import ConditionalOnMissingBean\n\n@service\n@ConditionalOnMissingBean(\"CustomEmailService\")\nclass DefaultEmailService:\n    pass\n</code></pre>"},{"location":"wiki/decorators/#conditionalonbean","title":"@ConditionalOnBean","text":"<p>Register component only if specified bean exists.</p> <pre><code>from cullinan.core.conditions import ConditionalOnBean\n\n@service\n@ConditionalOnBean(\"DatabaseConnection\")\nclass DatabaseService:\n    pass\n</code></pre>"},{"location":"wiki/decorators/#conditional","title":"@Conditional","text":"<p>Generic conditional with custom function.</p> <pre><code>from cullinan.core.conditions import Conditional\n\ndef is_production(ctx):\n    return ctx.get_property(\"env\") == \"production\"\n\n@service\n@Conditional(is_production)\nclass ProductionOnlyService:\n    pass\n</code></pre>"},{"location":"wiki/decorators/#complete-example","title":"Complete Example","text":"<pre><code>from cullinan.core import service, controller, ApplicationContext, PendingRegistry\nfrom cullinan.core.decorators import Inject, InjectByName\nfrom cullinan.core.conditions import ConditionalOnClass\n\n# Reset for clean state\nPendingRegistry.reset()\n\n# Define services\n@service\nclass EmailService:\n    def send(self, to: str, content: str):\n        return f\"Email sent to {to}\"\n\n@service\nclass UserService:\n    email_service: EmailService = Inject()\n\n    def get_user(self, id: int):\n        return {\"id\": id, \"name\": f\"User{id}\"}\n\n    def notify_user(self, id: int):\n        user = self.get_user(id)\n        return self.email_service.send(user[\"name\"], \"Hello!\")\n\n# Define controller\n@controller(url=\"/api/users\")\nclass UserController:\n    user_service: UserService = Inject()\n\n    @get_api(url=\"/{id}\")\n    def get_user(self, url_params):\n        user_id = url_params.get(\"id\")\n        return self.user_service.get_user(user_id)\n\n# Optional JSON processor (only if json module available)\n@service\n@ConditionalOnClass(\"json\")\nclass JsonProcessor:\n    def process(self, data):\n        import json\n        return json.dumps(data)\n\n# Create and start application\nctx = ApplicationContext()\nctx.refresh()\n\n# Use services\nuser_svc = ctx.get(\"UserService\")\nprint(user_svc.get_user(1))\n# Output: {'id': 1, 'name': 'User1'}\n\n# Cleanup\nctx.shutdown()\n</code></pre>"},{"location":"wiki/decorators/#two-phase-registration","title":"Two-Phase Registration","text":"<p>Decorators use a two-phase registration mechanism:</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   Module Loading    \u2502     \u2502  ApplicationContext \u2502     \u2502    Runtime Use      \u2502\n\u2502                     \u2502     \u2502      refresh()      \u2502     \u2502                     \u2502\n\u2502  @service collects  \u2502\u2500\u2500\u2500\u2500\u25b6\u2502  Process pending    \u2502\u2500\u2500\u2500\u2500\u25b6\u2502  ctx.get(\"Name\")    \u2502\n\u2502  metadata to        \u2502     \u2502  registrations      \u2502     \u2502  returns instance   \u2502\n\u2502  PendingRegistry    \u2502     \u2502  Freeze registry    \u2502     \u2502                     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"wiki/decorators/#pendingregistry","title":"PendingRegistry","text":"<p>All decorator metadata is collected in <code>PendingRegistry</code>:</p> <pre><code>from cullinan.core import PendingRegistry\n\n# Check registered components before refresh\npending = PendingRegistry.get_instance()\nprint(f\"Pending registrations: {pending.count}\")\n\n# After refresh, registry is frozen\nctx.refresh()\nassert pending.is_frozen  # True\n</code></pre>"},{"location":"wiki/decorators/#best-practices","title":"Best Practices","text":"<ol> <li> <p>Use decorators without parentheses when possible: <code>@service</code> is cleaner than <code>@service()</code></p> </li> <li> <p>Use <code>Inject</code> for type-based injection: Provides better IDE support</p> </li> <li> <p>Use <code>Lazy</code> for circular dependencies: Breaks the cycle explicitly</p> </li> <li> <p>Put conditions after component decorator: Order matters!    <pre><code>@service  # First\n@ConditionalOnClass(\"redis\")  # Second\nclass RedisService:\n    pass\n</code></pre></p> </li> <li> <p>Reset PendingRegistry in tests:    <pre><code>def setup_method(self):\n    PendingRegistry.reset()\n</code></pre></p> </li> </ol>"},{"location":"wiki/decorators/#migration-from-v083","title":"Migration from v0.83","text":"v0.83 v0.90 <code>@service</code> (from <code>cullinan.service</code>) <code>@service</code> (from <code>cullinan.core</code>) <code>@controller(url=...)</code> (from <code>cullinan.controller</code>) <code>@controller(url=...)</code> (from <code>cullinan.core</code>) Manual service registry <code>ApplicationContext.refresh()</code> <pre><code># Before (v0.83)\nfrom cullinan.service import service\nfrom cullinan.controller import controller\n\n# After (v0.90)\nfrom cullinan.core import service, controller\n</code></pre>"},{"location":"wiki/decorators/#related-documentation","title":"Related Documentation","text":"<ul> <li>Dependency Injection Guide</li> <li>Import Migration Guide</li> <li>Components</li> </ul>"},{"location":"wiki/extensions/","title":"Extensions &amp; Plugins","text":"<p>Note (v0.90): Extension registration has been updated in version 0.90. For the new extension system, see Quick Start Extensions and Extension Development Guide. The new <code>ApplicationContext</code> from <code>cullinan.core.container</code> is now the recommended way to register extensions.</p> <p>This page explains how to extend Cullinan with custom plugins and extensions. It covers extension points, provider registration, typical plugin patterns, and a minimal example showing how to register a custom provider and hook it into the application lifecycle.</p> <p>Design principles</p> <ul> <li>Non-invasive: prefer registering providers, controllers, or middleware rather than patching framework internals.</li> <li>Reversible: exposed extension points should be removable/unregisterable for tests and dynamic reconfiguration.</li> <li>Discoverable: plugins should be discoverable via module scanning or explicit registration APIs.</li> </ul> <p>Extension points</p> <ol> <li>Providers and ServiceRegistry</li> <li>Use <code>ProviderRegistry</code> and provider implementations (<code>ClassProvider</code>, <code>FactoryProvider</code>, <code>InstanceProvider</code>) to provide services. Register providers and then add the provider registry into the global <code>InjectionRegistry</code> so injections resolve correctly.</li> <li> <p>Key API: <code>cullinan.core.ProviderRegistry</code>, <code>cullinan.core.ScopedProvider</code>, <code>cullinan.service.registry.ServiceRegistry</code>.</p> </li> <li> <p>Controllers</p> </li> <li>Register controller functions or classes via the <code>controller</code> decorator or via explicit registry APIs. Plugins that add routes should register controllers during application startup.</li> <li> <p>Key API: <code>cullinan.controller.controller</code>, <code>cullinan.controller.get_controller_registry()</code>.</p> </li> <li> <p>Middleware</p> </li> <li>Implement middleware classes/functions that follow the project's middleware contract and register them in the app configuration or during startup to influence request/response processing.</li> <li> <p>Key API: <code>cullinan.middleware</code> package (see examples).</p> </li> <li> <p>Lifecycle hooks</p> </li> <li>Plugins can register startup and shutdown handlers with the <code>CullinanApplication</code> via <code>add_shutdown_handler</code> or by implementing <code>LifecycleAware</code> interfaces if needed.</li> <li>Key API: <code>CullinanApplication.add_shutdown_handler</code>, <code>cullinan.core.lifecycle</code> utilities.</li> </ol> <p>Discovery and registration patterns</p> <ul> <li>Explicit registration (recommended for clarity): your plugin provides a function <code>register(app_or_registry)</code> which the application calls during startup. Example:</li> </ul> <pre><code># my_plugin.py\nfrom cullinan.service import Service, service\nfrom cullinan.core import ProviderRegistry, ScopedProvider, SingletonScope\n\nclass MyService(Service):\n    def __init__(self):\n        self.value = 'my plugin service'\n\ndef register_service(provider_registry: ProviderRegistry):\n    provider_registry.register_provider(\n        'MyService',\n        ScopedProvider(lambda: MyService(), SingletonScope(), 'MyService')\n    )\n\n# Application startup\n# from my_plugin import register_service\n# provider_registry = ProviderRegistry()\n# register_service(provider_registry)\n# injection_registry.add_provider_registry(provider_registry)\n</code></pre> <ul> <li>Auto-discovery (convenience): use module scanning (if enabled) to discover plugin packages under a well-known namespace (e.g., <code>myproject.plugins.*</code>). Prefer explicit registration for production deployments.</li> </ul> <p>Packaging and distribution</p> <ul> <li>Package your plugin as a standard Python package. Expose a <code>register()</code> entrypoint or a well-known module path for discovery.</li> <li>Optionally provide an entry_point in setup.cfg / setup.py under a custom group (e.g., <code>cullinan.plugins</code>) and use pkg_resources or importlib.metadata to discover installed plugins.</li> </ul> <p>Minimal plugin example \u2014 logging middleware</p> <pre><code># my_logging_plugin.py\nimport logging\nfrom cullinan.middleware import MiddlewareBase\n\nlogger = logging.getLogger('my_plugin')\n\nclass RequestLogger(MiddlewareBase):\n    def process_request(self, request):\n        logger.info('Incoming %s %s', request.method, request.path)\n\ndef register(app):\n    # app-specific registration, pseudocode\n    app.add_middleware(RequestLogger())\n</code></pre> <p>Testing plugins</p> <ul> <li>Unit-test your plugin in isolation, mocking provider registries and application lifecycle.</li> <li>Ensure <code>register()</code> is idempotent and can be called multiple times safely (or add guards).</li> </ul> <p>Security and compatibility notes</p> <ul> <li>Plugins run inside the application process; avoid executing untrusted code or allowing plugins to run arbitrary startup scripts.</li> <li>Document compatibility with Cullinan versions and provide upgrade notes in your plugin's package.</li> </ul> <p>Next steps</p> <ul> <li>Provide a plugin scaffold generator (cookiecutter) for easier authoring.</li> <li>Add example plugin packages to the <code>examples/</code> directory for documentation and CI tests.</li> </ul>"},{"location":"wiki/injection/","title":"IoC &amp; DI (Injection)","text":"<p>Version: v0.90 Author: Plumeink</p> <p>This page documents the IoC (Inversion of Control) and DI (Dependency Injection) system used by Cullinan. For the complete architecture overview, see Architecture. For migration from previous versions, see Migration Guide.</p>"},{"location":"wiki/injection/#key-concepts","title":"Key Concepts","text":""},{"location":"wiki/injection/#inversion-of-control-ioc","title":"Inversion of Control (IoC)","text":"<p>IoC is a design principle where the control of object creation and lifecycle is transferred from the application code to a framework or container.</p>"},{"location":"wiki/injection/#dependency-injection-di","title":"Dependency Injection (DI)","text":"<p>DI is a technique for achieving IoC. Dependencies are \"injected\" into a class rather than being created by the class itself.</p>"},{"location":"wiki/injection/#recommended-usage-decorator-based","title":"Recommended Usage (Decorator-Based)","text":""},{"location":"wiki/injection/#1-define-a-service","title":"1. Define a Service","text":"<pre><code>from cullinan.service import service, Service\n\n@service\nclass DatabaseService(Service):\n    def __init__(self):\n        super().__init__()\n        self.connection = None\n\n    def on_init(self):\n        \"\"\"Called during service initialization\"\"\"\n        self.connection = create_connection()\n\n    def on_shutdown(self):\n        \"\"\"Called during service shutdown\"\"\"\n        if self.connection:\n            self.connection.close()\n\n    def query(self, sql: str):\n        return self.connection.execute(sql)\n</code></pre>"},{"location":"wiki/injection/#2-inject-dependencies","title":"2. Inject Dependencies","text":"<pre><code>from cullinan.service import service, Service\nfrom cullinan.core import Inject\n\n@service\nclass UserService(Service):\n    # Automatic injection via type annotation\n    database: DatabaseService = Inject()\n\n    def get_user(self, user_id: int):\n        return self.database.query(f\"SELECT * FROM users WHERE id={user_id}\")\n</code></pre>"},{"location":"wiki/injection/#3-use-in-controllers","title":"3. Use in Controllers","text":"<pre><code>from cullinan.controller import controller, get_api\nfrom cullinan.core import Inject\n\n@controller(url='/api/users')\nclass UserController:\n    user_service: UserService = Inject()\n\n    @get_api('/&lt;user_id&gt;')\n    async def get_user(self, url_param):\n        user_id = url_param.get('user_id')\n        return self.user_service.get_user(int(user_id))\n</code></pre>"},{"location":"wiki/injection/#injection-methods","title":"Injection Methods","text":""},{"location":"wiki/injection/#inject-type-annotation-injection-recommended","title":"Inject() - Type Annotation Injection (Recommended)","text":"<p>Best IDE support and type safety.</p> <pre><code>from cullinan.core import Inject\n\n@service\nclass MyService(Service):\n    # Infers dependency name from type annotation\n    database: DatabaseService = Inject()\n\n    # Optional dependency\n    cache: CacheService = Inject(required=False)\n</code></pre>"},{"location":"wiki/injection/#injectbyname-string-name-injection","title":"InjectByName() - String Name Injection","text":"<p>No need to import dependency classes, avoids circular imports.</p> <pre><code>from cullinan.controller import controller\nfrom cullinan.core import InjectByName\n\n@controller(url='/api')\nclass MyController:\n    # Explicit name\n    user_service = InjectByName('UserService')\n\n    # Auto-infer name (snake_case -&gt; PascalCase)\n    email_service = InjectByName()  # -&gt; EmailService\n</code></pre>"},{"location":"wiki/injection/#lifecycle-hooks","title":"Lifecycle Hooks","text":"<p>Services support lifecycle hooks for initialization and cleanup:</p> <pre><code>@service\nclass MyService(Service):\n    def get_phase(self) -&gt; int:\n        \"\"\"Initialization order (lower = earlier)\"\"\"\n        return 0\n\n    def on_init(self):\n        \"\"\"Called after all services are registered\"\"\"\n        pass\n\n    def on_startup(self):\n        \"\"\"Called before the server starts accepting requests\"\"\"\n        pass\n\n    def on_shutdown(self):\n        \"\"\"Called when the server is shutting down\"\"\"\n        pass\n</code></pre>"},{"location":"wiki/injection/#advanced-applicationcontext-for-complex-scenarios","title":"Advanced: ApplicationContext (For Complex Scenarios)","text":"<p>For advanced use cases like third-party integration or custom factories:</p> <pre><code>from cullinan.core.container import ApplicationContext, Definition, ScopeType\n\nctx = ApplicationContext()\n\nctx.register(Definition(\n    name='CustomService',\n    factory=lambda c: CustomService(c.get('Dependency')),\n    scope=ScopeType.SINGLETON,\n    source='custom:CustomService'\n))\n\nctx.refresh()  # Freeze registry\nservice = ctx.get('CustomService')\n</code></pre>"},{"location":"wiki/injection/#best-practices","title":"Best Practices","text":"<ol> <li>Use decorators for services and controllers - Let the framework handle registration</li> <li>Use <code>Inject()</code> for type-safe injection - Better IDE support and refactoring</li> <li>Use <code>InjectByName()</code> to avoid circular imports - When you can't import the type</li> <li>Implement lifecycle hooks properly - Clean initialization and shutdown</li> <li>Keep services focused - Single responsibility principle</li> </ol>"},{"location":"wiki/injection/#troubleshooting","title":"Troubleshooting","text":"Problem Solution Dependency is None Ensure the service is decorated with <code>@service</code> Service not found Check the service name matches (case-sensitive) Circular dependency Use <code>InjectByName()</code> with lazy resolution Injection not working Ensure the class extends <code>Service</code> or <code>Controller</code>"},{"location":"wiki/injection/#see-also","title":"See Also","text":"<ul> <li>Architecture - System architecture overview</li> <li>Decorators - All available decorators</li> <li>Lifecycle - Service lifecycle management</li> <li>Migration Guide - Migrating from older versions</li> </ul>"},{"location":"wiki/lifecycle/","title":"Application Lifecycle","text":"<p>Note (v0.90): This document describes the legacy lifecycle management. For the new IoC/DI 2.0 lifecycle, see Dependency Injection Guide. The new <code>ApplicationContext</code> provides unified lifecycle management via <code>refresh()</code> and <code>shutdown()</code>.</p> <p>This document describes the Cullinan application lifecycle: startup, service initialization, request handling, and graceful shutdown hooks and events. The content is derived from the implementation (source-first) and references <code>cullinan/app.py</code>, <code>cullinan/application.py</code> and <code>cullinan/core/lifecycle</code> related files.</p> <p>Main phases</p> <ol> <li>Startup</li> <li>Entry point: <code>CullinanApplication.run()</code> or using <code>create_app()</code> then calling <code>app.run()</code>.</li> <li> <p>Behavior (see <code>cullinan/app.py</code>):</p> <ul> <li>Calls <code>startup()</code> to perform the startup sequence: configure injection (InjectionRegistry), discover services (ServiceRegistry), and initialize services in dependency order.</li> <li>Registers signal handlers (SIGINT / SIGTERM) to trigger graceful shutdown on signals.</li> <li>Starts Tornado's IOLoop: <code>IOLoop.start()</code> (blocking until stop event).</li> </ul> </li> <li> <p>Service initialization</p> </li> <li>Services register via <code>@service</code> or during module scanning into <code>ServiceRegistry</code>.</li> <li><code>ProviderRegistry</code> / <code>ServiceRegistry</code> instantiate services in dependency order and invoke init hooks (e.g., <code>on_init</code>).</li> <li> <p>If no services registered, initialization step is skipped.</p> </li> <li> <p>Request handling &amp; request scope</p> </li> <li>On request arrival, a request context is created (via <code>create_context()</code>) to support <code>RequestScope</code>.</li> <li>Within the same request context, the RequestScope ensures instances are reused for the lifetime of the request.</li> <li> <p>Handlers (Handler / controller) can obtain request-scoped dependencies via property or constructor injection.</p> </li> <li> <p>Shutdown</p> </li> <li>When the app receives termination signals or a manual shutdown, <code>shutdown()</code> is invoked:<ul> <li>Executes registered shutdown handlers in order (sync or async); errors are controlled by the <code>force</code> flag.</li> <li>Sets <code>_running</code> to False and stops the IOLoop.</li> <li>Calls lifecycle hooks (e.g., <code>on_shutdown</code>) on services to clean up resources.</li> </ul> </li> </ol> <p>Common hooks &amp; extension points</p> <ul> <li><code>CullinanApplication.add_shutdown_handler(handler)</code> \u2014 register custom shutdown handlers (async or sync).</li> <li><code>LifecycleAware</code> and <code>LifecycleManager</code> (in <code>cullinan/core</code>) \u2014 services implementing lifecycle interfaces will be called at appropriate times.</li> <li>Provider/service <code>on_init</code> / <code>on_shutdown</code> hooks (if present) \u2014 invoked during init and shutdown phases.</li> </ul> <p>Minimal example: registering shutdown handlers</p> <pre><code># Quick (recommended): simple entrypoint using the framework module\nfrom cullinan import application\n\nif __name__ == '__main__':\n    application.run()\n\n# Advanced (optional): programmatic usage when you need to add shutdown handlers or fine-grained control\nfrom cullinan.app import create_app\nimport asyncio\n\napplication_instance = create_app()\n\ndef cleanup_sync():\n    print('Running sync cleanup')\n\nasync def cleanup_async():\n    await asyncio.sleep(0.01)\n    print('Running async cleanup')\n\napplication_instance.add_shutdown_handler(cleanup_sync)\napplication_instance.add_shutdown_handler(cleanup_async)\n\n# In process entrypoint call:\n# application_instance.run()\n</code></pre> <p>Request scope example (pseudocode)</p> <pre><code>from cullinan.core import create_context, RequestScope, ScopedProvider, ProviderRegistry\n\nprovider_registry = ProviderRegistry()\nprovider_registry.register_provider('RequestHandler', ScopedProvider(lambda: RequestHandler(), RequestScope(), 'RequestHandler'))\n\nwith create_context():\n    handler1 = provider_registry.get_instance('RequestHandler')\n    handler2 = provider_registry.get_instance('RequestHandler')\n    assert handler1 is handler2\n\n# leaving the context isolates RequestScope instances; next request gets new instances\n</code></pre> <p>Troubleshooting</p> <ul> <li>Startup failures: inspect <code>startup()</code> error logs (<code>Application startup failed</code>) and check service registration/provider initialization stacks.</li> <li>Injection/dependency missing: ensure provider is registered in the <code>ProviderRegistry</code> and the registry is added to the <code>InjectionRegistry</code>.</li> <li>Graceful shutdown issues: if a shutdown handler blocks or raises, consider catching errors or using <code>force=True</code> during shutdown.</li> </ul> <p>References &amp; next steps</p> <ul> <li>Source: <code>cullinan/app.py</code>, <code>cullinan/application.py</code>, <code>cullinan/core/*</code> (provider/registry/scope/lifecycle).</li> <li>Suggestion: add sequence diagrams illustrating startup and shutdown flows to <code>docs/wiki/lifecycle.md</code> for review.</li> </ul>"},{"location":"wiki/lifecycle/#lifecycle-sequence-diagram","title":"Lifecycle Sequence (diagram)","text":"<pre><code>CullinanApplication    ProviderRegistry    ServiceRegistry    Tornado IOLoop    RequestContext    Handler\n-------------------    ----------------    ---------------    ---------------    --------------    -------\nstartup() -&gt; register providers -&gt; discover &amp; init services -&gt; start IOLoop\n                                                        |\n                                                        |-&gt; IOLoop receives request -&gt; create RequestContext\n                                                        |                             -&gt; resolve request-scoped providers\n                                                        |                             -&gt; dispatch to Handler (injection resolves)\n                                                        |                             -&gt; Handler returns response\n                                                        |                             -&gt; RequestContext cleanup\nshutdown() -&gt; call on_shutdown on services -&gt; stop IOLoop\n</code></pre>"},{"location":"wiki/middleware/","title":"Middleware","text":"<p>Note (v0.90): The DI integration in middleware has been updated in version 0.90. For the new IoC/DI system, see Dependency Injection Guide. Middleware can now obtain dependencies via <code>ApplicationContext</code> instead of <code>InjectionRegistry</code>.</p> <p>This document explains Cullinan middleware: responsibilities, execution pipeline, registration, DI integration, examples, troubleshooting and best practices. Middleware is a pluggable stage in the request/response lifecycle for auth, logging, transformations, etc.</p> <p>Core concepts</p> <ul> <li>Middleware pipeline: requests pass through ordered middleware before reaching controllers; middleware may handle, mutate, or short-circuit a request. Responses may also be processed by middleware on the return path.</li> <li>Order &amp; priority: middleware are executed in registration order. Some frameworks offer priority hooks; in Cullinan the registration order determines execution order.</li> <li>Middleware contract: middleware should implement a contract (e.g., <code>process_request</code> / <code>process_response</code>) or inherit from a project base (see <code>cullinan/middleware</code>).</li> </ul> <p>Registration &amp; configuration</p> <ul> <li>Programmatic registration (recommended): register middleware during application startup.</li> </ul> <pre><code># register middleware (pseudocode)\nfrom cullinan import application\nfrom my_middleware import MyMiddleware\n\n# Quick start: run framework entrypoint (recommended)\nif __name__ == '__main__':\n    application.run()\n\n# Advanced (optional): programmatic registration\nfrom cullinan.app import create_app\nfrom my_middleware import MyMiddleware\n\napplication_instance = create_app()\napplication_instance.add_middleware(MyMiddleware())\n# application_instance.run()\n</code></pre> <ul> <li>DI integration: middleware may depend on services provided through the provider/registry system. Register services via provider registries and use injection in middleware classes.</li> </ul> <p>Middleware example (with DI)</p> <pre><code># examples/controller_di_middleware.py (reference)\nfrom cullinan.core import injectable, Inject, get_injection_registry\nfrom cullinan.middleware import MiddlewareBase\n\n@injectable\nclass AuditService:\n    def record(self, request):\n        print('Audit:', request.path)\n\nclass AuditMiddleware(MiddlewareBase):\n    audit: AuditService = Inject()\n\n    def process_request(self, request):\n        self.audit.record(request)\n\n# Register provider and middleware during application startup\n</code></pre> <p>Execution model &amp; constraints</p> <ul> <li>Avoid long-blocking operations in middleware; use background tasks or async patterns where appropriate.</li> <li>Middleware must handle exceptions to avoid breaking the request chain.</li> <li>Ensure middleware lifecycle aligns with request context when using RequestScope or DI; do not store request-scoped objects at module scope.</li> </ul> <p>Troubleshooting</p> <ul> <li>Middleware not invoked: confirm registration at startup and correct registration order; ensure no conditional config is skipping the middleware.</li> <li>Injection issues: if Inject in middleware is unresolved, confirm providers were registered to the InjectionRegistry before middleware instantiation; use <code>reset_injection_registry()</code> in tests to ensure a clean state.</li> <li>Performance: benchmark middleware to avoid expensive operations on critical paths.</li> </ul> <p>Best practices</p> <ul> <li>Keep middleware thin; delegate heavy logic to injected services.</li> <li>Use the framework logger instead of prints for production readiness.</li> <li>Unit test middleware in isolation, mocking request objects and injection registry.</li> </ul> <p>Next steps</p> <ul> <li>Extract a minimal runnable example from <code>examples/controller_di_middleware.py</code> into <code>examples/</code> and ensure it is covered by at least one automated test.</li> <li>Formalize a middleware base contract (if not present) and document the required methods and expected behaviors.</li> </ul>"},{"location":"wiki/middleware/#running-the-demo","title":"Running the demo","text":"<p>Ensure you have a working Python environment (virtualenv, conda, or system Python).</p> <p>On Windows (PowerShell):</p> <pre><code>python -m pip install -U pip\npip install cullinan tornado\npython examples\\middleware_demo.py\n</code></pre> <p>On Linux / macOS:</p> <pre><code>python -m pip install -U pip\npip install cullinan tornado\npython examples/middleware_demo.py\n</code></pre> <p>Typical output (example run):</p> <pre><code>INFO:__main__:Starting IOLoop for middleware demo\nINFO:__main__:Performing request 1\nINFO:__main__:Entered request context\nINFO:__main__:Injected dependencies into handler\nINFO:tornado.access:200 GET /middleware (127.0.0.1) 2.10ms\nINFO:__main__:Exited request context\nINFO:__main__:Response1: Hello from UserService (084297)  request_count=1\nINFO:__main__:Performing request 2\nINFO:__main__:Entered request context\nINFO:__main__:Injected dependencies into handler\nINFO:tornado.access:200 GET /middleware (127.0.0.1) 0.60ms\nINFO:__main__:Exited request context\nINFO:__main__:Response2: Hello from UserService (084297)  request_count=1\nINFO:__main__:IOLoop stopped, exiting\n</code></pre> <p>Note: <code>RequestCounter</code> is request-scoped and resets per request, while <code>UserService</code> is a singleton and retains its instance id across requests.</p>"},{"location":"wiki/restful_api/","title":"RESTful API decorators (detailed)","text":"<p>This page documents the HTTP method decorators used in Cullinan controllers: <code>get_api</code>, <code>post_api</code>, <code>patch_api</code>, <code>delete_api</code> and <code>put_api</code>.</p> <p>Summary - All decorators are defined as <code>def get_api(**kwargs)</code> (and similarly for others) and therefore accept only keyword arguments. Using a positional argument like <code>@get_api('/user')</code> is invalid and will raise a TypeError on import. Always use <code>@get_api(url='/users/{user_id}')</code>. - URL templates use <code>{name}</code> placeholders parsed by <code>url_resolver</code>. Those placeholders are mapped to controller method arguments (order-based).</p> <p>Supported keyword arguments (common) - url: string route template, e.g. <code>'/users/{user_id}'</code>. - query_params: iterable of query param names (mapped to <code>request_resolver</code>'s query section). - file_params: iterable of file field names for uploads. - headers: iterable of required HTTP header names; missing headers trigger the project's missing-header handler.</p> <p>POST/PATCH specific - body_params: iterable of body field names to parse from JSON or form body. - get_request_body: boolean; if True, the raw request body will be passed to the handler via <code>request_handler</code>.</p> <p>How URL templates work - Use <code>{param}</code> placeholders. Example: <code>'/users/{user_id}/posts/{post_id}'</code>. - <code>url_resolver</code> translates the template into a regex-like path and returns a list of parameter names in order (e.g. <code>['user_id','post_id']</code>). - The decorated method receives path parameter values as positional args in the same order as the list returned by <code>url_resolver</code> (or combined with controller-level url param keys). - Allowed characters for path captures are limited by the resolver (e.g. <code>[a-zA-Z0-9-]+</code>) and a trailing <code>/*</code> to allow an optional slash.</p> <p>Decorator behavior and request handling - Each decorator wraps the original function and registers a Tornado handler method via <code>EncapsulationHandler.add_func(url=local_url, type='get')</code> (or type='post', etc.). - At request time the framework calls <code>request_resolver</code> and <code>header_resolver</code> to build (url_dict, query_dict, body_dict, file_dict) and passes them, together with header data, into <code>request_handler</code> which invokes your controller method. - <code>get_api</code>/<code>delete_api</code>/<code>put_api</code> typically do not use <code>body_params</code>; <code>post_api</code> and <code>patch_api</code> support <code>body_params</code> and <code>get_request_body</code>.</p> <p>Examples</p> <p>1) Simple GET with path param</p> <pre><code>@controller(url='/api/users')\nclass UserController:\n    @get_api(url='/{user_id}')\n    def get_user(self, url_param):\n        # extract the path parameter from the url_param dict\n        user_id = url_param.get('user_id') if url_param else None\n        return {'id': user_id}\n</code></pre> <p>2) GET with query params</p> <pre><code>@controller(url='/api/users')\nclass UserController:\n    @get_api(url='/', query_params=('page','size'))\n    def list_users(self, query_param):\n        # page and size come from query string and are accessed via query_param\n        page = query_param.get('page') if query_param else None\n        size = query_param.get('size') if query_param else None\n        return {'page': page, 'size': size}\n</code></pre> <p>3) POST with body params and files</p> <pre><code>@controller(url='/api/upload')\nclass UploadController:\n    @post_api(url='/', body_params=('title',), file_params=('file',))\n    def upload(self, body_param, files):\n        title = body_param.get('title') if body_param else None\n        file_obj = files.get('file') if files else None\n        return {'uploaded': bool(file_obj)}\n</code></pre> <p>Errors and common pitfalls - Using positional decorator args: <code>@get_api('/user')</code> is invalid. Use <code>@get_api(url='/user')</code>. - Mismatched path names: if your URL template includes <code>{user_id}</code> but your method signature lacks the corresponding parameter, the framework will pass None or may behave unexpectedly \u2014 ensure names match and argument order aligns. - Missing required headers: if <code>headers</code> is provided and request omits them, the configured missing-header handler will be invoked (it may raise or set an error response). - Body parsing: <code>body_params</code> attempts to parse JSON when Content-Type starts with <code>application/json</code>; if parsing fails, fields will be None.</p> <p>When to use which decorator - Use <code>get_api</code> for idempotent read operations. - Use <code>post_api</code> for create operations where you need to parse body fields or accept file uploads. - Use <code>patch_api</code> for partial updates and <code>put_api</code> for full replacements; behavior mirrors POST w.r.t. body_params when provided.</p> <p>Linking to source - Implementation lives in <code>cullinan/controller/core.py</code> (<code>get_api</code>, <code>post_api</code>, <code>url_resolver</code>, <code>request_resolver</code>, and <code>request_handler</code>). Prefer reading the tests in <code>tests/</code> (search for <code>@get_api(url=</code>) for practical examples.</p> <p>See also - <code>docs/getting_started.md</code> (quick overview) - <code>docs/wiki/injection.md</code> (dependency injection patterns)</p>"},{"location":"zh/","title":"Cullinan \u6587\u6863","text":"<p>\u6b22\u8fce\u67e5\u9605 Cullinan \u6846\u67b6\u6587\u6863\u3002</p> <p>\u7248\u672c 0.90\uff1aIoC/DI \u67b6\u6784\u5df2\u91cd\u65b0\u8bbe\u8ba1\u3002\u8bf7\u53c2\u9605 \u4f9d\u8d56\u6ce8\u5165\u6307\u5357 \u548c \u8fc1\u79fb\u6307\u5357.</p> <p>\u8bf7\u4f7f\u7528\u5de6\u4fa7\u5bfc\u822a\u680f\u5feb\u901f\u8bbf\u95ee\u4ee5\u4e0b\u4e3b\u8981\u5185\u5bb9\uff1a</p> <ul> <li>\u5feb\u901f\u5f00\u59cb \u2014 \u5feb\u901f\u5165\u95e8\u548c\u6700\u5c0f\u5e94\u7528\u793a\u4f8b</li> <li>\u67b6\u6784\u8bbe\u8ba1 \u2014 \u7cfb\u7edf\u6982\u89c8\u548c\u67b6\u6784\u56fe</li> <li>\u7ef4\u57fa \u2014 \u6ce8\u5165\u3001\u751f\u547d\u5468\u671f\u3001\u4e2d\u95f4\u4ef6\u3001\u6269\u5c55</li> <li>\u4f9d\u8d56\u6ce8\u5165\u6307\u5357 \u2014 DI \u7cfb\u7edf\u6587\u6863</li> <li>\u8fc1\u79fb\u6307\u5357 \u2014 \u4ece 0.83 \u5347\u7ea7</li> <li>\u6a21\u5757 \u2014 \u5404\u6a21\u5757\u7684 API \u548c\u793a\u4f8b</li> <li>\u793a\u4f8b \u2014 <code>examples/</code> \u76ee\u5f55\u4e0b\u7684\u53ef\u8fd0\u884c\u793a\u4f8b</li> <li>API \u53c2\u8003 \u2014 \u8be6\u7ec6\u7684 API \u6587\u6863</li> </ul> <p>\u4e86\u89e3\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u8bbf\u95ee\u6211\u4eec\u7684 GitHub \u4ed3\u5e93\u3002</p>"},{"location":"zh/api_reference/","title":"API \u53c2\u8003","text":"<p>\u8bf4\u660e\uff08v0.90\uff09\uff1a\u6838\u5fc3\u6a21\u5757\u5df2\u91cd\u65b0\u7ec4\u7ec7\u3002\u65b0\u7684 API \u7ed3\u6784\u8bf7\u53c2\u9605 \u4f9d\u8d56\u6ce8\u5165\u6307\u5357 \u548c \u5bfc\u5165\u8fc1\u79fb\u6307\u5357\u3002</p> <p>\u672c\u6587\u6863\u7528\u4e8e\u6c47\u603b Cullinan \u7684\u516c\u5171 API \u6982\u89c8\uff0c\u5e76\u4e3a\u540e\u7eed\u81ea\u52a8\u751f\u6210\u6216\u624b\u52a8\u7ef4\u62a4\u7684 API \u9875\u9762\u63d0\u4f9b\u5165\u53e3\u3002\u63a8\u8350\u7684\u7ed3\u6784\u5305\u62ec\uff1a\u6a21\u5757\u7d22\u5f15\u3001\u6bcf\u4e2a\u6a21\u5757\u7684\u516c\u6709\u7b26\u53f7\u4e0e\u7b7e\u540d\u3001\u4ee5\u53ca\u91cd\u65b0\u751f\u6210 API \u6587\u6863\u7684\u6b65\u9aa4\u8bf4\u660e\u3002</p>"},{"location":"zh/api_reference/#_1","title":"\u6a21\u5757\u7d22\u5f15\uff08\u793a\u4f8b\uff09","text":"<p>\u4ee5\u4e0b\u6a21\u5757\u5217\u8868\u4ec5\u4e3a\u793a\u4f8b\uff0c\u5177\u4f53\u5185\u5bb9\u5e94\u6839\u636e\u5b9e\u9645\u4ee3\u7801\u7ed3\u6784\u548c\u81ea\u52a8\u5316\u751f\u6210\u7ed3\u679c\u8865\u5168\uff1a</p> <ul> <li><code>cullinan.app</code> \u2014 \u5e94\u7528\u521b\u5efa\u4e0e\u8fd0\u884c\u5165\u53e3</li> <li><code>cullinan.application</code> \u2014 \u5e94\u7528\u751f\u547d\u5468\u671f\u4e0e\u542f\u52a8\u6d41\u7a0b</li> <li><code>cullinan.core</code> \u2014 IoC/DI \u6838\u5fc3\uff08Provider\u3001Registry\u3001Scope\u3001\u6ce8\u5165 API\uff09</li> <li><code>cullinan.controller</code> \u2014 \u63a7\u5236\u5668\u4e0e RESTful API \u88c5\u9970\u5668</li> <li><code>cullinan.service</code> \u2014 Service \u57fa\u7c7b\u4e0e <code>@service</code> \u88c5\u9970\u5668</li> <li><code>cullinan.middleware</code> \u2014 \u4e2d\u95f4\u4ef6\u57fa\u7c7b\u4e0e\u6269\u5c55\u70b9</li> </ul>"},{"location":"zh/api_reference/#_2","title":"\u516c\u5171\u7b26\u53f7\u4e0e\u7b7e\u540d\uff08\u5efa\u8bae\u7ed3\u6784\uff09","text":"<p>\u6bcf\u4e2a\u6a21\u5757\u5efa\u8bae\u6309\u4ee5\u4e0b\u7ed3\u6784\u5217\u51fa\u516c\u5171\u7b26\u53f7\uff1a</p> <ul> <li>\u6a21\u5757\u8def\u5f84\uff0c\u4f8b\u5982\uff1a<code>cullinan.controller</code></li> <li>\u7b80\u8981\u8bf4\u660e\uff1a\u6a21\u5757\u7684\u4e3b\u8981\u804c\u8d23\u4e0e\u4f7f\u7528\u573a\u666f</li> <li>\u516c\u6709\u7c7b\u4e0e\u51fd\u6570\u5217\u8868\uff08\u793a\u4f8b\uff09\uff1a</li> <li><code>@controller(...)</code> \u2014 \u63a7\u5236\u5668\u88c5\u9970\u5668\uff0c\u8d1f\u8d23\u81ea\u52a8\u6ce8\u518c\u63a7\u5236\u5668\u4e0e\u8def\u7531</li> <li><code>@get_api(url=..., query_params=..., body_params=..., headers=...)</code> \u2014 GET \u63a5\u53e3\u88c5\u9970\u5668</li> <li><code>@post_api(url=..., body_params=..., headers=...)</code> \u2014 POST \u63a5\u53e3\u88c5\u9970\u5668</li> <li><code>Inject</code>, <code>InjectByName</code> \u2014 \u5c5e\u6027/\u6784\u9020\u5668\u6ce8\u5165\u6807\u8bb0</li> </ul> <p>\u5b8c\u6574 API \u53c2\u8003\u53ef\u4ee5\u901a\u8fc7\u81ea\u52a8\u751f\u6210\u811a\u672c\u6216\u624b\u5de5\u6574\u7406\u7684\u65b9\u5f0f\u586b\u5145\u4e0a\u8ff0\u7ed3\u6784\u3002</p>"},{"location":"zh/api_reference/#api_1","title":"\u91cd\u65b0\u751f\u6210 API \u6587\u6863\uff08\u6b65\u9aa4\u793a\u4f8b\uff09","text":"<p>\u5728\u540e\u7eed\u5b9e\u73b0\u81ea\u52a8\u5316\u65f6\uff0c\u53ef\u4ee5\u9009\u62e9\u4f7f\u7528\u9759\u6001\u5206\u6790\u811a\u672c\u751f\u6210 API \u7d22\u5f15\u5e76\u66f4\u65b0\u672c\u9875\u9762\u3002\u5178\u578b\u6d41\u7a0b\u793a\u4f8b\uff1a</p> <ol> <li>\u5728 <code>docs/work/</code> \u76ee\u5f55\u4e0b\u7ef4\u62a4\u4e00\u4e2a\u7528\u4e8e\u626b\u63cf\u6a21\u5757\u5e76\u751f\u6210 Markdown \u7247\u6bb5\u7684\u811a\u672c\uff08\u4f8b\u5982 <code>generate_api_reference.py</code>\uff09\u3002</li> <li>\u811a\u672c\u8f93\u51fa\u6309\u6a21\u5757\u5212\u5206\u7684 API \u5217\u8868\uff08\u7c7b\u3001\u51fd\u6570\u3001\u7b7e\u540d\u3001\u7b80\u8981\u8bf4\u660e\uff09\uff0c\u5199\u5165 <code>docs/work/api_modules.md</code> \u6216\u76f4\u63a5\u66f4\u65b0\u672c\u9875\u9762\u3002</li> <li>\u5728 CI \u6216\u672c\u5730\u6784\u5efa\u6d41\u7a0b\u4e2d\u5b9a\u671f\u8fd0\u884c\u8be5\u811a\u672c\uff0c\u4fdd\u8bc1 API \u53c2\u8003\u4e0e\u6e90\u7801\u4fdd\u6301\u540c\u6b65\u3002</li> </ol> <p>\u5177\u4f53\u5b9e\u73b0\u7ec6\u8282\u53ef\u6839\u636e\u9879\u76ee\u7ea6\u5b9a\u548c\u5de5\u5177\u94fe\u9009\u62e9\u8fdb\u884c\u8865\u5145\u3002</p>"},{"location":"zh/architecture/","title":"Cullinan \u6846\u67b6\u67b6\u6784\u6587\u6863\uff08\u66f4\u65b0\u7248\uff09","text":"<p>\u7248\u672c\uff1av0.90 \u6700\u540e\u66f4\u65b0\uff1a2025-12-25 \u4f5c\u8005\uff1aPlumeink \u72b6\u6001\uff1a\u5df2\u66f4\u65b0</p>"},{"location":"zh/architecture/#_1","title":"\u76ee\u5f55","text":"<ol> <li>\u67b6\u6784\u6982\u89c8</li> <li>\u6838\u5fc3\u7ec4\u4ef6</li> <li>IoC/DI 2.0 \u7cfb\u7edf</li> <li>\u6269\u5c55\u673a\u5236</li> <li>\u542f\u52a8\u6d41\u7a0b</li> <li>\u8bf7\u6c42\u5904\u7406\u6d41\u7a0b</li> <li>\u6a21\u5757\u626b\u63cf\u673a\u5236</li> <li>\u6027\u80fd\u4f18\u5316</li> <li>\u4ece 0.83 \u8fc1\u79fb</li> </ol>"},{"location":"zh/architecture/#overview","title":"\u67b6\u6784\u6982\u89c8","text":"<p>Cullinan \u662f\u4e00\u4e2a\u57fa\u4e8e Tornado \u7684 Web \u6846\u67b6\uff0c\u91c7\u7528 IoC/DI\uff08\u63a7\u5236\u53cd\u8f6c/\u4f9d\u8d56\u6ce8\u5165\uff09\u8bbe\u8ba1\u6a21\u5f0f\uff0c\u63d0\u4f9b\u88c5\u9970\u5668\u9a71\u52a8\u7684\u5f00\u53d1\u4f53\u9a8c\u3002</p>"},{"location":"zh/architecture/#_2","title":"\u6838\u5fc3\u8bbe\u8ba1\u7406\u5ff5","text":"<ul> <li>\u975e\u4fb5\u5165\u5f0f\uff1a\u901a\u8fc7\u88c5\u9970\u5668\u548c\u6ce8\u89e3\u5b9e\u73b0\u529f\u80fd\uff0c\u65e0\u9700\u7ee7\u627f\u590d\u6742\u57fa\u7c7b</li> <li>\u4f9d\u8d56\u6ce8\u5165\uff1a\u81ea\u52a8\u7ba1\u7406\u7ec4\u4ef6\u4f9d\u8d56\u5173\u7cfb</li> <li>\u6269\u5c55\u53cb\u597d\uff1a\u7edf\u4e00\u7684\u6269\u5c55\u70b9\u6ce8\u518c\u548c\u53d1\u73b0\u673a\u5236</li> <li>\u9ad8\u6027\u80fd\uff1a\u4f18\u5316\u7684\u542f\u52a8\u548c\u8fd0\u884c\u65f6\u6027\u80fd</li> </ul>"},{"location":"zh/architecture/#_3","title":"\u67b6\u6784\u5206\u5c42","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              \u5e94\u7528\u5c42 (Application Layer)               \u2502\n\u2502  - \u4e1a\u52a1\u903b\u8f91 (Controllers)                             \u2502\n\u2502  - \u670d\u52a1\u5c42 (Services)                                  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                  \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              \u6846\u67b6\u5c42 (Framework Layer)                 \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                     \u2502\n\u2502  \u2502    \u6269\u5c55\u673a\u5236                  \u2502                     \u2502\n\u2502  \u2502  - Middleware               \u2502                     \u2502\n\u2502  \u2502  - Extension Points         \u2502                     \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                     \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                     \u2502\n\u2502  \u2502    IoC/DI 2.0 \u5bb9\u5668           \u2502                     \u2502\n\u2502  \u2502  - ApplicationContext       \u2502                     \u2502\n\u2502  \u2502  - Definition + Factory     \u2502                     \u2502\n\u2502  \u2502  - ScopeManager             \u2502                     \u2502\n\u2502  \u2502  - \u7ed3\u6784\u5316\u8bca\u65ad               \u2502                     \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                     \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                     \u2502\n\u2502  \u2502    \u6838\u5fc3\u57fa\u7840                  \u2502                     \u2502\n\u2502  \u2502  - Lifecycle Management     \u2502                     \u2502\n\u2502  \u2502  - Request Context          \u2502                     \u2502\n\u2502  \u2502  - Module Scanner           \u2502                     \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                  \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502            Web \u670d\u52a1\u5668\u5c42 (Tornado)                     \u2502\n\u2502  - IOLoop                                            \u2502\n\u2502  - HTTP Server                                       \u2502\n\u2502  - Request Handler                                   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"zh/architecture/#core-components","title":"\u6838\u5fc3\u7ec4\u4ef6","text":""},{"location":"zh/architecture/#1-core-cullinancore","title":"1. Core \u6a21\u5757 (<code>cullinan/core/</code>)","text":"<p>\u63d0\u4f9b\u6846\u67b6\u7684\u57fa\u7840\u8bbe\u65bd\u3002</p> <p>\u4e3b\u8981\u7ec4\u4ef6\uff1a</p>"},{"location":"zh/architecture/#11-iocdi-20","title":"1.1 IoC/DI 2.0 \u5bb9\u5668","text":"<pre><code>ApplicationContext (\u5355\u4e00\u5165\u53e3)\n    \u251c\u2500\u2500 Definition Registry (\u4e0d\u53ef\u53d8\u5b9a\u4e49)\n    \u251c\u2500\u2500 Factory (\u5b9e\u4f8b\u521b\u5efa)\n    \u2514\u2500\u2500 ScopeManager (\u4f5c\u7528\u57df\u7ba1\u7406)\n        \u251c\u2500\u2500 SingletonScope\n        \u251c\u2500\u2500 PrototypeScope\n        \u2514\u2500\u2500 RequestScope\n</code></pre> <p>\u6838\u5fc3\u7ec4\u4ef6 (v0.90)\uff1a - ApplicationContext\uff1a\u6240\u6709\u5bb9\u5668\u64cd\u4f5c\u7684\u5355\u4e00\u5165\u53e3   - <code>register(Definition)</code> - \u6ce8\u518c\u4f9d\u8d56\u5b9a\u4e49   - <code>get(name)</code> / <code>try_get(name)</code> - \u89e3\u6790\u4f9d\u8d56   - <code>refresh()</code> - \u51bb\u7ed3\u6ce8\u518c\u8868\uff0c\u521d\u59cb\u5316 eager bean   - <code>shutdown()</code> - \u6e05\u7406\u8d44\u6e90</p> <ul> <li>Definition\uff1a\u4e0d\u53ef\u53d8\u7684\u4f9d\u8d56\u5b9a\u4e49</li> <li><code>name</code> - \u5168\u5c40\u552f\u4e00\u6807\u8bc6</li> <li><code>factory</code> - \u5b9e\u4f8b\u521b\u5efa\u51fd\u6570</li> <li><code>scope</code> - ScopeType\uff08SINGLETON/PROTOTYPE/REQUEST\uff09</li> <li> <p><code>source</code> - \u6765\u6e90\u63cf\u8ff0\uff08\u7528\u4e8e\u8bca\u65ad\uff09</p> </li> <li> <p>Factory\uff1a\u7edf\u4e00\u5b9e\u4f8b\u521b\u5efa</p> </li> <li>\u901a\u8fc7 Definition.factory \u521b\u5efa\u5b9e\u4f8b</li> <li> <p>\u59d4\u6258 ScopeManager \u8fdb\u884c\u7f13\u5b58</p> </li> <li> <p>ScopeManager\uff1a\u7edf\u4e00\u4f5c\u7528\u57df\u7ba1\u7406</p> </li> <li><code>SINGLETON</code> - \u5e94\u7528\u7ea7\u5355\u4f8b\uff08\u7ebf\u7a0b\u5b89\u5168\uff09</li> <li><code>PROTOTYPE</code> - \u6bcf\u6b21\u89e3\u6790\u521b\u5efa\u65b0\u5b9e\u4f8b</li> <li><code>REQUEST</code> - \u8bf7\u6c42\u4f5c\u7528\u57df\u5b9e\u4f8b</li> </ul> <p>\u65b0\u76ee\u5f55\u7ed3\u6784 (v0.90)\uff1a <pre><code>cullinan/core/\n\u251c\u2500\u2500 container/      # IoC/DI 2.0 API\n\u2502   \u251c\u2500\u2500 context.py\n\u2502   \u251c\u2500\u2500 definitions.py\n\u2502   \u251c\u2500\u2500 factory.py\n\u2502   \u2514\u2500\u2500 scope.py\n\u251c\u2500\u2500 diagnostics/    # \u5f02\u5e38 + \u6e32\u67d3\n\u251c\u2500\u2500 lifecycle/      # \u751f\u547d\u5468\u671f\u7ba1\u7406\n\u251c\u2500\u2500 request/        # \u8bf7\u6c42\u4e0a\u4e0b\u6587\n\u2514\u2500\u2500 legacy/         # \u5df2\u5f03\u7528\u7684 1.x \u7ec4\u4ef6\n</code></pre>   - \u5faa\u73af\u4f9d\u8d56\u68c0\u6d4b</p> <ul> <li>ProviderRegistry\uff1aProvider \u7ba1\u7406</li> <li>\u7ba1\u7406\u4e0d\u540c\u7c7b\u578b\u7684 Provider\uff08Instance\u3001Class\u3001Factory\u3001Scoped\uff09</li> <li> <p>\u652f\u6301\u5355\u4f8b\u548c\u77ac\u65f6\u6a21\u5f0f</p> </li> <li> <p>ServiceRegistry\uff1aService \u751f\u547d\u5468\u671f\u7ba1\u7406</p> </li> <li>\u6ce8\u518c\u548c\u521d\u59cb\u5316 <code>@service</code> \u88c5\u9970\u7684\u7c7b</li> <li>\u7ba1\u7406 Service \u751f\u547d\u5468\u671f\u94a9\u5b50</li> <li>\u4f9d\u8d56\u987a\u5e8f\u521d\u59cb\u5316</li> </ul>"},{"location":"zh/architecture/#12","title":"1.2 \u751f\u547d\u5468\u671f\u7ba1\u7406","text":"<pre><code>class LifecycleManager:\n    - initialize()    # \u521d\u59cb\u5316\u9636\u6bb5\n    - startup()       # \u542f\u52a8\u9636\u6bb5\n    - shutdown()      # \u5173\u95ed\u9636\u6bb5\n</code></pre> <p>\u751f\u547d\u5468\u671f\u94a9\u5b50\uff1a - <code>on_init()</code> - Service \u5b9e\u4f8b\u5316\u540e\u6267\u884c - <code>on_startup()</code> - \u6240\u6709 Service \u5c31\u7eea\u540e\u6267\u884c - <code>on_shutdown()</code> - \u5e94\u7528\u5173\u95ed\u65f6\u6267\u884c</p>"},{"location":"zh/architecture/#13","title":"1.3 \u8bf7\u6c42\u4e0a\u4e0b\u6587","text":"<pre><code>class RequestContext:\n    - request_id: str\n    - start_time: float\n    - _metadata: Dict (\u5ef6\u8fdf\u521d\u59cb\u5316)\n    - _cleanup_callbacks: List (\u5ef6\u8fdf\u521d\u59cb\u5316)\n</code></pre> <p>\u4f18\u5316\uff08v0.81+\uff09\uff1a - \u5ef6\u8fdf\u521d\u59cb\u5316\uff1a\u8282\u7701 20-55% \u5185\u5b58 - \u6027\u80fd\uff1a\u521d\u59cb\u5316\u4ece 500ns \u2192 350ns</p>"},{"location":"zh/architecture/#14-scope","title":"1.4 Scope \u7cfb\u7edf","text":"<ul> <li>SingletonScope\uff1a\u5355\u4f8b\u4f5c\u7528\u57df</li> <li>TransientScope\uff1a\u77ac\u65f6\u4f5c\u7528\u57df\uff08\u6bcf\u6b21\u65b0\u5efa\uff09</li> <li>RequestScope\uff1a\u8bf7\u6c42\u4f5c\u7528\u57df</li> <li>\u81ea\u5b9a\u4e49 Scope\uff1a\u652f\u6301\u7528\u6237\u6269\u5c55\uff08\u5982 SessionScope\uff09</li> </ul>"},{"location":"zh/architecture/#2-service-cullinanservice","title":"2. Service \u5c42 (<code>cullinan/service/</code>)","text":"<p>\u7ba1\u7406\u5e94\u7528\u7684\u4e1a\u52a1\u670d\u52a1\u3002</p> <p>\u4f7f\u7528\u65b9\u5f0f\uff1a <pre><code>from cullinan.service import service, Service\nfrom cullinan.core import Inject\n\n@service\nclass UserService(Service):\n    email_service: 'EmailService' = Inject()\n\n    def on_init(self):\n        # \u521d\u59cb\u5316\u8d44\u6e90\n        self.db = connect_database()\n\n    def on_shutdown(self):\n        # \u6e05\u7406\u8d44\u6e90\n        self.db.close()\n</code></pre></p> <p>\u7279\u6027\uff1a - \u5355\u4f8b\u6a21\u5f0f\uff08\u5e94\u7528\u7ea7\uff09 - \u81ea\u52a8\u4f9d\u8d56\u6ce8\u5165 - \u751f\u547d\u5468\u671f\u7ba1\u7406 - \u542f\u52a8\u9519\u8bef\u7b56\u7565\uff08strict/warn/ignore\uff09</p>"},{"location":"zh/architecture/#3-controller-cullinancontroller","title":"3. Controller \u5c42 (<code>cullinan/controller/</code>)","text":"<p>\u5904\u7406 HTTP \u8bf7\u6c42\u3002</p> <p>\u4f7f\u7528\u65b9\u5f0f\uff1a <pre><code>from cullinan.controller import controller, get_api\nfrom cullinan.core import Inject\n\n@controller('/api/users')\nclass UserController:\n    user_service: 'UserService' = Inject()\n\n    @get_api('/&lt;user_id&gt;')\n    def get_user(self, user_id: int):\n        return self.user_service.get_user(user_id)\n</code></pre></p> <p>\u7279\u6027\uff1a - RESTful \u8def\u7531\u6620\u5c04 - \u81ea\u52a8\u4f9d\u8d56\u6ce8\u5165 - \u8bf7\u6c42\u7ea7\u5b9e\u4f8b\uff08\u6bcf\u4e2a\u8bf7\u6c42\u65b0\u5efa\uff09 - \u53c2\u6570\u81ea\u52a8\u89e3\u6790\u548c\u9a8c\u8bc1</p>"},{"location":"zh/architecture/#4","title":"4. \u6269\u5c55\u673a\u5236","text":""},{"location":"zh/architecture/#41","title":"4.1 \u4e2d\u95f4\u4ef6\u7cfb\u7edf","text":"<pre><code>from cullinan.middleware import middleware, Middleware\n\n@middleware(priority=100)\nclass LoggingMiddleware(Middleware):\n    def process_request(self, handler):\n        logger.info(f\"Request: {handler.request.uri}\")\n        return handler\n\n    def process_response(self, handler, response):\n        logger.info(f\"Response: {response}\")\n        return response\n</code></pre> <p>\u7279\u6027\uff1a - \u88c5\u9970\u5668\u9a71\u52a8\u6ce8\u518c - \u4f18\u5148\u7ea7\u63a7\u5236\uff08\u6570\u5b57\u8d8a\u5c0f\u8d8a\u5148\u6267\u884c\uff09 - \u8bf7\u6c42/\u54cd\u5e94\u53cc\u5411\u62e6\u622a - \u652f\u6301\u77ed\u8def\uff08\u8fd4\u56de None \u505c\u6b62\u540e\u7eed\u5904\u7406\uff09</p>"},{"location":"zh/architecture/#42","title":"4.2 \u6269\u5c55\u70b9\u53d1\u73b0","text":"<pre><code>from cullinan.extensions import list_extension_points\n\n# \u67e5\u8be2\u53ef\u7528\u6269\u5c55\u70b9\npoints = list_extension_points(category='middleware')\nfor point in points:\n    print(f\"{point['name']}: {point['description']}\")\n</code></pre> <p>6 \u5927\u7c7b\u6269\u5c55\u70b9\uff1a 1. Middleware - \u8bf7\u6c42/\u54cd\u5e94\u62e6\u622a 2. Lifecycle - \u751f\u547d\u5468\u671f\u94a9\u5b50 3. Injection - \u4f9d\u8d56\u6ce8\u5165\u6269\u5c55 4. Routing - \u8def\u7531\u5904\u7406 5. Configuration - \u914d\u7f6e\u7ba1\u7406 6. Handler - \u8bf7\u6c42\u5904\u7406\u5668</p>"},{"location":"zh/architecture/#iocdi-20","title":"IoC/DI 2.0 \u7cfb\u7edf","text":""},{"location":"zh/architecture/#v090","title":"\u65b0\u67b6\u6784 (v0.90)","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   ApplicationContext (\u5355\u4e00\u5165\u53e3)      \u2502\n\u2502  - register(Definition)             \u2502\n\u2502  - get(name) / try_get(name)        \u2502\n\u2502  - refresh() / shutdown()           \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                \u2502\n      \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n      \u25bc         \u25bc         \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502Definition\u2502 \u2502 Factory \u2502 \u2502ScopeManager\u2502\n\u2502 Registry \u2502 \u2502         \u2502 \u2502            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"zh/architecture/#_4","title":"\u5173\u952e\u6539\u8fdb","text":"\u7279\u6027 0.83 (Legacy) 0.90 (2.0) \u5165\u53e3\u70b9 \u591a\u4e2a (IoCFacade, Registries) \u5355\u4e00 (ApplicationContext) \u5b9a\u4e49 \u53ef\u53d8 \u4e0d\u53ef\u53d8\uff08\u51bb\u7ed3\uff09 \u6ce8\u518c\u8868 \u8fd0\u884c\u65f6\u53ef\u4fee\u6539 refresh() \u540e\u51bb\u7ed3 \u4f5c\u7528\u57df \u9690\u5f0f \u663e\u5f0f ScopeType \u679a\u4e3e \u8bca\u65ad \u5b57\u7b26\u4e32\u9519\u8bef \u7ed3\u6784\u5316\u5f02\u5e38"},{"location":"zh/architecture/#_5","title":"\u4f7f\u7528\u65b9\u5f0f","text":""},{"location":"zh/architecture/#1","title":"\u65b9\u5f0f 1\uff1a\u57fa\u4e8e\u88c5\u9970\u5668\u7684\u81ea\u52a8\u6ce8\u5165\uff08\u63a8\u8350\uff09","text":"<pre><code>from cullinan.service import service, Service\nfrom cullinan.core import Inject\n\n@service\nclass UserService(Service):\n    email_service: EmailService = Inject()  # \u81ea\u52a8\u6ce8\u5165\n\n    def on_init(self):\n        # \u521d\u59cb\u5316\u903b\u8f91\n        pass\n\n    def on_startup(self):\n        # \u670d\u52a1\u542f\u52a8\u65f6\u6267\u884c\n        pass\n</code></pre> <p>\u7279\u6027\uff1a - \u88c5\u9970\u5668\u5185\u90e8\u4f7f\u7528\u65b0\u7248 IoC/DI 2.0 \u6ce8\u518c\u903b\u8f91 - \u81ea\u52a8\u7ba1\u7406\u4f9d\u8d56\u89e3\u6790\u548c\u751f\u547d\u5468\u671f - \u652f\u6301 <code>Inject()</code> \u5c5e\u6027\u6ce8\u5165</p>"},{"location":"zh/architecture/#2-definition","title":"\u65b9\u5f0f 2\uff1a\u57fa\u4e8e Definition \u7684\u6ce8\u518c\uff08\u9ad8\u7ea7\u7528\u6cd5\uff09","text":"<pre><code>from cullinan.core.container import ApplicationContext, Definition, ScopeType\n\nctx = ApplicationContext()\n\n# \u4f7f\u7528\u663e\u5f0f\u5b9a\u4e49\u6ce8\u518c\uff08\u9002\u7528\u4e8e\u590d\u6742\u573a\u666f\u6216\u7b2c\u4e09\u65b9\u5e93\u96c6\u6210\uff09\nctx.register(Definition(\n    name='UserService',\n    factory=lambda c: UserService(c.get('UserRepository')),\n    scope=ScopeType.SINGLETON,\n    source='service:UserService'\n))\n\nctx.refresh()  # \u51bb\u7ed3\u6ce8\u518c\u8868\nuser_service = ctx.get('UserService')\n</code></pre> <p>\u9002\u7528\u573a\u666f\uff1a - \u9700\u8981\u81ea\u5b9a\u4e49\u5b9e\u4f8b\u521b\u5efa\u903b\u8f91 - \u96c6\u6210\u7b2c\u4e09\u65b9\u5e93\u7ec4\u4ef6 - \u9700\u8981\u52a8\u6001\u6ce8\u518c\u4f9d\u8d56</p>"},{"location":"zh/architecture/#extensions","title":"\u6269\u5c55\u673a\u5236","text":""},{"location":"zh/architecture/#_6","title":"\u4e2d\u95f4\u4ef6\u6267\u884c\u6d41\u7a0b","text":"<pre><code>\u5ba2\u6237\u7aef\u8bf7\u6c42\n  \u2193\nCorsMiddleware (priority=10)      \u2192 process_request\n  \u2193\nAuthMiddleware (priority=50)      \u2192 process_request\n  \u2193\nLoggingMiddleware (priority=100)  \u2192 process_request\n  \u2193\nHandler \u5904\u7406\n  \u2193\nLoggingMiddleware (priority=100)  \u2192 process_response\n  \u2193\nAuthMiddleware (priority=50)      \u2192 process_response\n  \u2193\nCorsMiddleware (priority=10)      \u2192 process_response\n  \u2193\n\u5ba2\u6237\u7aef\u54cd\u5e94\n</code></pre> <p>\u4f18\u5148\u7ea7\u89c4\u8303\uff1a - <code>0-50</code>\uff1a\u5173\u952e\u4e2d\u95f4\u4ef6\uff08CORS\u3001\u5b89\u5168\uff09 - <code>51-100</code>\uff1a\u6807\u51c6\u4e2d\u95f4\u4ef6\uff08\u65e5\u5fd7\u3001\u6307\u6807\uff09 - <code>101-200</code>\uff1a\u5e94\u7528\u7279\u5b9a\u4e2d\u95f4\u4ef6</p>"},{"location":"zh/architecture/#startup-flow","title":"\u542f\u52a8\u6d41\u7a0b","text":""},{"location":"zh/architecture/#_7","title":"\u542f\u52a8\u5e8f\u5217\u56fe","text":"<pre><code>1. configure(...)\n   \u2514\u2500\u2500 \u52a0\u8f7d\u914d\u7f6e\n\n2. \u6a21\u5757\u626b\u63cf\n   \u251c\u2500\u2500 \u81ea\u52a8\u626b\u63cf\u6a21\u5f0f\n   \u2502   \u251c\u2500\u2500 \u68c0\u6d4b\u6253\u5305\u73af\u5883\uff08development/nuitka/pyinstaller\uff09\n   \u2502   \u251c\u2500\u2500 \u626b\u63cf\u7528\u6237\u5305\uff08user_packages\uff09\n   \u2502   \u2514\u2500\u2500 \u6536\u96c6\u7edf\u8ba1\u4fe1\u606f\uff08\u65b0\u589e v0.81+\uff09\n   \u2502\n   \u2514\u2500\u2500 \u663e\u5f0f\u6ce8\u518c\u6a21\u5f0f\uff08\u65b0\u589e v0.81+\uff09\n       \u2514\u2500\u2500 \u8df3\u8fc7\u626b\u63cf\uff0c\u76f4\u63a5\u4f7f\u7528\u914d\u7f6e\u7684\u7c7b\n\n3. IoC \u5bb9\u5668\u521d\u59cb\u5316\n   \u251c\u2500\u2500 \u521d\u59cb\u5316 IoCFacade\n   \u251c\u2500\u2500 \u6ce8\u518c Provider\n   \u2514\u2500\u2500 \u914d\u7f6e InjectionRegistry\n\n4. Service \u521d\u59cb\u5316\n   \u251c\u2500\u2500 \u6309\u4f9d\u8d56\u987a\u5e8f\u521d\u59cb\u5316\n   \u251c\u2500\u2500 \u8c03\u7528 on_init() \u94a9\u5b50\n   \u251c\u2500\u2500 \u8c03\u7528 on_startup() \u94a9\u5b50\n   \u2514\u2500\u2500 \u9519\u8bef\u5904\u7406\uff08\u6839\u636e startup_error_policy\uff09\n\n5. Controller \u6ce8\u518c\n   \u251c\u2500\u2500 \u6ce8\u518c\u8def\u7531\n   \u2514\u2500\u2500 \u914d\u7f6e Handler\n\n6. \u4e2d\u95f4\u4ef6\u94fe\u6784\u5efa\n   \u251c\u2500\u2500 \u6309\u4f18\u5148\u7ea7\u6392\u5e8f\n   \u251c\u2500\u2500 \u521d\u59cb\u5316\u4e2d\u95f4\u4ef6\uff08on_init\uff09\n   \u2514\u2500\u2500 \u6784\u5efa\u5904\u7406\u94fe\n\n7. \u542f\u52a8 Web \u670d\u52a1\u5668\n   \u251c\u2500\u2500 \u521b\u5efa Tornado Application\n   \u251c\u2500\u2500 \u6ce8\u518c\u4fe1\u53f7\u5904\u7406\u5668\uff08SIGINT/SIGTERM\uff09\n   \u2514\u2500\u2500 \u542f\u52a8 IOLoop\n</code></pre>"},{"location":"zh/architecture/#v081","title":"\u542f\u52a8\u6027\u80fd\uff08v0.81+ \u4f18\u5316\u540e\uff09","text":"\u573a\u666f \u4f18\u5316\u524d \u4f18\u5316\u540e \u63d0\u5347 \u663e\u5f0f\u6ce8\u518c\u6a21\u5f0f 69.56 ms 0.08 ms 902x \u5c0f\u578b\u9879\u76ee\uff0810\u6a21\u5757\uff09 50-100 ms 50-100 ms - \u4e2d\u578b\u9879\u76ee\uff0850\u6a21\u5757\uff09 300-800 ms 150-300 ms 2x"},{"location":"zh/architecture/#request-flow","title":"\u8bf7\u6c42\u5904\u7406\u6d41\u7a0b","text":"<pre><code>1. \u8bf7\u6c42\u5230\u8fbe Tornado\n   \u2514\u2500\u2500 IOLoop \u5206\u53d1\u5230 Handler\n\n2. \u521b\u5efa\u8bf7\u6c42\u4e0a\u4e0b\u6587\n   \u251c\u2500\u2500 RequestContext.create()\n   \u251c\u2500\u2500 \u8bbe\u7f6e request_id\n   \u2514\u2500\u2500 \u521d\u59cb\u5316\u8bf7\u6c42\u7ea7 Scope\n\n3. \u4e2d\u95f4\u4ef6\u5904\u7406\uff08\u8bf7\u6c42\u9636\u6bb5\uff09\n   \u251c\u2500\u2500 \u6309\u4f18\u5148\u7ea7\u6267\u884c process_request()\n   \u251c\u2500\u2500 \u53ef\u80fd\u77ed\u8def\u8fd4\u56de\uff08\u5982\u8ba4\u8bc1\u5931\u8d25\uff09\n   \u2514\u2500\u2500 \u4f20\u9012\u5230\u4e0b\u4e00\u4e2a\u4e2d\u95f4\u4ef6\n\n4. Controller \u5b9e\u4f8b\u5316\n   \u251c\u2500\u2500 \u521b\u5efa Controller \u5b9e\u4f8b\n   \u251c\u2500\u2500 \u6ce8\u5165\u4f9d\u8d56\uff08\u901a\u8fc7 InjectionRegistry\uff09\n   \u2514\u2500\u2500 \u89e3\u6790\u8bf7\u6c42\u53c2\u6570\n\n5. \u6267\u884c\u4e1a\u52a1\u903b\u8f91\n   \u251c\u2500\u2500 \u8c03\u7528 Controller \u65b9\u6cd5\n   \u251c\u2500\u2500 Service \u5c42\u5904\u7406\n   \u2514\u2500\u2500 \u8fd4\u56de\u54cd\u5e94\n\n6. \u4e2d\u95f4\u4ef6\u5904\u7406\uff08\u54cd\u5e94\u9636\u6bb5\uff09\n   \u251c\u2500\u2500 \u9006\u5e8f\u6267\u884c process_response()\n   \u251c\u2500\u2500 \u53ef\u4ee5\u4fee\u6539\u54cd\u5e94\n   \u2514\u2500\u2500 \u6dfb\u52a0\u54cd\u5e94\u5934\n\n7. \u6e05\u7406\u8bf7\u6c42\u4e0a\u4e0b\u6587\n   \u251c\u2500\u2500 \u6267\u884c cleanup callbacks\n   \u251c\u2500\u2500 \u6e05\u9664\u8bf7\u6c42\u7ea7\u4f9d\u8d56\n   \u2514\u2500\u2500 \u9500\u6bc1 RequestContext\n\n8. \u8fd4\u56de\u54cd\u5e94\u7ed9\u5ba2\u6237\u7aef\n</code></pre>"},{"location":"zh/architecture/#module-scanning","title":"\u6a21\u5757\u626b\u63cf\u673a\u5236","text":""},{"location":"zh/architecture/#_8","title":"\u626b\u63cf\u7b56\u7565\uff08\u591a\u73af\u5883\u652f\u6301\uff09","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502      \u68c0\u6d4b\u6253\u5305\u73af\u5883                     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n           \u2502\n     \u250c\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n     \u25bc           \u25bc         \u25bc         \u25bc\nDevelopment  Nuitka   PyInstaller  \u5176\u4ed6\n     \u2502           \u2502         \u2502         \u2502\n     \u25bc           \u25bc         \u25bc         \u25bc\n  \u6807\u51c6\u626b\u63cf   sys.modules  _MEIPASS  Fallback\n</code></pre>"},{"location":"zh/architecture/#v081_1","title":"\u626b\u63cf\u7edf\u8ba1\uff08\u65b0\u589e v0.81+\uff09","text":"<pre><code>from cullinan.scan_stats import get_scan_stats_collector\n\ncollector = get_scan_stats_collector()\nstats = collector.get_aggregate_stats()\n\n# \u8f93\u51fa\uff1a\n# {\n#   'total_scans': 1,\n#   'avg_duration_ms': 66.06,\n#   'total_modules': 35,\n#   'fastest_scan_ms': 66.06,\n#   'slowest_scan_ms': 66.06\n# }\n</code></pre> <p>\u6536\u96c6\u7684\u6307\u6807\uff1a - \u603b\u8017\u65f6\uff08\u5206\u9636\u6bb5\uff09 - \u6a21\u5757\u6570\u91cf\uff08\u53d1\u73b0/\u8fc7\u6ee4/\u7f13\u5b58\uff09 - \u626b\u63cf\u6a21\u5f0f\uff08auto/explicit/cached\uff09 - \u6253\u5305\u73af\u5883\uff08development/nuitka/pyinstaller\uff09 - \u9519\u8bef\u8bb0\u5f55</p>"},{"location":"zh/architecture/#performance","title":"\u6027\u80fd\u4f18\u5316","text":""},{"location":"zh/architecture/#v081_2","title":"\u5df2\u5b9e\u65bd\u7684\u4f18\u5316\uff08v0.81+\uff09","text":"\u4f18\u5316\u9879 \u4f18\u5316\u524d \u4f18\u5316\u540e \u63d0\u5347 \u6a21\u5757\u626b\u63cf\uff08\u663e\u5f0f\uff09 69.56 ms 0.08 ms 902x RequestContext \u521d\u59cb\u5316 500 ns 350 ns 30% RequestContext \u5185\u5b58 536 B 240 B 55% \u4f9d\u8d56\u89e3\u6790\uff08\u7f13\u5b58\uff09 - 0.26 \u03bcs \u6781\u5feb \u65e5\u5fd7\u5f00\u9500\uff08\u751f\u4ea7\uff09 150 ns 100 ns 33%"},{"location":"zh/architecture/#_9","title":"\u4f18\u5316\u7b56\u7565","text":""},{"location":"zh/architecture/#1_1","title":"1. \u663e\u5f0f\u6ce8\u518c\u6a21\u5f0f","text":"<pre><code>from cullinan import configure\n\nconfigure(\n    explicit_services=[DatabaseService, CacheService],\n    explicit_controllers=[UserController, AdminController],\n    auto_scan=False  # \u8df3\u8fc7\u626b\u63cf\n)\n</code></pre> <p>\u6536\u76ca\uff1a\u542f\u52a8\u901f\u5ea6\u63d0\u5347 902 \u500d\uff08\u6d4b\u8bd5\u573a\u666f\uff09</p>"},{"location":"zh/architecture/#2","title":"2. \u5ef6\u8fdf\u521d\u59cb\u5316","text":"<ul> <li>RequestContext \u5b57\u6bb5\u6309\u9700\u521b\u5efa</li> <li>\u964d\u4f4e\u5185\u5b58\u5360\u7528 55%</li> </ul>"},{"location":"zh/architecture/#3","title":"3. \u667a\u80fd\u7f13\u5b58","text":"<ul> <li>\u6a21\u5757\u626b\u63cf\u7ed3\u679c\u7f13\u5b58</li> <li>IoC \u4f9d\u8d56\u89e3\u6790\u7f13\u5b58\uff080.26 \u03bcs\uff09</li> <li>Provider \u5b9e\u4f8b\u7f13\u5b58</li> </ul>"},{"location":"zh/architecture/#4_1","title":"4. \u7ed3\u6784\u5316\u65e5\u5fd7","text":"<ul> <li>\u751f\u4ea7\u73af\u5883\u65e5\u5fd7\u4f18\u5316</li> <li>\u60f0\u6027\u6c42\u503c\u51cf\u5c11\u5f00\u9500</li> </ul>"},{"location":"zh/architecture/#_10","title":"\u914d\u7f6e\u9009\u9879","text":""},{"location":"zh/architecture/#_11","title":"\u6838\u5fc3\u914d\u7f6e","text":"<pre><code>from cullinan import configure\n\nconfigure(\n    # \u57fa\u7840\u914d\u7f6e\n    port=8080,\n    debug=True,\n\n    # \u6027\u80fd\u4f18\u5316\n    explicit_services=[...],      # \u663e\u5f0f\u670d\u52a1\u6ce8\u518c\n    explicit_controllers=[...],   # \u663e\u5f0f\u63a7\u5236\u5668\u6ce8\u518c\n    auto_scan=False,              # \u7981\u7528\u81ea\u52a8\u626b\u63cf\n    user_packages=['myapp'],      # \u9650\u5236\u626b\u63cf\u8303\u56f4\n\n    # \u542f\u52a8\u884c\u4e3a\n    startup_error_policy='strict', # 'strict'/'warn'/'ignore'\n\n    # \u6269\u5c55\u914d\u7f6e\n    middlewares=[...],            # \u81ea\u5b9a\u4e49\u4e2d\u95f4\u4ef6\n    handlers=[...],               # \u81ea\u5b9a\u4e49 Handler\n)\n</code></pre>"},{"location":"zh/architecture/#_12","title":"\u6700\u4f73\u5b9e\u8df5","text":""},{"location":"zh/architecture/#1_2","title":"1. \u4f9d\u8d56\u6ce8\u5165","text":"<p>\u2705 \u63a8\u8350\uff1a\u4f7f\u7528\u7c7b\u578b\u6ce8\u5165 <pre><code>@service\nclass UserService(Service):\n    email_service: EmailService = Inject()\n</code></pre></p> <p>\u274c \u907f\u514d\uff1a\u624b\u52a8\u83b7\u53d6\u4f9d\u8d56 <pre><code># \u4e0d\u63a8\u8350\nregistry = get_service_registry()\nemail_service = registry.get_instance('EmailService')\n</code></pre></p>"},{"location":"zh/architecture/#2_1","title":"2. \u6027\u80fd\u4f18\u5316","text":"<p>\u2705 \u63a8\u8350\uff1a\u4f7f\u7528\u663e\u5f0f\u6ce8\u518c\uff08\u5927\u578b\u9879\u76ee\uff09 <pre><code>configure(\n    explicit_services=[...],\n    explicit_controllers=[...],\n    auto_scan=False\n)\n</code></pre></p> <p>\u2705 \u63a8\u8350\uff1a\u9650\u5236\u626b\u63cf\u8303\u56f4 <pre><code>configure(\n    user_packages=['myapp', 'myapp.extensions'],\n    exclude_packages=['tests', '__pycache__']\n)\n</code></pre></p>"},{"location":"zh/architecture/#3_1","title":"3. \u4e2d\u95f4\u4ef6\u8bbe\u8ba1","text":"<p>\u2705 \u63a8\u8350\uff1a\u5355\u4e00\u804c\u8d23 <pre><code>@middleware(priority=50)\nclass AuthMiddleware(Middleware):  # \u53ea\u5904\u7406\u8ba4\u8bc1\n    pass\n\n@middleware(priority=60)\nclass RoleMiddleware(Middleware):  # \u53ea\u5904\u7406\u6743\u9650\n    pass\n</code></pre></p> <p>\u274c \u907f\u514d\uff1a\u804c\u8d23\u6df7\u6742 <pre><code>@middleware(priority=50)\nclass AuthAndLoggingMiddleware(Middleware):  # \u6df7\u6742\n    pass\n</code></pre></p>"},{"location":"zh/architecture/#_13","title":"\u53c2\u8003\u8d44\u6599","text":"<ul> <li>\u6269\u5c55\u5f00\u53d1\u6307\u5357</li> <li>API \u53c2\u8003\u6587\u6863</li> <li>\u5feb\u901f\u5f00\u59cb</li> <li>\u8fc1\u79fb\u6307\u5357</li> </ul>"},{"location":"zh/architecture/#migration","title":"\u4ece 0.83 \u8fc1\u79fb","text":"<p>\u5173\u4e8e\u4ece 0.83 \u7248\u672c\u8fc1\u79fb\u5230 0.90 \u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 \u5bfc\u5165\u8fc1\u79fb\u6307\u5357\u3002</p> <p>\u4e3b\u8981\u53d8\u66f4\uff1a - <code>cullinan.core.application_context</code> \u2192 <code>cullinan.core.container</code> - <code>cullinan.core.definitions</code> \u2192 <code>cullinan.core.container</code> - <code>cullinan.core.exceptions</code> \u2192 <code>cullinan.core.diagnostics</code> - <code>cullinan.core.context</code> \u2192 <code>cullinan.core.request</code> - \u9057\u7559\u7ec4\u4ef6\u79fb\u81f3 <code>cullinan.core.legacy/</code></p> <p>\u7248\u672c\uff1av0.90 \u4f5c\u8005\uff1aPlumeink \u6700\u540e\u66f4\u65b0\uff1a2025-12-25</p>"},{"location":"zh/build_run/","title":"\u672c\u5730\u6784\u5efa\u4e0e\u8fd0\u884c","text":"<p>\u672c\u6587\u8bf4\u660e\u5982\u4f55\u5728\u672c\u5730\u642d\u5efa Cullinan \u5f00\u53d1\u73af\u5883\u3001\u4ee5\u53ef\u7f16\u8f91\u6a21\u5f0f\u5b89\u88c5\u9879\u76ee\u3001\u8fd0\u884c\u6d4b\u8bd5\u4ee5\u53ca\u542f\u52a8\u793a\u4f8b\u5e94\u7528\uff0c\u8986\u76d6 Windows\uff08PowerShell\uff09\u3001Linux \u548c macOS\u3002</p>"},{"location":"zh/build_run/#_2","title":"\u524d\u7f6e\u6761\u4ef6","text":"<ul> <li>Python 3.8 \u6216\u66f4\u9ad8\u7248\u672c</li> <li>Git</li> </ul>"},{"location":"zh/build_run/#_3","title":"\u514b\u9686\u4ed3\u5e93","text":"<p>\u5728\u6240\u6709\u5e73\u53f0\u4e0a\u5747\u53ef\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1a</p> <pre><code>git clone https://github.com/plumeink/Cullinan.git\ncd Cullinan\n</code></pre>"},{"location":"zh/build_run/#_4","title":"\u521b\u5efa\u5e76\u6fc0\u6d3b\u865a\u62df\u73af\u5883\uff08\u53ef\u9009\u4f46\u63a8\u8350\uff09","text":"<p>\u5728 Windows\uff08PowerShell\uff09\u4e2d\uff1a</p> <pre><code>python -m venv .venv\n.venv\\Scripts\\Activate.ps1\n</code></pre> <p>\u5728 Linux / macOS \u4e2d\uff1a</p> <pre><code>python -m venv .venv\nsource .venv/bin/activate\n</code></pre>"},{"location":"zh/build_run/#_5","title":"\u4ee5\u53ef\u7f16\u8f91\u6a21\u5f0f\u5b89\u88c5\u4f9d\u8d56","text":"<p>\u5728\u6240\u6709\u5e73\u53f0\u4e0a\uff1a</p> <pre><code>python -m pip install -U pip\npip install -e .\n</code></pre> <p>\u5982\u679c\u5728 <code>setup.py</code> \u6216 <code>pyproject.toml</code> \u4e2d\u5b9a\u4e49\u4e86\u5f00\u53d1\u989d\u5916\u4f9d\u8d56\uff0c\u53ef\u6309\u9700\u5b89\u88c5\uff0c\u4f8b\u5982\uff1a</p> <pre><code>pip install -e .[dev]\n</code></pre>"},{"location":"zh/build_run/#_6","title":"\u8fd0\u884c\u6d4b\u8bd5","text":"<p>\u5728\u6240\u6709\u5e73\u53f0\u4e0a\uff1a</p> <pre><code>pytest -q\n</code></pre> <p>\u5982\u9879\u76ee\u4f7f\u7528\u4e0d\u540c\u7684\u6d4b\u8bd5\u8fd0\u884c\u65b9\u5f0f\uff0c\u53ef\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8c03\u6574\u547d\u4ee4\uff08\u4f8b\u5982\u4f7f\u7528 <code>python -m pytest</code>\uff09\u3002</p>"},{"location":"zh/build_run/#_7","title":"\u8fd0\u884c\u793a\u4f8b\u5e94\u7528","text":""},{"location":"zh/build_run/#hello-http","title":"Hello HTTP \u793a\u4f8b","text":"<p>\u5728 Windows\uff08PowerShell\uff09\u4e2d\uff1a</p> <pre><code>python examples\\hello_http.py\n</code></pre> <p>\u5728 Linux / macOS \u4e2d\uff1a</p> <pre><code>python examples/hello_http.py\n</code></pre> <p>\u7136\u540e\u5728\u6d4f\u89c8\u5668\u4e2d\u8bbf\u95ee <code>http://localhost:4080/hello</code>\uff0c\u9a8c\u8bc1\u670d\u52a1\u5df2\u6210\u529f\u542f\u52a8\u3002</p>"},{"location":"zh/build_run/#_8","title":"\u4e2d\u95f4\u4ef6\u6f14\u793a\u793a\u4f8b","text":"<p>\u5728 Windows\uff08PowerShell\uff09\u4e2d\uff1a</p> <pre><code>python examples\\middleware_demo.py\n</code></pre> <p>\u5728 Linux / macOS \u4e2d\uff1a</p> <pre><code>python examples/middleware_demo.py\n</code></pre> <p>\u5173\u4e8e\u8be5\u793a\u4f8b\u7684\u65e5\u5fd7\u8f93\u51fa\u548c\u884c\u4e3a\u8bf4\u660e\uff0c\u8bf7\u53c2\u8003\u4e2d\u95f4\u4ef6\u76f8\u5173\u6587\u6863\u3002</p>"},{"location":"zh/contributing/","title":"\u8d21\u732e\u6307\u5357","text":"<p>\u5360\u4f4d\uff1a\u8d21\u732e\u6307\u5357\u3001PR \u68c0\u67e5\u6e05\u5355\u3001\u6587\u6863\u6a21\u677f\u3001front-matter \u8981\u6c42\u4e0e\u5ba1\u9605\u6d41\u7a0b\u3002</p>"},{"location":"zh/cullinan_documentation_plan/#_1","title":"\u4efb\u52a1\u6536\u655b\u4e0e\u9ad8\u5c42\u8ba1\u5212","text":"<p>\u672c\u8ba1\u5212\u6587\u6863\u7528\u4e8e\u6536\u7eb3\u591a\u9636\u6bb5\u4efb\u52a1\u89c4\u5212\uff0c\u4fbf\u4e8e\u5728\u4ed3\u5e93\u4e2d\u4fdd\u7559\u89c4\u5212\u5185\u5bb9\uff0c\u4f9b\u56e2\u961f\u5ba1\u9605\u4e0e\u5206\u914d\u3002\u540e\u7eed\u64cd\u4f5c\u793a\u4f8b\uff1a</p> <ul> <li>\u5728 <code>docs/</code> \u76ee\u5f55\u4e0b\u7ef4\u62a4\u672c\u8ba1\u5212\u6587\u4ef6\u3002</li> <li>\u8fd0\u884c\u9759\u6001\u68c0\u67e5\u4ee5\u786e\u4fdd\u6587\u4ef6\u6ca1\u6709\u8bed\u6cd5/\u683c\u5f0f\u9519\u8bef\uff08\u6587\u6863\u6587\u4ef6\u901a\u5e38\u4e0d\u4f1a\u4ea7\u751f\u4ee3\u7801\u7f16\u8bd1\u9519\u8bef\uff0c\u4f46\u4ecd\u5efa\u8bae\u8fdb\u884c\u57fa\u672c\u68c0\u67e5\uff09\u3002</li> </ul> <p>\u7b80\u8981\u9a8c\u6536\u6e05\u5355\uff08\u5728\u63d0\u4ea4\u524d\uff09\uff1a - [x] \u6587\u4ef6\u4ee5 UTF-8 \u7f16\u7801\u3001Markdown \u683c\u5f0f\u4fdd\u5b58\u3002 - [x] \u5305\u542b\u76ee\u6807\u3001\u8303\u56f4\u3001\u4efb\u52a1\u62c6\u5206\u3001\u65f6\u95f4\u9884\u4f30\u3001\u8d28\u91cf\u95e8\u4e0e\u793a\u4f8b\u547d\u4ee4\u8bf4\u660e\u3002 - [x] \u660e\u786e\u8981\u6c42 <code>docs/</code> \u4e0e <code>docs/zh/</code> \u5fc5\u987b 1:1 \u5bf9\u5e94\u3002</p> <p>TL;DR\uff1a\u4e3a Cullinan\uff08\u57fa\u4e8e Tornado \u7684 IoC/DI \u6846\u67b6\uff09\u7f16\u5199\u4e2d\u82f1\u53cc\u8bed\u6587\u6863\uff08<code>docs/</code> \u4e0e <code>docs/zh/</code> 1:1 \u5bf9\u5e94\uff09\uff0c\u5305\u62ec\u5165\u95e8\u3001\u793a\u4f8b\u3001Wiki\uff08\u67b6\u6784/\u7ec4\u4ef6/\u751f\u547d\u5468\u671f/\u6ce8\u5165/\u4e2d\u95f4\u4ef6/\u6269\u5c55\uff09\u3001API \u53c2\u8003\u3001\u8fc1\u79fb\u6307\u5357\u3001\u8d21\u732e\u6307\u5357\u3001\u6d4b\u8bd5\u4e0e\u672c\u5730\u8fd0\u884c\u8bf4\u660e\uff1b\u91c7\u7528\u6e90\u7801\u9a71\u52a8\uff08\u5ffd\u7565\u6ce8\u91ca\uff09\u7814\u7a76\u7b56\u7565\uff0c\u4fdd\u6301\u73b0\u6709 IoC/DI \u8bbe\u8ba1\u4e0d\u53d8\uff0c\u63d0\u4f9b\u5206\u5de5\u3001\u91cc\u7a0b\u7891\u3001\u8d28\u91cf\u95e8\u4e0e PowerShell \u7b49\u73af\u5883\u4e0b\u7684\u8fd0\u884c/\u9a8c\u8bc1\u547d\u4ee4\u793a\u4f8b\u3002</p>"},{"location":"zh/cullinan_documentation_plan/#2","title":"2. \u8303\u56f4\u4e0e\u4ea7\u7269\u6e05\u5355","text":"<p>\u5fc5\u987b\u4ea7\u51fa\uff08\u6bcf\u9879\u5747\u9700\u5728 <code>docs/</code> \u4e0e <code>docs/zh/</code> \u4e0b 1:1 \u5bf9\u5e94\uff09\uff1a</p> <ul> <li><code>Getting Started</code>\uff08\u5feb\u901f\u5165\u95e8\uff09 \u2014 <code>docs/getting_started.md</code> / <code>docs/zh/getting_started.md</code></li> <li><code>Examples</code>\uff08\u793a\u4f8b\uff09 \u2014 <code>docs/examples.md</code> / <code>docs/zh/examples.md</code>\uff08\u5e76\u5728\u4ed3\u5e93\u4fdd\u7559 <code>examples/</code> \u53ef\u8fd0\u884c\u4ee3\u7801\uff09</li> <li><code>Wiki</code>\uff08\u67b6\u6784/\u7ec4\u4ef6/\u751f\u547d\u5468\u671f/\u6ce8\u5165/\u4e2d\u95f4\u4ef6/\u6269\u5c55\uff09 \u2014 <code>docs/wiki/architecture.md</code>, <code>components.md</code>, <code>lifecycle.md</code>, <code>injection.md</code>, <code>middleware.md</code>, <code>extensions.md</code>\uff08\u4e0e <code>docs/zh/wiki/*</code> \u5bf9\u5e94\uff09</li> <li><code>API Reference</code> \u2014 <code>docs/api_reference.md</code> / <code>docs/zh/api_reference.md</code>\uff08\u53ef\u9009\u62e9\u81ea\u52a8\u5316\u751f\u6210\uff09</li> <li><code>Migration Guide</code> \u2014 <code>docs/migration_guide.md</code> / <code>docs/zh/migration_guide.md</code></li> <li><code>Contributing</code> \u2014 <code>docs/contributing.md</code> / <code>docs/zh/contributing.md</code></li> <li><code>Testing &amp; Verification</code> \u2014 <code>docs/testing.md</code> / <code>docs/zh/testing.md</code></li> <li><code>Local Build &amp; Run</code> \u2014 <code>docs/build_run.md</code> / <code>docs/zh/build_run.md</code></li> <li>\u6587\u6863\u6a21\u677f\u548c\u6837\u4f8b\u9875\u9762\uff08front-matter\u3001\u793a\u4f8b\u4ee3\u7801\u7247\u6bb5\u89c4\u8303\u3001\u7ffb\u8bd1\u51c6\u5219\uff09</li> </ul> <p>\u9644\u52a0\u4ea7\u7269\uff08\u5efa\u8bae\uff09\uff1a</p> <ul> <li><code>examples/</code> \u53ef\u8fd0\u884c\u793a\u4f8b\u96c6\u5408\uff08\u8f7b\u91cf demo\uff09</li> <li>\u7b80\u8981 <code>README.md</code> \u66f4\u65b0\u94fe\u63a5 <code>docs/</code> \u9875\u9762</li> <li>\u6587\u6863 CI \u811a\u672c\uff08\u53ef\u9009\uff09</li> </ul>"},{"location":"zh/cullinan_documentation_plan/#3","title":"3. \u7814\u7a76\u65b9\u6cd5\u4e0e\u4ee3\u7801\u9605\u8bfb\u7b56\u7565\uff08\u53ea\u8bfb\u6e90\u7801\uff0c\u5ffd\u7565\u6ce8\u91ca\uff09","text":"<p>\u7814\u7a76\u76ee\u6807\uff1a\u4ece\u6e90\u7801\u63a8\u65ad\u8bbe\u8ba1\u4e0e\u884c\u4e3a\uff08\u4e0d\u4f9d\u8d56\u6ce8\u91ca\uff09\uff0c\u5b9a\u4f4d\u5173\u952e\u6a21\u5757\u4e0e\u4f9d\u8d56\u5173\u7cfb\uff0c\u63d0\u53d6\u5916\u90e8 API\u3001\u751f\u547d\u5468\u671f\u548c\u6ce8\u5165\u884c\u4e3a\u3002</p> <p>\u7b56\u7565\u4e0e\u6b65\u9aa4\uff1a</p> <ol> <li>\u9ad8\u5c42\u76ee\u5f55\u626b\u63cf\uff1a\u5148\u786e\u8ba4\u9876\u5c42\u6a21\u5757\u4e0e\u5165\u53e3\u70b9\u3002\u4f18\u5148\u9605\u8bfb <code>cullinan/__init__.py</code>\u3001<code>app.py</code>\u3001<code>application.py</code>\u3001<code>config.py</code>\u3002</li> <li>\u6838\u5fc3\u5b50\u7cfb\u7edf\u5b9a\u4f4d\uff1a\u5b9a\u4f4d IoC/DI \u5b9e\u73b0\u4f4d\u7f6e\uff08\u901a\u5e38\u5728 <code>cullinan/core</code>\uff09\u3002\u91cd\u70b9\u9605\u8bfb <code>core/__init__.py</code>\u3001<code>core/provider.py</code>\u3001<code>core/registry.py</code>\u3001<code>core/scope.py</code> \u7b49\uff08\u5b9e\u9645\u6587\u4ef6\u540d\u8bf7\u6839\u636e <code>cullinan/core</code> \u76ee\u5f55\u6587\u4ef6\u5217\u8868\u8c03\u6574\uff09\u3002</li> <li>\u63a7\u5236\u5668/\u8def\u7531/\u4e2d\u95f4\u4ef6\uff1a\u67e5\u770b <code>controller/</code>\u3001<code>handler/</code>\u3001<code>middleware/</code> \u6587\u4ef6\uff0c\u627e\u5230\u8def\u7531\u6ce8\u518c\u3001\u5904\u7406\u6d41\u7a0b\u4e0e\u751f\u547d\u5468\u671f\u94a9\u5b50\u3002</li> <li>\u6a21\u5757\u626b\u63cf\u4e0e\u81ea\u52a8\u6ce8\u518c\uff1a\u9605\u8bfb <code>module_scanner.py</code>\u3001<code>websocket_registry.py</code> \u7b49\u4e86\u89e3\u81ea\u52a8\u53d1\u73b0\u673a\u5236\u4e0e\u6ce8\u518c\u65f6\u5e8f\u3002</li> <li>\u914d\u7f6e\u4e0e\u542f\u52a8\u6d41\u7a0b\uff1a\u8ffd\u8e2a <code>application.py</code> \u4e0e <code>app.py</code> \u4e2d\u7684 <code>main</code>\u3001<code>start</code>\u3001<code>initialize</code>\u3001<code>run</code> \u98ce\u683c\u51fd\u6570\uff0c\u5f62\u6210\u542f\u52a8\u5e8f\u5217\u56fe\uff08\u987a\u5e8f\u3001\u4f9d\u8d56\uff09\u3002</li> <li>\u6ce8\u5165\u70b9\u53d1\u73b0\uff1a\u5728\u6e90\u7801\u4e2d\u641c\u7d22\u5173\u952e\u8bcd\uff08<code>inject</code>, <code>provide</code>, <code>provider</code>, <code>register</code>, <code>scope</code>, <code>singleton</code>, <code>transient</code>\uff09\u4ee5\u5b9a\u4f4d\u6ce8\u5165 API \u4e0e\u7528\u6cd5\u3002</li> <li>\u4ee5\u6d4b\u8bd5\u4e3a\u53cd\u8bc1\uff1a\u5ba1\u9605 <code>tests/</code> \u4e0b\u5173\u952e\u6d4b\u8bd5\uff08\u5982 <code>test_core_injection.py</code>\u3001<code>test_controller_injection_fix.py</code>\u3001<code>test_registry.py</code> \u7b49\uff09\u6765\u7406\u89e3\u671f\u671b\u884c\u4e3a\u4e0e\u8fb9\u754c\u6761\u4ef6\uff08\u6d4b\u8bd5\u662f\u884c\u4e3a\u89c4\u8303\u7684\u91cd\u8981\u6765\u6e90\uff09\u3002</li> <li>\u4f9d\u8d56\u56fe\u6784\u5efa\uff1a\u4f7f\u7528\u9759\u6001\u8bfb\u53d6\uff08\u6216\u7b80\u5355\u811a\u672c\uff09\u5217\u51fa\u6a21\u5757\u4e4b\u95f4 import \u5173\u7cfb\uff0c\u7ed8\u5236\u7b80\u6613\u6a21\u5757\u4f9d\u8d56\u56fe\uff08\u5e2e\u52a9\u64b0\u5199\u67b6\u6784/\u7ec4\u4ef6\u8bf4\u660e\uff09\u3002</li> <li>\u8bb0\u5f55\u53d1\u73b0\uff1a\u4ee5\u201c\u4e8b\u5b9e\u9648\u8ff0\u201d\u8bb0\u5f55\u6bcf\u4e2a\u6a21\u5757\u7684\u804c\u8d23\u3001\u8f93\u5165\u8f93\u51fa\u3001\u751f\u547d\u5468\u671f\u3001\u9519\u8bef\u6a21\u5f0f\u3002\u4ec5\u57fa\u4e8e\u6e90\u7801\u884c\u4e3a\uff0c\u4e0d\u4f9d\u8d56\u6ce8\u91ca\u89e3\u91ca\u3002</li> </ol> <p>\u5de5\u5177\u4e0e\u65b9\u6cd5\uff1a</p> <ul> <li>\u4f7f\u7528\u4ed3\u5e93\u641c\u7d22\uff08\u901a\u8fc7 IDE \u6216 <code>rg</code>/<code>grep</code>\uff09\u5b9a\u4f4d\u7b26\u53f7\u548c\u5b57\u7b26\u4e32\u6a21\u5f0f\u3002</li> <li>\u9605\u8bfb\u5173\u952e\u6d4b\u8bd5\u7528\u4f8b\u4ee5\u8865\u5168\u7406\u89e3\u3002</li> <li>\u6784\u5efa\u5c0f\u7684\u95ee\u7b54\u5f0f\u7b14\u8bb0\uff08\u6a21\u5757 -&gt; \u8d23\u4efb -&gt; \u4e0e\u5176\u4ed6\u6a21\u5757\u7684\u4ea4\u4e92\uff09\u4f9b\u6587\u6863\u5199\u4f5c\u4f7f\u7528\u3002</li> </ul> <p>\u6ce8\u610f\uff1a\u4e0d\u8981\u5728\u6587\u6863\u4e2d\u6539\u53d8\u6216\u9f13\u52b1\u6539\u53d8\u73b0\u6709 IoC/DI \u8bbe\u8ba1\uff1b\u6587\u6863\u53ea\u63cf\u8ff0/\u8bf4\u660e\uff0c\u53ef\u63d0\u51fa\u201c\u6539\u8fdb\u5efa\u8bae\u201d\u4f46\u987b\u4f5c\u4e3a\u9644\u5f55\u6216 issues\u3002</p>"},{"location":"zh/cullinan_documentation_plan/#4","title":"4. \u4efb\u52a1\u62c6\u5206\u4e0e\u91cc\u7a0b\u7891\uff08\u4f18\u5148\u7ea7 + \u65f6\u95f4\u4f30\u7b97\uff09","text":"<p>\u603b\u4f53\u9884\u8ba1\u65f6\u957f\uff1a6 \u5468\uff08\u53ef\u6309\u8d44\u6e90\u5e76\u884c\u538b\u7f29\uff09\u3002\u65f6\u95f4\u5355\u4f4d\u4e3a\u4eba\u5929\uff08\u5de5\u4f5c\u65e5\uff09\u3002</p> <p>\u9636\u6bb5 A \u2014 \u53d1\u73b0\u4e0e\u5927\u7eb2\uff08\u4f18\u5148\u7ea7\uff1a\u9ad8\uff0c\u65f6\u957f\uff1a4 \u4eba\u65e5\uff09 - A1. \u6e90\u7801\u5feb\u901f\u626b\u63cf\u5e76\u751f\u6210\u6a21\u5757\u6620\u5c04\uff082 \u4eba\u65e5\uff09 - A2. \u57fa\u4e8e\u6620\u5c04\u8349\u62df\u6587\u6863\u603b\u7eb2\uff081 \u4eba\u65e5\uff09 - A3. \u786e\u8ba4\u8f93\u51fa\u683c\u5f0f\uff08Markdown \u7ed3\u6784\u3001\u76ee\u5f55\u3001\u7ffb\u8bd1\u6d41\u7a0b\u3001\u662f\u5426\u7528 Sphinx/mkdocs \u7b49\uff09\uff081 \u4eba\u65e5\uff09</p> <p>\u91cc\u7a0b\u7891 A\uff1a\u63d0\u4ea4 <code>docs/outline.md</code> \u4e0e <code>docs/zh/outline.md</code>\uff0c\u5305\u542b\u6587\u4ef6\u6e05\u5355\u4e0e\u8d1f\u8d23\u4eba\u3002</p> <p>\u9636\u6bb5 B \u2014 \u5165\u95e8\u4e0e\u793a\u4f8b\uff08\u4f18\u5148\u7ea7\uff1a\u9ad8\uff0c\u65f6\u957f\uff1a6 \u4eba\u65e5\uff09 - B1. \u7f16\u5199 <code>Getting Started</code> \u82f1\u4e2d\u7248\u672c\uff082 \u4eba\u65e5\uff09 - B2. \u8bbe\u8ba1\u5e76\u5b9e\u73b0 2\u20133 \u4e2a\u6700\u5c0f\u53ef\u8fd0\u884c\u793a\u4f8b\u5230 <code>examples/</code>\uff083 \u4eba\u65e5\uff09 - B3. \u5c06\u793a\u4f8b\u96c6\u6210\u5230\u6587\u6863\u5e76\u9a8c\u8bc1\uff081 \u4eba\u65e5\uff09</p> <p>\u91cc\u7a0b\u7891 B\uff1a<code>docs/getting_started.md</code> \u4e0e <code>examples/</code> \u53ef\u88ab\u672c\u5730\u7528\u6237\u8fd0\u884c\u3002</p> <p>\u9636\u6bb5 C \u2014 \u6838\u5fc3 Wiki\uff08\u67b6\u6784/\u7ec4\u4ef6/\u751f\u547d\u5468\u671f/\u6ce8\u5165\u673a\u5236/\u4e2d\u95f4\u4ef6/\u6269\u5c55\uff09\uff08\u4f18\u5148\u7ea7\uff1a\u9ad8\uff0c\u65f6\u957f\uff1a10 \u4eba\u65e5\uff09 - C1. <code>architecture.md</code>\uff082 \u4eba\u65e5\uff09 - C2. <code>components.md</code>\uff082 \u4eba\u65e5\uff09 - C3. <code>lifecycle.md</code>\uff082 \u4eba\u65e5\uff09 - C4. <code>injection.md</code>\uff083 \u4eba\u65e5\uff09 - C5. <code>middleware.md</code> / <code>extensions.md</code>\uff081 \u4eba\u65e5\uff09</p> <p>\u91cc\u7a0b\u7891 C\uff1a\u5b8c\u6210\u6838\u5fc3\u8bbe\u8ba1\u7684\u68b3\u7406\u4e0e\u6587\u6863\u5316\uff0c\u5e76\u901a\u8fc7\u540c\u884c\u8bc4\u5ba1\u3002</p> <p>\u9636\u6bb5 D \u2014 API \u53c2\u8003\u4e0e\u8fc1\u79fb\u6307\u5357\uff08\u4f18\u5148\u7ea7\uff1a\u4e2d\uff0c\u65f6\u957f\uff1a8 \u4eba\u65e5\uff09 - D1. \u51b3\u5b9a API \u53c2\u8003\u65b9\u5f0f\uff08\u81ea\u52a8 vs \u624b\u5de5\uff09\uff080.5 \u4eba\u65e5\uff09 - D2. \u751f\u6210\u6216\u624b\u5199\u6240\u6709\u516c\u5171\u6a21\u5757\u7684 API \u6458\u8981\uff085 \u4eba\u65e5\uff09 - D3. \u7f16\u5199\u8fc1\u79fb\u6307\u5357\uff08\u517c\u5bb9\u6027/\u7834\u574f\u6027\u53d8\u5316\u8bf4\u660e\uff09\uff082.5 \u4eba\u65e5\uff09</p> <p>\u91cc\u7a0b\u7891 D\uff1aAPI \u53c2\u8003\u5b8c\u6210\u5e76\u53ef\u7d22\u5f15\uff1b\u8fc1\u79fb\u6307\u5357\u8986\u76d6\u4e3b\u8981\u53d8\u66f4\u70b9\u3002</p> <p>\u9636\u6bb5 E \u2014 \u8d21\u732e/\u6d4b\u8bd5/\u8fd0\u884c\u8bf4\u660e\u4e0e\u672c\u5730\u6784\u5efa\uff08\u4f18\u5148\u7ea7\uff1a\u4e2d\uff0c\u65f6\u957f\uff1a4 \u4eba\u65e5\uff09 - E1. <code>contributing.md</code>\uff081 \u4eba\u65e5\uff09 - E2. <code>testing.md</code>\uff081 \u4eba\u65e5\uff09 \u2014 \u5305\u62ec\u5982\u4f55\u8fd0\u884c\u73b0\u6709\u6d4b\u8bd5\u3001\u5982\u4f55\u7f16\u5199\u6d4b\u8bd5\u3001CI \u8981\u6c42 - E3. <code>build_run.md</code>\uff082 \u4eba\u65e5\uff09 \u2014 \u5305\u542b Windows PowerShell \u6307\u4ee4\u548c\u865a\u62df\u73af\u5883\u6b65\u9aa4</p> <p>\u91cc\u7a0b\u7891 E\uff1a\u8d21\u732e\u6d41\u7a0b\u4e0e\u6d4b\u8bd5\u51c6\u5219\u5c31\u7eea\u3002</p> <p>\u9636\u6bb5 F \u2014 \u7ffb\u8bd1\u3001\u6821\u9a8c\u3001\u8d28\u91cf\u95e8\uff08\u4f18\u5148\u7ea7\uff1a\u9ad8\uff0c\u65f6\u957f\uff1a6 \u4eba\u65e5\uff09 - F1. \u7ffb\u8bd1\u6821\u5bf9\uff08\u82f1-&gt;\u4e2d\uff09\u5e76\u786e\u4fdd 1:1 \u6587\u4ef6\u7ed3\u6784\uff083 \u4eba\u65e5\uff09 - F2. \u6587\u6863\u5185\u90e8\u5ba1\u6821\uff08\u7ed3\u6784\u3001\u4e8b\u5b9e\u3001\u793a\u4f8b\u53ef\u8fd0\u884c\uff09\uff082 \u4eba\u65e5\uff09 - F3. \u6700\u7ec8\u8d28\u91cf\u95e8\uff08\u8fd0\u884c\u6d4b\u8bd5\u3001\u793a\u4f8b\u9a8c\u8bc1\u3001\u63d0\u4ea4 PR\uff09\uff081 \u4eba\u65e5\uff09</p> <p>\u91cc\u7a0b\u7891 F\uff1a\u53cc\u8bed\u6587\u6863 1:1 \u5bf9\u5e94\u901a\u8fc7 QA\u3002</p> <p>\u603b\u4f53\u91cc\u7a0b\u7891\u65f6\u95f4\u8868\uff08\u53ef\u901a\u8fc7\u5e76\u884c\u5de5\u4f5c\u7f29\u77ed\uff09\uff1a - \u7b2c 1 \u5468\uff1a\u5b8c\u6210\u9636\u6bb5 A - \u7b2c 2 \u5468\uff1a\u5f00\u59cb\u5e76\u5b8c\u6210\u9636\u6bb5 B - \u7b2c 3\u20134 \u5468\uff1a\u5b8c\u6210\u9636\u6bb5 C - \u7b2c 5 \u5468\uff1a\u5b8c\u6210\u9636\u6bb5 D \u548c E - \u7b2c 6 \u5468\uff1a\u5b8c\u6210\u9636\u6bb5 F \u7684\u9a8c\u6536\u4e0e\u53d1\u5e03</p>"},{"location":"zh/cullinan_documentation_plan/#5","title":"5. \u4eba\u5458\u5206\u5de5\u5efa\u8bae\uff08\u793a\u4f8b\uff09","text":"<ul> <li>1 \u540d\u6280\u672f\u4f5c\u8005\uff08\u4e3b\u6587\u6863\u64b0\u5199\uff09 \u2014 \u8d1f\u8d23\u5165\u95e8\u3001Wiki \u4e3b\u4f53\u3001\u793a\u4f8b\u6587\u672c</li> <li>1 \u540d\u5f00\u53d1\u5de5\u7a0b\u5e08\uff08\u4ee3\u7801\u7814\u7a76\u4e0e\u793a\u4f8b\u5b9e\u73b0\uff09 \u2014 \u8d1f\u8d23\u6e90\u7801\u6620\u5c04\u3001\u53ef\u8fd0\u884c\u793a\u4f8b\u3001\u9a8c\u8bc1\u6d4b\u8bd5</li> <li>1 \u540d\u7ffb\u8bd1/\u672c\u5730\u5316\u4eba\u5458\uff08\u4e2d\u6587\u6821\u5bf9\uff09 \u2014 \u8d1f\u8d23 <code>docs/zh/</code> \u5bf9\u5e94\u7ffb\u8bd1\u4e0e\u8bed\u5883\u6821\u9a8c</li> <li>1 \u540d\u8bc4\u5ba1/\u7ef4\u62a4\u8005\uff08\u67b6\u6784 &amp; CI \u5ba1\u6838\uff09 \u2014 \u8d1f\u8d23\u5ba1\u7a3f\u3001CI \u5408\u5e76\u3001\u8d28\u91cf\u95e8\u7b7e\u6536</li> </ul>"},{"location":"zh/cullinan_documentation_plan/#6","title":"6. \u5199\u4f5c\u51c6\u5219\uff08\u5fc5\u9075\u5b88\uff09","text":"<ul> <li>\u6587\u4ef6\u7f16\u7801\uff1aUTF-8\u3002</li> <li>\u76ee\u5f55\u7ed3\u6784\uff1a<code>docs/</code> \u4e0e <code>docs/zh/</code> \u5fc5\u987b 1:1 \u5bf9\u5e94\uff0c\u6587\u4ef6\u540d\u4e0e\u76f8\u5bf9\u8def\u5f84\u4e00\u81f4\u3002</li> <li>\u8bed\u8a00\u4e0e\u98ce\u683c\uff1a\u7b80\u6d01\u3001\u4ee5\u4e8b\u5b9e\u4e3a\u57fa\u7840\uff08\u4ee5\u6e90\u7801\u884c\u4e3a\u4e3a\u51c6\uff09\uff0c\u5c3d\u91cf\u63d0\u4f9b\u793a\u4f8b\u548c\u53ef\u590d\u5236\u6b65\u9aa4\u3002</li> <li>\u7981\u6b62\u5728\u65e5\u5fd7\u6216\u793a\u4f8b\u8f93\u51fa\u4e2d\u4f7f\u7528 emoji\uff08\u9879\u76ee\u89c4\u5b9a\uff09\u3002</li> <li>Windows PowerShell \u547d\u4ee4\u793a\u4f8b\u5e94\u7b26\u5408 Windows PowerShell v5.1 \u8bed\u6cd5\uff1b\u4e0d\u8981\u4f7f\u7528 <code>&amp;&amp;</code> \u8fde\u63a5\u547d\u4ee4\uff1b\u82e5\u9700\u8981\u5728\u4e00\u884c\u6267\u884c\u591a\u4e2a\u547d\u4ee4\uff0c\u4f7f\u7528\u5206\u53f7 <code>;</code>\u3002</li> <li>\u6587\u6863\u4e2d\u5f15\u7528\u6587\u4ef6\u6216\u7b26\u53f7\u65f6\u4f7f\u7528\u53cd\u5f15\u53f7\u5305\u88f9\uff08\u4f8b\u5982 <code>cullinan/core</code>\u3001<code>application.py</code>\uff09\u3002</li> <li>\u5bf9\u4e8e API \u53c2\u8003\uff0c\u660e\u786e\u6807\u6ce8\u201c\u516c\u6709 API\u201d\u4e0e\u201c\u5185\u90e8\u5b9e\u73b0\u201d\uff0c\u9f13\u52b1\u53ea\u5728\u516c\u6709 API \u4e0a\u5efa\u7acb\u4f7f\u7528\u793a\u4f8b\u3002</li> <li>\u7ffb\u8bd1\u7b56\u7565\uff1a\u5148\u5b8c\u6210\u82f1\u6587\u539f\u7a3f\u5e76\u8bc4\u5ba1\u901a\u8fc7\uff0c\u518d\u505a\u4e2d\u6587\u7ffb\u8bd1\uff1b\u59cb\u7ec8\u4fdd\u6301 1:1 \u5185\u5bb9\u4e00\u81f4\u6027\u3002</li> </ul>"},{"location":"zh/cullinan_documentation_plan/#7-quality-gates","title":"7. \u6821\u9a8c / \u8d28\u91cf\u95e8\uff08Quality Gates\uff09","text":"<p>\u6bcf\u4e2a\u9636\u6bb5\u5fc5\u987b\u901a\u8fc7\u76f8\u5e94\u7684\u8d28\u91cf\u95e8\u624d\u80fd\u8fdb\u5165\u4e0b\u4e00\u9636\u6bb5\uff1a</p> <p>\u8d28\u91cf\u95e8\u793a\u4f8b\uff1a - \u4ee3\u7801\u7814\u7a76\u5b8c\u6210\uff1a\u63d0\u4ea4 <code>docs/outline.md</code>\uff0c\u5305\u542b\u6a21\u5757\u6620\u5c04\u4e0e\u5173\u952e\u51fd\u6570\u5217\u8868\uff1b\u81f3\u5c11\u4e24\u540d\u5de5\u7a0b\u5e08\u5ba1\u6838\u540c\u610f\uff08\u7b7e\u540d\u6216 PR \u8bc4\u8bba\uff09\u3002 - \u793a\u4f8b\u53ef\u8fd0\u884c\uff1a<code>examples/</code> \u4e2d\u793a\u4f8b\u53ef\u5728\u672c\u5730\u865a\u62df\u73af\u5883\u4e2d\u6210\u529f\u8fd0\u884c\uff08\u89c1\u9a8c\u8bc1\u547d\u4ee4\uff09\u3002 - \u5355\u5143/\u96c6\u6210\u6d4b\u8bd5\uff1a\u8fd0\u884c\u4ed3\u5e93\u73b0\u6709\u6d4b\u8bd5\u5e76\u786e\u4fdd\u65e0\u56de\u5f52\uff08\u89c1\u4e0b\u65b9\u547d\u4ee4\uff09\u3002\u5fc5\u987b\u81f3\u5c11\u5b9e\u73b0\u201c\u5f53\u524d\u4e3b\u5206\u652f\u76f8\u540c\u6216\u66f4\u597d\u201d\u7684\u901a\u8fc7\u7387\u3002 - \u6587\u6863\u5ba1\u6821\uff1a\u6bcf\u7bc7\u6587\u6863\u81f3\u5c11\u8fdb\u884c 1 \u6b21\u6280\u672f\u5ba1\u9605\u4e0e 1 \u6b21\u8bed\u8a00\u6821\u5bf9\u3002 - \u53d1\u5e03\u524d\uff1aCI \u901a\u8fc7\u3001\u6587\u6863\u94fe\u63a5\u5b8c\u6574\u6027\u68c0\u67e5\u3001\u793a\u4f8b\u5728 Windows PowerShell \u73af\u5883\u6d4b\u8bd5\u901a\u8fc7\u3002</p> <p>\u5173\u952e\u6821\u9a8c\u547d\u4ee4\uff08\u4ee5 PowerShell \u8868\u793a\uff0c\u5355\u884c\u793a\u4f8b\u4f7f\u7528 <code>;</code> \u5206\u9694\uff09\uff1a - \u521b\u5efa\u865a\u62df\u73af\u5883\u5e76\u6fc0\u6d3b\uff08\u53ef\u9009\uff09\uff1a\u786e\u4fdd\u5b58\u5728\u53ef\u7528\u7684 Python \u73af\u5883\uff08virtualenv/conda/system Python \u7b49\u5747\u53ef\uff09\uff0c\u65e0\u9700\u5728\u6587\u6863\u4e2d\u5f3a\u5236\u89c4\u5b9a\u6fc0\u6d3b\u547d\u4ee4\u3002 - \u5b89\u88c5\u5f00\u53d1\u4f9d\u8d56\u5e76\u5b89\u88c5\u672c\u5305\uff08\u53ef\u9009 extras\uff09\uff1a<code>pip install -U pip; pip install -e .[dev]</code> \u6216 <code>pip install -e .</code> - \u8fd0\u884c\u6d4b\u8bd5\uff1a<code>py -3 -m pytest -q</code>\uff08\u6216 <code>pytest -q</code>\uff09 - \u8fd0\u884c\u5355\u4e2a\u793a\u4f8b\uff08\u5728 <code>examples/</code> \u76ee\u5f55\uff09\uff1a<code>py example_script.py</code> \u6216 <code>python -m examples.demo</code>\uff08\u89c6\u793a\u4f8b\u5b9e\u73b0\u800c\u5b9a\uff09 - \u68c0\u67e5\u6587\u6863\u94fe\u63a5/\u62fc\u5199\uff08\u82e5\u4f7f\u7528\u5de5\u5177\uff09\uff1a<code>pylint</code>/<code>flake8</code>\uff08\u4ee3\u7801\uff09\uff0c<code>markdownlint</code>\uff08\u6587\u6863\uff09\uff08\u6309\u9700\u5b89\u88c5\uff09</p>"},{"location":"zh/cullinan_documentation_plan/#8","title":"8. \u9700\u8981\u521b\u5efa\u7684\u6587\u4ef6\u7ed3\u6784\u4e0e\u6a21\u677f\u793a\u4f8b","text":"<p>\u5efa\u8bae\u5728\u4ed3\u5e93\u4e2d\u65b0\u589e\u6216\u8865\u5145\u4ee5\u4e0b\u6587\u4ef6\uff08<code>docs/</code> \u4e0e <code>docs/zh/</code> \u5fc5\u987b\u955c\u50cf\uff09\uff1a</p> <ul> <li><code>docs/README.md</code>\uff08\u6587\u6863\u4e3b\u9875/\u5bfc\u822a\uff09</li> <li><code>docs/getting_started.md</code>\uff08\u5feb\u901f\u5f00\u59cb\uff1a\u73af\u5883\u3001\u5b89\u88c5\u3001\u8fd0\u884c\u7b2c\u4e00\u4e2a\u5e94\u7528\uff09</li> <li><code>docs/examples.md</code>\uff08\u793a\u4f8b\u7d22\u5f15\u4e0e\u8bf4\u660e\uff09 + <code>examples/</code> \u76ee\u5f55\u653e\u793a\u4f8b\u4ee3\u7801</li> <li><code>docs/wiki/architecture.md</code>\uff08\u67b6\u6784\u603b\u89c8\uff09</li> <li><code>docs/wiki/components.md</code>\uff08\u7ec4\u4ef6\u8d23\u4efb\u4e0e API \u6458\u8981\uff09</li> <li><code>docs/wiki/lifecycle.md</code>\uff08\u5e94\u7528\u542f\u52a8/\u5173\u95ed/\u751f\u547d\u5468\u671f\u94a9\u5b50\uff09</li> <li><code>docs/wiki/injection.md</code>\uff08IoC/DI \u673a\u5236\u8be6\u89e3\uff09</li> <li><code>docs/wiki/middleware.md</code>\uff08\u4e2d\u95f4\u4ef6\u94fe\u4e0e\u6269\u5c55\u70b9\uff09</li> <li><code>docs/api_reference.md</code>\uff08\u6309\u6a21\u5757\u5217\u51fa\u7684\u516c\u6709 API\uff09</li> <li><code>docs/migration_guide.md</code>\uff08\u517c\u5bb9\u6027\u4e0e\u8fc1\u79fb\u8bf4\u660e\uff09</li> <li><code>docs/contributing.md</code>\uff08\u8d21\u732e\u8005\u6307\u5357\u3001\u4ee3\u7801\u98ce\u683c\u3001PR \u6d41\u7a0b\uff09</li> <li><code>docs/testing.md</code>\uff08\u5982\u4f55\u8fd0\u884c\u73b0\u6709 tests\u3001\u7f16\u5199\u6d4b\u8bd5\u3001CI \u8981\u6c42\uff09</li> <li><code>docs/build_run.md</code>\uff08\u5728 Windows/Unix \u4e0b\u7684\u672c\u5730\u6784\u5efa\u4e0e\u8fd0\u884c\u8bf4\u660e\uff09</li> <li><code>docs/templates/</code>\uff08\u9875\u9762\u6a21\u677f\uff1a\u6807\u9898\u3001\u6982\u8ff0\u3001\u793a\u4f8b\u7ed3\u6784\u3001API \u6761\u76ee\u683c\u5f0f\u3001\u7ffb\u8bd1\u5bf9\u7167\u8868\uff09</li> </ul> <p>\u6a21\u677f\u793a\u4f8b\uff08\u63cf\u8ff0\u800c\u975e\u4ee3\u7801\u5757\uff09\uff1a - \u6587\u6863\u9876\u90e8\u5e94\u5305\u542b\u7b80\u77ed\u7684\u201c\u76ee\u7684/\u8303\u56f4/\u524d\u63d0\u201d\u4e09\u6bb5\uff0c\u968f\u540e\u201c\u793a\u4f8b\u201d\u90e8\u5206\u6309\u201c\u793a\u4f8b\u8bf4\u660e / \u4ee3\u7801\u4f4d\u7f6e / \u8fd0\u884c\u6b65\u9aa4 / \u671f\u671b\u7ed3\u679c\u201d\u56db\u6bb5\u6a21\u677f\u6392\u5217\u3002 - API \u6761\u76ee\u6a21\u677f\uff1a\u6a21\u5757\u8def\u5f84 -&gt; \u7b80\u77ed\u63cf\u8ff0 -&gt; \u516c\u5f00\u7c7b/\u51fd\u6570\u5217\u8868\uff08\u6bcf\u9879\uff1a\u7b7e\u540d\u3001\u53c2\u6570\u8bf4\u660e\u3001\u8fd4\u56de\u503c\u3001\u5f02\u5e38\u4e0e\u4f7f\u7528\u793a\u4f8b\u884c\u53f7\u5f15\u7528\uff09\u3002 - \u7ffb\u8bd1\u6a21\u677f\uff1a\u6bcf\u4e2a\u82f1\u6587\u6587\u4ef6\u5e94\u5e26\u6709\u4e00\u4efd\u5bf9\u7167\u6e05\u5355\u5217\u51fa\u201c\u5efa\u8bae\u672f\u8bed\u7ffb\u8bd1\u201d\uff08\u4f8b\u5982 IoC -&gt; \u63a7\u5236\u53cd\u8f6c\uff0cDI -&gt; \u4f9d\u8d56\u6ce8\u5165\uff09\u3002</p>"},{"location":"zh/cullinan_documentation_plan/#9","title":"9. \u9a8c\u6536\u6807\u51c6\uff08\u9a8c\u6536\u68c0\u67e5\u8868\uff09","text":"<p>\u6bcf\u9879\u6587\u6863\u5728\u4ea4\u4ed8\u524d\u5fc5\u987b\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\uff1a - \u82f1\u6587\u4e0e\u4e2d\u6587\u6587\u4ef6 1:1 \u5bf9\u5e94\uff08\u8def\u5f84\u4e0e\u6587\u4ef6\u540d\u4e00\u81f4\uff0c\u5185\u5bb9\u7b49\u6548\uff09\u3002 - Getting Started\uff1a\u65b0\u7528\u6237\u6309\u6b65\u9aa4\u80fd\u5728 30 \u5206\u949f\u5185\u8fd0\u884c\u793a\u4f8b\u5e76\u8bbf\u95ee\u5e94\u7528\u3002 - Examples\uff1a\u81f3\u5c11\u5305\u542b 2 \u4e2a\u53ef\u8fd0\u884c\u793a\u4f8b\uff08\u6700\u5c0f\uff1aHello World HTTP\uff0c\u8fdb\u9636\uff1aController + DI + Middleware \u793a\u4f8b\uff09\u3002 - Wiki\uff1a\u8986\u76d6\u67b6\u6784\u56fe\u3001\u7ec4\u4ef6\u804c\u8d23\u3001\u6ce8\u5165\u751f\u547d\u5468\u671f\u4e0e\u9519\u8bef\u6a21\u578b\u3002 - API \u53c2\u8003\uff1a\u8986\u76d6\u6240\u6709\u516c\u5171\u6a21\u5757\u5e76\u63d0\u4f9b\u81f3\u5c11\u4e00\u4e2a\u4f7f\u7528\u793a\u4f8b\u3002 - Migration Guide\uff1a\u5217\u51fa\u6240\u6709\u7834\u574f\u6027\u53d8\u66f4\u4e0e\u8fc1\u79fb\u6b65\u9aa4\uff08\u82e5\u5b58\u5728\uff09\u3002 - Contributing\uff1a\u5305\u542b\u4ee3\u7801\u98ce\u683c\u3001PR \u6d41\u7a0b\u3001\u6d4b\u8bd5\u51c6\u5165\u95e8\u69db\u3002 - Testing\uff1a\u73b0\u6709\u6d4b\u8bd5\u5728\u5e72\u51c0\u73af\u5883\u4e0b\u4f7f\u7528 <code>pytest</code> \u8fd0\u884c\u901a\u8fc7\uff08\u4e0e\u4e3b\u5206\u652f\u540c\u7b49\u6216\u66f4\u4f18\uff09\u3002 - \u6587\u6863\u5ba1\u9605\uff1a\u81f3\u5c11 2 \u540d\u6280\u672f\u8bc4\u5ba1\u4e0e 1 \u540d\u6587\u672c\u6821\u5bf9\u4eba\u5458\u901a\u8fc7\u5ba1\u9605\u3002 - CI/\u53d1\u5e03\uff1a\u6587\u6863\u6784\u5efa\u6216\u9759\u6001\u68c0\u67e5\uff08\u82e5\u4f7f\u7528 mkdocs/sphinx\uff09\u901a\u8fc7\u3002</p>"},{"location":"zh/cullinan_documentation_plan/#10","title":"10. \u98ce\u9669\u4e0e\u7f13\u89e3\u63aa\u65bd","text":"<p>\u98ce\u9669 1\uff1a\u6e90\u7801\u7406\u89e3\u504f\u5dee\uff08\u53ea\u8bfb\u6e90\u7801\u3001\u4e0d\u770b\u6ce8\u91ca\u53ef\u80fd\u4e22\u5931\u8bbe\u8ba1\u80cc\u666f\uff09 - \u7f13\u89e3\uff1a\u4ee5\u6d4b\u8bd5\u7528\u4f8b\u4e3a\u884c\u4e3a\u89c4\u8303\uff0c\u5fc5\u8981\u65f6\u5728\u5ba1\u9605\u9636\u6bb5\u5411\u539f\u4f5c\u8005\u786e\u8ba4\u8bbe\u8ba1\u610f\u56fe\uff0c\u5e76\u8bb0\u5f55\u4e3a\u201c\u4f5c\u8005\u8bf4\u660e\u201d\u9644\u5f55\uff08\u4e0d\u4fee\u6539\u6e90\u7801\uff09\u3002</p> <p>\u98ce\u9669 2\uff1aIoC/DI \u8bbe\u8ba1\u590d\u6742\uff0c\u96be\u4ee5\u76f4\u89c2\u8868\u8fbe - \u7f13\u89e3\uff1a\u4f7f\u7528\u6d41\u7a0b\u56fe\u3001\u987a\u5e8f\u56fe\u548c\u793a\u4f8b\u4ee3\u7801\u6f14\u793a\u6ce8\u5165\u65f6\u5e8f\uff1b\u5728 <code>docs/wiki/injection.md</code> \u4e2d\u589e\u52a0\u201c\u5e38\u89c1\u6a21\u5f0f/\u53cd\u6a21\u5f0f\u201d\u5c0f\u8282\u3002</p> <p>\u98ce\u9669 3\uff1a\u4e2d\u82f1\u6587\u7ffb\u8bd1\u4e0d\u4e00\u81f4\u6216\u672f\u8bed\u4e0d\u7edf\u4e00 - \u7f13\u89e3\uff1a\u7ef4\u62a4\u201c\u672f\u8bed\u5bf9\u7167\u8868\u201d\uff1b\u5148\u5b8c\u6210\u82f1\u6587\u5e76\u5ba1\u6821\uff0c\u518d\u7531\u7ffb\u8bd1\u4eba\u5458\u5bf9\u7167\u9010\u6761\u7ffb\u8bd1\u5e76\u590d\u6838\u3002</p> <p>\u98ce\u9669 4\uff1a\u793a\u4f8b\u5728 Windows \u73af\u5883\u4e0b\u4e0d\u53ef\u8fd0\u884c - \u7f13\u89e3\uff1a\u5728 Windows PowerShell v5.1 \u4e0b\u6d4b\u8bd5\u6240\u6709\u793a\u4f8b\uff0c\u5e76\u5728 <code>build_run.md</code> \u4e2d\u7ed9\u51fa PowerShell \u4e13\u7528\u547d\u4ee4\uff08\u4f7f\u7528\u5206\u53f7 <code>;</code>\uff0c\u907f\u514d <code>&amp;&amp;</code>\uff09\u3002</p> <p>\u98ce\u9669 5\uff1a\u81ea\u52a8\u751f\u6210 API \u5de5\u5177\u914d\u7f6e\u590d\u6742 - \u7f13\u89e3\uff1a\u5982\u81ea\u52a8\u5316\u6210\u672c\u8fc7\u9ad8\uff0c\u53ef\u91c7\u7528\u534a\u81ea\u52a8\u5316\u65b9\u6848\uff08\u811a\u672c\u63d0\u53d6\u516c\u6709\u7b26\u53f7\u5e76\u751f\u6210\u6a21\u677f\uff09\u6216\u624b\u5de5\u8865\u5168\u5173\u952e\u6a21\u5757\u3002</p>"},{"location":"zh/cullinan_documentation_plan/#11-powershell-v51","title":"11. \u5fc5\u8981\u7684\u547d\u4ee4\u4e0e\u5de5\u5177\uff08PowerShell v5.1 \u793a\u4f8b\u8bf4\u660e\uff09","text":"<ul> <li>\u5efa\u8bae\u5f00\u53d1\u73af\u5883\u5de5\u5177\uff1aPython 3.8+\uff08\u9879\u76ee\u5f53\u524d\u8981\u6c42\u8bf7\u6838\u5bf9 <code>setup.py</code>\uff09\uff0cpytest\uff0cmkdocs/sphinx\uff0cmarkdownlint\uff0cTypora/VSCode\uff08\u7528\u4e8e\u6821\u5bf9\uff09\uff0c\u53ef\u9009\uff1agraphviz\uff08\u7ed8\u5236\u4f9d\u8d56\u56fe\uff09\u3002</li> <li>\u865a\u62df\u73af\u5883\uff08\u793a\u4f8b\u8bf4\u660e\uff09\uff1a\u5982\u9700\u5728\u672c\u5730\u521b\u5efa\u865a\u62df\u73af\u5883\uff0c\u8bf7\u53c2\u8003\u4f7f\u7528\u7684\u5e73\u53f0\u548c\u504f\u597d\uff1b\u6587\u6863\u793a\u4f8b\u7edf\u4e00\u4f7f\u7528 <code>pip</code> \u547d\u4ee4\uff0c\u5047\u5b9a\u5df2\u6709\u53ef\u7528\u7684 Python \u73af\u5883\u3002</li> <li>\u5b89\u88c5\u5f00\u53d1\u4f9d\u8d56\uff1a<code>pip install -U pip; pip install -e .[dev]</code>\uff08\u6216 <code>pip install -e .</code>\uff09</li> <li>\u8fd0\u884c\u6d4b\u8bd5\uff1a<code>py -3 -m pytest -q</code></li> <li>\u8fd0\u884c\u5355\u4e2a\u793a\u4f8b\uff08\u793a\u4f8b\u4f4d\u4e8e <code>examples/hello.py</code>\uff09\uff1a<code>py examples\\hello.py</code></li> <li>\u82e5\u4f7f\u7528\u6587\u6863\u5de5\u5177\uff08mkdocs\uff09\u6784\u5efa\u672c\u5730\u9884\u89c8\uff1a<code>pip install mkdocs mkdocs-material; mkdocs serve</code>\uff08\u5728\u9879\u76ee\u6839\u76ee\u5f55\u6216\u5305\u542b <code>mkdocs.yml</code> \u7684\u76ee\u5f55\u6267\u884c\uff09</li> </ul>"},{"location":"zh/cullinan_documentation_plan/#12","title":"12. \u4ea4\u4ed8\u7269\u63d0\u4ea4 / \u5408\u5e76\u6d41\u7a0b\u5efa\u8bae","text":"<ul> <li>\u6bcf\u4e2a\u9636\u6bb5\u5b8c\u6210\u540e\u63d0\u4ea4\u4e00\u4e2a\u5355\u72ec\u7684 PR\uff08\u4f8b\u5982 <code>docs/getting-started</code>\u3001<code>docs/wiki-injection</code> \u7b49\uff09\uff0cPR \u5fc5\u987b\u5305\u542b\uff1a\u53d8\u66f4\u8bf4\u660e\u3001\u6d4b\u8bd5/\u793a\u4f8b\u9a8c\u8bc1\u6b65\u9aa4\u3001\u5ba1\u9605\u68c0\u67e5\u6e05\u5355\u3002</li> <li>\u5408\u5e76\u524d\u9700\u901a\u8fc7\u81f3\u5c11\u4e00\u540d\u4ee3\u7801/\u67b6\u6784\u8bc4\u5ba1\u8005\u4e0e\u4e00\u540d\u6587\u6863\u6821\u5bf9\u8005\u7684\u5ba1\u9605\u3002</li> <li>\u53d1\u5e03\u6587\u6863\u7248\u672c\uff08tag\uff09\u540e\u5728 <code>README.MD</code> \u4e2d\u66f4\u65b0\u5bf9\u5e94\u7248\u672c\u94fe\u63a5\u3002</li> </ul> <p>\u5982\u9700\u5c06\u672c\u8ba1\u5212\u8fdb\u4e00\u6b65\u62c6\u5206\u4e3a\u5177\u4f53\u7684 <code>docs/</code> \u6587\u4ef6\u6a21\u677f\uff0c\u5e76\u4e3a\u6bcf\u4e2a\u6587\u4ef6\u751f\u6210\u521d\u59cb\u5360\u4f4d\u5185\u5bb9\uff08\u82f1\u6587 + \u4e2d\u6587\u5360\u4f4d\uff09\uff0c\u53ef\u4ee5\u57fa\u4e8e\u672c\u8ba1\u5212\u7ee7\u7eed\u5b9e\u65bd\u5e76\u521b\u5efa\u8fd9\u4e9b\u6587\u4ef6\u3002</p>"},{"location":"zh/dependency_injection_guide/","title":"Cullinan \u4f9d\u8d56\u6ce8\u5165\u7cfb\u7edf\u6307\u5357","text":"<p>\u7248\u672c: v0.9 \u4f5c\u8005: Plumeink \u6700\u540e\u66f4\u65b0: 2025-12-24</p>"},{"location":"zh/dependency_injection_guide/#_1","title":"\u6982\u8ff0","text":"<p>Cullinan \u63d0\u4f9b\u4e86\u4e00\u4e2a\u5f3a\u5927\u7684\u4f9d\u8d56\u6ce8\u5165\uff08DI\uff09\u7cfb\u7edf\uff0c\u652f\u6301\u591a\u79cd\u6ce8\u5165\u65b9\u5f0f\uff0c\u5e76\u5728 v0.9 \u4e2d\u5f15\u5165\u4e86\u7edf\u4e00\u7684\u6ce8\u5165\u6a21\u578b\u3002\u672c\u6307\u5357\u5c06\u5e2e\u52a9\u60a8\u7406\u89e3\u548c\u4f7f\u7528\u8fd9\u4e9b\u529f\u80fd\u3002</p>"},{"location":"zh/dependency_injection_guide/#_2","title":"\u76ee\u5f55","text":"<ol> <li>\u57fa\u7840\u6982\u5ff5</li> <li>\u4e09\u79cd\u6ce8\u5165\u65b9\u5f0f</li> <li>\u7edf\u4e00\u6ce8\u5165\u6a21\u578b</li> <li>\u9ad8\u7ea7\u7279\u6027</li> <li>\u6700\u4f73\u5b9e\u8df5</li> <li>\u8fc1\u79fb\u6307\u5357</li> </ol>"},{"location":"zh/dependency_injection_guide/#basics","title":"\u57fa\u7840\u6982\u5ff5","text":""},{"location":"zh/dependency_injection_guide/#_3","title":"\u4ec0\u4e48\u662f\u4f9d\u8d56\u6ce8\u5165\uff1f","text":"<p>\u4f9d\u8d56\u6ce8\u5165\u662f\u4e00\u79cd\u8bbe\u8ba1\u6a21\u5f0f\uff0c\u7528\u4e8e\u5b9e\u73b0\u63a7\u5236\u53cd\u8f6c\uff08IoC\uff09\u3002\u7b80\u5355\u6765\u8bf4\uff0c\u5c31\u662f\u8ba9\u6846\u67b6\u81ea\u52a8\u4e3a\u60a8\u7684\u7c7b\u6ce8\u5165\u6240\u9700\u7684\u4f9d\u8d56\uff0c\u800c\u4e0d\u662f\u5728\u7c7b\u5185\u90e8\u624b\u52a8\u521b\u5efa\u3002</p>"},{"location":"zh/dependency_injection_guide/#_4","title":"\u4e3a\u4ec0\u4e48\u4f7f\u7528\u4f9d\u8d56\u6ce8\u5165\uff1f","text":"<p>\u2705 \u677e\u8026\u5408\uff1a\u7c7b\u4e4b\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\u66f4\u6e05\u6670 \u2705 \u6613\u6d4b\u8bd5\uff1a\u53ef\u4ee5\u8f7b\u677e\u66ff\u6362\u4f9d\u8d56\u8fdb\u884c\u5355\u5143\u6d4b\u8bd5 \u2705 \u6613\u7ef4\u62a4\uff1a\u4f9d\u8d56\u5173\u7cfb\u96c6\u4e2d\u7ba1\u7406 \u2705 \u53ef\u6269\u5c55\uff1a\u8f7b\u677e\u6dfb\u52a0\u65b0\u7684\u670d\u52a1\u548c\u7ec4\u4ef6</p>"},{"location":"zh/dependency_injection_guide/#three-injection-methods","title":"\u4e09\u79cd\u6ce8\u5165\u65b9\u5f0f","text":"<p>Cullinan \u652f\u6301\u4e09\u79cd\u4f9d\u8d56\u6ce8\u5165\u65b9\u5f0f\uff0c\u5b83\u4eec\u90fd\u5df2\u7edf\u4e00\u5230\u65b0\u7684\u6ce8\u5165\u6a21\u578b\u4e2d\u3002</p>"},{"location":"zh/dependency_injection_guide/#1-inject-","title":"1. Inject() - \u7c7b\u578b\u6ce8\u89e3\u6ce8\u5165","text":"<p>\u63a8\u8350\u6307\u6570: \u2b50\u2b50\u2b50\u2b50\u2b50</p> <p>\u4f7f\u7528\u7c7b\u578b\u6ce8\u89e3\u7684\u65b9\u5f0f\uff0c\u63d0\u4f9b\u6700\u4f73\u7684 IDE \u652f\u6301\u548c\u7c7b\u578b\u5b89\u5168\u3002</p> <pre><code>from cullinan.core import Inject\nfrom cullinan.service import service\n\n@service\nclass DatabaseService:\n    def query(self, sql: str):\n        return f\"Result: {sql}\"\n\n@service\nclass UserService:\n    # \u4f7f\u7528\u7c7b\u578b\u6ce8\u89e3 + Inject()\n    database: DatabaseService = Inject()\n\n    def get_user(self, user_id: int):\n        return self.database.query(f\"SELECT * FROM users WHERE id={user_id}\")\n</code></pre> <p>\u7279\u70b9\uff1a - \u2705 IDE \u81ea\u52a8\u8865\u5168 - \u2705 \u7c7b\u578b\u68c0\u67e5 - \u2705 \u81ea\u52a8\u63a8\u65ad\u4f9d\u8d56\u540d\u79f0 - \u2705 \u652f\u6301\u53ef\u9009\u4f9d\u8d56</p> <p>\u53ef\u9009\u4f9d\u8d56\uff1a <pre><code>class UserService:\n    database: DatabaseService = Inject()\n    cache: CacheService = Inject(required=False)  # \u53ef\u9009\u4f9d\u8d56\n\n    def get_user(self, user_id: int):\n        # cache \u53ef\u80fd\u4e3a None\n        if self.cache:\n            return self.cache.get(f\"user_{user_id}\")\n        return self.database.query(...)\n</code></pre></p>"},{"location":"zh/dependency_injection_guide/#2-injectbyname-","title":"2. InjectByName() - \u5b57\u7b26\u4e32\u540d\u79f0\u6ce8\u5165","text":"<p>\u63a8\u8350\u6307\u6570: \u2b50\u2b50\u2b50\u2b50</p> <p>\u4f7f\u7528\u5b57\u7b26\u4e32\u540d\u79f0\u7684\u65b9\u5f0f\uff0c\u5b8c\u5168\u65e0\u9700 import \u4f9d\u8d56\u7c7b\u3002</p> <pre><code>from cullinan.controller import controller\nfrom cullinan.core import InjectByName\n\n@controller(url='/api')\nclass UserController:\n    # \u663e\u5f0f\u6307\u5b9a\u540d\u79f0\n    user_service = InjectByName('UserService')\n\n    # \u81ea\u52a8\u63a8\u65ad\u540d\u79f0\uff08email_service \u2192 EmailService\uff09\n    email_service = InjectByName()\n\n    def get_user(self, user_id: int):\n        return self.user_service.get_user(user_id)\n</code></pre> <p>\u7279\u70b9\uff1a - \u2705 \u65e0\u9700 import \u4f9d\u8d56\u7c7b - \u2705 \u907f\u514d\u5faa\u73af\u5bfc\u5165 - \u2705 \u81ea\u52a8\u540d\u79f0\u63a8\u65ad\uff08snake_case \u2192 PascalCase\uff09 - \u2705 \u652f\u6301\u53ef\u9009\u4f9d\u8d56</p> <p>\u81ea\u52a8\u540d\u79f0\u63a8\u65ad\u89c4\u5219\uff1a <pre><code>user_service = InjectByName()  # \u2192 UserService\nemail_service = InjectByName()  # \u2192 EmailService\ncache_manager = InjectByName()  # \u2192 CacheManager\n</code></pre></p>"},{"location":"zh/dependency_injection_guide/#3-injectable-","title":"3. @injectable - \u88c5\u9970\u5668\u6279\u91cf\u6ce8\u5165","text":"<p>\u63a8\u8350\u6307\u6570: \u2b50\u2b50\u2b50\u2b50\u2b50</p> <p>\u4f7f\u7528\u88c5\u9970\u5668\u7684\u65b9\u5f0f\uff0c\u5728\u7c7b\u5b9e\u4f8b\u5316\u65f6\u81ea\u52a8\u6ce8\u5165\u6240\u6709\u4f9d\u8d56\u3002</p> <pre><code>from cullinan.controller import controller\nfrom cullinan.core import injectable, Inject, InjectByName\n\n@injectable\n@controller(url='/api')\nclass UserController:\n    database: DatabaseService = Inject()\n    cache = InjectByName('CacheService')\n    logger = InjectByName('LogService', required=False)\n\n    def __init__(self):\n        # __init__ \u6267\u884c\u540e\uff0c\u6240\u6709\u4f9d\u8d56\u81ea\u52a8\u6ce8\u5165\n        pass\n\n    def get_user(self, user_id: int):\n        # \u6b64\u65f6 database\u3001cache \u5df2\u7ecf\u53ef\u7528\n        result = self.database.query(...)\n        if self.cache:\n            self.cache.set(f\"user_{user_id}\", result)\n        return result\n</code></pre> <p>\u7279\u70b9\uff1a - \u2705 \u81ea\u52a8\u6279\u91cf\u6ce8\u5165 - \u2705 \u652f\u6301\u6df7\u5408\u4f7f\u7528 Inject \u548c InjectByName - \u2705 \u5728 init \u540e\u7acb\u5373\u6ce8\u5165 - \u2705 \u4e0e @service\u3001@controller \u88c5\u9970\u5668\u517c\u5bb9</p>"},{"location":"zh/dependency_injection_guide/#unified-model","title":"\u7edf\u4e00\u6ce8\u5165\u6a21\u578b","text":""},{"location":"zh/dependency_injection_guide/#_5","title":"\u65b0\u67b6\u6784\u6982\u89c8","text":"<p>\u4ece v0.9 \u5f00\u59cb\uff0cCullinan \u5f15\u5165\u4e86\u7edf\u4e00\u7684\u6ce8\u5165\u6a21\u578b\uff0c\u6240\u6709\u6ce8\u5165\u65b9\u5f0f\u90fd\u57fa\u4e8e\u76f8\u540c\u7684\u5e95\u5c42\u67b6\u6784\uff1a</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  \u5e94\u7528\u5c42 (Inject / InjectByName / @injectable) \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                   \u2502\n                   \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  InjectionPoint (\u7edf\u4e00\u5143\u4fe1\u606f\u6a21\u578b)        \u2502\n\u2502  - attr_name: \u5c5e\u6027\u540d                    \u2502\n\u2502  - dependency_name: \u4f9d\u8d56\u540d\u79f0            \u2502\n\u2502  - required: \u662f\u5426\u5fc5\u9700                   \u2502\n\u2502  - attr_type: \u7c7b\u578b\u6ce8\u89e3                  \u2502\n\u2502  - resolve_strategy: \u89e3\u6790\u7b56\u7565           \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                   \u2502\n                   \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  InjectionExecutor (\u7edf\u4e00\u6267\u884c\u5668)         \u2502\n\u2502  - resolve_injection_point()            \u2502\n\u2502  - inject_instance()                    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                   \u2502\n                   \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  ServiceRegistry / ProviderRegistry     \u2502\n\u2502  (\u670d\u52a1\u63d0\u4f9b\u8005)                           \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"zh/dependency_injection_guide/#_6","title":"\u89e3\u6790\u7b56\u7565","text":"<p>\u65b0\u6a21\u578b\u652f\u6301\u4e09\u79cd\u89e3\u6790\u7b56\u7565\uff1a</p>"},{"location":"zh/dependency_injection_guide/#auto","title":"AUTO\uff08\u81ea\u52a8\u63a8\u65ad\uff09","text":"<pre><code># \u4f7f\u7528 Inject() \u65f6\u7684\u9ed8\u8ba4\u7b56\u7565\nuser_service: UserService = Inject()\n# \u7b56\u7565\uff1a\u4f18\u5148\u6309\u7c7b\u578b\uff08UserService\uff09\uff0c\u56de\u9000\u5230\u540d\u79f0\uff08'UserService'\uff09\n</code></pre>"},{"location":"zh/dependency_injection_guide/#by_type","title":"BY_TYPE\uff08\u6309\u7c7b\u578b\uff09","text":"<pre><code># \u5f3a\u5236\u6309\u7c7b\u578b\u89e3\u6790\nuser_service: UserService = Inject()\n# \u53ea\u4f1a\u67e5\u627e\u7c7b\u578b\u4e3a UserService \u7684\u670d\u52a1\n</code></pre>"},{"location":"zh/dependency_injection_guide/#by_name","title":"BY_NAME\uff08\u6309\u540d\u79f0\uff09","text":"<pre><code># \u4f7f\u7528 InjectByName \u65f6\u7684\u7b56\u7565\nuser_service = InjectByName('UserService')\n# \u53ea\u4f1a\u67e5\u627e\u540d\u79f0\u4e3a 'UserService' \u7684\u670d\u52a1\n</code></pre>"},{"location":"zh/dependency_injection_guide/#_7","title":"\u6027\u80fd\u7279\u6027","text":"<p>\u65b0\u7684\u7edf\u4e00\u6a21\u578b\u63d0\u4f9b\u4e86\u51fa\u8272\u7684\u6027\u80fd\uff1a</p> <ul> <li>\u7f13\u5b58\u673a\u5236\uff1a\u6ce8\u5165\u540e\u7684\u4f9d\u8d56\u4f1a\u7f13\u5b58\u5230\u5b9e\u4f8b\uff0c\u907f\u514d\u91cd\u590d\u89e3\u6790</li> <li>\u5ef6\u8fdf\u6ce8\u5165\uff1a\u53ea\u5728\u9996\u6b21\u8bbf\u95ee\u65f6\u624d\u89e3\u6790\u4f9d\u8d56</li> <li>\u6279\u91cf\u6ce8\u5165\uff1a@injectable \u4e00\u6b21\u6027\u6ce8\u5165\u6240\u6709\u4f9d\u8d56\uff0c\u51cf\u5c11\u5f00\u9500</li> </ul>"},{"location":"zh/dependency_injection_guide/#advanced-features","title":"\u9ad8\u7ea7\u7279\u6027","text":""},{"location":"zh/dependency_injection_guide/#1","title":"1. \u5d4c\u5957\u4f9d\u8d56","text":"<p>\u670d\u52a1\u53ef\u4ee5\u4f9d\u8d56\u5176\u4ed6\u670d\u52a1\uff0c\u5f62\u6210\u4f9d\u8d56\u94fe\uff1a</p> <pre><code>@service\nclass DatabaseService:\n    pass\n\n@service\nclass CacheService:\n    pass\n\n@service\n@injectable\nclass DataAccessLayer:\n    database: DatabaseService = Inject()\n    cache: CacheService = Inject()\n\n    def fetch(self, key):\n        # \u5148\u67e5\u7f13\u5b58\n        if self.cache:\n            return self.cache.get(key)\n        # \u518d\u67e5\u6570\u636e\u5e93\n        return self.database.query(...)\n\n@injectable\nclass BusinessLogic:\n    dal: DataAccessLayer = Inject()\n\n    def process(self, key):\n        return self.dal.fetch(key)\n</code></pre>"},{"location":"zh/dependency_injection_guide/#2","title":"2. \u5faa\u73af\u4f9d\u8d56\u68c0\u6d4b","text":"<p>\u6846\u67b6\u4f1a\u81ea\u52a8\u68c0\u6d4b\u5e76\u963b\u6b62\u5faa\u73af\u4f9d\u8d56\uff1a</p> <pre><code>@service\n@injectable\nclass ServiceA:\n    b: ServiceB = Inject()\n\n@service\n@injectable\nclass ServiceB:\n    a: ServiceA = Inject()  # \u274c \u4f1a\u629b\u51fa CircularDependencyError\n</code></pre> <p>\u89e3\u51b3\u65b9\u6848\uff1a 1. \u91cd\u65b0\u8bbe\u8ba1\u4f9d\u8d56\u5173\u7cfb 2. \u4f7f\u7528\u5ef6\u8fdf\u6ce8\u5165 3. \u5f15\u5165\u4e2d\u95f4\u5c42\u6253\u7834\u5faa\u73af</p>"},{"location":"zh/dependency_injection_guide/#3","title":"3. \u5b57\u7b26\u4e32\u6ce8\u89e3\u652f\u6301","text":"<p>\u652f\u6301\u4f7f\u7528\u5b57\u7b26\u4e32\u7c7b\u578b\u6ce8\u89e3\uff08\u907f\u514d\u5faa\u73af\u5bfc\u5165\uff09\uff1a</p> <pre><code>from __future__ import annotations\n\n@injectable\nclass UserController:\n    # \u4f7f\u7528\u5b57\u7b26\u4e32\u6ce8\u89e3\uff08Python 3.7+\uff09\n    user_service: 'UserService' = Inject()\n</code></pre>"},{"location":"zh/dependency_injection_guide/#4-mock","title":"4. \u6d4b\u8bd5 Mock","text":"<p>\u6240\u6709\u6ce8\u5165\u65b9\u5f0f\u90fd\u652f\u6301\u624b\u52a8\u8bbe\u7f6e\uff08\u4fbf\u4e8e\u6d4b\u8bd5\uff09\uff1a</p> <pre><code>def test_user_controller():\n    controller = UserController()\n\n    # \u624b\u52a8\u6ce8\u5165 Mock \u5bf9\u8c61\n    controller.user_service = MockUserService()\n\n    # \u6d4b\u8bd5\u4e1a\u52a1\u903b\u8f91\n    result = controller.get_user(123)\n    assert result == expected_value\n</code></pre>"},{"location":"zh/dependency_injection_guide/#best-practices","title":"\u6700\u4f73\u5b9e\u8df5","text":""},{"location":"zh/dependency_injection_guide/#_8","title":"\u2705 \u63a8\u8350\u505a\u6cd5","text":""},{"location":"zh/dependency_injection_guide/#1-inject","title":"1. \u4f18\u5148\u4f7f\u7528 Inject() + \u7c7b\u578b\u6ce8\u89e3","text":"<pre><code>@injectable\nclass UserService:\n    database: DatabaseService = Inject()  # \u2705 \u63a8\u8350\n    cache: CacheService = Inject()\n</code></pre>"},{"location":"zh/dependency_injection_guide/#2_1","title":"2. \u660e\u786e\u6807\u8bb0\u53ef\u9009\u4f9d\u8d56","text":"<pre><code>class UserService:\n    database: DatabaseService = Inject()  # \u5fc5\u9700\n    cache: CacheService = Inject(required=False)  # \u53ef\u9009\n</code></pre>"},{"location":"zh/dependency_injection_guide/#3-injectable","title":"3. \u4f7f\u7528 @injectable \u7b80\u5316\u6ce8\u5165","text":"<pre><code>@injectable\nclass UserController:\n    user_service: UserService = Inject()\n    # \u81ea\u52a8\u6ce8\u5165\uff0c\u65e0\u9700\u624b\u52a8\u8c03\u7528\n</code></pre>"},{"location":"zh/dependency_injection_guide/#4-service","title":"4. \u670d\u52a1\u7c7b\u4f7f\u7528 @service \u88c5\u9970\u5668","text":"<pre><code>@service  # \u81ea\u52a8\u6ce8\u518c\u5230 ServiceRegistry\n@injectable  # \u652f\u6301\u4f9d\u8d56\u6ce8\u5165\nclass UserService:\n    database: DatabaseService = Inject()\n</code></pre>"},{"location":"zh/dependency_injection_guide/#_9","title":"\u274c \u907f\u514d\u505a\u6cd5","text":""},{"location":"zh/dependency_injection_guide/#1_1","title":"1. \u907f\u514d\u5728\u6784\u9020\u51fd\u6570\u4e2d\u8bbf\u95ee\u4f9d\u8d56","text":"<pre><code>@injectable\nclass UserService:\n    database: DatabaseService = Inject()\n\n    def __init__(self):\n        # \u274c \u6b64\u65f6 database \u8fd8\u672a\u6ce8\u5165\n        # self.database.query(...)  \n        pass\n\n    def get_user(self, user_id):\n        # \u2705 \u6b64\u65f6\u53ef\u4ee5\u5b89\u5168\u8bbf\u95ee\n        return self.database.query(...)\n</code></pre>"},{"location":"zh/dependency_injection_guide/#2_2","title":"2. \u907f\u514d\u5faa\u73af\u4f9d\u8d56","text":"<pre><code># \u274c \u9519\u8bef\uff1a\u5faa\u73af\u4f9d\u8d56\n@service\nclass ServiceA:\n    b: ServiceB = Inject()\n\n@service\nclass ServiceB:\n    a: ServiceA = Inject()\n</code></pre>"},{"location":"zh/dependency_injection_guide/#3-injectbyname","title":"3. \u907f\u514d\u8fc7\u5ea6\u4f7f\u7528 InjectByName","text":"<pre><code># \u274c \u4e0d\u63a8\u8350\uff1a\u5931\u53bb\u7c7b\u578b\u5b89\u5168\nuser_service = InjectByName('UserService')\n\n# \u2705 \u63a8\u8350\uff1a\u6709\u7c7b\u578b\u68c0\ufffd\ufffd\nuser_service: UserService = Inject()\n</code></pre>"},{"location":"zh/dependency_injection_guide/#migration-guide","title":"\u8fc1\u79fb\u6307\u5357","text":""},{"location":"zh/dependency_injection_guide/#_10","title":"\u4ece\u65e7\u4ee3\u7801\u8fc1\u79fb","text":"<p>\u5982\u679c\u60a8\u7684\u4ee3\u7801\u4f7f\u7528\u4e86\u65e7\u7684\u6ce8\u5165\u65b9\u5f0f\uff0c\u65e0\u9700\u4fee\u6539\uff01\u65b0\u7684\u7edf\u4e00\u6a21\u578b\u5b8c\u5168\u5411\u540e\u517c\u5bb9\u3002</p>"},{"location":"zh/dependency_injection_guide/#_11","title":"\u65e7\u4ee3\u7801\u7ee7\u7eed\u5de5\u4f5c","text":"<pre><code># \u65e7\u4ee3\u7801 - \u4ecd\u7136\u5de5\u4f5c\n@injectable\nclass UserService:\n    database: DatabaseService = Inject()\n\n# \u65b0\u4ee3\u7801 - \u5b8c\u5168\u76f8\u540c\u7684\u8bed\u6cd5\n@injectable\nclass UserService:\n    database: DatabaseService = Inject()\n</code></pre>"},{"location":"zh/dependency_injection_guide/#_12","title":"\u5411\u540e\u517c\u5bb9\u673a\u5236","text":"<p>\u6846\u67b6\u5185\u90e8\u4f7f\u7528\u4e86\u5411\u540e\u517c\u5bb9\u673a\u5236\uff1a 1. \u4f18\u5148\u5c1d\u8bd5\u65b0\u6a21\u578b\uff08InjectionExecutor\uff09 2. \u5931\u8d25\u65f6\u81ea\u52a8\u56de\u9000\u5230\u65e7\u903b\u8f91\uff08registry.inject()\uff09 3. \u5b8c\u5168\u900f\u660e\uff0c\u7528\u6237\u65e0\u611f\u77e5</p> <p>\u8fd9\u4e9b\u5411\u540e\u517c\u5bb9\u4ee3\u7801\u5728\u6e90\u7801\u4e2d\u6807\u8bb0\u4e3a\uff1a <pre><code># BACKWARD_COMPAT: v0.8 - \u4fdd\u7559\u65e7\u7684\u6ce8\u5165\u903b\u8f91\n# \u8ba1\u5212\u79fb\u9664\u7248\u672c\uff1av1.0\n</code></pre></p>"},{"location":"zh/dependency_injection_guide/#_13","title":"\u5347\u7ea7\u5efa\u8bae","text":"<p>\u867d\u7136\u65e7\u4ee3\u7801\u7ee7\u7eed\u5de5\u4f5c\uff0c\u4f46\u5efa\u8bae\uff1a</p> <ol> <li>\u65b0\u9879\u76ee\uff1a\u76f4\u63a5\u4f7f\u7528\u65b0\u7684\u63a8\u8350\u6a21\u5f0f</li> <li>\u73b0\u6709\u9879\u76ee\uff1a\u9010\u6b65\u8fc1\u79fb\uff0c\u65e0\u9700\u6025\u4e8e\u4e00\u6b21\u6027\u6539\u5b8c</li> <li>\u5173\u6ce8\u6027\u80fd\uff1a\u65b0\u6a21\u578b\u5728\u5927\u591a\u6570\u573a\u666f\u4e0b\u6027\u80fd\u66f4\u4f18</li> </ol>"},{"location":"zh/dependency_injection_guide/#_14","title":"\u5e38\u89c1\u95ee\u9898","text":""},{"location":"zh/dependency_injection_guide/#q","title":"Q: \u4e09\u79cd\u6ce8\u5165\u65b9\u5f0f\u5e94\u8be5\u7528\u54ea\u4e2a\uff1f","text":"<p>A: \u63a8\u8350\u987a\u5e8f\uff1a 1. Inject() + \u7c7b\u578b\u6ce8\u89e3\uff1a\u6700\u63a8\u8350\uff0c\u7c7b\u578b\u5b89\u5168 2. @injectable + \u6df7\u5408\u4f7f\u7528\uff1a\u7b80\u5316\u4ee3\u7801 3. InjectByName\uff1a\u907f\u514d\u5faa\u73af\u5bfc\u5165\u65f6\u4f7f\u7528</p>"},{"location":"zh/dependency_injection_guide/#q_1","title":"Q: \u4ec0\u4e48\u65f6\u5019\u4f9d\u8d56\u4f1a\u88ab\u6ce8\u5165\uff1f","text":"<p>A:  - Inject/InjectByName\uff1a\u9996\u6b21\u8bbf\u95ee\u5c5e\u6027\u65f6\uff08\u5ef6\u8fdf\u6ce8\u5165\uff09 - @injectable\uff1ainit \u65b9\u6cd5\u6267\u884c\u540e\uff08\u6279\u91cf\u6ce8\u5165\uff09</p>"},{"location":"zh/dependency_injection_guide/#q_2","title":"Q: \u5982\u4f55\u5904\u7406\u53ef\u9009\u4f9d\u8d56\uff1f","text":"<p>A:  <pre><code>cache: CacheService = Inject(required=False)\n\nif self.cache:  # \u68c0\u67e5\u662f\u5426\u4e3a None\n    self.cache.set(key, value)\n</code></pre></p>"},{"location":"zh/dependency_injection_guide/#q_3","title":"Q: \u5982\u4f55\u907f\u514d\u5faa\u73af\u4f9d\u8d56\uff1f","text":"<p>A: 1. \u91cd\u65b0\u8bbe\u8ba1\u4f9d\u8d56\u5173\u7cfb 2. \u4f7f\u7528\u4e8b\u4ef6\u7cfb\u7edf\u89e3\u8026 3. \u5f15\u5165\u4e2d\u95f4\u5c42/Facade</p>"},{"location":"zh/dependency_injection_guide/#q_4","title":"Q: \u6027\u80fd\u5982\u4f55\uff1f","text":"<p>A: \u65b0\u6a21\u578b\u6027\u80fd\u4f18\u5f02\uff1a - \u7f13\u5b58\u547d\u4e2d\uff1a&lt; 1 \u03bcs - \u9996\u6b21\u89e3\u6790\uff1a10-50 \u03bcs - \u4e0e\u65e7\u6a21\u578b\u76f8\u5f53\u6216\u66f4\u4f18</p>"},{"location":"zh/dependency_injection_guide/#_15","title":"\u5b8c\u6574\u793a\u4f8b","text":""},{"location":"zh/dependency_injection_guide/#1_2","title":"\u793a\u4f8b 1\uff1a\u7b80\u5355\u7684\u4e09\u5c42\u67b6\u6784","text":"<pre><code>from cullinan.core import Inject, injectable\nfrom cullinan.service import service\n\n# \u6570\u636e\u8bbf\u95ee\u5c42\n@service\nclass DatabaseService:\n    def query(self, sql: str):\n        return f\"Query result: {sql}\"\n\n# \u4e1a\u52a1\u903b\u8f91\u5c42\n@service\n@injectable\nclass UserService:\n    database: DatabaseService = Inject()\n\n    def get_user(self, user_id: int):\n        return self.database.query(\n            f\"SELECT * FROM users WHERE id={user_id}\"\n        )\n\n    def create_user(self, username: str):\n        return self.database.query(\n            f\"INSERT INTO users (username) VALUES ('{username}')\"\n        )\n\n# \u63a7\u5236\u5668\u5c42\n@injectable\nclass UserController:\n    user_service: UserService = Inject()\n\n    def get(self, user_id: int):\n        return self.user_service.get_user(user_id)\n\n    def post(self, username: str):\n        return self.user_service.create_user(username)\n</code></pre>"},{"location":"zh/dependency_injection_guide/#2_3","title":"\u793a\u4f8b 2\uff1a\u5e26\u7f13\u5b58\u7684\u590d\u6742\u573a\u666f","text":"<pre><code>from cullinan.core import Inject, InjectByName, injectable\nfrom cullinan.service import service\n\n@service\nclass CacheService:\n    def get(self, key): pass\n    def set(self, key, value): pass\n\n@service\nclass LogService:\n    def log(self, message): pass\n\n@service\n@injectable\nclass UserService:\n    database: DatabaseService = Inject()\n    cache: CacheService = Inject(required=False)\n    logger = InjectByName('LogService', required=False)\n\n    def get_user(self, user_id: int):\n        # \u5c1d\u8bd5\u4ece\u7f13\u5b58\u83b7\u53d6\n        if self.cache:\n            cached = self.cache.get(f\"user_{user_id}\")\n            if cached:\n                if self.logger:\n                    self.logger.log(f\"Cache hit: user_{user_id}\")\n                return cached\n\n        # \u4ece\u6570\u636e\u5e93\u67e5\u8be2\n        result = self.database.query(\n            f\"SELECT * FROM users WHERE id={user_id}\"\n        )\n\n        # \u5199\u5165\u7f13\u5b58\n        if self.cache:\n            self.cache.set(f\"user_{user_id}\", result)\n\n        return result\n</code></pre>"},{"location":"zh/dependency_injection_guide/#_16","title":"\u53c2\u8003\u8d44\u6599","text":"<ul> <li>\u67b6\u6784\u6587\u6863</li> <li>\u6269\u5c55\u5f00\u53d1\u6307\u5357</li> <li>API \u53c2\u8003</li> </ul> <p>\u66f4\u65b0\u65e5\u5fd7: - 2025-12-24: \u521b\u5efa\u6587\u6863\uff0c\u8986\u76d6 v0.9 \u7edf\u4e00\u6ce8\u5165\u6a21\u578b - \u672a\u6765\uff1a\u6301\u7eed\u66f4\u65b0\u6700\u4f73\u5b9e\u8df5\u548c\u793a\u4f8b</p>"},{"location":"zh/examples/","title":"\u793a\u4f8b\u4e0e\u6f14\u793a","text":"<p>\u8bf4\u660e\uff08v0.90\uff09\uff1a\u4ee5\u4e0b\u90e8\u5206\u793a\u4f8b\u4f7f\u7528\u65e7\u7248 1.x DI API\u3002 \u65b0\u7684 2.0 API \u793a\u4f8b\u8bf7\u53c2\u9605 \u4f9d\u8d56\u6ce8\u5165\u6307\u5357\u3002 \u65b0\u9879\u76ee\u5e94\u4f7f\u7528 <code>cullinan.core.container</code> \u4e2d\u7684 <code>ApplicationContext</code>\u3002</p> <p>\u672c\u6587\u5217\u51fa\u4e86 Cullinan \u4ed3\u5e93\u4e2d\u7ef4\u62a4\u7684\u53ef\u8fd0\u884c\u793a\u4f8b\u3002\u6bcf\u4e2a\u793a\u4f8b\u5305\u542b\uff1a\u8def\u5f84\u3001\u7b80\u8981\u8bf4\u660e\uff0c\u4ee5\u53ca\u5728\u5e38\u89c1\u5e73\u53f0\u4e0a\u7684\u8fd0\u884c\u65b9\u5f0f\u3002</p>"},{"location":"zh/examples/#hello-http","title":"Hello HTTP","text":"<ul> <li>\u8def\u5f84\uff1a<code>examples/hello_http.py</code></li> <li>\u8bf4\u660e\uff1a\u6700\u5c0f\u5316\u7684 HTTP \u670d\u52a1\uff0c\u8fd4\u56de\u7b80\u5355\u95ee\u5019\u3002</li> </ul>"},{"location":"zh/examples/#_2","title":"\u8fd0\u884c\u65b9\u5f0f","text":"<p>\u5728 Windows\uff08PowerShell\uff09\u4e2d\uff1a</p> <pre><code>python examples\\hello_http.py\n</code></pre> <p>\u5728 Linux / macOS \u4e2d\uff1a</p> <pre><code>python examples/hello_http.py\n</code></pre> <p>\u9884\u671f\u884c\u4e3a\uff1a</p> <ul> <li>\u542f\u52a8\u4e00\u4e2a HTTP \u670d\u52a1\u3002</li> <li>\u5728 <code>http://localhost:4080/hello</code> \u4e0a\u63d0\u4f9b\u54cd\u5e94\u3002</li> </ul>"},{"location":"zh/examples/#controller-di-middleware","title":"Controller + DI + Middleware \u793a\u4f8b","text":"<ul> <li>\u8def\u5f84\uff1a<code>examples/controller_di_middleware.py</code></li> <li>\u8bf4\u660e\uff1a\u6f14\u793a\u63a7\u5236\u5668\u3001\u4f9d\u8d56\u6ce8\u5165\u4e0e\u4e2d\u95f4\u4ef6\u7684\u96c6\u6210\u7528\u6cd5\u3002</li> </ul>"},{"location":"zh/examples/#_3","title":"\u8fd0\u884c\u65b9\u5f0f","text":"<p>\u5728 Windows\uff08PowerShell\uff09\u4e2d\uff1a</p> <pre><code>python examples\\controller_di_middleware.py\n</code></pre> <p>\u5728 Linux / macOS \u4e2d\uff1a</p> <pre><code>python examples/controller_di_middleware.py\n</code></pre> <p>\u9884\u671f\u884c\u4e3a\uff1a</p> <ul> <li>\u901a\u8fc7\u4e2d\u95f4\u4ef6\u8bb0\u5f55\u8bf7\u6c42\u5904\u7406\u8fc7\u7a0b\u3002</li> <li>\u5c55\u793a\u6ce8\u5165\u7684\u670d\u52a1\u5982\u4f55\u53c2\u4e0e\u8bf7\u6c42\u5904\u7406\u7ba1\u7ebf\u3002</li> </ul>"},{"location":"zh/extension_development_guide/","title":"Cullinan \u6269\u5c55\u5f00\u53d1\u6307\u5357","text":"<p>\u7248\u672c\uff1av0.81+ \u4f5c\u8005\uff1aPlumeink \u6700\u540e\u66f4\u65b0\uff1a2025-12-16</p>"},{"location":"zh/extension_development_guide/#_1","title":"\u76ee\u5f55","text":"<ol> <li>\u6982\u8ff0</li> <li>\u6269\u5c55\u70b9\u5206\u7c7b</li> <li>\u4e2d\u95f4\u4ef6\u6269\u5c55</li> <li>\u4f9d\u8d56\u6ce8\u5165\u6269\u5c55</li> <li>\u751f\u547d\u5468\u671f\u6269\u5c55</li> <li>\u8def\u7531\u6269\u5c55</li> <li>\u6700\u4f73\u5b9e\u8df5</li> <li>\u5e38\u89c1\u95ee\u9898</li> </ol>"},{"location":"zh/extension_development_guide/#overview","title":"\u6982\u8ff0","text":"<p>Cullinan \u6846\u67b6\u63d0\u4f9b\u4e86\u4e30\u5bcc\u7684\u6269\u5c55\u70b9\uff0c\u5141\u8bb8\u5f00\u53d1\u8005\u5728\u4e0d\u4fee\u6539\u6846\u67b6\u4ee3\u7801\u7684\u524d\u63d0\u4e0b\u5b9a\u5236\u529f\u80fd\u3002\u672c\u6307\u5357\u4ecb\u7ecd\u5982\u4f55\u5f00\u53d1\u5404\u7c7b\u6269\u5c55\u3002</p>"},{"location":"zh/extension_development_guide/#_2","title":"\u6269\u5c55\u7406\u5ff5","text":"<ul> <li>\u975e\u4fb5\u5165\u5f0f\uff1a\u901a\u8fc7\u88c5\u9970\u5668\u3001\u63a5\u53e3\u5b9e\u73b0\u7b49\u65b9\u5f0f\u6269\u5c55</li> <li>\u7edf\u4e00\u6a21\u5f0f\uff1a\u6240\u6709\u6269\u5c55\u4f7f\u7528\u4e00\u81f4\u7684\u6ce8\u518c\u65b9\u5f0f</li> <li>\u53ef\u53d1\u73b0\u6027\uff1a\u6269\u5c55\u70b9\u53ef\u901a\u8fc7 API \u67e5\u8be2</li> <li>\u5411\u540e\u517c\u5bb9\uff1a\u4fdd\u6301\u517c\u5bb9\u6027\uff0c\u4e0d\u7834\u574f\u73b0\u6709\u529f\u80fd</li> </ul>"},{"location":"zh/extension_development_guide/#_3","title":"\u67e5\u8be2\u53ef\u7528\u6269\u5c55\u70b9","text":"<pre><code>from cullinan.extensions import list_extension_points\n\n# \u67e5\u8be2\u6240\u6709\u6269\u5c55\u70b9\nall_points = list_extension_points()\nfor point in all_points:\n    print(f\"{point['category']}: {point['name']}\")\n    print(f\"  {point['description']}\")\n\n# \u67e5\u8be2\u7279\u5b9a\u5206\u7c7b\nmiddleware_points = list_extension_points(category='middleware')\n</code></pre>"},{"location":"zh/extension_development_guide/#extension-categories","title":"\u6269\u5c55\u70b9\u5206\u7c7b","text":"<p>Cullinan \u63d0\u4f9b 6 \u5927\u7c7b\u6269\u5c55\u70b9\uff1a</p> \u5206\u7c7b \u8bf4\u660e \u5178\u578b\u7528\u4f8b Middleware \u8bf7\u6c42/\u54cd\u5e94\u62e6\u622a \u8ba4\u8bc1\u3001\u65e5\u5fd7\u3001CORS Lifecycle \u751f\u547d\u5468\u671f\u94a9\u5b50 \u521d\u59cb\u5316\u3001\u542f\u52a8\u3001\u5173\u95ed Injection \u4f9d\u8d56\u6ce8\u5165 \u81ea\u5b9a\u4e49 Scope\u3001Provider Routing \u8def\u7531\u5904\u7406 \u81ea\u5b9a\u4e49 Handler Configuration \u914d\u7f6e\u7ba1\u7406 \u914d\u7f6e\u6e90\u3001\u73af\u5883\u9002\u914d Handler \u8bf7\u6c42\u5904\u7406\u5668 \u81ea\u5b9a\u4e49\u8bf7\u6c42\u5904\u7406\u903b\u8f91"},{"location":"zh/extension_development_guide/#middleware-extensions","title":"\u4e2d\u95f4\u4ef6\u6269\u5c55","text":""},{"location":"zh/extension_development_guide/#_4","title":"\u57fa\u7840\u6982\u5ff5","text":"<p>\u4e2d\u95f4\u4ef6\u662f\u8bf7\u6c42\u5904\u7406\u7ba1\u9053\u4e2d\u7684\u62e6\u622a\u5668\uff0c\u53ef\u4ee5\uff1a - \u5728\u8bf7\u6c42\u5230\u8fbe Handler \u524d\u8fdb\u884c\u9884\u5904\u7406 - \u5728\u54cd\u5e94\u8fd4\u56de\u5ba2\u6237\u7aef\u524d\u8fdb\u884c\u540e\u5904\u7406 - \u77ed\u8def\u8bf7\u6c42\uff08\u5982\u8ba4\u8bc1\u5931\u8d25\u76f4\u63a5\u8fd4\u56de 401\uff09</p>"},{"location":"zh/extension_development_guide/#_5","title":"\u521b\u5efa\u4e2d\u95f4\u4ef6","text":""},{"location":"zh/extension_development_guide/#_6","title":"\u65b9\u5f0f\u4e00\uff1a\u88c5\u9970\u5668\u6ce8\u518c\uff08\u63a8\u8350\uff09","text":"<pre><code>from cullinan.middleware import middleware, Middleware\n\n@middleware(priority=100)\nclass LoggingMiddleware(Middleware):\n    \"\"\"\u65e5\u5fd7\u4e2d\u95f4\u4ef6\"\"\"\n\n    def process_request(self, handler):\n        # \u8bf7\u6c42\u9884\u5904\u7406\n        print(f\"Request: {handler.request.uri}\")\n        return handler  # \u8fd4\u56de handler \u7ee7\u7eed\u5904\u7406\n\n    def process_response(self, handler, response):\n        # \u54cd\u5e94\u540e\u5904\u7406\n        print(f\"Response: {response}\")\n        return response\n</code></pre>"},{"location":"zh/extension_development_guide/#_7","title":"\u65b9\u5f0f\u4e8c\uff1a\u624b\u52a8\u6ce8\u518c","text":"<pre><code>from cullinan.middleware import Middleware, get_middleware_registry\n\nclass MyMiddleware(Middleware):\n    def process_request(self, handler):\n        return handler\n\n# \u624b\u52a8\u6ce8\u518c\nregistry = get_middleware_registry()\nregistry.register(MyMiddleware, priority=100)\n</code></pre>"},{"location":"zh/extension_development_guide/#_8","title":"\u4f18\u5148\u7ea7\u89c4\u5219","text":"<ul> <li>\u6570\u5b57\u8d8a\u5c0f\uff0c\u8d8a\u5148\u6267\u884c</li> <li>\u63a8\u8350\u8303\u56f4\uff1a</li> <li><code>0-50</code>\uff1a\u5173\u952e\u4e2d\u95f4\u4ef6\uff08CORS\u3001\u5b89\u5168\uff09</li> <li><code>51-100</code>\uff1a\u6807\u51c6\u4e2d\u95f4\u4ef6\uff08\u65e5\u5fd7\u3001\u6307\u6807\uff09</li> <li><code>101-200</code>\uff1a\u5e94\u7528\u7279\u5b9a\u4e2d\u95f4\u4ef6</li> </ul>"},{"location":"zh/extension_development_guide/#_9","title":"\u751f\u547d\u5468\u671f\u94a9\u5b50","text":"<pre><code>@middleware(priority=100)\nclass DatabaseMiddleware(Middleware):\n    def on_init(self):\n        \"\"\"\u521d\u59cb\u5316\u65f6\u6267\u884c\uff08\u5e94\u7528\u542f\u52a8\u65f6\uff09\"\"\"\n        self.pool = create_connection_pool()\n\n    def on_destroy(self):\n        \"\"\"\u9500\u6bc1\u65f6\u6267\u884c\uff08\u5e94\u7528\u5173\u95ed\u65f6\uff09\"\"\"\n        self.pool.close()\n\n    def process_request(self, handler):\n        # \u4e3a\u6bcf\u4e2a\u8bf7\u6c42\u83b7\u53d6\u8fde\u63a5\n        handler.db = self.pool.get_connection()\n        return handler\n\n    def process_response(self, handler, response):\n        # \u5f52\u8fd8\u8fde\u63a5\n        if hasattr(handler, 'db'):\n            self.pool.return_connection(handler.db)\n        return response\n</code></pre>"},{"location":"zh/extension_development_guide/#_10","title":"\u77ed\u8def\u8bf7\u6c42","text":"<p>\u8fd4\u56de <code>None</code> \u8868\u793a\u77ed\u8def\uff0c\u540e\u7eed\u4e2d\u95f4\u4ef6\u548c Handler \u4e0d\u518d\u6267\u884c\uff1a</p> <pre><code>@middleware(priority=50)\nclass AuthMiddleware(Middleware):\n    def process_request(self, handler):\n        token = handler.request.headers.get('Authorization')\n        if not token:\n            # \u8ba4\u8bc1\u5931\u8d25\uff0c\u77ed\u8def\n            handler.set_status(401)\n            handler.finish({'error': 'Unauthorized'})\n            return None  # \u505c\u6b62\u5904\u7406\n\n        # \u8ba4\u8bc1\u6210\u529f\uff0c\u7ee7\u7eed\n        handler.current_user = validate_token(token)\n        return handler\n</code></pre>"},{"location":"zh/extension_development_guide/#_11","title":"\u5b8c\u6574\u793a\u4f8b","text":"<p>\u53c2\u8003\uff1a<code>examples/custom_auth_middleware.py</code></p>"},{"location":"zh/extension_development_guide/#di-extensions","title":"\u4f9d\u8d56\u6ce8\u5165\u6269\u5c55","text":""},{"location":"zh/extension_development_guide/#scope","title":"\u81ea\u5b9a\u4e49 Scope","text":"<p>Scope \u5b9a\u4e49\u4f9d\u8d56\u7684\u751f\u547d\u5468\u671f\uff08\u5355\u4f8b\u3001\u8bf7\u6c42\u7ea7\u3001\u4f1a\u8bdd\u7ea7\u7b49\uff09\u3002</p> <pre><code>from cullinan.core.scope import Scope\nfrom typing import Any, Optional\n\nclass SessionScope(Scope):\n    \"\"\"\u4f1a\u8bdd\u7ea7\u4f5c\u7528\u57df\"\"\"\n\n    def __init__(self):\n        super().__init__('session')\n        self._instances = {}  # {session_id: {key: instance}}\n\n    def get(self, key: str) -&gt; Optional[Any]:\n        \"\"\"\u83b7\u53d6\u5b9e\u4f8b\"\"\"\n        session_id = self._get_current_session_id()\n        if session_id and session_id in self._instances:\n            return self._instances[session_id].get(key)\n        return None\n\n    def set(self, key: str, value: Any) -&gt; None:\n        \"\"\"\u8bbe\u7f6e\u5b9e\u4f8b\"\"\"\n        session_id = self._get_current_session_id()\n        if session_id:\n            if session_id not in self._instances:\n                self._instances[session_id] = {}\n            self._instances[session_id][key] = value\n\n    def clear(self) -&gt; None:\n        \"\"\"\u6e05\u7406\u5f53\u524d\u4f1a\u8bdd\"\"\"\n        session_id = self._get_current_session_id()\n        if session_id and session_id in self._instances:\n            del self._instances[session_id]\n\n    def _get_current_session_id(self) -&gt; Optional[str]:\n        \"\"\"\u4ece\u8bf7\u6c42\u4e0a\u4e0b\u6587\u83b7\u53d6\u4f1a\u8bdd ID\"\"\"\n        from cullinan.core.context import get_current_context\n        try:\n            context = get_current_context()\n            return context.get('session_id')\n        except:\n            return None\n</code></pre>"},{"location":"zh/extension_development_guide/#provider","title":"\u81ea\u5b9a\u4e49 Provider","text":"<p>Provider \u8d1f\u8d23\u521b\u5efa\u548c\u7ba1\u7406\u4f9d\u8d56\u5b9e\u4f8b\u3002</p>"},{"location":"zh/extension_development_guide/#provider_1","title":"\u5de5\u5382\u6a21\u5f0f Provider","text":"<pre><code>from cullinan.core.provider import Provider\n\nclass FactoryProvider(Provider):\n    \"\"\"\u6bcf\u6b21\u90fd\u521b\u5efa\u65b0\u5b9e\u4f8b\"\"\"\n\n    def __init__(self, factory: Callable[[], Any], name: str):\n        self.factory = factory\n        self.name = name\n\n    def get(self, key: str) -&gt; Optional[Any]:\n        return self.factory()\n\n    def set(self, key: str, value: Any) -&gt; None:\n        pass\n</code></pre>"},{"location":"zh/extension_development_guide/#provider_2","title":"\u5ef6\u8fdf\u521d\u59cb\u5316 Provider","text":"<pre><code>class LazyProvider(Provider):\n    \"\"\"\u9996\u6b21\u8bbf\u95ee\u65f6\u624d\u521d\u59cb\u5316\"\"\"\n\n    def __init__(self, factory: Callable[[], Any], name: str):\n        self.factory = factory\n        self.name = name\n        self._instance = None\n        self._initialized = False\n\n    def get(self, key: str) -&gt; Optional[Any]:\n        if not self._initialized:\n            self._instance = self.factory()\n            self._initialized = True\n        return self._instance\n\n    def set(self, key: str, value: Any) -&gt; None:\n        self._instance = value\n        self._initialized = True\n</code></pre>"},{"location":"zh/extension_development_guide/#provider_3","title":"\u6ce8\u518c\u81ea\u5b9a\u4e49 Provider","text":"<pre><code>from cullinan.service import service, Service\nfrom cullinan.core.injection import get_injection_registry\n\n@service\nclass ProviderRegistryService(Service):\n    def on_init(self):\n        \"\"\"\u5728\u670d\u52a1\u521d\u59cb\u5316\u65f6\u6ce8\u518c\u81ea\u5b9a\u4e49 Provider\"\"\"\n        registry = get_injection_registry()\n\n        # \u6ce8\u518c\u5de5\u5382 Provider\n        factory_provider = FactoryProvider(\n            factory=lambda: MyClass(),\n            name='MyClassFactory'\n        )\n        registry.register_provider('MyClass', factory_provider)\n\n        # \u6ce8\u518c\u5ef6\u8fdf Provider\n        lazy_provider = LazyProvider(\n            factory=lambda: HeavyClass(),\n            name='HeavyClassLazy'\n        )\n        registry.register_provider('HeavyClass', lazy_provider)\n</code></pre>"},{"location":"zh/extension_development_guide/#_12","title":"\u5b8c\u6574\u793a\u4f8b","text":"<p>\u53c2\u8003\uff1a<code>examples/custom_provider_demo.py</code></p>"},{"location":"zh/extension_development_guide/#lifecycle-extensions","title":"\u751f\u547d\u5468\u671f\u6269\u5c55","text":""},{"location":"zh/extension_development_guide/#service","title":"Service \u751f\u547d\u5468\u671f\u94a9\u5b50","text":"<pre><code>from cullinan.service import service, Service\n\n@service\nclass DatabaseService(Service):\n    def on_init(self):\n        \"\"\"\u521d\u59cb\u5316\u8d44\u6e90\uff08Service \u5b9e\u4f8b\u5316\u540e\uff09\"\"\"\n        self.connection = connect_to_database()\n        print(\"Database connected\")\n\n    def on_startup(self):\n        \"\"\"\u6240\u6709 Service \u5c31\u7eea\u540e\u6267\u884c\"\"\"\n        self.connection.execute(\"SELECT 1\")  # \u5065\u5eb7\u68c0\u67e5\n        print(\"Database ready\")\n\n    def on_shutdown(self):\n        \"\"\"\u5e94\u7528\u5173\u95ed\u65f6\u6267\u884c\"\"\"\n        self.connection.close()\n        print(\"Database disconnected\")\n</code></pre>"},{"location":"zh/extension_development_guide/#_13","title":"\u5f02\u6b65\u94a9\u5b50","text":"<pre><code>@service\nclass AsyncService(Service):\n    async def on_init(self):\n        \"\"\"\u652f\u6301\u5f02\u6b65\u521d\u59cb\u5316\"\"\"\n        self.client = await create_async_client()\n\n    async def on_shutdown(self):\n        \"\"\"\u652f\u6301\u5f02\u6b65\u6e05\u7406\"\"\"\n        await self.client.close()\n</code></pre>"},{"location":"zh/extension_development_guide/#_14","title":"\u94a9\u5b50\u6267\u884c\u987a\u5e8f","text":"<ol> <li>on_init()\uff1aService \u5b9e\u4f8b\u5316\u540e\u7acb\u5373\u6267\u884c</li> <li>on_startup()\uff1a\u6240\u6709 Service \u521d\u59cb\u5316\u5b8c\u6210\u540e\u6267\u884c</li> <li>on_shutdown()\uff1a\u5e94\u7528\u5173\u95ed\u65f6\u6267\u884c\uff08\u9006\u5e8f\uff09</li> </ol>"},{"location":"zh/extension_development_guide/#routing-extensions","title":"\u8def\u7531\u6269\u5c55","text":""},{"location":"zh/extension_development_guide/#tornado-handler","title":"\u81ea\u5b9a\u4e49 Tornado Handler","text":"<pre><code>import tornado.web\nfrom cullinan import configure, run\n\nclass CustomHandler(tornado.web.RequestHandler):\n    \"\"\"\u81ea\u5b9a\u4e49\u8bf7\u6c42\u5904\u7406\u5668\"\"\"\n\n    def get(self):\n        self.write({\"message\": \"Custom handler\"})\n\n    def post(self):\n        data = self.get_json_argument()\n        self.write({\"received\": data})\n\n# \u6ce8\u518c\u81ea\u5b9a\u4e49 Handler\nif __name__ == '__main__':\n    configure(\n        handlers=[\n            (r'/custom', CustomHandler),\n            (r'/custom/(?P&lt;id&gt;[0-9]+)', CustomHandler),\n        ]\n    )\n    run()\n</code></pre>"},{"location":"zh/extension_development_guide/#controller","title":"\u4e0e Controller \u6df7\u5408\u4f7f\u7528","text":"<pre><code>from cullinan.controller import controller, get_api\n\n@controller('/api/users')\nclass UserController:\n    @get_api('/')\n    def list_users(self):\n        return {\"users\": []}\n\n# CustomHandler \u548c UserController \u53ef\u4ee5\u5171\u5b58\nif __name__ == '__main__':\n    configure(\n        handlers=[\n            (r'/health', HealthCheckHandler),  # \u81ea\u5b9a\u4e49\n        ]\n    )\n    run()  # UserController \u4f1a\u81ea\u52a8\u6ce8\u518c\n</code></pre>"},{"location":"zh/extension_development_guide/#best-practices","title":"\u6700\u4f73\u5b9e\u8df5","text":""},{"location":"zh/extension_development_guide/#1","title":"1. \u4e2d\u95f4\u4ef6\u8bbe\u8ba1\u539f\u5219","text":"<p>\u2705 \u5355\u4e00\u804c\u8d23\uff1a\u6bcf\u4e2a\u4e2d\u95f4\u4ef6\u53ea\u505a\u4e00\u4ef6\u4e8b <pre><code># \u597d\u7684\u8bbe\u8ba1\n@middleware(priority=50)\nclass AuthMiddleware(Middleware):  # \u53ea\u8d1f\u8d23\u8ba4\u8bc1\n    pass\n\n@middleware(priority=60)\nclass RoleMiddleware(Middleware):  # \u53ea\u8d1f\u8d23\u6743\u9650\u68c0\u67e5\n    pass\n</code></pre></p> <p>\u274c \u907f\u514d\u804c\u8d23\u6df7\u6742 <pre><code># \u4e0d\u597d\u7684\u8bbe\u8ba1\n@middleware(priority=50)\nclass AuthAndLoggingMiddleware(Middleware):  # \u804c\u8d23\u6df7\u6742\n    pass\n</code></pre></p>"},{"location":"zh/extension_development_guide/#2","title":"2. \u4f18\u5148\u7ea7\u89c4\u5212","text":"<ul> <li>\u6309\u4f9d\u8d56\u5173\u7cfb\u6392\u5e8f\uff08\u540e\u7eed\u4e2d\u95f4\u4ef6\u4f9d\u8d56\u524d\u9762\u7684\u7ed3\u679c\uff09</li> <li>\u5b89\u5168\u76f8\u5173\u7684\u4e2d\u95f4\u4ef6\u4f18\u5148\u7ea7\u6700\u9ad8</li> <li>\u65e5\u5fd7\u548c\u76d1\u63a7\u4e2d\u95f4\u4ef6\u4f18\u5148\u7ea7\u9002\u4e2d</li> </ul> <pre><code>@middleware(priority=10)   # CORS\uff08\u6700\u5148\u6267\u884c\uff09\nclass CorsMiddleware(Middleware):\n    pass\n\n@middleware(priority=40)   # \u901f\u7387\u9650\u5236\uff08\u5728\u8ba4\u8bc1\u524d\uff09\nclass RateLimitMiddleware(Middleware):\n    pass\n\n@middleware(priority=50)   # \u8ba4\u8bc1\nclass AuthMiddleware(Middleware):\n    pass\n\n@middleware(priority=60)   # \u6743\u9650\uff08\u4f9d\u8d56\u8ba4\u8bc1\u7ed3\u679c\uff09\nclass RoleMiddleware(Middleware):\n    pass\n\n@middleware(priority=100)  # \u65e5\u5fd7\uff08\u6700\u540e\u6267\u884c\uff09\nclass LoggingMiddleware(Middleware):\n    pass\n</code></pre>"},{"location":"zh/extension_development_guide/#3","title":"3. \u4f9d\u8d56\u6ce8\u5165\u539f\u5219","text":"<p>\u2705 \u4f18\u5148\u4f7f\u7528\u7c7b\u578b\u6ce8\u5165 <pre><code>@service\nclass UserService(Service):\n    email_service: EmailService = Inject()  # \u63a8\u8350\n</code></pre></p> <p>\u2705 \u7279\u6b8a\u60c5\u51b5\u4f7f\u7528\u6309\u540d\u79f0\u6ce8\u5165 <pre><code>@service\nclass UserService(Service):\n    email_service = InjectByName('EmailService')  # \u907f\u514d\u5faa\u73af\u5bfc\u5165\n</code></pre></p>"},{"location":"zh/extension_development_guide/#4","title":"4. \u751f\u547d\u5468\u671f\u7ba1\u7406","text":"<ul> <li>on_init()\uff1a\u521d\u59cb\u5316\u5fc5\u9700\u8d44\u6e90</li> <li>on_startup()\uff1a\u6267\u884c\u4f9d\u8d56\u5176\u4ed6\u670d\u52a1\u7684\u903b\u8f91</li> <li>on_shutdown()\uff1a\u603b\u662f\u6e05\u7406\u8d44\u6e90</li> </ul> <pre><code>@service\nclass ResourceService(Service):\n    def on_init(self):\n        # \u521d\u59cb\u5316\u72ec\u7acb\u8d44\u6e90\n        self.connection = create_connection()\n\n    def on_startup(self):\n        # \u4f9d\u8d56\u5176\u4ed6\u670d\u52a1\u7684\u521d\u59cb\u5316\n        self.cache = get_cache_service()\n\n    def on_shutdown(self):\n        # \u6e05\u7406\uff08\u5fc5\u987b\u5b9e\u73b0\uff09\n        if self.connection:\n            self.connection.close()\n</code></pre>"},{"location":"zh/extension_development_guide/#5","title":"5. \u9519\u8bef\u5904\u7406","text":"<p>\u2705 \u603b\u662f\u63d0\u4f9b\u6e05\u6670\u7684\u9519\u8bef\u4fe1\u606f <pre><code>@middleware(priority=50)\nclass AuthMiddleware(Middleware):\n    def process_request(self, handler):\n        try:\n            token = self._extract_token(handler)\n            user = self._validate_token(token)\n            handler.current_user = user\n            return handler\n        except TokenExpiredError:\n            handler.set_status(401)\n            handler.finish({\n                'error': 'TokenExpired',\n                'message': 'Your token has expired. Please login again.'\n            })\n            return None\n        except InvalidTokenError:\n            handler.set_status(401)\n            handler.finish({\n                'error': 'InvalidToken',\n                'message': 'Invalid authentication token.'\n            })\n            return None\n</code></pre></p>"},{"location":"zh/extension_development_guide/#6","title":"6. \u65e5\u5fd7\u89c4\u8303","text":"<ul> <li>\u4f7f\u7528\u7ed3\u6784\u5316\u65e5\u5fd7</li> <li>\u4e25\u7981\u4f7f\u7528 emoji</li> <li>\u8bb0\u5f55\u5173\u952e\u64cd\u4f5c\u548c\u9519\u8bef</li> </ul> <pre><code>import logging\n\nlogger = logging.getLogger(__name__)\n\n@middleware(priority=100)\nclass LoggingMiddleware(Middleware):\n    def process_request(self, handler):\n        logger.info(\n            \"Request started\",\n            extra={\n                'method': handler.request.method,\n                'path': handler.request.path,\n                'remote_ip': handler.request.remote_ip,\n            }\n        )\n        return handler\n</code></pre>"},{"location":"zh/extension_development_guide/#faq","title":"\u5e38\u89c1\u95ee\u9898","text":""},{"location":"zh/extension_development_guide/#q1","title":"Q1: \u5982\u4f55\u5728\u4e2d\u95f4\u4ef6\u4e2d\u8bbf\u95ee\u4f9d\u8d56\u6ce8\u5165\u7684\u670d\u52a1\uff1f","text":"<p>A: \u4e2d\u95f4\u4ef6\u672c\u8eab\u4e0d\u652f\u6301\u81ea\u52a8\u6ce8\u5165\uff0c\u4f46\u53ef\u4ee5\u624b\u52a8\u83b7\u53d6\uff1a</p> <pre><code>@middleware(priority=100)\nclass ServiceAwareMiddleware(Middleware):\n    def on_init(self):\n        # \u4ece ServiceRegistry \u83b7\u53d6\u670d\u52a1\n        from cullinan.service import get_service_registry\n        registry = get_service_registry()\n        self.user_service = registry.get_instance('UserService')\n\n    def process_request(self, handler):\n        # \u4f7f\u7528\u670d\u52a1\n        user = self.user_service.get_user(123)\n        return handler\n</code></pre>"},{"location":"zh/extension_development_guide/#q2","title":"Q2: \u4e2d\u95f4\u4ef6\u53ef\u4ee5\u4fee\u6539\u54cd\u5e94\u5417\uff1f","text":"<p>A: \u53ef\u4ee5\uff0c\u5728 <code>process_response</code> \u4e2d\u4fee\u6539\uff1a</p> <pre><code>@middleware(priority=100)\nclass ResponseModifierMiddleware(Middleware):\n    def process_response(self, handler, response):\n        # \u6dfb\u52a0\u54cd\u5e94\u5934\n        handler.set_header('X-Custom-Header', 'value')\n\n        # \u4fee\u6539\u54cd\u5e94\u4f53\uff08\u5982\u679c\u662f\u5b57\u5178\uff09\n        if isinstance(response, dict):\n            response['timestamp'] = time.time()\n\n        return response\n</code></pre>"},{"location":"zh/extension_development_guide/#q3","title":"Q3: \u5982\u4f55\u5b9e\u73b0\u6761\u4ef6\u6027\u4e2d\u95f4\u4ef6\uff08\u4ec5\u5e94\u7528\u4e8e\u7279\u5b9a\u8def\u5f84\uff09\uff1f","text":"<p>A: \u5728\u4e2d\u95f4\u4ef6\u4e2d\u5224\u65ad\u8def\u5f84\uff1a</p> <pre><code>@middleware(priority=50)\nclass ConditionalMiddleware(Middleware):\n    def process_request(self, handler):\n        # \u4ec5\u5e94\u7528\u4e8e /api/ \u8def\u5f84\n        if not handler.request.path.startswith('/api/'):\n            return handler  # \u8df3\u8fc7\n\n        # \u6267\u884c\u4e2d\u95f4\u4ef6\u903b\u8f91\n        # ...\n        return handler\n</code></pre>"},{"location":"zh/extension_development_guide/#q4","title":"Q4: \u4e2d\u95f4\u4ef6\u7684\u6267\u884c\u987a\u5e8f\u662f\u4ec0\u4e48\uff1f","text":"<p>A: \u8bf7\u6c42\u548c\u54cd\u5e94\u7684\u987a\u5e8f\u4e0d\u540c\uff1a</p> <ul> <li>\u8bf7\u6c42\u9636\u6bb5\uff1a\u6309\u4f18\u5148\u7ea7\u4ece\u5c0f\u5230\u5927\uff0810 \u2192 50 \u2192 100\uff09</li> <li>\u54cd\u5e94\u9636\u6bb5\uff1a\u6309\u4f18\u5148\u7ea7\u4ece\u5927\u5230\u5c0f\uff08100 \u2192 50 \u2192 10\uff0c\u9006\u5e8f\uff09</li> </ul> <pre><code>\u5ba2\u6237\u7aef\u8bf7\u6c42\n  \u2193\nMiddleware A (priority=10)  \u2192  process_request\n  \u2193\nMiddleware B (priority=50)  \u2192  process_request\n  \u2193\nMiddleware C (priority=100) \u2192  process_request\n  \u2193\nHandler \u5904\u7406\n  \u2193\nMiddleware C (priority=100) \u2192  process_response\n  \u2193\nMiddleware B (priority=50)  \u2192  process_response\n  \u2193\nMiddleware A (priority=10)  \u2192  process_response\n  \u2193\n\u5ba2\u6237\u7aef\u54cd\u5e94\n</code></pre>"},{"location":"zh/extension_development_guide/#q5","title":"Q5: \u5982\u4f55\u6d4b\u8bd5\u81ea\u5b9a\u4e49\u6269\u5c55\uff1f","text":"<p>A: \u4f7f\u7528 Cullinan \u7684\u6d4b\u8bd5\u5de5\u5177\uff1a</p> <pre><code>from cullinan.testing import ServiceTestCase\n\nclass TestMyMiddleware(ServiceTestCase):\n    def test_process_request(self):\n        middleware = MyMiddleware()\n\n        # \u6a21\u62df handler\n        class MockHandler:\n            request = MockRequest()\n\n        handler = MockHandler()\n        result = middleware.process_request(handler)\n\n        self.assertIsNotNone(result)\n</code></pre>"},{"location":"zh/extension_development_guide/#_15","title":"\u8fdb\u4e00\u6b65\u9605\u8bfb","text":"<ul> <li>\u7ef4\u57fa\u6269\u5c55 - \u6269\u5c55\u6a21\u5f0f\u4e0e\u6700\u4f73\u5b9e\u8df5</li> <li>\u4f9d\u8d56\u6ce8\u5165\u6307\u5357 - DI \u7cfb\u7edf\u6587\u6863</li> <li>\u6269\u5c55\u5feb\u901f\u5165\u95e8 - \u6269\u5c55\u5feb\u901f\u5165\u95e8\u6307\u5357</li> </ul> <p>\u6ce8\u610f\uff1a\u793a\u4f8b\u6587\u4ef6\u53ef\u4ee5\u5728\u4ed3\u5e93\u7684 <code>examples/</code> \u76ee\u5f55\u4e2d\u627e\u5230\uff1a - <code>examples/custom_auth_middleware.py</code> - \u4e2d\u95f4\u4ef6\u793a\u4f8b - <code>examples/custom_provider_demo.py</code> - Provider \u793a\u4f8b - <code>examples/extension_registration_demo.py</code> - \u6269\u5c55\u6ce8\u518c\u6f14\u793a</p>"},{"location":"zh/extension_development_guide/#_16","title":"\u83b7\u53d6\u5e2e\u52a9","text":"<ul> <li>GitHub Issues\uff1ahttps://github.com/yourusername/cullinan/issues</li> <li>\u793a\u4f8b\u4ee3\u7801\uff1a<code>examples/</code> \u76ee\u5f55</li> <li>API \u6587\u6863\uff1a<code>docs/api_reference.md</code></li> </ul> <p>\u7248\u672c\uff1av1.0 \u4f5c\u8005\uff1aPlumeink \u6700\u540e\u66f4\u65b0\uff1a2025-12-16</p>"},{"location":"zh/getting_started/","title":"Cullinan \u5feb\u901f\u5f00\u59cb","text":"<p>\u672c\u9875\u63d0\u4f9b\u6700\u5c0f\u5316\u7684\u5feb\u901f\u5165\u95e8\uff0c\u8bf4\u660e\u5982\u4f55\u5b89\u88c5\u5e76\u8fd0\u884c Cullinan \u793a\u4f8b\u5e94\u7528\u3002</p>"},{"location":"zh/getting_started/#_1","title":"\u524d\u7f6e\u6761\u4ef6","text":"<ul> <li>Python 3.8+</li> <li>Git</li> </ul>"},{"location":"zh/getting_started/#_2","title":"\u5b89\u88c5","text":"<p>\u5728\u7ee7\u7eed\u4e4b\u524d\uff0c\u8bf7\u786e\u4fdd\u5df2\u7ecf\u5b89\u88c5 Python 3.8+ \u5e76\u53ef\u4ee5\u5728\u547d\u4ee4\u884c\u4e2d\u4f7f\u7528 <code>python</code> \u548c <code>pip</code>\u3002</p> <p>\u5728\u5927\u591a\u6570\u73af\u5883\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5347\u7ea7 pip \u5e76\u5b89\u88c5 Cullinan\uff08\u9002\u7528\u4e8e Windows\u3001Linux\u3001macOS\uff09\uff1a</p> <pre><code>python -m pip install -U pip\npython -m pip install cullinan\n</code></pre>"},{"location":"zh/getting_started/#_3","title":"\u5feb\u901f\u5f00\u59cb","text":"<ol> <li>\u5728\u4f60\u5e0c\u671b\u653e\u7f6e\u9879\u76ee\u7684\u76ee\u5f55\u521b\u5efa\u4e00\u4e2a\u65b0\u9879\u76ee\u76ee\u5f55\u5e76\u8fdb\u5165\uff1a</li> </ol> <p>\u5728\u6240\u6709\u5e73\u53f0\u4e0a\uff1a</p> <pre><code>mkdir my_cullinan_project\ncd my_cullinan_project\n</code></pre> <ol> <li>\u786e\u4fdd\u4f60\u5df2\u6709\u4e00\u4e2a Python \u73af\u5883\uff08virtualenv\u3001conda\u3001\u7cfb\u7edf Python \u7b49\u5747\u53ef\uff09\u3002\u7136\u540e\u5b89\u88c5\u53d1\u5e03\u7248\u672c\u7684\u5305\uff1a</li> </ol> <pre><code>python -m pip install -U pip\npython -m pip install cullinan\n</code></pre> <ol> <li>\u5728\u9879\u76ee\u6839\u76ee\u5f55\u521b\u5efa\u4e00\u4e2a\u6700\u5c0f\u5e94\u7528\u6587\u4ef6 <code>minimal_app.py</code>\uff0c\u5185\u5bb9\u5982\u4e0b\uff1a</li> </ol> <pre><code># minimal_app.py\nfrom cullinan import application\nfrom cullinan.controller import controller\n\n@controller(url='/hello')\ndef hello_handler(request):\n    \"\"\"\u7b80\u5355\u7684 HTTP \u5904\u7406\u5668\u3002\"\"\"\n    return {'message': 'Hello from Cullinan!'}\n\nif __name__ == '__main__':\n    # Start the framework application (no instantiation required)\n    application.run()\n</code></pre> <ol> <li>\u8fd0\u884c\u4f60\u7684\u5e94\u7528\uff1a</li> </ol> <p>\u5728 Windows\uff08PowerShell\uff09\u4e2d\uff1a</p> <pre><code>python minimal_app.py\n</code></pre> <p>\u5728 Linux / macOS \u4e2d\uff1a</p> <pre><code>python minimal_app.py\n</code></pre> <p>\u5728\u6d4f\u89c8\u5668\u4e2d\u6253\u5f00 <code>http://localhost:4080/hello</code> \u9a8c\u8bc1\u670d\u52a1\u5668\u662f\u5426\u542f\u52a8\u3002</p>"},{"location":"zh/getting_started/#_4","title":"\u793a\u4f8b\u8fd0\u884c\u8f93\u51fa","text":"<p>\u4e0b\u65b9\u65e5\u5fd7\u5c55\u793a\u4e86\u5728\u672c\u5730\u73af\u5883\uff08Windows PowerShell \u4f1a\u8bdd\uff09\u4e2d\u6210\u529f\u8fd0\u884c\u4e0a\u8ff0\u793a\u4f8b\u65f6\u7684\u5178\u578b\u8f93\u51fa\uff0c\u5b9e\u9645\u65f6\u95f4\u6233\u548c\u6267\u884c\u8017\u65f6\u53ef\u80fd\u56e0\u73af\u5883\u4e0d\u540c\u800c\u6709\u6240\u53d8\u5316\uff1a</p> <pre><code>|||||||||||||||||||||||||||||||||||||||||||||||||\n|||                                           |||\n|||    _____      _ _ _                       |||\n|||   / ____|    | | (_)                      |||\n|||  | |    _   _| | |_ _ __   __ _ _ __      |||\n|||  | |   | | | | | | | '_ \\ / _` | '_ \\     |||\n|||  | |___| |_| | | | | | | | (_| | | | |    |||\n|||   \\_____\\__,_|_|_|_|_| |_|\\__,_|_| |_|    |||\n|||                                           |||\n|||||||||||||||||||||||||||||||||||||||||||||||||\n    |||\n\n2025-11-19 04:18:50,209 INFO cullinan.application: loading env...\n2025-11-19 04:18:50,210 INFO cullinan.application: \u2514---configuring dependency injection...\n2025-11-19 04:18:50,210 INFO cullinan.application: \u2514---dependency injection configured\n2025-11-19 04:18:50,210 INFO cullinan.application: \u2514---scanning services...\n2025-11-19 04:18:50,210 INFO cullinan.application: ...\n2025-11-19 04:18:50,223 INFO cullinan.application: \u2514---found 31 modules to scan\n2025-11-19 04:18:50,228 INFO cullinan.application: \u2514---scanning controllers...\n2025-11-19 04:18:50,260 INFO cullinan.application: \u2514---found 31 modules to scan\n2025-11-19 04:18:50,261 INFO cullinan.application: \u2514---initializing services...\n2025-11-19 04:18:50,261 INFO cullinan.application: \u2514---no services registered\n2025-11-19 04:18:50,261 INFO cullinan.application: \u2514---loading controller finish\n\n2025-11-19 04:18:50,261 INFO cullinan.application: loading env finish\n\n2025-11-19 04:18:50,262 INFO cullinan.application: server is starting\n2025-11-19 04:18:50,262 INFO cullinan.application: port is 4080\n</code></pre> <p>\u6b64\u65f6\u670d\u52a1\u5668\u5df2\u542f\u52a8\u5e76\u4fdd\u6301\u8fd0\u884c\u72b6\u6001\uff0c\u76d1\u542c\u5728 <code>http://localhost:4080</code>\u3002\u4f7f\u7528 Ctrl+C \u53ef\u4ee5\u4f18\u96c5\u5730\u505c\u6b62\u670d\u52a1\u5668\u3002</p>"},{"location":"zh/getting_started/#_5","title":"\u6700\u5c0f\u5e94\u7528\u793a\u4f8b","text":"<p>\u8fd9\u662f\u4e00\u4e2a\u6f14\u793a Cullinan \u6838\u5fc3\u529f\u80fd\u7684\u6700\u5c0f\u5e94\u7528\uff1a</p> <pre><code># minimal_app.py\nfrom cullinan import application\nfrom cullinan.controller import controller\n\n@controller(url='/hello')\ndef hello_handler(request):\n    \"\"\"\u7b80\u5355\u7684 HTTP \u5904\u7406\u5668\u3002\"\"\"\n    return {'message': 'Hello from Cullinan!'}\n\nif __name__ == '__main__':\n    # Start the framework application (no instantiation required)\n    application.run()\n</code></pre> <p>\u8fd0\u884c\u6b64\u793a\u4f8b\uff1a</p> <pre><code># \u5c06\u4e0a\u8ff0\u4ee3\u7801\u4fdd\u5b58\u4e3a minimal_app.py\npython minimal_app.py\n</code></pre> <p>\u7136\u540e\u5728\u6d4f\u89c8\u5668\u4e2d\u8bbf\u95ee <code>http://localhost:4080/hello</code>\u3002</p>"},{"location":"zh/getting_started/#_6","title":"\u7406\u89e3\u57fa\u7840\u77e5\u8bc6","text":""},{"location":"zh/getting_started/#_7","title":"\u5e94\u7528\u751f\u547d\u5468\u671f","text":"<ol> <li>\u521b\u5efa\uff1a<code>create_app()</code> \u4f7f\u7528\u9ed8\u8ba4\u8bbe\u7f6e\u521d\u59cb\u5316\u5e94\u7528</li> <li>\u6ce8\u518c\uff1a\u901a\u8fc7\u6a21\u5757\u626b\u63cf\u6216\u663e\u5f0f\u6ce8\u518c\u53d1\u73b0\u63a7\u5236\u5668\u548c\u670d\u52a1</li> <li>\u542f\u52a8\uff1a<code>app.run()</code> \u542f\u52a8 Tornado IOLoop \u5e76\u5f00\u59cb\u63a5\u53d7\u8bf7\u6c42</li> <li>\u5173\u95ed\uff1a\u5728 SIGINT/SIGTERM \u4fe1\u53f7\u65f6\u4f18\u96c5\u5173\u95ed</li> </ol>"},{"location":"zh/getting_started/#_8","title":"\u4f9d\u8d56\u6ce8\u5165","text":"<p>Cullinan \u63d0\u4f9b\u5185\u7f6e\u7684 IoC/DI \u652f\u6301\u3002</p>"},{"location":"zh/getting_started/#injectable-vs-controller","title":"\u6ce8\u89e3\u8bf4\u660e\uff1a<code>@injectable</code> vs <code>@controller()</code>","text":"<p><code>@injectable</code> - \u901a\u7528\u4f9d\u8d56\u6ce8\u5165\u6ce8\u89e3 - \u9002\u7528\u4e8e\u4efb\u4f55\u9700\u8981\u4f9d\u8d56\u6ce8\u5165\u7684\u7c7b\uff08Service\u3001Repository\u3001\u666e\u901a\u7c7b\u7b49\uff09 - \u9700\u8981\u624b\u52a8\u4f7f\u7528\uff0c\u4e0d\u4f1a\u81ea\u52a8\u6ce8\u518c\u5230\u4efb\u4f55\u6ce8\u518c\u8868 - \u5728\u7c7b\u5b9e\u4f8b\u5316\u540e\u81ea\u52a8\u6ce8\u5165\u6807\u8bb0\u7684\u4f9d\u8d56 - \u4f7f\u7528\u573a\u666f\uff1aService \u5c42\u3001Repository \u5c42\u3001\u5de5\u5177\u7c7b\u7b49</p> <p><code>@controller()</code> - Controller \u4e13\u7528\u81ea\u6ce8\u518c\u6ce8\u89e3 - \u4e13\u95e8\u7528\u4e8e HTTP Controller \u7c7b - \u81ea\u52a8\u8c03\u7528 <code>@injectable</code>\uff0c\u65e0\u9700\u624b\u52a8\u6dfb\u52a0 - \u81ea\u52a8\u6ce8\u518c Controller \u53ca\u5176\u8def\u7531\u5230 ControllerRegistry - \u81ea\u52a8\u626b\u63cf\u7c7b\u4e2d\u7684 <code>@get_api</code>\u3001<code>@post_api</code> \u7b49\u65b9\u6cd5\u88c5\u9970\u5668 - \u4f7f\u7528\u573a\u666f\uff1a\u4ec5\u7528\u4e8e HTTP Controller</p> <pre><code>from cullinan.controller import controller, get_api\nfrom cullinan.service import Service, service\nfrom cullinan.core import injectable, InjectByName\n\n# Service \u4f7f\u7528 @service (\u7ee7\u627f\u81ea Service \u57fa\u7c7b)\n@service\nclass UserService(Service):\n    def get_user(self, user_id):\n        return {'id': user_id, 'name': 'John'}\n\n# Repository \u4f7f\u7528 @injectable\n@injectable\nclass UserRepository:\n    def find_by_id(self, user_id):\n        return {'id': user_id}\n\n# Controller \u4f7f\u7528 @controller() - \u81ea\u52a8\u5305\u542b @injectable\n@controller(url='/api/users')\nclass UserController:\n    # Controller \u4e2d\u7684\u4f9d\u8d56\u6ce8\u5165\n    user_service = InjectByName('UserService')\n\n    @get_api(url='/{user_id}')\n    def get_user(self, url_params):\n        # \u4ece url_params \u5b57\u5178\u4e2d\u83b7\u53d6\u8def\u5f84\u53c2\u6570\n        user_id = url_params.get('user_id') if url_params else None\n        return self.user_service.get_user(user_id)\n</code></pre> <p>\u91cd\u8981\uff1a \u5728 Controller \u4e2d\u4e0d\u8981\u91cd\u590d\u4f7f\u7528 <code>@injectable</code>\uff0c\u56e0\u4e3a <code>@controller()</code> \u5df2\u7ecf\u81ea\u52a8\u5305\u542b\u4e86\u5b83\u3002</p>"},{"location":"zh/getting_started/#restful-api","title":"RESTful API \u88c5\u9970\u5668\uff08\u5feb\u901f\u8bf4\u660e\uff09","text":"<p>Cullinan \u63d0\u4f9b\u4e00\u7ec4 REST \u98ce\u683c\u7684\u88c5\u9970\u5668\uff0c\u7528\u4e8e\u5c06 Controller \u65b9\u6cd5\u7ed1\u5b9a\u5230 HTTP \u8def\u7531\uff1a</p> <ul> <li><code>get_api</code></li> <li><code>post_api</code></li> <li><code>patch_api</code></li> <li><code>delete_api</code></li> <li><code>put_api</code></li> </ul> <p>\u5173\u952e\u70b9\uff1a</p> <ul> <li>\u8fd9\u4e9b\u88c5\u9970\u5668\u5728\u6e90\u7801\u4e2d\u5b9a\u4e49\u4e3a <code>def get_api(**kwargs)</code> \u7b49\uff0c\u53ea\u63a5\u53d7\u5173\u952e\u5b57\u53c2\u6570\u3002</li> <li>\u5199\u6cd5 <code>@get_api('/user')</code> \u662f\u4e0d\u5408\u6cd5\u7684\uff0c\u4f1a\u5728\u5bfc\u5165\u6a21\u5757\u65f6\u629b\u51fa <code>TypeError</code>\u3002</li> <li>\u6b63\u786e\u5199\u6cd5\u5e94\u4e3a\uff1a<code>@get_api(url='/user')</code>\u3002</li> <li><code>url</code> \u53c2\u6570\u4f7f\u7528\u8f7b\u91cf\u7ea7\u6a21\u677f\u8bed\u6cd5\uff0c\u652f\u6301 <code>{param}</code> \u5360\u4f4d\u7b26\uff0c\u5e76\u4e0e\u65b9\u6cd5\u53c2\u6570\u4e00\u4e00\u5bf9\u5e94\uff1a</li> </ul> <pre><code>@controller(url='/api/users')\nclass UserController:\n    @get_api(url='/{user_id}')\n    def get_user(self, url_params):\n        user_id = url_params.get('user_id') if url_params else None\n        ...\n</code></pre> <p>\u5e38\u7528\u53c2\u6570\uff1a</p> <ul> <li><code>url</code>\uff1a\u8def\u7531\u8def\u5f84\uff08\u5b57\u7b26\u4e32\uff09\uff0c\u652f\u6301 <code>{param}</code> \u5360\u4f4d\u7b26\uff0c\u4f8b\u5982 <code>'/users/{user_id}'</code>\u3002</li> <li><code>query_params</code>\uff1a\u67e5\u8be2\u53c2\u6570\u540d\u79f0\u5217\u8868/\u5143\u7ec4\uff0c\u4f8b\u5982 <code>('page', 'size')</code>\u3002 \u5728\u5904\u7406\u5668\u4e2d\uff0c\u8fd9\u4e9b\u67e5\u8be2\u53c2\u6570\u901a\u8fc7\u5355\u4e2a <code>query_params</code> \u5b57\u5178\u53c2\u6570\u4f20\u5165\u3002</li> <li><code>body_params</code>\uff08\u4ec5 POST/PATCH\uff09\uff1a\u9700\u8981\u4ece JSON/form body \u4e2d\u89e3\u6790\u7684\u5b57\u6bb5\u540d\u79f0\u96c6\u5408\u3002\u5728\u5904\u7406\u5668\u4e2d\uff0c\u8fd9\u4e9b\u5b57\u6bb5\u901a\u8fc7\u5355\u4e2a <code>body_params</code> \u5b57\u5178\u53c2\u6570\u4f20\u5165\u3002</li> <li><code>file_params</code>\uff1a\u4e0a\u4f20\u6587\u4ef6\u5b57\u6bb5\u540d\u79f0\u5217\u8868\u3002</li> <li><code>headers</code>\uff1a\u5fc5\u987b\u5b58\u5728\u7684 HTTP \u8bf7\u6c42\u5934\u540d\u79f0\u5217\u8868\u3002</li> <li><code>get_request_body</code>\uff08\u4ec5 POST/PATCH\uff09\uff1a\u4e3a <code>True</code> \u65f6\uff0c\u4f1a\u5c06\u539f\u59cb\u8bf7\u6c42\u4f53\u4f5c\u4e3a\u53c2\u6570\u4f20\u5165\u65b9\u6cd5\u3002</li> </ul> <p>\u5178\u578b\u7ec4\u5408\u793a\u4f8b\uff1a</p> <pre><code>@controller(url='/api/users')\nclass UserController:\n    @get_api(url='/', query_params=('page', 'size'))\n    def list_users(self, query_params):\n        page = query_params.get('page') if query_params else None\n        size = query_params.get('size') if query_params else None\n        ...\n\n    @post_api(url='/', body_params=('name', 'email'))\n    def create_user(self, body_params):\n        name = body_params.get('name') if body_params else None\n        email = body_params.get('email') if body_params else None\n        ...\n</code></pre> <p>\u5982\u9700\u4e86\u89e3 URL \u6a21\u677f\u4e0e\u5404\u88c5\u9970\u5668\u53c2\u6570\u7684\u5b8c\u6574\u8bf4\u660e\uff0c\u8bf7\u53c2\u8003 <code>docs/zh/wiki/restful_api.md</code>\u3002</p>"},{"location":"zh/getting_started/#_9","title":"\u63a8\u8350\u7684\u4f9d\u8d56\u6ce8\u5165\u65b9\u5f0f","text":"<p>\u65b9\u5f0f\u4e00\uff1aInjectByName\uff08\u63a8\u8350\uff0c\u6700\u7b80\u5355\uff09</p> <p>\u6309\u540d\u79f0\u6ce8\u5165\uff0c\u65e0\u9700\u5bfc\u5165\u4f9d\u8d56\u7c7b\uff0c\u907f\u514d\u5faa\u73af\u5bfc\u5165\u95ee\u9898\uff1a</p> <pre><code>from cullinan.service import Service, service\nfrom cullinan.core import injectable, InjectByName\n\n@service\nclass DatabaseService(Service):\n    def query(self, sql):\n        return f\"Results for: {sql}\"\n\n@injectable\nclass UserRepository:\n    # \u63a8\u8350\uff1aInjectByName \u4e0d\u9700\u8981\u7c7b\u578b\u6ce8\u89e3\uff0c\u76f4\u63a5\u4f7f\u7528\u5b57\u7b26\u4e32\u540d\u79f0\n    db = InjectByName('DatabaseService')\n\n    def get_users(self):\n        return self.db.query(\"SELECT * FROM users\")\n</code></pre> <p>\u65b9\u5f0f\u4e8c\uff1aInject + TYPE_CHECKING\uff08\u652f\u6301 IDE \u8054\u60f3\uff09</p> <p>\u5982\u679c\u9700\u8981 IDE \u81ea\u52a8\u8865\u5168\u548c\u7c7b\u578b\u68c0\u67e5\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>Inject</code> \u914d\u5408 TYPE_CHECKING\uff1a</p> <pre><code>from typing import TYPE_CHECKING\nfrom cullinan.core import injectable, Inject\nfrom cullinan.service import Service, service\n\n# TYPE_CHECKING \u5757\u4e2d\u7684\u5bfc\u5165\u4e0d\u4f1a\u5728\u8fd0\u884c\u65f6\u6267\u884c\uff0c\u907f\u514d\u5faa\u73af\u5bfc\u5165\nif TYPE_CHECKING:\n    from cullinan.service import DatabaseService\n\n@service\nclass DatabaseService(Service):\n    def query(self, sql):\n        return f\"Results for: {sql}\"\n\n@injectable\nclass UserRepository:\n    # \u4f7f\u7528 TYPE_CHECKING \u5bfc\u5165\u7c7b\u578b\u540e\uff0c\u53ef\u4ee5\u83b7\u5f97 IDE \u8054\u60f3\u652f\u6301\n    db: 'DatabaseService' = Inject()\n\n    def get_users(self):\n        # IDE \u53ef\u4ee5\u63d0\u793a db.query \u65b9\u6cd5\n        return self.db.query(\"SELECT * FROM users\")\n</code></pre> <p>\u65b9\u5f0f\u4e09\uff1aInject + \u7eaf\u5b57\u7b26\u4e32\u6ce8\u89e3\uff08\u65e0 IDE \u8054\u60f3\uff09</p> <p>\u5982\u679c\u4e0d\u9700\u8981 IDE \u8054\u60f3\uff0c\u4e5f\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u5b57\u7b26\u4e32\u6ce8\u89e3\uff1a</p> <pre><code>from cullinan.core import injectable, Inject\n\n@injectable\nclass UserRepository:\n    # \u7eaf\u5b57\u7b26\u4e32\u6ce8\u89e3\uff0c\u65e0\u9700\u5bfc\u5165\uff0c\u4f46\u4e5f\u6ca1\u6709 IDE \u8054\u60f3\n    db: 'DatabaseService' = Inject()\n\n    def get_users(self):\n        return self.db.query(\"SELECT * FROM users\")\n</code></pre> <p>\u603b\u7ed3\uff1a - InjectByName\uff1a\u63a8\u8350\u7528\u4e8e\u5927\u591a\u6570\u573a\u666f\uff0c\u7b80\u5355\u76f4\u63a5\uff0c\u65e0\u9700\u7c7b\u578b\u6ce8\u89e3 - Inject + TYPE_CHECKING\uff1a\u9002\u5408\u9700\u8981 IDE \u8054\u60f3\u7684\u573a\u666f\uff0c\u5f00\u53d1\u4f53\u9a8c\u66f4\u597d - Inject + \u5b57\u7b26\u4e32\u6ce8\u89e3\uff1a\u6700\u7b80\u5355\u4f46\u65e0 IDE \u652f\u6301</p> <p>\u6709\u5173\u6ce8\u5165\u6a21\u5f0f\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 <code>docs/wiki/injection.md</code>\u3002</p>"},{"location":"zh/getting_started/#_10","title":"\u5e38\u89c1\u6a21\u5f0f","text":""},{"location":"zh/getting_started/#_11","title":"\u6dfb\u52a0\u4e2d\u95f4\u4ef6","text":"<pre><code>from cullinan.middleware import MiddlewareBase\n\nclass LoggingMiddleware(MiddlewareBase):\n    def process_request(self, request):\n        print(f\"Request: {request.method} {request.path}\")\n\n# \u5728\u5e94\u7528\u521d\u59cb\u5316\u671f\u95f4\u6ce8\u518c\napp.add_middleware(LoggingMiddleware())\n</code></pre>"},{"location":"zh/getting_started/#_12","title":"\u914d\u7f6e","text":"<pre><code>from cullinan.config import Config\n\nconfig = Config()\nconfig.set('database.url', 'postgresql://localhost/mydb')\nconfig.set('server.port', 8080)\n</code></pre>"},{"location":"zh/getting_started/#_13","title":"\u6545\u969c\u6392\u67e5","text":"<ul> <li>\u5982\u679c\u5b89\u88c5\u5305\u65f6\u51fa\u73b0\u9519\u8bef\uff0c\u8bf7\u786e\u4fdd Python \u548c pip \u5df2\u66f4\u65b0\uff0c\u5e76\u4e14\u80fd\u8bbf\u95ee PyPI\uff08\u7f51\u7edc\u6216\u4ee3\u7406\u8bbe\u7f6e\uff09\u3002</li> <li>\u5982\u679c\u5728\u8fd0\u884c PowerShell \u547d\u4ee4\u65f6\u9047\u5230\u6743\u9650\u95ee\u9898\uff0c\u8bf7\u68c0\u67e5 PowerShell \u7684\u6267\u884c\u7b56\u7565\u6216\u4ee5\u7ba1\u7406\u5458\u6743\u9650\u8fd0\u884c\u547d\u4ee4\u3002</li> </ul>"},{"location":"zh/getting_started/#_14","title":"\u4e0b\u4e00\u6b65","text":"<ul> <li>\u9605\u8bfb <code>docs/wiki/injection.md</code> \u4e86\u89e3 IoC/DI \u7ec6\u8282\u3002</li> <li>\u6d4f\u89c8 <code>examples/</code> \u76ee\u5f55\u67e5\u770b\u53ef\u8fd0\u884c\u793a\u4f8b\u3002</li> </ul>"},{"location":"zh/getting_started/#_15","title":"\u5176\u4ed6\u8d44\u6e90","text":"<ul> <li>\u67b6\u6784\uff1a\u53c2\u9605 <code>docs/architecture.md</code> \u4e86\u89e3\u7cfb\u7edf\u8bbe\u8ba1\u6982\u89c8</li> <li>\u7ec4\u4ef6\uff1a\u9605\u8bfb <code>docs/wiki/components.md</code> \u4e86\u89e3\u7ec4\u4ef6\u804c\u8d23</li> <li>\u751f\u547d\u5468\u671f\uff1a\u5728 <code>docs/wiki/lifecycle.md</code> \u4e2d\u5b66\u4e60\u5e94\u7528\u751f\u547d\u5468\u671f</li> <li>\u4e2d\u95f4\u4ef6\uff1a\u5728 <code>docs/wiki/middleware.md</code> \u4e2d\u7406\u89e3\u4e2d\u95f4\u4ef6</li> <li>API \u53c2\u8003\uff1a\u6d4f\u89c8 <code>docs/api_reference.md</code> \u67e5\u770b\u5b8c\u6574 API \u6587\u6863</li> <li>\u793a\u4f8b\uff1a\u63a2\u7d22 <code>examples/</code> \u76ee\u5f55\u83b7\u53d6\u66f4\u591a\u793a\u4f8b</li> </ul>"},{"location":"zh/getting_started/#_16","title":"\u793e\u533a\u4e0e\u652f\u6301","text":"<ul> <li>\u95ee\u9898\u53cd\u9988\uff1a\u5728 GitHub Issues \u62a5\u544a bug</li> <li>\u8d21\u732e\uff1a\u53c2\u9605 <code>docs/contributing.md</code> \u4e86\u89e3\u8d21\u732e\u6307\u5357</li> <li>\u6d4b\u8bd5\uff1a\u9605\u8bfb <code>docs/testing.md</code> \u4e86\u89e3\u6d4b\u8bd5\u6700\u4f73\u5b9e\u8df5</li> </ul>"},{"location":"zh/import_migration_090/","title":"Cullinan 0.90 \u5bfc\u5165\u8fc1\u79fb\u624b\u518c","text":"<p>\u672c\u624b\u518c\u5e2e\u52a9\u60a8\u5c06\u5bfc\u5165\u8bed\u53e5\u4ece\u65e7\u7ed3\u6784\u8fc1\u79fb\u5230\u65b0\u7684 0.90 \u7ed3\u6784\u3002</p>"},{"location":"zh/import_migration_090/#_1","title":"\u6982\u8ff0","text":"<p>Cullinan 0.90 \u91cd\u65b0\u7ec4\u7ec7\u4e86 <code>core/</code> \u6a21\u5757\uff0c\u5b9e\u73b0\u4e86\u6e05\u6670\u7684\u804c\u8d23\u5206\u79bb\uff1a</p> <ul> <li><code>container/</code> - IoC/DI \u5bb9\u5668\uff08ApplicationContext\u3001Definition\u3001Scope\uff09</li> <li><code>diagnostics/</code> - \u5f02\u5e38\u4e0e\u9519\u8bef\u6e32\u67d3</li> <li><code>lifecycle/</code> - \u751f\u547d\u5468\u671f\u7ba1\u7406</li> <li><code>request/</code> - \u8bf7\u6c42\u4e0a\u4e0b\u6587</li> <li><code>legacy/</code> - \u5df2\u5f03\u7528\u7ec4\u4ef6\uff08\u5c06\u5728 1.0 \u4e2d\u79fb\u9664\uff09</li> </ul>"},{"location":"zh/import_migration_090/#_2","title":"\u5feb\u901f\u8fc1\u79fb\u5bf9\u7167\u8868","text":""},{"location":"zh/import_migration_090/#20-api-","title":"\u6838\u5fc3\u5bb9\u5668\uff082.0 API - \u63a8\u8350\uff09","text":"\u65e7\u5bfc\u5165 \u65b0\u5bfc\u5165 <code>from cullinan.core.application_context import ApplicationContext</code> <code>from cullinan.core.container import ApplicationContext</code> <code>from cullinan.core.definitions import Definition, ScopeType</code> <code>from cullinan.core.container import Definition, ScopeType</code> <code>from cullinan.core.factory import Factory</code> <code>from cullinan.core.container import Factory</code> <code>from cullinan.core.scope_manager import ScopeManager</code> <code>from cullinan.core.container import ScopeManager</code>"},{"location":"zh/import_migration_090/#_3","title":"\u5f02\u5e38","text":"\u65e7\u5bfc\u5165 \u65b0\u5bfc\u5165 <code>from cullinan.core.exceptions import RegistryFrozenError</code> <code>from cullinan.core.diagnostics import RegistryFrozenError</code> <code>from cullinan.core.exceptions import DependencyNotFoundError</code> <code>from cullinan.core.diagnostics import DependencyNotFoundError</code> <code>from cullinan.core.exceptions import CircularDependencyError</code> <code>from cullinan.core.diagnostics import CircularDependencyError</code> <code>from cullinan.core.exceptions import ScopeNotActiveError</code> <code>from cullinan.core.diagnostics import ScopeNotActiveError</code> <code>from cullinan.core.exceptions import ConditionNotMetError</code> <code>from cullinan.core.diagnostics import ConditionNotMetError</code> <code>from cullinan.core.exceptions import CreationError</code> <code>from cullinan.core.diagnostics import CreationError</code> <code>from cullinan.core.exceptions import LifecycleError</code> <code>from cullinan.core.diagnostics import LifecycleError</code>"},{"location":"zh/import_migration_090/#_4","title":"\u8bca\u65ad","text":"\u65e7\u5bfc\u5165 \u65b0\u5bfc\u5165 <code>from cullinan.core.diagnostics import render_resolution_path</code> <code>from cullinan.core.diagnostics import render_resolution_path</code> <code>from cullinan.core.diagnostics import format_circular_dependency_error</code> <code>from cullinan.core.diagnostics import format_circular_dependency_error</code>"},{"location":"zh/import_migration_090/#_5","title":"\u751f\u547d\u5468\u671f","text":"\u65e7\u5bfc\u5165 \u65b0\u5bfc\u5165 <code>from cullinan.core.lifecycle import LifecycleManager</code> <code>from cullinan.core.lifecycle import LifecycleManager</code> <code>from cullinan.lifecycle_hooks import LifecycleEvent</code> <code>from cullinan.core.lifecycle import LifecycleEvent</code> <code>from cullinan.lifecycle_hooks import LifecycleEventManager</code> <code>from cullinan.core.lifecycle import LifecycleEventManager</code>"},{"location":"zh/import_migration_090/#_6","title":"\u8bf7\u6c42\u4e0a\u4e0b\u6587","text":"\u65e7\u5bfc\u5165 \u65b0\u5bfc\u5165 <code>from cullinan.core.context import RequestContext</code> <code>from cullinan.core.request import RequestContext</code> <code>from cullinan.core.context import get_current_context</code> <code>from cullinan.core.request import get_current_context</code> <code>from cullinan.core.context import create_context</code> <code>from cullinan.core.request import create_context</code>"},{"location":"zh/import_migration_090/#_7","title":"\u7c7b\u578b","text":"\u65e7\u5bfc\u5165 \u65b0\u5bfc\u5165 <code>from cullinan.core.types import LifecycleState</code> <code>from cullinan.core.diagnostics import LifecycleState</code> <code>from cullinan.core.types import LifecycleAware</code> <code>from cullinan.core.diagnostics import LifecycleAware</code>"},{"location":"zh/import_migration_090/#_8","title":"\u9876\u5c42\u6587\u4ef6","text":"\u65e7\u6587\u4ef6 \u65b0\u6587\u4ef6 \u8bf4\u660e <code>cullinan/app.py</code> <code>cullinan/bootstrap.py</code> \u5e94\u7528\u542f\u52a8\u5f15\u5bfc <code>cullinan/application.py</code> <code>cullinan/scanner.py</code> \u6a21\u5757\u626b\u63cf\u5668 <code>cullinan/lifecycle_hooks.py</code> <code>cullinan/core/lifecycle/events.py</code> \u751f\u547d\u5468\u671f\u4e8b\u4ef6 <code>cullinan/extensions.py</code> <code>cullinan/core/extensions.py</code> \u6269\u5c55\u6ce8\u518c\u8868"},{"location":"zh/import_migration_090/#_9","title":"\u9057\u7559\u5bfc\u5165\uff08\u5df2\u5f03\u7528\uff09","text":"<p>\u4ee5\u4e0b\u5bfc\u5165\u5df2\u5f03\u7528\uff0c\u5c06\u5728 1.0 \u4e2d\u79fb\u9664\uff1a</p> <pre><code># \u5df2\u5f03\u7528 - \u5c06\u5728 1.0 \u4e2d\u79fb\u9664\nfrom cullinan.core.injection import Inject, InjectByName, injectable\nfrom cullinan.core.provider import Provider, ProviderRegistry\nfrom cullinan.core.facade import IoCFacade, get_ioc_facade\nfrom cullinan.core.registry import Registry, SimpleRegistry\nfrom cullinan.core.scope import SingletonScope, TransientScope, RequestScope\n</code></pre> <p>\u8fd9\u4e9b\u5df2\u88ab\u79fb\u52a8\u5230 <code>cullinan.core.legacy/</code>\uff0c\u4f7f\u7528\u65f6\u4f1a\u53d1\u51fa <code>DeprecationWarning</code>\u3002</p>"},{"location":"zh/import_migration_090/#_10","title":"\u4ee3\u7801\u793a\u4f8b","text":""},{"location":"zh/import_migration_090/#083","title":"\u8fc1\u79fb\u524d\uff080.83\uff09","text":"<pre><code>from cullinan.core.application_context import ApplicationContext\nfrom cullinan.core.definitions import Definition, ScopeType\nfrom cullinan.core.exceptions import (\n    RegistryFrozenError,\n    CircularDependencyError,\n    ScopeNotActiveError,\n)\nfrom cullinan.core.context import RequestContext\n\nctx = ApplicationContext()\nctx.register(Definition(\n    name='UserService',\n    factory=lambda c: UserService(),\n    scope=ScopeType.SINGLETON,\n    source='service:UserService'\n))\nctx.refresh()\n</code></pre>"},{"location":"zh/import_migration_090/#090","title":"\u8fc1\u79fb\u540e\uff080.90\uff09","text":"<pre><code>from cullinan.core.container import ApplicationContext, Definition, ScopeType\nfrom cullinan.core.diagnostics import (\n    RegistryFrozenError,\n    CircularDependencyError,\n    ScopeNotActiveError,\n)\nfrom cullinan.core.request import RequestContext\n\nctx = ApplicationContext()\nctx.register(Definition(\n    name='UserService',\n    factory=lambda c: UserService(),\n    scope=ScopeType.SINGLETON,\n    source='service:UserService'\n))\nctx.refresh()\n</code></pre>"},{"location":"zh/import_migration_090/#_11","title":"\u6279\u91cf\u8fc1\u79fb\u811a\u672c","text":"<p>\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u6b63\u5219\u8868\u8fbe\u5f0f\u6279\u91cf\u66f4\u65b0\u5bfc\u5165\uff1a</p>"},{"location":"zh/import_migration_090/#linuxmac-sed","title":"Linux/Mac (sed)","text":"<pre><code># \u5bb9\u5668\u5bfc\u5165\nsed -i 's/from cullinan\\.core\\.application_context import/from cullinan.core.container import/g' *.py\nsed -i 's/from cullinan\\.core\\.definitions import/from cullinan.core.container import/g' *.py\nsed -i 's/from cullinan\\.core\\.factory import/from cullinan.core.container import/g' *.py\nsed -i 's/from cullinan\\.core\\.scope_manager import/from cullinan.core.container import/g' *.py\n\n# \u5f02\u5e38\u5bfc\u5165\nsed -i 's/from cullinan\\.core\\.exceptions import/from cullinan.core.diagnostics import/g' *.py\n\n# \u8bf7\u6c42\u4e0a\u4e0b\u6587\u5bfc\u5165\nsed -i 's/from cullinan\\.core\\.context import/from cullinan.core.request import/g' *.py\n</code></pre>"},{"location":"zh/import_migration_090/#windows-powershell","title":"Windows (PowerShell)","text":"<pre><code># \u5bb9\u5668\u5bfc\u5165\nGet-ChildItem -Filter *.py -Recurse | ForEach-Object {\n    (Get-Content $_.FullName) -replace 'from cullinan\\.core\\.application_context import', 'from cullinan.core.container import' | Set-Content $_.FullName\n}\n\n# \u5f02\u5e38\u5bfc\u5165\nGet-ChildItem -Filter *.py -Recurse | ForEach-Object {\n    (Get-Content $_.FullName) -replace 'from cullinan\\.core\\.exceptions import', 'from cullinan.core.diagnostics import' | Set-Content $_.FullName\n}\n\n# \u8bf7\u6c42\u4e0a\u4e0b\u6587\u5bfc\u5165\nGet-ChildItem -Filter *.py -Recurse | ForEach-Object {\n    (Get-Content $_.FullName) -replace 'from cullinan\\.core\\.context import', 'from cullinan.core.request import' | Set-Content $_.FullName\n}\n</code></pre>"},{"location":"zh/import_migration_090/#_12","title":"\u65e0\u9700\u66f4\u6539\u7684\u5bfc\u5165","text":"<p>\u4ee5\u4e0b\u5bfc\u5165\u4fdd\u6301\u4e0d\u53d8\uff0c\u53ef\u4ee5\u7ee7\u7eed\u4f7f\u7528\uff1a</p> <pre><code># \u8fd9\u4e9b\u5bfc\u5165\u65b9\u5f0f\u4fdd\u6301\u4e0d\u53d8\nfrom cullinan import (\n    # \u914d\u7f6e\n    configure, get_config, CullinanConfig,\n\n    # \u670d\u52a1\u5c42\n    Service, ServiceRegistry, service, get_service_registry,\n\n    # \u63a7\u5236\u5668\n    ControllerRegistry, get_controller_registry,\n    get_api, post_api, patch_api, delete_api, put_api,\n    Handler, response,\n\n    # \u4e2d\u95f4\u4ef6\n    Middleware, MiddlewareChain, middleware,\n\n    # WebSocket\n    WebSocketRegistry, websocket_handler,\n\n    # \u6d4b\u8bd5\n    ServiceTestCase, MockService, TestRegistry,\n)\n</code></pre>"},{"location":"zh/import_migration_090/#_13","title":"\u5e38\u89c1\u95ee\u9898","text":""},{"location":"zh/import_migration_090/#q","title":"Q: \u65e7\u7684\u5bfc\u5165\u8fd8\u80fd\u7528\u5417\uff1f","text":"<p>A: \u65e7\u7684\u9876\u5c42\u6587\u4ef6\uff08\u5982 <code>cullinan.core.exceptions</code>\uff09\u6682\u65f6\u4ecd\u53ef\u7528\uff0c\u4f46\u4f1a\u53d1\u51fa\u5f03\u7528\u8b66\u544a\u3002\u5efa\u8bae\u5c3d\u5feb\u8fc1\u79fb\u5230\u65b0\u8def\u5f84\u3002</p>"},{"location":"zh/import_migration_090/#q_1","title":"Q: \u9057\u7559\u6a21\u5757\u4ec0\u4e48\u65f6\u5019\u79fb\u9664\uff1f","text":"<p>A: <code>cullinan.core.legacy/</code> \u4e2d\u7684\u7ec4\u4ef6\u5c06\u5728 1.0 \u7248\u672c\u4e2d\u5b8c\u5168\u79fb\u9664\u3002</p>"},{"location":"zh/import_migration_090/#q_2","title":"Q: \u5982\u4f55\u9a8c\u8bc1\u8fc1\u79fb\u662f\u5426\u6210\u529f\uff1f","text":"<p>A: \u8fd0\u884c\u6d4b\u8bd5\u5e76\u786e\u4fdd\u6ca1\u6709 <code>ImportError</code> \u6216 <code>DeprecationWarning</code>\uff1a</p> <pre><code>python -m pytest tests/ -v --tb=short\n</code></pre>"},{"location":"zh/import_migration_090/#_14","title":"\u76f8\u5173\u6587\u6863","text":"<ul> <li>\u4f9d\u8d56\u6ce8\u5165\u6307\u5357</li> <li>\u5b8c\u6574\u8fc1\u79fb\u6307\u5357</li> </ul>"},{"location":"zh/migration_guide/","title":"Cullinan 2.0 \u8fc1\u79fb\u6307\u5357","text":"<p>\u7248\u672c\uff1av0.90 \u4f5c\u8005\uff1aPlumeink</p> <p>\u672c\u6307\u5357\u5e2e\u52a9\u60a8\u4ece Cullinan 1.x \u8fc1\u79fb\u5230 2.0\uff080.90\uff09\u3002</p>"},{"location":"zh/migration_guide/#_1","title":"\u7834\u574f\u6027\u53d8\u66f4","text":""},{"location":"zh/migration_guide/#1","title":"1. \u5355\u4e00\u5165\u53e3","text":"<p>\u4e4b\u524d\uff081.x\uff09\uff1a <pre><code>from cullinan.core import get_injection_registry, get_service_registry\n\nregistry = get_injection_registry()\nregistry.add_provider_source(my_source)\n</code></pre></p> <p>\u4e4b\u540e\uff082.0\uff09\uff1a <pre><code>from cullinan.core.container import ApplicationContext, Definition, ScopeType\n\nctx = ApplicationContext()\nctx.register(Definition(\n    name='MyService',\n    factory=lambda c: MyService(),\n    scope=ScopeType.SINGLETON,\n    source='service:MyService'\n))\nctx.refresh()\n</code></pre></p>"},{"location":"zh/migration_guide/#2","title":"2. \u6ce8\u518c\u8868\u51bb\u7ed3","text":"<p>\u5728 2.0 \u4e2d\uff0c\u6ce8\u518c\u8868\u5728 <code>refresh()</code> \u540e\u88ab\u51bb\u7ed3\u3002\u4efb\u4f55\u5c1d\u8bd5\u6ce8\u518c\u65b0\u4f9d\u8d56\u7684\u64cd\u4f5c\u90fd\u4f1a\u629b\u51fa <code>RegistryFrozenError</code>\u3002</p> <p>\u4e4b\u524d\uff081.x\uff09\uff1a <pre><code># \u53ef\u4ee5\u968f\u65f6\u6ce8\u518c\nregistry.register('NewService', NewService)\n</code></pre></p> <p>\u4e4b\u540e\uff082.0\uff09\uff1a <pre><code>ctx = ApplicationContext()\nctx.register(...)  # refresh \u524d\u53ef\u4ee5\nctx.refresh()\nctx.register(...)  # RegistryFrozenError!\n</code></pre></p>"},{"location":"zh/migration_guide/#3","title":"3. \u4f5c\u7528\u57df\u5f3a\u5236","text":"<p>\u8bf7\u6c42\u4f5c\u7528\u57df\u4f9d\u8d56\u73b0\u5728\u4e25\u683c\u8981\u6c42 <code>RequestContext</code>\u3002</p> <p>\u4e4b\u524d\uff081.x\uff09\uff1a <pre><code># \u53ef\u80fd\u9759\u9ed8\u5931\u8d25\u6216\u8fd4\u56de\u9519\u8bef\u5b9e\u4f8b\ninstance = registry.get('RequestScoped')\n</code></pre></p> <p>\u4e4b\u540e\uff082.0\uff09\uff1a <pre><code>ctx.enter_request_context()\ntry:\n    instance = ctx.get('RequestScoped')  # \u6b63\u5e38\nfinally:\n    ctx.exit_request_context()\n\n# \u6ca1\u6709\u4e0a\u4e0b\u6587\uff1a\nctx.get('RequestScoped')  # ScopeNotActiveError!\n</code></pre></p>"},{"location":"zh/migration_guide/#4","title":"4. \u7ed3\u6784\u5316\u5f02\u5e38","text":"<p>\u6240\u6709\u5f02\u5e38\u73b0\u5728\u90fd\u643a\u5e26\u7ed3\u6784\u5316\u8bca\u65ad\u5b57\u6bb5\u3002</p> <p>\u4e4b\u524d\uff081.x\uff09\uff1a <pre><code>try:\n    registry.resolve('Missing')\nexcept Exception as e:\n    print(str(e))  # \u901a\u7528\u6d88\u606f\n</code></pre></p> <p>\u4e4b\u540e\uff082.0\uff09\uff1a <pre><code>from cullinan.core.diagnostics import DependencyNotFoundError\n\ntry:\n    ctx.get('Missing')\nexcept DependencyNotFoundError as e:\n    print(e.dependency_name)      # 'Missing'\n    print(e.resolution_path)      # ['ParentService', 'Missing']\n    print(e.candidate_sources)    # [{'source': '...', 'reason': '...'}]\n</code></pre></p>"},{"location":"zh/migration_guide/#5","title":"5. \u5faa\u73af\u4f9d\u8d56\u68c0\u6d4b","text":"<p>\u5faa\u73af\u4f9d\u8d56\u73b0\u5728\u4ea7\u751f\u7a33\u5b9a\u3001\u6709\u5e8f\u7684\u94fe\u8def\u3002</p> <p>\u4e4b\u524d\uff081.x\uff09\uff1a <pre><code># \u65e0\u5e8f\uff0c\u4e0d\u4e00\u81f4\u7684\u8f93\u51fa\nCircularDependencyError: Circular dependency detected\n</code></pre></p> <p>\u4e4b\u540e\uff082.0\uff09\uff1a <pre><code># \u7a33\u5b9a\u3001\u6709\u5e8f\u7684\u94fe\u8def\nCircularDependencyError: \u68c0\u6d4b\u5230\u5faa\u73af\u4f9d\u8d56: A -&gt; B -&gt; C -&gt; A\n</code></pre></p>"},{"location":"zh/migration_guide/#_2","title":"\u8fc1\u79fb\u6b65\u9aa4","text":""},{"location":"zh/migration_guide/#1_1","title":"\u7b2c 1 \u6b65\uff1a\u66f4\u65b0\u5bfc\u5165","text":"<pre><code># \u65e7\u5bfc\u5165\uff08\u5df2\u5f03\u7528\uff09\nfrom cullinan.core import get_injection_registry, Inject, InjectByName\n\n# \u65b0\u5bfc\u5165\uff082.0\uff09\nfrom cullinan.core.container import ApplicationContext, Definition, ScopeType\n</code></pre>"},{"location":"zh/migration_guide/#2_1","title":"\u7b2c 2 \u6b65\uff1a\u8f6c\u6362\u670d\u52a1\u6ce8\u518c","text":"<pre><code># \u65e7\u98ce\u683c\n@service\nclass UserService:\n    user_repo = Inject()\n\n# \u65b0\u98ce\u683c\nctx.register(Definition(\n    name='UserService',\n    factory=lambda c: UserService(user_repo=c.get('UserRepository')),\n    scope=ScopeType.SINGLETON,\n    source='service:UserService'\n))\n</code></pre>"},{"location":"zh/migration_guide/#3_1","title":"\u7b2c 3 \u6b65\uff1a\u66f4\u65b0\u5e94\u7528\u542f\u52a8","text":"<pre><code># \u65e7\u98ce\u683c\uff08app.py\uff09\nfrom cullinan.app import CullinanApplication\napp = CullinanApplication()\napp.run()\n\n# \u65b0\u98ce\u683c\nfrom cullinan.core.container import ApplicationContext\n\nctx = ApplicationContext()\n# ... \u6ce8\u518c\u5b9a\u4e49 ...\nctx.refresh()\n# ... \u8fd0\u884c tornado ...\nctx.shutdown()\n</code></pre>"},{"location":"zh/migration_guide/#4_1","title":"\u7b2c 4 \u6b65\uff1a\u5904\u7406\u8bf7\u6c42\u4f5c\u7528\u57df","text":"<pre><code># \u5728\u8bf7\u6c42\u5904\u7406\u5668\u4e2d\nclass MyHandler(RequestHandler):\n    def get(self):\n        ctx.enter_request_context()\n        try:\n            service = ctx.get('RequestScopedService')\n            # ... \u4f7f\u7528\u670d\u52a1 ...\n        finally:\n            ctx.exit_request_context()\n</code></pre>"},{"location":"zh/migration_guide/#api","title":"\u5df2\u5f03\u7528\u7684 API","text":"<p>\u4ee5\u4e0b API \u5728 2.0 \u4e2d\u5df2\u5f03\u7528\uff0c\u5c06\u5728 3.0 \u4e2d\u79fb\u9664\uff1a</p> \u5df2\u5f03\u7528 API \u66ff\u4ee3\u65b9\u6848 <code>get_injection_registry()</code> <code>ApplicationContext</code> <code>get_service_registry()</code> <code>ApplicationContext.register()</code> <code>@service</code> \u88c5\u9970\u5668\uff08\u81ea\u52a8\u6ce8\u5165\uff09 \u663e\u5f0f Definition \u6ce8\u518c <code>Inject()</code> / <code>InjectByName()</code> \u4f7f\u7528 <code>ctx.get()</code> \u7684 factory <code>DependencyInjector</code> <code>ApplicationContext</code>"},{"location":"zh/migration_guide/#_3","title":"\u517c\u5bb9\u6a21\u5f0f","text":"<p>\u8fc1\u79fb\u671f\u95f4\uff0c\u60a8\u53ef\u4ee5\u542f\u7528\u517c\u5bb9\u6a21\u5f0f\uff08\u5df2\u5f03\u7528\uff0c\u5c06\u88ab\u79fb\u9664\uff09\uff1a</p> <pre><code>from cullinan.core.container import ApplicationContext\n\nctx = ApplicationContext()\nctx.set_strict_mode(False)  # \u5141\u8bb8\u4e00\u4e9b\u65e7\u884c\u4e3a\n</code></pre> <p>\u8b66\u544a\uff1a \u517c\u5bb9\u6a21\u5f0f\u4ec5\u7528\u4e8e\u8fc1\u79fb\u3002\u751f\u4ea7\u90e8\u7f72\u524d\u52a1\u5fc5\u8fc1\u79fb\u5230\u4e25\u683c\u6a21\u5f0f\u3002</p>"},{"location":"zh/migration_guide/#_4","title":"\u6d4b\u8bd5\u8fc1\u79fb","text":"<p>\u8fd0\u884c\u6240\u6709 2.0 \u6d4b\u8bd5\u4ee5\u9a8c\u8bc1\u60a8\u7684\u8fc1\u79fb\uff1a</p> <pre><code>python -m pytest tests/test_ioc_di_v2_*.py -v\n</code></pre>"},{"location":"zh/migration_guide/#_5","title":"\u83b7\u53d6\u5e2e\u52a9","text":"<ul> <li>\u4f9d\u8d56\u6ce8\u5165\u6307\u5357</li> <li>API \u53c2\u8003</li> <li>GitHub Issues</li> </ul>"},{"location":"zh/quick_reference_di/","title":"Cullinan \u4f9d\u8d56\u6ce8\u5165\u5feb\u901f\u53c2\u8003","text":"<p>\u7248\u672c: v0.90 \u4f5c\u8005: Plumeink</p>"},{"location":"zh/quick_reference_di/#_1","title":"\u57fa\u672c\u7528\u6cd5","text":""},{"location":"zh/quick_reference_di/#1","title":"1. \u5b9a\u4e49\u670d\u52a1","text":"<pre><code>from cullinan.service import service, Service\n\n@service\nclass UserService(Service):\n    def __init__(self):\n        super().__init__()\n        self.name = \"UserService\"\n\n    def get_user(self, user_id):\n        return {\"id\": user_id, \"name\": \"John\"}\n</code></pre>"},{"location":"zh/quick_reference_di/#2-controller","title":"2. \u6ce8\u5165\u670d\u52a1\u5230 Controller","text":"<pre><code>from cullinan.controller import controller, get_api\nfrom cullinan.core import Inject, InjectByName\n\n@controller(url='/api')\nclass UserController:\n    # \u65b9\u5f0f1: \u7c7b\u578b\u6ce8\u89e3\uff08\u63a8\u8350\uff09\n    user_service: UserService = Inject()\n\n    # \u65b9\u5f0f2: \u663e\u5f0f\u6307\u5b9a\u540d\u79f0\n    auth_service = InjectByName('AuthService')\n\n    # \u65b9\u5f0f3: \u53ef\u9009\u4f9d\u8d56\n    cache_service = InjectByName('CacheService', required=False)\n</code></pre>"},{"location":"zh/quick_reference_di/#3","title":"3. \u4f7f\u7528\u6ce8\u5165\u7684\u670d\u52a1","text":"<pre><code>from cullinan.controller import controller, get_api\nfrom cullinan.core import Inject\n\n@controller(url='/api')\nclass UserController:\n    user_service: UserService = Inject()\n\n    @get_api('/users/&lt;user_id&gt;')\n    async def get_user(self, url_param):\n        user_id = url_param.get('user_id')\n        user = self.user_service.get_user(user_id)\n        return user\n</code></pre>"},{"location":"zh/quick_reference_di/#_2","title":"\u6253\u5305\u5e94\u7528\u914d\u7f6e","text":""},{"location":"zh/quick_reference_di/#_3","title":"\u4f7f\u7528\u663e\u5f0f\u6ce8\u518c\uff08\u63a8\u8350\uff09","text":"<pre><code>from cullinan import configure\nfrom my_app.service.user_service import UserService\nfrom my_app.service.auth_service import AuthService\nfrom my_app.controller.user_controller import UserController\n\n# \u5728 run() \u4e4b\u524d\u914d\u7f6e\nconfigure(\n    explicit_services=[\n        UserService,\n        AuthService,\n    ],\n    explicit_controllers=[\n        UserController,\n    ]\n)\n\nfrom cullinan.application import run\nrun()\n</code></pre>"},{"location":"zh/quick_reference_di/#pyinstaller","title":"PyInstaller \u914d\u7f6e","text":"<pre><code># your_app.spec\nhiddenimports=[\n    'my_app.service.user_service',\n    'my_app.service.auth_service',\n],\ndatas=[\n    ('my_app', 'my_app'),\n],\n</code></pre>"},{"location":"zh/quick_reference_di/#nuitka","title":"Nuitka \u914d\u7f6e","text":"<pre><code>nuitka --include-package=my_app \\\n       --include-module=my_app.service.user_service \\\n       your_app.py\n</code></pre>"},{"location":"zh/quick_reference_di/#_4","title":"\u6545\u969c\u6392\u67e5","text":"\u95ee\u9898 \u89e3\u51b3\u65b9\u6848 \u4f9d\u8d56\u4e3a None \u786e\u4fdd\u670d\u52a1\u4f7f\u7528 <code>@service</code> \u88c5\u9970\u5668 \u627e\u4e0d\u5230\u670d\u52a1 \u68c0\u67e5\u670d\u52a1\u540d\u79f0\u662f\u5426\u5339\u914d\uff08\u533a\u5206\u5927\u5c0f\u5199\uff09 \u5faa\u73af\u4f9d\u8d56 \u4f7f\u7528 <code>InjectByName()</code> \u8fdb\u884c\u5ef6\u8fdf\u89e3\u6790 \u6ce8\u5165\u4e0d\u751f\u6548 \u786e\u4fdd\u7c7b\u7ee7\u627f\u81ea <code>Service</code> \u6216 <code>Controller</code>"},{"location":"zh/quick_reference_di/#_5","title":"\u53e6\u8bf7\u53c2\u9605","text":"<ul> <li>\u4f9d\u8d56\u6ce8\u5165\u6307\u5357 - \u5b8c\u6574 DI \u6587\u6863</li> <li>\u67b6\u6784\u8bbe\u8ba1 - \u7cfb\u7edf\u67b6\u6784\u6982\u89c8</li> <li>\u8fc1\u79fb\u6307\u5357 - \u4ece\u65e7\u7248\u672c\u8fc1\u79fb</li> </ul>"},{"location":"zh/quick_start_extensions/","title":"Cullinan \u6269\u5c55\u6ce8\u518c\u5feb\u901f\u6307\u5357","text":"<p>\u7248\u672c\uff1av0.90 \u529f\u80fd\uff1a\u7edf\u4e00\u6269\u5c55\u6ce8\u518c\u4e0e\u53d1\u73b0\u6a21\u5f0f \u4f5c\u8005\uff1aPlumeink</p>"},{"location":"zh/quick_start_extensions/#_1","title":"\u5feb\u901f\u5f00\u59cb","text":""},{"location":"zh/quick_start_extensions/#1","title":"1. \u4e2d\u95f4\u4ef6\u6ce8\u518c\uff08\u63a8\u8350\u65b9\u5f0f\uff09","text":"<p>\u4f7f\u7528 <code>@middleware</code> \u88c5\u9970\u5668\u81ea\u52a8\u6ce8\u518c\u4e2d\u95f4\u4ef6\uff1a</p> <pre><code>from cullinan.middleware import middleware, Middleware\n\n@middleware(priority=100)\nclass LoggingMiddleware(Middleware):\n    \"\"\"\u65e5\u5fd7\u4e2d\u95f4\u4ef6 - \u8bb0\u5f55\u6240\u6709\u8bf7\u6c42\"\"\"\n\n    def process_request(self, handler):\n        print(f\"\u2192 Request: {handler.request.uri}\")\n        return handler  # \u8fd4\u56de handler \u7ee7\u7eed\u5904\u7406\n\n    def process_response(self, handler, response):\n        print(f\"\u2190 Response: {response}\")\n        return response\n</code></pre>"},{"location":"zh/quick_start_extensions/#2","title":"2. \u4f18\u5148\u7ea7\u63a7\u5236","text":"<p>\u4f18\u5148\u7ea7\u6570\u5b57\u8d8a\u5c0f\uff0c\u8d8a\u5148\u6267\u884c\uff1a</p> <pre><code>@middleware(priority=10)   # \u7b2c\u4e00\u4e2a\u6267\u884c\nclass CorsMiddleware(Middleware):\n    pass\n\n@middleware(priority=50)   # \u7b2c\u4e8c\u4e2a\u6267\u884c\nclass AuthMiddleware(Middleware):\n    pass\n\n@middleware(priority=100)  # \u7b2c\u4e09\u4e2a\u6267\u884c\nclass LoggingMiddleware(Middleware):\n    pass\n</code></pre> <p>\u63a8\u8350\u4f18\u5148\u7ea7\u8303\u56f4\uff1a - <code>0-50</code>\uff1a\u5173\u952e\u4e2d\u95f4\u4ef6\uff08CORS\u3001\u5b89\u5168\u68c0\u67e5\uff09 - <code>51-100</code>\uff1a\u6807\u51c6\u4e2d\u95f4\u4ef6\uff08\u65e5\u5fd7\u3001\u6307\u6807\u6536\u96c6\uff09 - <code>101-200</code>\uff1a\u5e94\u7528\u7279\u5b9a\u4e2d\u95f4\u4ef6</p>"},{"location":"zh/quick_start_extensions/#3","title":"3. \u6269\u5c55\u70b9\u53d1\u73b0","text":"<p>\u67e5\u8be2\u6846\u67b6\u63d0\u4f9b\u7684\u6269\u5c55\u70b9\uff1a</p> <pre><code>from cullinan.extensions import list_extension_points\n\n# \u67e5\u8be2\u6240\u6709\u6269\u5c55\u70b9\nall_points = list_extension_points()\n\n# \u67e5\u8be2\u7279\u5b9a\u5206\u7c7b\u7684\u6269\u5c55\u70b9\nmiddleware_points = list_extension_points(category='middleware')\nlifecycle_points = list_extension_points(category='lifecycle')\n\n# \u663e\u793a\u6269\u5c55\u70b9\u4fe1\u606f\nfor point in middleware_points:\n    print(f\"{point['name']}: {point['description']}\")\n</code></pre> <p>\u8f93\u51fa\u793a\u4f8b\uff1a <pre><code>Middleware.process_request: Intercept and process requests before they reach handlers\nMiddleware.process_response: Intercept and process responses before they are sent\n</code></pre></p>"},{"location":"zh/quick_start_extensions/#4","title":"4. \u67e5\u8be2\u5df2\u6ce8\u518c\u4e2d\u95f4\u4ef6","text":"<pre><code>from cullinan.middleware import get_middleware_registry\n\nregistry = get_middleware_registry()\nregistered = registry.get_registered_middleware()\n\nfor mw in registered:\n    print(f\"{mw['priority']:3d}: {mw['name']}\")\n</code></pre> <p>\u8f93\u51fa\u793a\u4f8b\uff1a <pre><code> 10: CorsMiddleware\n 50: AuthMiddleware\n100: LoggingMiddleware\n</code></pre></p>"},{"location":"zh/quick_start_extensions/#_2","title":"\u5b8c\u6574\u793a\u4f8b","text":""},{"location":"zh/quick_start_extensions/#api","title":"\u573a\u666f\uff1a\u6784\u5efa\u4e00\u4e2a\u5e26\u8ba4\u8bc1\u7684 API","text":"<pre><code>from cullinan import configure, run\nfrom cullinan.middleware import middleware, Middleware\nfrom cullinan.controller import controller, get_api\nfrom cullinan.service import service, Service\nfrom cullinan.core import Inject\n\n# 1. \u5b9a\u4e49\u4e2d\u95f4\u4ef6\uff08\u6309\u4f18\u5148\u7ea7\u81ea\u52a8\u6392\u5e8f\uff09\n\n@middleware(priority=10)\nclass CorsMiddleware(Middleware):\n    \"\"\"CORS \u4e2d\u95f4\u4ef6 - \u6700\u5148\u6267\u884c\"\"\"\n    def process_response(self, handler, response):\n        handler.set_header('Access-Control-Allow-Origin', '*')\n        return response\n\n\n@middleware(priority=50)\nclass AuthMiddleware(Middleware):\n    \"\"\"\u8ba4\u8bc1\u4e2d\u95f4\u4ef6 - CORS \u4e4b\u540e\u6267\u884c\"\"\"\n    def process_request(self, handler):\n        token = handler.request.headers.get('Authorization')\n        if not token and handler.request.path.startswith('/api/'):\n            handler.set_status(401)\n            handler.finish({\"error\": \"Unauthorized\"})\n            return None  # \u77ed\u8def\uff0c\u4e0d\u7ee7\u7eed\u5904\u7406\n        return handler\n\n\n@middleware(priority=100)\nclass LoggingMiddleware(Middleware):\n    \"\"\"\u65e5\u5fd7\u4e2d\u95f4\u4ef6 - \u6700\u540e\u6267\u884c\"\"\"\n    def process_request(self, handler):\n        print(f\"[{handler.request.method}] {handler.request.path}\")\n        return handler\n\n\n# 2. \u5b9a\u4e49\u670d\u52a1\n\n@service\nclass UserService(Service):\n    def get_user(self, user_id):\n        return {\"id\": user_id, \"name\": \"Alice\"}\n\n\n# 3. \u5b9a\u4e49\u63a7\u5236\u5668\n\n@controller('/api/users')\nclass UserController:\n    user_service: 'UserService' = Inject()\n\n    @get_api('/&lt;user_id&gt;')\n    def get_user(self, user_id: int):\n        return self.user_service.get_user(user_id)\n\n\n# 4. \u542f\u52a8\u5e94\u7528\n\nif __name__ == '__main__':\n    configure(\n        port=8080,\n        debug=True\n    )\n    run()\n</code></pre> <p>\u6267\u884c\u6d41\u7a0b\uff1a <pre><code>\u8bf7\u6c42\u5230\u8fbe\n  \u2193\nCorsMiddleware (priority=10)\n  \u2193\nAuthMiddleware (priority=50) \n  \u2193\nLoggingMiddleware (priority=100)\n  \u2193\nUserController.get_user()\n  \u2193\nLoggingMiddleware (\u54cd\u5e94\uff0c\u9006\u5e8f)\n  \u2193\nAuthMiddleware (\u54cd\u5e94\uff0c\u9006\u5e8f)\n  \u2193\nCorsMiddleware (\u54cd\u5e94\uff0c\u9006\u5e8f)\n  \u2193\n\u54cd\u5e94\u8fd4\u56de\n</code></pre></p>"},{"location":"zh/quick_start_extensions/#_3","title":"\u5411\u540e\u517c\u5bb9","text":"<p>\u624b\u52a8\u6ce8\u518c\u65b9\u5f0f\u4ecd\u7136\u53ef\u7528\uff1a</p> <pre><code>from cullinan.middleware import Middleware, get_middleware_registry\n\nclass MyMiddleware(Middleware):\n    def process_request(self, handler):\n        return handler\n\n# \u624b\u52a8\u6ce8\u518c\nregistry = get_middleware_registry()\nregistry.register(MyMiddleware, priority=100)\n</code></pre> <p>\u65b0\u65e7\u65b9\u5f0f\u53ef\u4ee5\u6df7\u7528\uff0c\u6846\u67b6\u4f1a\u81ea\u52a8\u6309\u4f18\u5148\u7ea7\u6392\u5e8f\u3002</p>"},{"location":"zh/quick_start_extensions/#_4","title":"\u6269\u5c55\u70b9\u5206\u7c7b","text":"<p>\u6846\u67b6\u63d0\u4f9b 6 \u5927\u7c7b\u6269\u5c55\u70b9\uff1a</p> <ol> <li>Middleware\uff08\u4e2d\u95f4\u4ef6\uff09</li> <li><code>Middleware.process_request</code></li> <li> <p><code>Middleware.process_response</code></p> </li> <li> <p>Lifecycle\uff08\u751f\u547d\u5468\u671f\uff09</p> </li> <li><code>Service.on_init</code></li> <li><code>Service.on_startup</code></li> <li> <p><code>Service.on_shutdown</code></p> </li> <li> <p>Injection\uff08\u4f9d\u8d56\u6ce8\u5165\uff09</p> </li> <li><code>custom_scope</code></li> <li> <p><code>custom_provider</code></p> </li> <li> <p>Routing\uff08\u8def\u7531\uff09</p> </li> <li> <p><code>custom_handler</code></p> </li> <li> <p>Configuration\uff08\u914d\u7f6e\uff09</p> </li> <li> <p><code>config_provider</code></p> </li> <li> <p>Handler\uff08\u5904\u7406\u5668\uff09</p> </li> <li>\u81ea\u5b9a\u4e49 Tornado Handler</li> </ol>"},{"location":"zh/quick_start_extensions/#_5","title":"\u5e38\u89c1\u95ee\u9898","text":""},{"location":"zh/quick_start_extensions/#q1-none","title":"Q1: \u4e2d\u95f4\u4ef6\u8fd4\u56de None \u4f1a\u600e\u6837\uff1f","text":"<p>A: \u8fd4\u56de <code>None</code> \u8868\u793a\u77ed\u8def\uff0c\u540e\u7eed\u4e2d\u95f4\u4ef6\u548c\u5904\u7406\u5668\u4e0d\u518d\u6267\u884c\uff1a</p> <pre><code>def process_request(self, handler):\n    if not_authorized:\n        handler.set_status(401)\n        handler.finish({\"error\": \"Unauthorized\"})\n        return None  # \u77ed\u8def\uff0c\u4e0d\u7ee7\u7eed\n    return handler  # \u7ee7\u7eed\u5230\u4e0b\u4e00\u4e2a\u4e2d\u95f4\u4ef6\n</code></pre>"},{"location":"zh/quick_start_extensions/#q2","title":"Q2: \u5982\u4f55\u67e5\u770b\u4e2d\u95f4\u4ef6\u6267\u884c\u987a\u5e8f\uff1f","text":"<p>A: \u4f7f\u7528\u6ce8\u518c\u8868\u67e5\u8be2\uff1a</p> <pre><code>from cullinan.middleware import get_middleware_registry\n\nregistry = get_middleware_registry()\nfor mw in registry.get_registered_middleware():\n    print(f\"{mw['priority']}: {mw['name']}\")\n</code></pre>"},{"location":"zh/quick_start_extensions/#q3","title":"Q3: \u53ef\u4ee5\u52a8\u6001\u6ce8\u518c\u4e2d\u95f4\u4ef6\u5417\uff1f","text":"<p>A: \u53ef\u4ee5\uff0c\u4f46\u5efa\u8bae\u5728\u5e94\u7528\u542f\u52a8\u524d\u5b8c\u6210\u6ce8\u518c\uff1a</p> <pre><code># \u542f\u52a8\u524d\u6ce8\u518c\nregistry = get_middleware_registry()\nregistry.register(DynamicMiddleware, priority=150)\n\n# \u7136\u540e\u542f\u52a8\u5e94\u7528\nrun()\n</code></pre>"},{"location":"zh/quick_start_extensions/#q4","title":"Q4: \u4e2d\u95f4\u4ef6\u4f1a\u5f71\u54cd\u6027\u80fd\u5417\uff1f","text":"<p>A: \u88c5\u9970\u5668\u6ce8\u518c\u7684\u5f00\u9500\u6781\u5c0f\uff08~1\u03bcs\uff09\uff0c\u8fd0\u884c\u65f6\u65e0\u989d\u5916\u5f00\u9500\u3002\u4e2d\u95f4\u4ef6\u7684\u6027\u80fd\u53d6\u51b3\u4e8e\u4f60\u7684\u5b9e\u73b0\u903b\u8f91\u3002</p>"},{"location":"zh/quick_start_extensions/#_6","title":"\u8fdb\u4e00\u6b65\u9605\u8bfb","text":"<ul> <li>\u793a\u4f8b\u4ee3\u7801\uff1a<code>examples/extension_registration_demo.py</code></li> <li>\u6269\u5c55\u5f00\u53d1\u6307\u5357\uff1a<code>docs/extension_development_guide.md</code></li> <li>\u4e2d\u95f4\u4ef6\u8be6\u89e3\uff1a<code>docs/wiki/middleware.md</code></li> </ul>"},{"location":"zh/quick_start_extensions/#_7","title":"\u53cd\u9988\u4e0e\u652f\u6301","text":"<p>\u5982\u6709\u95ee\u9898\u6216\u5efa\u8bae\uff0c\u8bf7\uff1a 1. \u67e5\u770b\u793a\u4f8b\u4ee3\u7801\uff1a<code>examples/extension_registration_demo.py</code> 2. \u63d0\u4ea4 Issue \u6216 PR \u5230\u9879\u76ee\u4ed3\u5e93</p>"},{"location":"zh/testing/","title":"\u6d4b\u8bd5\u4e0e\u9a8c\u8bc1","text":"<p>\u672c\u6587\u8bf4\u660e\u5982\u4f55\u8fd0\u884c\u73b0\u6709\u6d4b\u8bd5\u96c6\u3001\u6dfb\u52a0\u65b0\u7684\u6d4b\u8bd5\u3001\u4f7f\u7528\u793a\u4f8b\u8fdb\u884c\u70df\u96fe\u6d4b\u8bd5\uff0c\u4ee5\u53ca\u5728 CI \u4e2d\u96c6\u6210\u6d4b\u8bd5\u6267\u884c\u3002\u793a\u4f8b\u547d\u4ee4\u8986\u76d6 Windows\uff08PowerShell\uff09\u3001Linux \u548c macOS\u3002</p>"},{"location":"zh/testing/#_2","title":"\u524d\u7f6e\u6761\u4ef6","text":"<ul> <li>Python 3.8 \u6216\u66f4\u9ad8\u7248\u672c</li> <li>Git</li> <li>\u5df2\u514b\u9686\u5e76\u53ef\u7528\u7684 Cullinan \u4ed3\u5e93\uff08\u73af\u5883\u51c6\u5907\u53ef\u53c2\u8003 <code>docs/build_run.md</code>\uff09</li> </ul>"},{"location":"zh/testing/#_3","title":"\u8fd0\u884c\u6d4b\u8bd5\u96c6","text":"<p>\u5728\u4ee5\u53ef\u7f16\u8f91\u6a21\u5f0f\u5b89\u88c5 Cullinan \u4e4b\u540e\uff08\u53c2\u89c1 <code>docs/build_run.md</code>\uff09\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>pytest</code> \u8fd0\u884c\u6d4b\u8bd5\u3002</p> <p>\u5728\u6240\u6709\u5e73\u53f0\u4e0a\uff1a</p> <pre><code>pytest -q\n</code></pre> <p>\u5982\u679c\u503e\u5411\u4e8e\u901a\u8fc7 Python \u6a21\u5757\u65b9\u5f0f\u8c03\u7528\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\uff1a</p> <pre><code>python -m pytest -q\n</code></pre> <p>\u5728 Windows \u4e0a\uff0c\u5e38\u89c1\u7684\u505a\u6cd5\u662f\u4f7f\u7528 <code>py</code> \u542f\u52a8\u5668\uff1a</p> <pre><code>py -3 -m pytest -q\n</code></pre>"},{"location":"zh/testing/#_4","title":"\u8fd0\u884c\u5355\u4e2a\u6d4b\u8bd5\u6a21\u5757","text":"<p>\u8981\u8fd0\u884c\u5355\u4e2a\u6d4b\u8bd5\u6587\u4ef6\uff08\u4f8b\u5982 <code>tests/test_core_injection.py</code>\uff09\uff1a</p> <p>\u5728\u6240\u6709\u5e73\u53f0\u4e0a\uff1a</p> <pre><code>pytest tests/test_core_injection.py -q\n</code></pre> <p>\u6216\u4f7f\u7528 Python \u6a21\u5757\u65b9\u5f0f\uff1a</p> <pre><code>python -m pytest tests/test_core_injection.py -q\n</code></pre>"},{"location":"zh/testing/#_5","title":"\u6dfb\u52a0\u65b0\u6d4b\u8bd5","text":"<p>\u5728\u4e3a\u65b0\u7279\u6027\u6216\u7f3a\u9677\u4fee\u590d\u6dfb\u52a0\u6d4b\u8bd5\u65f6\uff0c\u5efa\u8bae\u9075\u5faa\u4ee5\u4e0b\u539f\u5219\uff1a</p> <ol> <li>\u5c06\u6d4b\u8bd5\u6587\u4ef6\u653e\u7f6e\u5728 <code>tests/</code> \u76ee\u5f55\u4e0b\u3002</li> <li>\u4f7f\u7528\u5177\u6709\u63cf\u8ff0\u6027\u7684\u6d4b\u8bd5\u540d\u79f0\uff0c\u5e76\u5c06\u76f8\u5173\u6d4b\u8bd5\u7ec4\u7ec7\u5728\u540c\u4e00\u6a21\u5757\u4e2d\u3002</li> <li>\u4f18\u5148\u91c7\u7528 <code>pytest</code> \u98ce\u683c\u7684\u6d4b\u8bd5\uff08\u51fd\u6570\u6216\u6d4b\u8bd5\u7c7b\uff09\uff0c\u4e0e\u73b0\u6709\u6d4b\u8bd5\u96c6\u4fdd\u6301\u4e00\u81f4\u3002</li> <li>\u786e\u4fdd\u6d4b\u8bd5\u5177\u6709\u786e\u5b9a\u6027\uff0c\u4e0d\u4f9d\u8d56\u5916\u90e8\u670d\u52a1\uff0c\u9664\u975e\u660e\u786e\u6807\u6ce8\u3002</li> </ol>"},{"location":"zh/testing/#_6","title":"\u4f7f\u7528\u793a\u4f8b\u8fdb\u884c\u70df\u96fe\u6d4b\u8bd5","text":"<p>Cullinan \u5728 <code>examples/</code> \u76ee\u5f55\u4e0b\u63d0\u4f9b\u4e86\u53ef\u8fd0\u884c\u793a\u4f8b\uff0c\u53ef\u4f5c\u4e3a\u70df\u96fe\u6d4b\u8bd5\u4f7f\u7528\u3002</p>"},{"location":"zh/testing/#hello-http","title":"\u793a\u4f8b\uff1aHello HTTP","text":"<p>\u5728 Windows\uff08PowerShell\uff09\u4e2d\uff1a</p> <pre><code>python examples\\hello_http.py\n</code></pre> <p>\u5728 Linux / macOS \u4e2d\uff1a</p> <pre><code>python examples/hello_http.py\n</code></pre> <p>\u7136\u540e\u5728\u6d4f\u89c8\u5668\u4e2d\u8bbf\u95ee <code>http://localhost:4080/hello</code>\uff0c\u9a8c\u8bc1\u670d\u52a1\u662f\u5426\u6b63\u5e38\u54cd\u5e94\u3002</p>"},{"location":"zh/testing/#_7","title":"\u793a\u4f8b\uff1a\u4e2d\u95f4\u4ef6\u6f14\u793a","text":"<p>\u5728 Windows\uff08PowerShell\uff09\u4e2d\uff1a</p> <pre><code>python examples\\middleware_demo.py\n</code></pre> <p>\u5728 Linux / macOS \u4e2d\uff1a</p> <pre><code>python examples/middleware_demo.py\n</code></pre> <p>\u65e5\u5fd7\u8f93\u51fa\u5c06\u5c55\u793a\u4e2d\u95f4\u4ef6\u548c\u6ce8\u5165\u7684\u670d\u52a1\u5982\u4f55\u53c2\u4e0e\u8bf7\u6c42\u5904\u7406\u3002\u5177\u4f53\u65f6\u95f4\u6233\u548c ID \u4f1a\u56e0\u8fd0\u884c\u73af\u5883\u4e0d\u540c\u800c\u6709\u6240\u5dee\u5f02\u3002</p>"},{"location":"zh/testing/#ci","title":"\u5728 CI \u4e2d\u96c6\u6210\u6d4b\u8bd5","text":"<p>\u5728 CI \u6d41\u6c34\u7ebf\u4e2d\uff0c\u901a\u5e38\u9700\u8981\u6267\u884c\u4ee5\u4e0b\u6b65\u9aa4\uff1a</p> <ol> <li>\u51c6\u5907 Python \u8fd0\u884c\u73af\u5883\u3002</li> <li>\u4ee5\u53ef\u7f16\u8f91\u6a21\u5f0f\u5b89\u88c5\u4f9d\u8d56\uff08\u53ef\u9009\u5b89\u88c5\u5f00\u53d1\u989d\u5916\u4f9d\u8d56\uff09\u3002</li> <li>\u4f7f\u7528 <code>pytest</code> \u8fd0\u884c\u6d4b\u8bd5\u96c6\u3002</li> </ol> <p>bash \u98ce\u683c\u7684\u5178\u578b\u547d\u4ee4\u5e8f\u5217\uff08\u53ef\u6839\u636e CI \u7cfb\u7edf\u8fdb\u884c\u8c03\u6574\uff09\uff1a</p> <pre><code>python -m pip install -U pip\npip install -e .[dev]\npytest -q\n</code></pre> <p>\u5728\u57fa\u4e8e Windows \u7684 CI \u73af\u5883\u4e2d\u4f7f\u7528 PowerShell \u65f6\uff0c\u53ef\u4f7f\u7528\u7c7b\u4f3c\u547d\u4ee4\uff1a</p> <pre><code>python -m pip install -U pip\npip install -e .[dev]\npy -3 -m pytest -q\n</code></pre> <p>\u53ef\u6839\u636e CI \u63d0\u4f9b\u5546\u4e0e\u5177\u4f53\u73af\u5883\u8c03\u6574\u547d\u4ee4\u4e0e\u9009\u9879\u3002</p>"},{"location":"zh/modules/app/","title":"cullinan.app","text":"<p>\u8bf4\u660e\uff08v0.90\uff09\uff1a\u5e94\u7528\u751f\u547d\u5468\u671f\u73b0\u5728\u7531 <code>ApplicationContext</code> \u7ba1\u7406\u3002 \u65b0\u7684 IoC/DI 2.0 \u751f\u547d\u5468\u671f\u8bf7\u53c2\u9605 \u4f9d\u8d56\u6ce8\u5165\u6307\u5357\u3002 \u4f7f\u7528 <code>ApplicationContext.refresh()</code> \u548c <code>ApplicationContext.shutdown()</code> \u8fdb\u884c\u751f\u547d\u5468\u671f\u7ba1\u7406\u3002</p> <p>\u6458\u8981\uff1a<code>cullinan.app</code> \u6a21\u5757\u6587\u6863\u5360\u4f4d\u3002\u63cf\u8ff0\u5165\u53e3\u70b9\u4ee5\u53ca\u5982\u4f55\u521b\u5efa\u5e94\u7528\u5b9e\u4f8b\u3002</p> <p>\u5efa\u8bae\u8bb0\u5f55\u7684\u516c\u6709\u7b26\u53f7\uff1aApp\uff0cmain\uff08\u5982\u5b58\u5728\uff09</p>"},{"location":"zh/modules/app/#api","title":"\u516c\u5171 API\uff08\u81ea\u52a8\u751f\u6210\uff09","text":""},{"location":"zh/modules/app/#cullinanapp_1","title":"cullinan.app","text":"\u540d\u79f0 \u7c7b\u578b \u7b7e\u540d / \u503c <code>CullinanApplication</code> class <code>CullinanApplication(shutdown_timeout: int = 30)</code> <code>create_app</code> function <code>create_app(shutdown_timeout: int = 30) -&gt; cullinan.app.CullinanApplication</code>"},{"location":"zh/modules/app/#_1","title":"\u793a\u4f8b\uff1a\u521b\u5efa\u5e76\u8fd0\u884c\u5e94\u7528","text":"<pre><code># \u5feb\u901f\uff08\u63a8\u8350\uff09: \u5728\u5165\u53e3\u811a\u672c\u4f7f\u7528 framework \u5165\u53e3\u51fd\u6570\nfrom cullinan import application\n\nif __name__ == '__main__':\n    application.run()\n\n# \u9ad8\u7ea7\uff08\u53ef\u9009\uff09: \u7f16\u7a0b\u5316\u63a7\u5236\uff08\u4f8b\u5982\u5728\u6d4b\u8bd5\u6216\u9700\u8981\u6dfb\u52a0\u5173\u95ed\u5904\u7406\u5668\u65f6\uff09\nfrom cullinan.app import create_app\n\napplication_instance = create_app()\n# \u73b0\u5728\u53ef\u4ee5\u4ee5\u7f16\u7a0b\u65b9\u5f0f\u8c03\u7528 application_instance.startup()/application_instance.shutdown() \u6216 application_instance.add_shutdown_handler(...)\n# application_instance.run()  # \u5728 CLI \u5165\u53e3\u8c03\u7528\n</code></pre> <p>\u8bf4\u660e\uff1a<code>CullinanApplication.run()</code> \u4f1a\u6ce8\u518c\u4fe1\u53f7\u5904\u7406\u5668\u5e76\u542f\u52a8 Tornado \u7684 IOLoop\uff1b\u5728 CLI \u5165\u53e3\u8c03\u7528\u3002\u6d4b\u8bd5\u6216\u7a0b\u5e8f\u5316\u63a7\u5236\u8bf7\u7528 <code>create_app()</code> \u521b\u5efa\u5b9e\u4f8b\u3002</p>"},{"location":"zh/modules/application/","title":"cullinan.application","text":"<p>\u8bf4\u660e\uff08v0.90\uff09\uff1a\u65b0\u7684 IoC/DI 2.0 \u67b6\u6784\u8bf7\u53c2\u9605 \u4f9d\u8d56\u6ce8\u5165\u6307\u5357\u3002</p> <p>\u6458\u8981\uff1a<code>cullinan.application</code> \u6a21\u5757\u6587\u6863\u5360\u4f4d\u3002\u5305\u542b\u516c\u6709\u7c7b\u3001\u5178\u578b\u7528\u6cd5\uff0c\u53ca\u76f8\u5173\u6d4b\u8bd5/\u793a\u4f8b\u94fe\u63a5\u3002</p> <p>\u5efa\u8bae\u8bb0\u5f55\u7684\u516c\u6709\u7b26\u53f7\uff1aApplication\uff0cstart\uff0cstop</p> <p>\u793a\u4f8b\u7528\u6cd5\uff1a</p> <p>\uff08\u5360\u4f4d\uff1a\u5c55\u793a\u5178\u578b Application \u4f7f\u7528\u7684\u6700\u5c0f\u4ee3\u7801\u7247\u6bb5\uff09</p>"},{"location":"zh/modules/application/#_1","title":"\u793a\u4f8b","text":""},{"location":"zh/modules/application/#hello-http","title":"Hello HTTP\uff08\u70df\u96fe\u6d4b\u8bd5\u793a\u4f8b\uff09","text":"<p>\u4ed3\u5e93\u5305\u542b\u4e00\u4e2a\u6700\u5c0f\u793a\u4f8b <code>examples/hello_http.py</code>\uff0c\u7528\u4e8e\u6587\u6863\u4e2d\u7684\u70df\u96fe\u6d4b\u8bd5\u3002\u8be5\u793a\u4f8b\u4e0d\u4f7f\u7528 <code>application.run()</code>\uff0c\u800c\u662f\u76f4\u63a5\u901a\u8fc7 Cullinan \u7684 handler registry \u6ce8\u518c\u4e00\u4e2a\u7b80\u5355\u7684 Tornado \u5904\u7406\u5668\uff0c\u542f\u52a8\u4e00\u4e2a\u77ed\u65f6 HTTP \u670d\u52a1\u5668\uff0c\u53d1\u8d77\u4e00\u6b21\u9a8c\u8bc1\u8bf7\u6c42\uff0c\u7136\u540e\u9000\u51fa\u3002</p> <p>\u6ce8\u610f\uff1a\u6b64\u793a\u4f8b\u7684\u8f93\u51fa\u4e0e\u4f7f\u7528 <code>application.run()</code> \u542f\u52a8\u7684\u5e38\u89c4\u5e94\u7528\u4e0d\u540c\u3002<code>application.run()</code> \u4f1a\u663e\u793a Cullinan \u6846\u67b6 banner\u3001\u626b\u63cf\u670d\u52a1\u548c\u63a7\u5236\u5668\uff0c\u5e76\u4fdd\u6301\u670d\u52a1\u5668\u8fd0\u884c\u76f4\u5230\u624b\u52a8\u505c\u6b62\uff08Ctrl+C\uff09\u3002</p> <p>PowerShell\uff08Windows\uff09\u8fd0\u884c\u547d\u4ee4\uff1a</p> <pre><code>pip install -U pip\npip install cullinan tornado\npython examples\\hello_http.py\n</code></pre> <p>\u89c2\u5bdf\u5230\u7684\u8f93\u51fa\uff08\u8282\u9009\uff09\uff1a</p> <pre><code>INFO:__main__:Starting IOLoop... (will stop after one verification request)\nINFO:__main__:Async Requesting http://127.0.0.1:4080/hello\nINFO:tornado.access:200 GET /hello (127.0.0.1) 0.50ms\nINFO:__main__:Response status: 200\nINFO:__main__:Response body: Hello Cullinan\nINFO:__main__:IOLoop stopped, exiting\n</code></pre> <p>\u8bf4\u660e\uff1a\u8be5\u793a\u4f8b\u9002\u5408\u7528\u4f5c\u6587\u6863\u6216 CI \u7684\u70df\u96fe\u6d4b\u8bd5\uff08\u542f\u52a8\u3001\u9a8c\u8bc1\u8bf7\u6c42\u3001\u9000\u51fa\uff09\uff0c\u4f46\u4e0d\u4ee3\u8868 <code>application.run()</code> \u7684\u5b9e\u9645\u884c\u4e3a\u3002</p>"},{"location":"zh/modules/controller/","title":"cullinan.controller","text":"<p>\u8bf4\u660e\uff08v0.90\uff09\uff1a\u63a7\u5236\u5668 DI \u73b0\u5728\u7531 <code>ApplicationContext</code> \u7ba1\u7406\u3002 \u65b0\u7684 IoC/DI 2.0 \u67b6\u6784\u8bf7\u53c2\u9605 \u4f9d\u8d56\u6ce8\u5165\u6307\u5357\u3002</p> <p>\u6458\u8981\uff1a\u63a7\u5236\u5668\u6ce8\u518c\u3001\u751f\u547d\u5468\u671f\u4e0e\u6ce8\u5165\u5230\u63a7\u5236\u5668\u5b9e\u4f8b\u7684\u673a\u5236\u3002\u8bb0\u5f55\u4f7f\u7528\u6a21\u5f0f\u4e0e\u5e38\u89c1\u9677\u9631\u3002</p>"},{"location":"zh/modules/controller/#api","title":"\u516c\u5171 API\uff08\u81ea\u52a8\u751f\u6210\uff09","text":""},{"location":"zh/modules/controller/#cullinancontroller_1","title":"cullinan.controller","text":"\u540d\u79f0 \u7c7b\u578b \u7b7e\u540d / \u503c <code>ControllerRegistry</code> class <code>ControllerRegistry()</code> <code>EncapsulationHandler</code> class <code>EncapsulationHandler()</code> <code>Handler</code> class <code>Handler(application: 'Application', request: tornado.httputil.HTTPServerRequest, **kwargs: Any) -&gt; None</code> <code>HeaderRegistry</code> class <code>HeaderRegistry()</code> <code>HttpResponse</code> class <code>HttpResponse() -&gt; None</code> <code>ResponsePool</code> class <code>ResponsePool(size: int = 100)</code> <code>StatusResponse</code> class <code>StatusResponse(**kwargs) -&gt; None</code> <code>controller</code> function <code>controller(**kwargs) -&gt; Callable</code> <code>delete_api</code> function <code>delete_api(**kwargs: Any) -&gt; Callable</code> <code>disable_response_pooling</code> function <code>disable_response_pooling() -&gt; None</code> <code>emit_access_log</code> function <code>emit_access_log(request: Any, resp_obj: Optional[Any], status_code: Optional[int], duration: float) -&gt; None</code> <code>enable_response_pooling</code> function <code>enable_response_pooling(pool_size: int = 100) -&gt; None</code> <code>get_api</code> function <code>get_api(**kwargs: Any) -&gt; Callable</code> <code>get_controller_registry</code> function <code>get_controller_registry() -&gt; cullinan.controller.registry.ControllerRegistry</code> <code>get_header_registry</code> function <code>get_header_registry() -&gt; cullinan.controller.core.HeaderRegistry</code> <code>get_missing_header_handler</code> function <code>get_missing_header_handler() -&gt; Callable[[Any, str], NoneType]</code> <code>get_pooled_response</code> function <code>get_pooled_response() -&gt; cullinan.controller.core.HttpResponse</code> <code>get_response_pool_stats</code> function <code>get_response_pool_stats() -&gt; Optional[dict]</code> <code>header_resolver</code> function <code>header_resolver(self, header_names: Optional[Sequence] = None) -&gt; Optional[dict]</code> <code>patch_api</code> function <code>patch_api(**kwargs: Any) -&gt; Callable</code> <code>post_api</code> function <code>post_api(**kwargs: Any) -&gt; Callable</code> <code>put_api</code> function <code>put_api(**kwargs: Any) -&gt; Callable</code> <code>request_handler</code> function <code>request_handler(self, func: Callable, params: Tuple, headers: Optional[dict], type: str, get_request_body: bool = False) -&gt; None</code> <code>request_resolver</code> function <code>request_resolver(self, url_param_key_list: Optional[Sequence] = None, url_param_value_list: Optional[Sequence] = None, query_param_names: Optional[Sequence] = None, body_param_names: Optional[Sequence] = None, file_param_key_list: Optional[Sequence] = None) -&gt; Tuple[Optional[dict], Optional[dict], Optional[dict], Optional[dict]]</code> <code>reset_controller_registry</code> function <code>reset_controller_registry() -&gt; None</code> <code>response</code> class <code>response()</code> <code>response_build</code> function <code>response_build(**kwargs) -&gt; cullinan.controller.core.StatusResponse</code> <code>return_pooled_response</code> function <code>return_pooled_response(resp: cullinan.controller.core.HttpResponse) -&gt; None</code> <code>set_missing_header_handler</code> function <code>set_missing_header_handler(handler: Callable[[Any, str], NoneType])</code> <code>url_resolver</code> function <code>url_resolver(url: str) -&gt; Tuple[str, list]</code>"},{"location":"zh/modules/controller/#_1","title":"\u793a\u4f8b\uff1a\u6ce8\u518c\u4e00\u4e2a\u7b80\u5355\u63a7\u5236\u5668","text":"<pre><code>from cullinan.controller import controller, get_controller_registry\n\n@controller(path='/hello')\ndef hello(request):\n    return {'status': 200, 'body': 'Hello World'}\n\n# \u53ef\u9009\uff1a\u76f4\u63a5\u6ce8\u518c\u5230 registry\uff08\u901a\u5e38\u7531\u6a21\u5757\u626b\u63cf\u81ea\u52a8\u53d1\u73b0\uff09\nregistry = get_controller_registry()\nregistry.register(r'/hello', hello)\n</code></pre> <p>\u8bf4\u660e\uff1a - \u4f7f\u7528 <code>controller</code> \u88c5\u9970\u5668\u6ce8\u518c\u8def\u7531\u5904\u7406\u5668\uff1b\u6846\u67b6\u652f\u6301\u6a21\u5757\u626b\u63cf\u81ea\u52a8\u53d1\u73b0\u6216\u663e\u5f0f\u6ce8\u518c\u3002 - \u82e5\u5904\u7406\u5668\u9700\u8981\u4f9d\u8d56\u6ce8\u5165\uff0c\u8bf7\u4f7f\u7528 <code>@injectable</code> \u7c7b\u6216\u5c5e\u6027\u6ce8\u5165\u5e76\u786e\u4fdd\u5728\u5e94\u7528\u542f\u52a8\u524d\u5df2\u6ce8\u518c\u76f8\u5e94 provider\u3002</p>"},{"location":"zh/modules/core/","title":"cullinan.core","text":"<p>\u8bf4\u660e\uff08v0.90\uff09\uff1a\u6838\u5fc3\u6a21\u5757\u5df2\u5728 0.90 \u7248\u672c\u4e2d\u91cd\u65b0\u7ec4\u7ec7\u3002 \u65b0\u7684 IoC/DI 2.0 API \u8bf7\u53c2\u9605 \u4f9d\u8d56\u6ce8\u5165\u6307\u5357\u3002 \u65b0\u9879\u76ee\u5e94\u4f7f\u7528 <code>cullinan.core.container</code> \u4e2d\u7684 <code>ApplicationContext</code>\u3002</p> <p>\u65b0\u6a21\u5757\u7ed3\u6784\uff1a - <code>cullinan.core.container</code> - ApplicationContext\u3001Definition\u3001ScopeType - <code>cullinan.core.diagnostics</code> - \u5f02\u5e38\u4e0e\u9519\u8bef\u6e32\u67d3 - <code>cullinan.core.lifecycle</code> - \u751f\u547d\u5468\u671f\u7ba1\u7406 - <code>cullinan.core.request</code> - \u8bf7\u6c42\u4e0a\u4e0b\u6587</p> <p>\u6458\u8981\uff1a\u6838\u5fc3 IoC/DI \u539f\u8bed\uff0cprovider\u3001scope\u3001registry \u4e0e\u751f\u547d\u5468\u671f\u5e2e\u52a9\u5668\u3002\u672c\u9875\u5e94\u5f15\u7528 <code>cullinan/core/</code> \u4e0b\u7684\u5177\u4f53\u6587\u4ef6\u5e76\u5305\u542b\u4f7f\u7528\u793a\u4f8b\u3002</p> <p>\u5efa\u8bae\u8bb0\u5f55\u7684\u516c\u6709\u7b26\u53f7\uff1aprovider\u3001registry\u3001scope\u3001\u6ce8\u5165\u76f8\u5173 API</p>"},{"location":"zh/modules/core/#_1","title":"\u793a\u4f8b","text":"<p>\u5c5e\u6027\u6ce8\u5165\u793a\u4f8b\uff08\u8bf7\u6c42\u4f5c\u7528\u57df\u7684 provider\uff09\uff1a</p> <pre><code>from cullinan.core import (\n    ProviderRegistry, ScopedProvider, get_request_scope,\n    injectable, Inject, get_injection_registry, reset_injection_registry\n)\n\nclass Database:\n    def __init__(self):\n        self.id = object()\n\nreset_injection_registry()\nregistry = ProviderRegistry()\nrequest_scope = get_request_scope()\nregistry.register_provider('Database', ScopedProvider(lambda: Database(), request_scope, 'Database'))\nget_injection_registry().add_provider_registry(registry)\n\n@injectable\nclass Service:\n    db: Database = Inject()\n\ns = Service()\nassert s.db is not None\n</code></pre> <p>\u6784\u9020\u5668\u6ce8\u5165\u793a\u4f8b\uff1a</p> <pre><code>from cullinan.core import inject_constructor, reset_injection_registry, ProviderRegistry, ScopedProvider, get_request_scope, get_injection_registry\n\nclass Config:\n    pass\n\nreset_injection_registry()\npr = ProviderRegistry()\npr.register_provider('Config', ScopedProvider(lambda: Config(), get_request_scope(), 'Config'))\nget_injection_registry().add_provider_registry(pr)\n\n@inject_constructor\nclass Controller:\n    def __init__(self, config: Config):\n        self.config = config\n\nc = Controller()\nassert c.config is not None\n</code></pre> <p>\u8bf4\u660e\uff1a - \u5728\u6d4b\u8bd5/\u8bbe\u7f6e\u4e2d\u4f7f\u7528 <code>reset_injection_registry()</code> \u4ee5\u786e\u4fdd\u6ce8\u5165\u72b6\u6001\u5e72\u51c0\u3002 - \u5bf9\u4e8e\u5c5e\u6027\u6ce8\u5165\u4f18\u5148\u4f7f\u7528 <code>@injectable</code>\uff0c\u9700\u8981\u6784\u9020\u5668\u6ce8\u5165\u65f6\u4f7f\u7528 <code>@inject_constructor</code>\u3002\u786e\u4fdd\u5728\u89e3\u6790\u6ce8\u5165\u524d ProviderRegistry \u4e2d\u5df2\u6ce8\u518c\u76f8\u5e94\u63d0\u4f9b\u8005\u3002</p>"},{"location":"zh/modules/service/","title":"cullinan.service","text":"<p>\u8bf4\u660e\uff08v0.90\uff09\uff1a\u670d\u52a1\u73b0\u5728\u53ef\u4ee5\u901a\u8fc7 <code>ApplicationContext</code> \u6ce8\u518c\u3002 \u65b0\u7684 IoC/DI 2.0 \u67b6\u6784\u8bf7\u53c2\u9605 \u4f9d\u8d56\u6ce8\u5165\u6307\u5357\u3002</p> <p>\u6458\u8981\uff1a\u670d\u52a1\u6ce8\u518c\u4e0e\u63d0\u4f9b\u8005\u6a21\u5f0f\u3002\u8bb0\u5f55\u670d\u52a1\u5982\u4f55\u88ab\u63d0\u4f9b\u3001\u4f5c\u7528\u57df\u53ca\u6ce8\u5165\u65b9\u5f0f\u3002</p>"},{"location":"zh/modules/service/#api","title":"\u516c\u5171 API\uff08\u81ea\u52a8\u751f\u6210\uff09","text":""},{"location":"zh/modules/service/#cullinanservice_1","title":"cullinan.service","text":"\u540d\u79f0 \u7c7b\u578b \u7b7e\u540d / \u503c <code>Service</code> class <code>Service()</code> <code>ServiceRegistry</code> class <code>ServiceRegistry()</code> <code>get_service_registry</code> function <code>get_service_registry() -&gt; cullinan.service.registry.ServiceRegistry</code> <code>reset_service_registry</code> function <code>reset_service_registry() -&gt; None</code> <code>service</code> function <code>service(cls: Optional[Type[cullinan.service.base.Service]] = None, *, dependencies: Optional[List[str]] = None)</code>"},{"location":"zh/modules/service/#_1","title":"\u8bf4\u660e\u4e0e\u793a\u4f8b","text":"<p>\u5360\u4f4d\uff1a\u63cf\u8ff0 Service \u7684\u6ce8\u518c\u3001\u5178\u578b <code>@service</code> \u7528\u6cd5\uff0c\u4ee5\u53ca\u5982\u4f55\u4ece registry \u83b7\u53d6\u6216\u91cd\u7f6e service registry\uff1b\u7ed9\u51fa\u6700\u5c0f\u793a\u4f8b\u8bf4\u660e\u5982\u4f55\u58f0\u660e\u4e00\u4e2a Service \u5e76\u4ece registry \u4e2d\u68c0\u7d22\u5b83\u3002</p>"},{"location":"zh/modules/service/#_2","title":"\u793a\u4f8b\uff1a\u6ce8\u518c\u5e76\u4f7f\u7528\u670d\u52a1","text":"<pre><code>from cullinan.service import Service, service, get_service_registry\n\n@service\nclass DatabaseService(Service):\n    def __init__(self):\n        self.connection = \"db_connection_mock\"\n\n    def query(self, sql):\n        return f\"Result for: {sql}\"\n\n# \u670d\u52a1\u901a\u8fc7 @service \u88c5\u9970\u5668\u81ea\u52a8\u6ce8\u518c\nregistry = get_service_registry()\ndb_service = registry.get('DatabaseService')\nresult = db_service.query(\"SELECT * FROM users\")\nprint(result)  # \u8f93\u51fa: Result for: SELECT * FROM users\n</code></pre> <p>\u8bf4\u660e\uff1a - \u4f7f\u7528 <code>@service</code> \u88c5\u9970\u5668\u5728\u6a21\u5757\u626b\u63cf\u6216\u663e\u5f0f\u521d\u59cb\u5316\u65f6\u81ea\u52a8\u6ce8\u518c\u670d\u52a1\u3002 - \u670d\u52a1\u901a\u5e38\u4e3a\u957f\u671f\u8fd0\u884c\uff08\u9ed8\u8ba4\u5355\u4f8b\u4f5c\u7528\u57df\uff0c\u9664\u975e\u53e6\u884c\u914d\u7f6e\uff09\u3002 - \u901a\u8fc7 <code>get_service_registry()</code> \u8bbf\u95ee\u670d\u52a1\uff0c\u6216\u5728 controller/handler \u4e2d\u901a\u8fc7 DI \u6ce8\u5165\u4f7f\u7528\u3002</p>"},{"location":"zh/wiki/components/","title":"\u7ec4\u4ef6","text":"<p>\u8bf4\u660e\uff08v0.90\uff09\uff1a\u6838\u5fc3\uff08IoC/DI\uff09\u7ec4\u4ef6\u5df2\u5728 0.90 \u7248\u672c\u4e2d\u91cd\u65b0\u8bbe\u8ba1\u3002 \u65b0\u67b6\u6784\u8bf7\u53c2\u9605 \u4f9d\u8d56\u6ce8\u5165\u6307\u5357\u3002 <code>cullinan.core.container</code> \u4e2d\u7684\u65b0 <code>ApplicationContext</code> \u662f\u63a8\u8350\u7684\u5165\u53e3\u70b9\u3002</p> <p>\u672c\u6587\u4ecb\u7ecd Cullinan \u7684\u4e3b\u8981\u7ec4\u4ef6\u53ca\u5176\u804c\u8d23\uff0c\u5e76\u7ed9\u51fa\u5b9e\u73b0\u4ee3\u7801\u7684\u6307\u5411\uff08<code>cullinan/</code> \u5305\uff09\u3002\u76ee\u6807\u662f\u4e3a\u8d21\u732e\u8005\u4e0e\u4f7f\u7528\u8005\u63d0\u4f9b\u4e00\u4e2a\u7b80\u660e\u7d22\u5f15\uff0c\u65b9\u4fbf\u5b9a\u4f4d\u6e90\u7801\u5b50\u7cfb\u7edf\u3002</p> <p>\u7ec4\u4ef6\u6982\u89c8</p> <ul> <li>\u8def\u7531 / URL \u89e3\u6790\u5668</li> <li>\u804c\u8d23\uff1a\u5c06 URL \u6a21\u5f0f\u89e3\u6790\u4e3a\u63a7\u5236\u5668\u5904\u7406\u51fd\u6570\u5e76\u5206\u53d1\u8bf7\u6c42\u3002</li> <li>\u5173\u952e\u6587\u4ef6\uff1a<code>cullinan/controller/core.py</code>\u3001<code>cullinan/controller/registry.py</code>\u3001<code>cullinan/controller/__init__.py</code>\u3002</li> <li> <p>\u516c\u6709\u7b26\u53f7\uff1a<code>controller</code>\uff08\u88c5\u9970\u5668\uff09\u3001<code>get_controller_registry</code>\u3001<code>url_resolver</code>\u3002</p> </li> <li> <p>\u63a7\u5236\u5668\u5c42</p> </li> <li>\u804c\u8d23\uff1a\u5b9a\u4e49\u63a7\u5236\u5668\u7c7b\u4e0e\u5904\u7406\u5668\u65b9\u6cd5\uff1b\u63d0\u4f9b\u8bf7\u6c42/\u54cd\u5e94\u62bd\u8c61\u4e0e\u54cd\u5e94\u6c60\u5de5\u5177\u3002</li> <li>\u5173\u952e\u6587\u4ef6\uff1a<code>cullinan/controller/core.py</code>\u3001<code>cullinan/controller/registry.py</code>\u3001<code>cullinan/controller/stateless_validator.py</code>\u3002</li> <li> <p>\u516c\u6709\u7b26\u53f7\uff1a<code>Handler</code>\u3001<code>ControllerRegistry</code>\u3001<code>response_build</code>\u3001<code>request_resolver</code>\u3002</p> </li> <li> <p>\u8bf7\u6c42\u5904\u7406\u4e0e HTTP \u96c6\u6210</p> </li> <li>\u804c\u8d23\uff1a\u628a Tornado \u7684 <code>HTTPServerRequest</code> \u9002\u914d\u4e3a\u63a7\u5236\u5668\u5904\u7406\u5668\uff0c\u7ba1\u7406\u8bf7\u6c42\u89e3\u6790\u4e0e\u5934\u90e8\u89e3\u6790\u3002</li> <li>\u5173\u952e\u6587\u4ef6\uff1a<code>cullinan/handler/*</code>\u3001<code>cullinan/controller/core.py</code>\u3002</li> <li> <p>\u516c\u6709\u7b26\u53f7\uff1a<code>get_handler_registry</code>\u3001<code>request_handler</code>\u3002</p> </li> <li> <p>\u4e2d\u95f4\u4ef6</p> </li> <li>\u804c\u8d23\uff1a\u63d0\u4f9b\u8bf7\u6c42/\u54cd\u5e94\u5904\u7406\u7684\u62e6\u622a\u70b9\uff0c\u5982\u8ba4\u8bc1\u3001\u65e5\u5fd7\u6216\u53d8\u6362\u3002</li> <li>\u5173\u952e\u6587\u4ef6\uff1a<code>cullinan/middleware/*</code>\u3002</li> <li> <p>\u8bf4\u660e\uff1a\u4e2d\u95f4\u4ef6\u6309\u6d41\u6c34\u7ebf\u5e94\u7528\uff1b\u8be6\u89c1 <code>middleware</code> \u76ee\u5f55\u4e2d\u7684\u6837\u4f8b\u4e0e\u987a\u5e8f\u8bed\u4e49\u3002</p> </li> <li> <p>\u670d\u52a1\uff08\u4e1a\u52a1\u5c42\uff09</p> </li> <li>\u804c\u8d23\uff1a\u4e3a\u63a7\u5236\u5668\u63d0\u4f9b\u957f\u671f\u8fd0\u884c\u7684\u670d\u52a1\uff08\u6570\u636e\u5e93\u8bbf\u95ee\u3001\u7f13\u5b58\u3001\u540e\u53f0\u4efb\u52a1\u7b49\uff09\u3002</li> <li>\u5173\u952e\u6587\u4ef6\uff1a<code>cullinan/service/*</code>\uff08base\u3001decorators\u3001registry\uff09\u3002</li> <li> <p>\u516c\u6709\u7b26\u53f7\uff1a<code>Service</code>\u3001<code>ServiceRegistry</code>\u3001<code>service</code>\uff08\u88c5\u9970\u5668\uff09\u3001<code>get_service_registry</code>\u3002</p> </li> <li> <p>\u6838\u5fc3\uff08IoC / DI / \u751f\u547d\u5468\u671f / provider / scope\uff09</p> </li> <li>\u804c\u8d23\uff1a\u4f9d\u8d56\u6ce8\u5165\u3001\u63d0\u4f9b\u8005\u6ce8\u518c\u3001\u4f5c\u7528\u57df\uff08singleton/transient/request\uff09\u3001\u751f\u547d\u5468\u671f\u7ba1\u7406\u3002</li> <li>\u5173\u952e\u6587\u4ef6\uff1a<code>cullinan/core/*</code>\uff08<code>injection.py</code>\u3001<code>provider.py</code>\u3001<code>registry.py</code>\u3001<code>scope.py</code>\u3001<code>lifecycle*.py</code>\uff09\u3002</li> <li> <p>\u516c\u6709\u7b26\u53f7\uff1a<code>Inject</code>\u3001<code>injectable</code>\u3001<code>inject_constructor</code>\u3001<code>InjectionRegistry</code>\u3001<code>ProviderRegistry</code>\u3001<code>SingletonScope</code>\u3001<code>RequestScope</code>\u3001<code>create_context</code>\u3002</p> </li> <li> <p>\u5e94\u7528 / \u542f\u52a8</p> </li> <li>\u804c\u8d23\uff1a\u5e94\u7528\u751f\u547d\u5468\u671f\u3001\u670d\u52a1\u53d1\u73b0\u4e0e\u521d\u59cb\u5316\u3001\u6709\u5e8f\u7684\u542f\u52a8/\u5173\u95ed\u4e0e\u4fe1\u53f7\u5904\u7406\u3002</li> <li>\u5173\u952e\u6587\u4ef6\uff1a<code>cullinan/app.py</code>\u3001<code>cullinan/application.py</code>\u3002</li> <li>\u516c\u6709\u7b26\u53f7\uff1a<code>create_app</code>\u3001<code>CullinanApplication</code>\u3001<code>run</code>\uff08\u5e94\u7528\u5165\u53e3\uff09\u3002</li> </ul> <p>\u793a\u4f8b \u2014 \u5feb\u901f\u53c2\u8003</p> <p>\u6700\u5c0f\u7684\u63a7\u5236\u5668\u6ce8\u518c\u793a\u4f8b\uff08\u6982\u5ff5\u6027\uff09\uff1a</p> <pre><code>from cullinan.controller import controller, get_controller_registry\n\n@controller(path='/hello')\ndef hello_handler(request):\n    return {'status': 200, 'body': 'Hello Cullinan'}\n\n# \u63a7\u5236\u5668\u88ab\u626b\u63cf\u6216\u6ce8\u518c\uff1b\u5e94\u7528\u4f1a\u5c06 /hello \u8def\u7531\u5230 hello_handler\n</code></pre> <p>\u6700\u5c0f\u7684\u670d\u52a1\u793a\u4f8b\uff08\u6982\u5ff5\u6027\uff09\uff1a</p> <pre><code>from cullinan.service import Service, service, get_service_registry\n\n@service\ndef MySvc():\n    # \u6ce8\u518c\u670d\u52a1\n    pass\n\nsvc_registry = get_service_registry()\n</code></pre> <p>\u63a5\u4e0b\u6765\u5e94\u67e5\u770b\u7684\u5730\u65b9</p> <ul> <li>\u9605\u8bfb <code>tests/</code> \u4e0b\u7684\u6d4b\u8bd5\u4ee5\u83b7\u53d6\u771f\u5b9e\u7528\u6cd5\u4e0e\u671f\u671b\u884c\u4e3a\uff1a\u63a8\u8350\u8d77\u70b9 <code>tests/test_core_injection.py</code>\u3001<code>tests/test_controller_injection_fix.py</code>\u3001<code>tests/test_provider_system.py</code>\u3002</li> <li>\u9605\u8bfb <code>docs/wiki/injection.md</code> \u4ee5\u83b7\u53d6 IoC/DI \u7684\u8be6\u7ec6\u793a\u4f8b\u4e0e\u53ef\u8fd0\u884c\u7247\u6bb5\u3002</li> </ul> <p>\u6587\u6863\u4e0b\u4e00\u6b65</p> <ul> <li>\u6269\u5c55\u6bcf\u4e2a\u7ec4\u4ef6\u5c0f\u8282\uff0c\u52a0\u5165\u65f6\u5e8f\u56fe\u4e0e\u4ece\u6d4b\u8bd5\u4e2d\u63d0\u53d6\u7684\u5177\u4f53\u4ee3\u7801\u6837\u4f8b\u3002</li> <li>\u589e\u52a0\u4e00\u4e2a\u516c\u6709\u7b26\u53f7\u5230\u6587\u4ef6\u8def\u5f84\u7684\u6620\u5c04\u8868\uff0c\u4fbf\u4e8e\u5feb\u901f\u5bfc\u822a\u6e90\u7801\u3002</li> </ul>"},{"location":"zh/wiki/decorators/","title":"\u88c5\u9970\u5668","text":"<p>\u7248\u672c: v0.90 \u4f5c\u8005: Plumeink</p> <p>\u672c\u6587\u6863\u63cf\u8ff0 Cullinan 0.90 \u4e2d\u57fa\u4e8e\u88c5\u9970\u5668\u7684\u7ec4\u4ef6\u6ce8\u518c\u7cfb\u7edf\u3002</p>"},{"location":"zh/wiki/decorators/#_2","title":"\u6982\u8ff0","text":"<p>Cullinan 0.90 \u5f15\u5165\u4e86\u5f3a\u5927\u7684\u88c5\u9970\u5668\u7cfb\u7edf\uff0c\u63d0\u4f9b\u4e86\u4e00\u79cd\u7b80\u6d01\u3001\u58f0\u660e\u5f0f\u7684\u7ec4\u4ef6\u6ce8\u518c\u65b9\u5f0f\u3002\u8fd9\u79cd\u65b9\u5f0f\u4e0e Cullinan \u7684\u539f\u59cb\u8bbe\u8ba1\u7406\u5ff5\u4fdd\u6301\u4e00\u81f4\uff0c\u540c\u65f6\u4e0e\u65b0\u7684 IoC/DI 2.0 \u67b6\u6784\u96c6\u6210\u3002</p>"},{"location":"zh/wiki/decorators/#_3","title":"\u6838\u5fc3\u7279\u6027","text":"<ul> <li>\u7b80\u6d01\u8bed\u6cd5\uff1a\u4f7f\u7528 <code>@service</code>\u3001<code>@controller</code>\u3001<code>@component</code>\uff0c\u65e0\u9700\u62ec\u53f7</li> <li>\u4e24\u9636\u6bb5\u6ce8\u518c\uff1a\u88c5\u9970\u5668\u6536\u96c6\u5143\u6570\u636e \u2192 <code>refresh()</code> \u7edf\u4e00\u6ce8\u518c</li> <li>\u4f9d\u8d56\u6ce8\u5165\uff1a\u4f7f\u7528 <code>Inject</code>\u3001<code>InjectByName</code>\u3001<code>Lazy</code> \u6807\u8bb0</li> <li>\u6761\u4ef6\u6ce8\u518c\uff1a\u6839\u636e\u6761\u4ef6\u6ce8\u518c\u7ec4\u4ef6</li> </ul>"},{"location":"zh/wiki/decorators/#_4","title":"\u7ec4\u4ef6\u88c5\u9970\u5668","text":""},{"location":"zh/wiki/decorators/#service","title":"@service","text":"<p>\u5c06\u7c7b\u6807\u8bb0\u4e3a\u670d\u52a1\u7ec4\u4ef6\u3002\u670d\u52a1\u9ed8\u8ba4\u4e3a\u5355\u4f8b\u6a21\u5f0f\u3002</p> <pre><code>from cullinan.core import service\nfrom cullinan.core.decorators import Inject\n\n# \u7b80\u5355\u7528\u6cd5\uff08\u65e0\u9700\u62ec\u53f7\uff09\n@service\nclass UserService:\n    def get_user(self, id: int):\n        return {\"id\": id}\n\n# \u5e26\u53c2\u6570\n@service(name=\"customUserService\", scope=\"prototype\")\nclass UserService:\n    pass\n\n# \u5e26\u4f9d\u8d56\n@service(dependencies=[\"EmailService\"])\nclass NotificationService:\n    email: EmailService = Inject()\n</code></pre> <p>\u53c2\u6570\uff1a</p> \u53c2\u6570 \u7c7b\u578b \u9ed8\u8ba4\u503c \u63cf\u8ff0 <code>name</code> <code>str</code> \u7c7b\u540d \u81ea\u5b9a\u4e49\u7ec4\u4ef6\u540d\u79f0 <code>scope</code> <code>str</code> <code>\"singleton\"</code> \u4f5c\u7528\u57df\uff1a<code>\"singleton\"</code>\u3001<code>\"prototype\"</code>\u3001<code>\"request\"</code> <code>dependencies</code> <code>list[str]</code> <code>None</code> \u663e\u5f0f\u4f9d\u8d56\u5217\u8868\uff08\u7528\u4e8e\u6392\u5e8f\uff09"},{"location":"zh/wiki/decorators/#controller","title":"@controller","text":"<p>\u5c06\u7c7b\u6807\u8bb0\u4e3a\u63a7\u5236\u5668\u7ec4\u4ef6\u3002\u63a7\u5236\u5668\u5904\u7406 HTTP \u8bf7\u6c42\u3002</p> <pre><code>from cullinan.core import controller\nfrom cullinan.core.decorators import Inject\n\n# \u7b80\u5355\u7528\u6cd5\n@controller\nclass RootController:\n    pass\n\n# \u5e26 URL \u524d\u7f00\n@controller(url=\"/api/users\")\nclass UserController:\n    user_service: UserService = Inject()\n\n    @get_api(url=\"\")\n    def list_users(self):\n        return {\"users\": []}\n\n    @get_api(url=\"/{id}\")\n    def get_user(self, url_params):\n        user_id = url_params.get(\"id\")\n        return self.user_service.get_user(user_id)\n</code></pre> <p>\u53c2\u6570\uff1a</p> \u53c2\u6570 \u7c7b\u578b \u9ed8\u8ba4\u503c \u63cf\u8ff0 <code>url</code> <code>str</code> <code>\"\"</code> \u6240\u6709\u8def\u7531\u7684 URL \u524d\u7f00"},{"location":"zh/wiki/decorators/#component","title":"@component","text":"<p>\u901a\u7528\u7ec4\u4ef6\u88c5\u9970\u5668\uff0c\u7528\u4e8e\u65e2\u4e0d\u662f\u670d\u52a1\u4e5f\u4e0d\u662f\u63a7\u5236\u5668\u7684\u7c7b\u3002</p> <pre><code>from cullinan.core import component\n\n# \u7b80\u5355\u7528\u6cd5\n@component\nclass CacheManager:\n    pass\n\n# \u5e26\u4f5c\u7528\u57df\n@component(scope=\"prototype\")\nclass RequestHandler:\n    pass\n\n# \u5e26\u81ea\u5b9a\u4e49\u540d\u79f0\n@component(name=\"myHelper\")\nclass Helper:\n    pass\n</code></pre> <p>\u53c2\u6570\uff1a</p> \u53c2\u6570 \u7c7b\u578b \u9ed8\u8ba4\u503c \u63cf\u8ff0 <code>name</code> <code>str</code> \u7c7b\u540d \u81ea\u5b9a\u4e49\u7ec4\u4ef6\u540d\u79f0 <code>scope</code> <code>str</code> <code>\"singleton\"</code> \u4f5c\u7528\u57df\uff1a<code>\"singleton\"</code>\u3001<code>\"prototype\"</code>\u3001<code>\"request\"</code>"},{"location":"zh/wiki/decorators/#provider","title":"@provider","text":"<p>\u5c06\u7c7b\u6807\u8bb0\u4e3a\u4f9d\u8d56\u63d0\u4f9b\u8005\uff08\u5de5\u5382\uff09\u3002</p> <pre><code>from cullinan.core.decorators import provider\n\n@provider\nclass DatabaseConnectionProvider:\n    def get(self):\n        return create_connection()\n\n@provider(name=\"customProvider\")\nclass CustomProvider:\n    pass\n</code></pre>"},{"location":"zh/wiki/decorators/#_5","title":"\u6ce8\u5165\u6807\u8bb0","text":""},{"location":"zh/wiki/decorators/#inject","title":"Inject","text":"<p>\u6309\u7c7b\u578b\u6ce8\u89e3\u6ce8\u5165\u4f9d\u8d56\u3002</p> <pre><code>from cullinan.core.decorators import Inject\n\n@service\nclass UserService:\n    # \u5fc5\u987b\u6ce8\u5165\uff08\u9ed8\u8ba4\uff09\n    email_service: EmailService = Inject()\n\n    # \u53ef\u9009\u6ce8\u5165\n    cache: CacheService = Inject(required=False)\n</code></pre> <p>\u53c2\u6570\uff1a</p> \u53c2\u6570 \u7c7b\u578b \u9ed8\u8ba4\u503c \u63cf\u8ff0 <code>required</code> <code>bool</code> <code>True</code> \u627e\u4e0d\u5230\u4f9d\u8d56\u65f6\u662f\u5426\u629b\u51fa\u9519\u8bef"},{"location":"zh/wiki/decorators/#injectbyname","title":"InjectByName","text":"<p>\u6309\u663e\u5f0f\u540d\u79f0\u6ce8\u5165\u4f9d\u8d56\u3002</p> <pre><code>from cullinan.core.decorators import InjectByName\n\n@service\nclass UserService:\n    # \u663e\u5f0f\u540d\u79f0\n    email = InjectByName(\"EmailService\")\n\n    # \u4ece\u5c5e\u6027\u540d\u81ea\u52a8\u63a8\u65ad\uff08user_repo -&gt; UserRepo\uff09\n    user_repo = InjectByName()\n</code></pre> <p>\u53c2\u6570\uff1a</p> \u53c2\u6570 \u7c7b\u578b \u9ed8\u8ba4\u503c \u63cf\u8ff0 <code>name</code> <code>str</code> <code>None</code> \u4f9d\u8d56\u540d\u79f0\uff08None \u65f6\u81ea\u52a8\u63a8\u65ad\uff09 <code>required</code> <code>bool</code> <code>True</code> \u627e\u4e0d\u5230\u4f9d\u8d56\u65f6\u662f\u5426\u629b\u51fa\u9519\u8bef"},{"location":"zh/wiki/decorators/#lazy","title":"Lazy","text":"<p>\u5ef6\u8fdf\u6ce8\u5165 - \u9996\u6b21\u8bbf\u95ee\u65f6\u89e3\u6790\u4f9d\u8d56\u3002\u7528\u4e8e\u6253\u65ad\u5faa\u73af\u4f9d\u8d56\u3002</p> <pre><code>from cullinan.core.decorators import Lazy\n\n@service\nclass ServiceA:\n    # \u6253\u65ad\u5faa\u73af\u4f9d\u8d56\n    service_b: 'ServiceB' = Lazy()\n\n@service\nclass ServiceB:\n    service_a: 'ServiceA' = Lazy()\n</code></pre> <p>\u53c2\u6570\uff1a</p> \u53c2\u6570 \u7c7b\u578b \u9ed8\u8ba4\u503c \u63cf\u8ff0 <code>name</code> <code>str</code> <code>None</code> \u53ef\u9009\u7684\u663e\u5f0f\u4f9d\u8d56\u540d\u79f0"},{"location":"zh/wiki/decorators/#_6","title":"\u6761\u4ef6\u88c5\u9970\u5668","text":""},{"location":"zh/wiki/decorators/#conditionalonproperty","title":"@ConditionalOnProperty","text":"<p>\u6839\u636e\u914d\u7f6e\u5c5e\u6027\u6ce8\u518c\u7ec4\u4ef6\u3002</p> <pre><code>from cullinan.core.decorators import service\nfrom cullinan.core.conditions import ConditionalOnProperty\n\n@service\n@ConditionalOnProperty(\"feature.email\", having_value=\"true\")\nclass EmailService:\n    pass\n\n@service\n@ConditionalOnProperty(\"cache.enabled\", match_if_missing=True)\nclass CacheService:\n    pass\n</code></pre>"},{"location":"zh/wiki/decorators/#conditionalonclass","title":"@ConditionalOnClass","text":"<p>\u4ec5\u5f53\u7c7b/\u6a21\u5757\u53ef\u7528\u65f6\u6ce8\u518c\u7ec4\u4ef6\u3002</p> <pre><code>from cullinan.core.conditions import ConditionalOnClass\n\n@service\n@ConditionalOnClass(\"redis.Redis\")\nclass RedisCacheService:\n    pass\n</code></pre>"},{"location":"zh/wiki/decorators/#conditionalonmissingbean","title":"@ConditionalOnMissingBean","text":"<p>\u4ec5\u5f53\u6307\u5b9a bean \u672a\u6ce8\u518c\u65f6\u6ce8\u518c\u7ec4\u4ef6\u3002</p> <pre><code>from cullinan.core.conditions import ConditionalOnMissingBean\n\n@service\n@ConditionalOnMissingBean(\"CustomEmailService\")\nclass DefaultEmailService:\n    pass\n</code></pre>"},{"location":"zh/wiki/decorators/#conditionalonbean","title":"@ConditionalOnBean","text":"<p>\u4ec5\u5f53\u6307\u5b9a bean \u5b58\u5728\u65f6\u6ce8\u518c\u7ec4\u4ef6\u3002</p> <pre><code>from cullinan.core.conditions import ConditionalOnBean\n\n@service\n@ConditionalOnBean(\"DatabaseConnection\")\nclass DatabaseService:\n    pass\n</code></pre>"},{"location":"zh/wiki/decorators/#conditional","title":"@Conditional","text":"<p>\u4f7f\u7528\u81ea\u5b9a\u4e49\u51fd\u6570\u7684\u901a\u7528\u6761\u4ef6\u88c5\u9970\u5668\u3002</p> <pre><code>from cullinan.core.conditions import Conditional\n\ndef is_production(ctx):\n    return ctx.get_property(\"env\") == \"production\"\n\n@service\n@Conditional(is_production)\nclass ProductionOnlyService:\n    pass\n</code></pre>"},{"location":"zh/wiki/decorators/#_7","title":"\u5b8c\u6574\u793a\u4f8b","text":"<pre><code>from cullinan.core import service, controller, ApplicationContext, PendingRegistry\nfrom cullinan.core.decorators import Inject, InjectByName\nfrom cullinan.core.conditions import ConditionalOnClass\n\n# \u91cd\u7f6e\u4ee5\u83b7\u5f97\u5e72\u51c0\u72b6\u6001\nPendingRegistry.reset()\n\n# \u5b9a\u4e49\u670d\u52a1\n@service\nclass EmailService:\n    def send(self, to: str, content: str):\n        return f\"\u90ae\u4ef6\u5df2\u53d1\u9001\u81f3 {to}\"\n\n@service\nclass UserService:\n    email_service: EmailService = Inject()\n\n    def get_user(self, id: int):\n        return {\"id\": id, \"name\": f\"\u7528\u6237{id}\"}\n\n    def notify_user(self, id: int):\n        user = self.get_user(id)\n        return self.email_service.send(user[\"name\"], \"\u4f60\u597d\uff01\")\n\n# \u5b9a\u4e49\u63a7\u5236\u5668\n@controller(url=\"/api/users\")\nclass UserController:\n    user_service: UserService = Inject()\n\n    @get_api(url=\"/{id}\")\n    def get_user(self, url_params):\n        user_id = url_params.get(\"id\")\n        return self.user_service.get_user(user_id)\n\n# \u53ef\u9009\u7684 JSON \u5904\u7406\u5668\uff08\u4ec5\u5f53 json \u6a21\u5757\u53ef\u7528\u65f6\uff09\n@service\n@ConditionalOnClass(\"json\")\nclass JsonProcessor:\n    def process(self, data):\n        import json\n        return json.dumps(data)\n\n# \u521b\u5efa\u5e76\u542f\u52a8\u5e94\u7528\nctx = ApplicationContext()\nctx.refresh()\n\n# \u4f7f\u7528\u670d\u52a1\nuser_svc = ctx.get(\"UserService\")\nprint(user_svc.get_user(1))\n# \u8f93\u51fa: {'id': 1, 'name': '\u7528\u62371'}\n\n# \u6e05\u7406\nctx.shutdown()\n</code></pre>"},{"location":"zh/wiki/decorators/#_8","title":"\u4e24\u9636\u6bb5\u6ce8\u518c","text":"<p>\u88c5\u9970\u5668\u4f7f\u7528\u4e24\u9636\u6bb5\u6ce8\u518c\u673a\u5236\uff1a</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502     \u6a21\u5757\u52a0\u8f7d        \u2502     \u2502  ApplicationContext \u2502     \u2502      \u8fd0\u884c\u65f6\u4f7f\u7528     \u2502\n\u2502                     \u2502     \u2502      refresh()      \u2502     \u2502                     \u2502\n\u2502  @service \u6536\u96c6      \u2502\u2500\u2500\u2500\u2500\u25b6\u2502  \u5904\u7406\u5f85\u6ce8\u518c\u7ec4\u4ef6     \u2502\u2500\u2500\u2500\u2500\u25b6\u2502  ctx.get(\"Name\")    \u2502\n\u2502  \u5143\u6570\u636e\u5230           \u2502     \u2502  \u51bb\u7ed3\u6ce8\u518c\u8868         \u2502     \u2502  \u8fd4\u56de\u5b9e\u4f8b           \u2502\n\u2502  PendingRegistry    \u2502     \u2502                     \u2502     \u2502                     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"zh/wiki/decorators/#pendingregistry","title":"PendingRegistry","text":"<p>\u6240\u6709\u88c5\u9970\u5668\u5143\u6570\u636e\u90fd\u6536\u96c6\u5728 <code>PendingRegistry</code> \u4e2d\uff1a</p> <pre><code>from cullinan.core import PendingRegistry\n\n# \u5728 refresh \u524d\u68c0\u67e5\u5df2\u6ce8\u518c\u7684\u7ec4\u4ef6\npending = PendingRegistry.get_instance()\nprint(f\"\u5f85\u6ce8\u518c\u6570\u91cf: {pending.count}\")\n\n# refresh \u540e\uff0c\u6ce8\u518c\u8868\u88ab\u51bb\u7ed3\nctx.refresh()\nassert pending.is_frozen  # True\n</code></pre>"},{"location":"zh/wiki/decorators/#_9","title":"\u6700\u4f73\u5b9e\u8df5","text":"<ol> <li> <p>\u5c3d\u53ef\u80fd\u4e0d\u4f7f\u7528\u62ec\u53f7\uff1a<code>@service</code> \u6bd4 <code>@service()</code> \u66f4\u7b80\u6d01</p> </li> <li> <p>\u4f7f\u7528 <code>Inject</code> \u8fdb\u884c\u7c7b\u578b\u6ce8\u5165\uff1a\u63d0\u4f9b\u66f4\u597d\u7684 IDE \u652f\u6301</p> </li> <li> <p>\u4f7f\u7528 <code>Lazy</code> \u5904\u7406\u5faa\u73af\u4f9d\u8d56\uff1a\u663e\u5f0f\u6253\u65ad\u5faa\u73af</p> </li> <li> <p>\u6761\u4ef6\u88c5\u9970\u5668\u653e\u5728\u7ec4\u4ef6\u88c5\u9970\u5668\u4e4b\u540e\uff1a\u987a\u5e8f\u5f88\u91cd\u8981\uff01    <pre><code>@service  # \u9996\u5148\n@ConditionalOnClass(\"redis\")  # \u5176\u6b21\nclass RedisService:\n    pass\n</code></pre></p> </li> <li> <p>\u5728\u6d4b\u8bd5\u4e2d\u91cd\u7f6e PendingRegistry\uff1a    <pre><code>def setup_method(self):\n    PendingRegistry.reset()\n</code></pre></p> </li> </ol>"},{"location":"zh/wiki/decorators/#v083","title":"\u4ece v0.83 \u8fc1\u79fb","text":"v0.83 v0.90 <code>@service</code>\uff08\u6765\u81ea <code>cullinan.service</code>\uff09 <code>@service</code>\uff08\u6765\u81ea <code>cullinan.core</code>\uff09 <code>@controller(url=...)</code>\uff08\u6765\u81ea <code>cullinan.controller</code>\uff09 <code>@controller(url=...)</code>\uff08\u6765\u81ea <code>cullinan.core</code>\uff09 \u624b\u52a8\u670d\u52a1\u6ce8\u518c <code>ApplicationContext.refresh()</code> <pre><code># \u4e4b\u524d (v0.83)\nfrom cullinan.service import service\nfrom cullinan.controller import controller\n\n# \u4e4b\u540e (v0.90)\nfrom cullinan.core import service, controller\n</code></pre>"},{"location":"zh/wiki/decorators/#_10","title":"\u76f8\u5173\u6587\u6863","text":"<ul> <li>\u4f9d\u8d56\u6ce8\u5165\u6307\u5357</li> <li>\u5bfc\u5165\u8fc1\u79fb\u6307\u5357</li> <li>\u7ec4\u4ef6</li> </ul>"},{"location":"zh/wiki/extensions/","title":"\u6269\u5c55\u4e0e\u63d2\u4ef6","text":"<p>\u8bf4\u660e\uff08v0.90\uff09\uff1a\u6269\u5c55\u6ce8\u518c\u65b9\u5f0f\u5df2\u5728 0.90 \u7248\u672c\u4e2d\u66f4\u65b0\u3002 \u65b0\u7684\u6269\u5c55\u7cfb\u7edf\u8bf7\u53c2\u9605 \u6269\u5c55\u5feb\u901f\u5165\u95e8 \u548c \u6269\u5c55\u5f00\u53d1\u6307\u5357\u3002 <code>cullinan.core.container</code> \u4e2d\u7684\u65b0 <code>ApplicationContext</code> \u662f\u6ce8\u518c\u6269\u5c55\u7684\u63a8\u8350\u65b9\u5f0f\u3002</p> <p>\u672c\u6587\u6863\u8bf4\u660e\u5982\u4f55\u901a\u8fc7\u81ea\u5b9a\u4e49\u63d2\u4ef6\u6269\u5c55 Cullinan\u3002\u5185\u5bb9\u5305\u62ec\u6269\u5c55\u70b9\u3001\u63d0\u4f9b\u8005\u6ce8\u518c\u3001\u5178\u578b\u63d2\u4ef6\u6a21\u5f0f\uff0c\u4ee5\u53ca\u4e00\u4e2a\u6700\u5c0f\u793a\u4f8b\uff08\u5c55\u793a\u5982\u4f55\u6ce8\u518c\u81ea\u5b9a\u4e49 provider \u5e76\u6302\u63a5\u5230\u5e94\u7528\u751f\u547d\u5468\u671f\uff09\u3002</p> <p>\u8bbe\u8ba1\u539f\u5219</p> <ul> <li>\u975e\u4fb5\u5165\u5f0f\uff1a\u4f18\u5148\u901a\u8fc7\u6ce8\u518c provider\u3001controller \u6216 middleware \u6269\u5c55\uff0c\u800c\u4e0d\u662f\u4fee\u6539\u6846\u67b6\u5185\u90e8\u3002</li> <li>\u53ef\u64a4\u9500\uff1a\u66b4\u9732\u7684\u6269\u5c55\u70b9\u5e94\u53ef\u79fb\u9664/\u53d6\u6d88\u6ce8\u518c\uff0c\u4fbf\u4e8e\u6d4b\u8bd5\u4e0e\u8fd0\u884c\u65f6\u91cd\u65b0\u914d\u7f6e\u3002</li> <li>\u53ef\u53d1\u73b0\u6027\uff1a\u63d2\u4ef6\u5e94\u53ef\u901a\u8fc7\u6a21\u5757\u626b\u63cf\u6216\u663e\u5f0f\u6ce8\u518c API \u88ab\u53d1\u73b0\u3002</li> </ul> <p>\u6269\u5c55\u70b9</p> <ol> <li>Provider \u4e0e ServiceRegistry</li> <li>\u4f7f\u7528 <code>ProviderRegistry</code> \u4e0e\u63d0\u4f9b\u8005\u5b9e\u73b0\uff08<code>ClassProvider</code>\u3001<code>FactoryProvider</code>\u3001<code>InstanceProvider</code>\uff09\u6765\u63d0\u4f9b\u670d\u52a1\u3002\u5148\u6ce8\u518c provider\uff0c\u7136\u540e\u628a provider registry \u6dfb\u52a0\u5230\u5168\u5c40\u7684 <code>InjectionRegistry</code>\uff0c\u8fd9\u6837\u6ce8\u5165\u70b9\u624d\u80fd\u89e3\u6790\u4f9d\u8d56\u3002</li> <li> <p>\u5173\u952e API\uff1a<code>cullinan.core.ProviderRegistry</code>\u3001<code>cullinan.core.ScopedProvider</code>\u3001<code>cullinan.service.registry.ServiceRegistry</code>\u3002</p> </li> <li> <p>\u63a7\u5236\u5668</p> </li> <li>\u4f7f\u7528 <code>controller</code> \u88c5\u9970\u5668\u6216\u663e\u5f0f\u6ce8\u518c API \u6ce8\u518c controller \u51fd\u6570/\u7c7b\u3002\u6dfb\u52a0\u8def\u7531\u7684\u63d2\u4ef6\u5e94\u5728\u5e94\u7528\u542f\u52a8\u9636\u6bb5\u6ce8\u518c\u63a7\u5236\u5668\u3002</li> <li> <p>\u5173\u952e API\uff1a<code>cullinan.controller.controller</code>\u3001<code>cullinan.controller.get_controller_registry()</code>\u3002</p> </li> <li> <p>\u4e2d\u95f4\u4ef6</p> </li> <li>\u5b9e\u73b0\u9075\u5faa\u9879\u76ee\u4e2d\u95f4\u4ef6\u7ea6\u5b9a\u7684\u4e2d\u95f4\u4ef6\u7c7b/\u51fd\u6570\uff0c\u5e76\u5728\u5e94\u7528\u914d\u7f6e\u6216\u542f\u52a8\u671f\u95f4\u6ce8\u518c\uff0c\u4ee5\u5f71\u54cd\u8bf7\u6c42/\u54cd\u5e94\u5904\u7406\u3002</li> <li> <p>\u5173\u952e API\uff1a<code>cullinan.middleware</code> \u5305\uff08\u53c2\u89c1\u793a\u4f8b\uff09\u3002</p> </li> <li> <p>\u751f\u547d\u5468\u671f\u94a9\u5b50</p> </li> <li>\u63d2\u4ef6\u53ef\u4ee5\u901a\u8fc7 <code>CullinanApplication.add_shutdown_handler</code> \u6ce8\u518c\u542f\u52a8/\u5173\u95ed\u5904\u7406\u5668\uff0c\u4e5f\u53ef\u4ee5\u5b9e\u73b0 <code>LifecycleAware</code> \u63a5\u53e3\u4ee5\u96c6\u6210\u751f\u547d\u5468\u671f\u7ba1\u7406\u3002</li> <li>\u5173\u952e API\uff1a<code>CullinanApplication.add_shutdown_handler</code>\u3001<code>cullinan.core.lifecycle</code> \u5de5\u5177\u51fd\u6570\u3002</li> </ol> <p>\u53d1\u73b0\u4e0e\u6ce8\u518c\u6a21\u5f0f</p> <ul> <li>\u663e\u5f0f\u6ce8\u518c\uff08\u63a8\u8350\uff09\uff1a\u63d2\u4ef6\u63d0\u4f9b <code>register(app_or_registry)</code> \u51fd\u6570\uff0c\u5e94\u7528\u5728\u542f\u52a8\u65f6\u8c03\u7528\u8be5\u51fd\u6570\u8fdb\u884c\u6ce8\u518c\u3002\u793a\u4f8b\uff1a</li> </ul> <pre><code># my_plugin.py\nfrom cullinan.service import Service, service\nfrom cullinan.core import ProviderRegistry, ScopedProvider, SingletonScope\n\nclass MyService(Service):\n    def __init__(self):\n        self.value = 'my plugin service'\n\ndef register_service(provider_registry: ProviderRegistry):\n    provider_registry.register_provider(\n        'MyService',\n        ScopedProvider(lambda: MyService(), SingletonScope(), 'MyService')\n    )\n\n# \u5e94\u7528\u542f\u52a8\uff1a\n# provider_registry = ProviderRegistry()\n# register_service(provider_registry)\n# injection_registry.add_provider_registry(provider_registry)\n</code></pre> <ul> <li>\u81ea\u52a8\u53d1\u73b0\uff08\u4fbf\u6377\uff09\uff1a\u542f\u7528\u6a21\u5757\u626b\u63cf\u65f6\u53ef\u4ee5\u5728\u9884\u5b9a\u4e49\u547d\u540d\u7a7a\u95f4\u4e0b\u53d1\u73b0\u63d2\u4ef6\u5305\uff08\u4f8b\u5982 <code>myproject.plugins.*</code>\uff09\u3002\u751f\u4ea7\u73af\u5883\u5efa\u8bae\u4f7f\u7528\u663e\u5f0f\u6ce8\u518c\u3002</li> </ul> <p>\u6253\u5305\u4e0e\u5206\u53d1</p> <ul> <li>\u5c06\u63d2\u4ef6\u6253\u5305\u4e3a\u6807\u51c6 Python \u5305\uff0c\u66b4\u9732 <code>register()</code> \u5165\u53e3\u6216\u7ea6\u5b9a\u6a21\u5757\u8def\u5f84\u4ee5\u4f9b\u53d1\u73b0\u3002</li> <li>\u53ef\u9009\uff1a\u5728 <code>setup.cfg</code> / <code>setup.py</code> \u4e2d\u4f7f\u7528 <code>entry_points</code>\uff08\u4f8b\u5982 <code>cullinan.plugins</code>\uff09\u5e76\u901a\u8fc7 <code>pkg_resources</code> \u6216 <code>importlib.metadata</code> \u53d1\u73b0\u5df2\u5b89\u88c5\u63d2\u4ef6\u3002</li> </ul> <p>\u6700\u5c0f\u63d2\u4ef6\u793a\u4f8b \u2014 \u65e5\u5fd7\u4e2d\u95f4\u4ef6</p> <pre><code># my_logging_plugin.py\nimport logging\nfrom cullinan.middleware import MiddlewareBase\n\nlogger = logging.getLogger('my_plugin')\n\nclass RequestLogger(MiddlewareBase):\n    def process_request(self, request):\n        logger.info('Incoming %s %s', request.method, request.path)\n\ndef register(app):\n    # app-specific registration, pseudocode\n    app.add_middleware(RequestLogger())\n</code></pre> <p>\u63d2\u4ef6\u6d4b\u8bd5</p> <ul> <li>\u5728\u9694\u79bb\u73af\u5883\u4e2d\u5355\u5143\u6d4b\u8bd5\u63d2\u4ef6\uff0c\u6a21\u62df provider registry \u4e0e\u5e94\u7528\u751f\u547d\u5468\u671f\u3002</li> <li>\u786e\u4fdd <code>register()</code> \u662f\u5e42\u7b49\u7684\uff0c\u6216\u5728\u51fd\u6570\u5185\u52a0\u5165\u9632\u91cd\u590d\u6ce8\u518c\u7684\u4fdd\u62a4\u903b\u8f91\u3002</li> </ul> <p>\u5b89\u5168\u4e0e\u517c\u5bb9\u6027\u6ce8\u610f</p> <ul> <li>\u63d2\u4ef6\u5728\u5e94\u7528\u8fdb\u7a0b\u4e2d\u8fd0\u884c\uff1b\u907f\u514d\u6267\u884c\u4e0d\u53d7\u4fe1\u4efb\u7684\u4ee3\u7801\u6216\u5141\u8bb8\u63d2\u4ef6\u8fd0\u884c\u4efb\u610f\u542f\u52a8\u811a\u672c\u3002</li> <li>\u5728\u63d2\u4ef6\u5305\u4e2d\u8bb0\u5f55\u5bf9 Cullinan \u7248\u672c\u7684\u517c\u5bb9\u6027\u4e0e\u5347\u7ea7\u8bf4\u660e\u3002</li> </ul> <p>\u4e0b\u4e00\u6b65</p> <ul> <li>\u63d0\u4f9b\u63d2\u4ef6\u811a\u624b\u67b6\uff08cookiecutter\uff09\u4ee5\u7b80\u5316\u63d2\u4ef6\u5f00\u53d1\u3002</li> <li>\u5728 <code>examples/</code> \u76ee\u5f55\u6dfb\u52a0\u63d2\u4ef6\u793a\u4f8b\u5305\uff0c\u5e76\u5728 CI \u4e2d\u8fd0\u884c\u8fd9\u4e9b\u793a\u4f8b\u4ee5\u505a\u9a8c\u8bc1\u3002</li> </ul>"},{"location":"zh/wiki/injection/","title":"IoC \u4e0e DI\uff08\u6ce8\u5165\uff09","text":"<p>\u7248\u672c: v0.90 \u4f5c\u8005: Plumeink</p> <p>\u672c\u6587\u6863\u4ecb\u7ecd Cullinan \u7684 IoC\uff08\u63a7\u5236\u53cd\u8f6c\uff09\u4e0e DI\uff08\u4f9d\u8d56\u6ce8\u5165\uff09\u7cfb\u7edf\u3002\u5b8c\u6574\u67b6\u6784\u6982\u89c8\u8bf7\u53c2\u9605 \u67b6\u6784\u8bbe\u8ba1\u3002\u4ece\u65e7\u7248\u672c\u8fc1\u79fb\u8bf7\u53c2\u9605 \u8fc1\u79fb\u6307\u5357\u3002</p>"},{"location":"zh/wiki/injection/#_1","title":"\u6838\u5fc3\u6982\u5ff5","text":""},{"location":"zh/wiki/injection/#ioc","title":"\u63a7\u5236\u53cd\u8f6c (IoC)","text":"<p>IoC \u662f\u4e00\u79cd\u8bbe\u8ba1\u539f\u5219\uff0c\u5c06\u5bf9\u8c61\u521b\u5efa\u548c\u751f\u547d\u5468\u671f\u7684\u63a7\u5236\u6743\u4ece\u5e94\u7528\u7a0b\u5e8f\u4ee3\u7801\u8f6c\u79fb\u7ed9\u6846\u67b6\u6216\u5bb9\u5668\u3002</p>"},{"location":"zh/wiki/injection/#di","title":"\u4f9d\u8d56\u6ce8\u5165 (DI)","text":"<p>DI \u662f\u5b9e\u73b0 IoC \u7684\u4e00\u79cd\u6280\u672f\u3002\u4f9d\u8d56\u9879\u88ab\"\u6ce8\u5165\"\u5230\u7c7b\u4e2d\uff0c\u800c\u4e0d\u662f\u7531\u7c7b\u81ea\u5df1\u521b\u5efa\u3002</p>"},{"location":"zh/wiki/injection/#_2","title":"\u63a8\u8350\u7528\u6cd5\uff08\u57fa\u4e8e\u88c5\u9970\u5668\uff09","text":""},{"location":"zh/wiki/injection/#1","title":"1. \u5b9a\u4e49\u670d\u52a1","text":"<pre><code>from cullinan.service import service, Service\n\n@service\nclass DatabaseService(Service):\n    def __init__(self):\n        super().__init__()\n        self.connection = None\n\n    def on_init(self):\n        \"\"\"\u670d\u52a1\u521d\u59cb\u5316\u65f6\u8c03\u7528\"\"\"\n        self.connection = create_connection()\n\n    def on_shutdown(self):\n        \"\"\"\u670d\u52a1\u5173\u95ed\u65f6\u8c03\u7528\"\"\"\n        if self.connection:\n            self.connection.close()\n\n    def query(self, sql: str):\n        return self.connection.execute(sql)\n</code></pre>"},{"location":"zh/wiki/injection/#2","title":"2. \u6ce8\u5165\u4f9d\u8d56","text":"<pre><code>from cullinan.service import service, Service\nfrom cullinan.core import Inject\n\n@service\nclass UserService(Service):\n    # \u901a\u8fc7\u7c7b\u578b\u6ce8\u89e3\u81ea\u52a8\u6ce8\u5165\n    database: DatabaseService = Inject()\n\n    def get_user(self, user_id: int):\n        return self.database.query(f\"SELECT * FROM users WHERE id={user_id}\")\n</code></pre>"},{"location":"zh/wiki/injection/#3","title":"3. \u5728\u63a7\u5236\u5668\u4e2d\u4f7f\u7528","text":"<pre><code>from cullinan.controller import controller, get_api\nfrom cullinan.core import Inject\n\n@controller(url='/api/users')\nclass UserController:\n    user_service: UserService = Inject()\n\n    @get_api('/&lt;user_id&gt;')\n    async def get_user(self, url_param):\n        user_id = url_param.get('user_id')\n        return self.user_service.get_user(int(user_id))\n</code></pre>"},{"location":"zh/wiki/injection/#_3","title":"\u6ce8\u5165\u65b9\u5f0f","text":""},{"location":"zh/wiki/injection/#inject-","title":"Inject() - \u7c7b\u578b\u6ce8\u89e3\u6ce8\u5165\uff08\u63a8\u8350\uff09","text":"<p>\u6700\u4f73\u7684 IDE \u652f\u6301\u548c\u7c7b\u578b\u5b89\u5168\u3002</p> <pre><code>from cullinan.core import Inject\n\n@service\nclass MyService(Service):\n    # \u4ece\u7c7b\u578b\u6ce8\u89e3\u63a8\u65ad\u4f9d\u8d56\u540d\u79f0\n    database: DatabaseService = Inject()\n\n    # \u53ef\u9009\u4f9d\u8d56\n    cache: CacheService = Inject(required=False)\n</code></pre>"},{"location":"zh/wiki/injection/#injectbyname-","title":"InjectByName() - \u5b57\u7b26\u4e32\u540d\u79f0\u6ce8\u5165","text":"<p>\u65e0\u9700\u5bfc\u5165\u4f9d\u8d56\u7c7b\uff0c\u53ef\u907f\u514d\u5faa\u73af\u5bfc\u5165\u3002</p> <pre><code>from cullinan.controller import controller\nfrom cullinan.core import InjectByName\n\n@controller(url='/api')\nclass MyController:\n    # \u663e\u5f0f\u6307\u5b9a\u540d\u79f0\n    user_service = InjectByName('UserService')\n\n    # \u81ea\u52a8\u63a8\u65ad\u540d\u79f0 (snake_case -&gt; PascalCase)\n    email_service = InjectByName()  # -&gt; EmailService\n</code></pre>"},{"location":"zh/wiki/injection/#_4","title":"\u751f\u547d\u5468\u671f\u94a9\u5b50","text":"<p>\u670d\u52a1\u652f\u6301\u7528\u4e8e\u521d\u59cb\u5316\u548c\u6e05\u7406\u7684\u751f\u547d\u5468\u671f\u94a9\u5b50\uff1a</p> <pre><code>@service\nclass MyService(Service):\n    def get_phase(self) -&gt; int:\n        \"\"\"\u521d\u59cb\u5316\u987a\u5e8f\uff08\u6570\u503c\u8d8a\u5c0f\u8d8a\u65e9\uff09\"\"\"\n        return 0\n\n    def on_init(self):\n        \"\"\"\u6240\u6709\u670d\u52a1\u6ce8\u518c\u5b8c\u6210\u540e\u8c03\u7528\"\"\"\n        pass\n\n    def on_startup(self):\n        \"\"\"\u670d\u52a1\u5668\u5f00\u59cb\u63a5\u53d7\u8bf7\u6c42\u4e4b\u524d\u8c03\u7528\"\"\"\n        pass\n\n    def on_shutdown(self):\n        \"\"\"\u670d\u52a1\u5668\u5173\u95ed\u65f6\u8c03\u7528\"\"\"\n        pass\n</code></pre>"},{"location":"zh/wiki/injection/#applicationcontext","title":"\u9ad8\u7ea7\u7528\u6cd5\uff1aApplicationContext\uff08\u590d\u6742\u573a\u666f\uff09","text":"<p>\u7528\u4e8e\u7b2c\u4e09\u65b9\u96c6\u6210\u6216\u81ea\u5b9a\u4e49\u5de5\u5382\u7b49\u9ad8\u7ea7\u7528\u4f8b\uff1a</p> <pre><code>from cullinan.core.container import ApplicationContext, Definition, ScopeType\n\nctx = ApplicationContext()\n\nctx.register(Definition(\n    name='CustomService',\n    factory=lambda c: CustomService(c.get('Dependency')),\n    scope=ScopeType.SINGLETON,\n    source='custom:CustomService'\n))\n\nctx.refresh()  # \u51bb\u7ed3\u6ce8\u518c\u8868\nservice = ctx.get('CustomService')\n</code></pre>"},{"location":"zh/wiki/injection/#_5","title":"\u6700\u4f73\u5b9e\u8df5","text":"<ol> <li>\u4e3a\u670d\u52a1\u548c\u63a7\u5236\u5668\u4f7f\u7528\u88c5\u9970\u5668 - \u8ba9\u6846\u67b6\u5904\u7406\u6ce8\u518c</li> <li>\u4f7f\u7528 <code>Inject()</code> \u8fdb\u884c\u7c7b\u578b\u5b89\u5168\u6ce8\u5165 - \u66f4\u597d\u7684 IDE \u652f\u6301\u548c\u91cd\u6784\u80fd\u529b</li> <li>\u4f7f\u7528 <code>InjectByName()</code> \u907f\u514d\u5faa\u73af\u5bfc\u5165 - \u5f53\u65e0\u6cd5\u5bfc\u5165\u7c7b\u578b\u65f6\u4f7f\u7528</li> <li>\u6b63\u786e\u5b9e\u73b0\u751f\u547d\u5468\u671f\u94a9\u5b50 - \u5e72\u51c0\u7684\u521d\u59cb\u5316\u548c\u5173\u95ed</li> <li>\u4fdd\u6301\u670d\u52a1\u804c\u8d23\u5355\u4e00 - \u5355\u4e00\u804c\u8d23\u539f\u5219</li> </ol>"},{"location":"zh/wiki/injection/#_6","title":"\u6545\u969c\u6392\u67e5","text":"\u95ee\u9898 \u89e3\u51b3\u65b9\u6848 \u4f9d\u8d56\u4e3a None \u786e\u4fdd\u670d\u52a1\u4f7f\u7528 <code>@service</code> \u88c5\u9970\u5668 \u627e\u4e0d\u5230\u670d\u52a1 \u68c0\u67e5\u670d\u52a1\u540d\u79f0\u662f\u5426\u5339\u914d\uff08\u533a\u5206\u5927\u5c0f\u5199\uff09 \u5faa\u73af\u4f9d\u8d56 \u4f7f\u7528 <code>InjectByName()</code> \u8fdb\u884c\u5ef6\u8fdf\u89e3\u6790 \u6ce8\u5165\u4e0d\u751f\u6548 \u786e\u4fdd\u7c7b\u7ee7\u627f\u81ea <code>Service</code> \u6216 <code>Controller</code>"},{"location":"zh/wiki/injection/#_7","title":"\u53e6\u8bf7\u53c2\u9605","text":"<ul> <li>\u67b6\u6784\u8bbe\u8ba1 - \u7cfb\u7edf\u67b6\u6784\u6982\u89c8</li> <li>\u88c5\u9970\u5668 - \u6240\u6709\u53ef\u7528\u7684\u88c5\u9970\u5668</li> <li>\u751f\u547d\u5468\u671f - \u670d\u52a1\u751f\u547d\u5468\u671f\u7ba1\u7406</li> <li>\u8fc1\u79fb\u6307\u5357 - \u4ece\u65e7\u7248\u672c\u8fc1\u79fb</li> </ul>"},{"location":"zh/wiki/lifecycle/","title":"\u5e94\u7528\u751f\u547d\u5468\u671f","text":"<p>\u8bf4\u660e\uff08v0.90\uff09\uff1a\u672c\u6587\u6863\u63cf\u8ff0\u65e7\u7248\u751f\u547d\u5468\u671f\u7ba1\u7406\u3002 \u65b0\u7684 IoC/DI 2.0 \u751f\u547d\u5468\u671f\uff0c\u8bf7\u53c2\u9605 \u4f9d\u8d56\u6ce8\u5165\u6307\u5357\u3002 \u65b0\u7684 <code>ApplicationContext</code> \u901a\u8fc7 <code>refresh()</code> \u548c <code>shutdown()</code> \u63d0\u4f9b\u7edf\u4e00\u7684\u751f\u547d\u5468\u671f\u7ba1\u7406\u3002</p> <p>\u672c\u6587\u6863\u63cf\u8ff0 Cullinan \u5e94\u7528\u7684\u751f\u547d\u5468\u671f\uff1a\u542f\u52a8\uff08startup\uff09\u3001\u521d\u59cb\u5316\u670d\u52a1\uff08initialize\uff09\u3001\u8bf7\u6c42\u5904\u7406\uff08request handling\uff09\u3001\u4ee5\u53ca\u4f18\u96c5\u5173\u95ed\uff08shutdown\uff09\u94a9\u5b50\u4e0e\u4e8b\u4ef6\u3002\u5185\u5bb9\u57fa\u4e8e\u6e90\u7801\uff08\u4ee5\u5b9e\u73b0\u4e3a\u51c6\uff09\uff0c\u4e3b\u8981\u53c2\u8003\uff1a<code>cullinan/app.py</code>\u3001<code>cullinan/application.py</code> \u4e0e <code>cullinan/core/lifecycle</code> \u76f8\u5173\u5b9e\u73b0\u3002</p> <p>\u4e3b\u8981\u9636\u6bb5</p> <ol> <li>\u542f\u52a8\uff08startup\uff09</li> <li>\u5165\u53e3\uff1a<code>CullinanApplication.run()</code> \u6216 <code>create_app()</code> \u4e4b\u540e\u8c03\u7528 <code>app.run()</code>\u3002</li> <li> <p>\u884c\u4e3a\uff08\u89c1 <code>cullinan/app.py</code>\uff09:</p> <ul> <li>\u8c03\u7528 <code>startup()</code> \u6267\u884c\u542f\u52a8\u5e8f\u5217\uff1a\u914d\u7f6e\u6ce8\u5165\uff08InjectionRegistry\uff09\u3001\u53d1\u73b0\u670d\u52a1\uff08ServiceRegistry\uff09\u3001\u6309\u4f9d\u8d56\u987a\u5e8f\u521d\u59cb\u5316\u670d\u52a1\uff08initialize_all\uff09\u3002</li> <li>\u6ce8\u518c\u4fe1\u53f7\u5904\u7406\uff08SIGINT / SIGTERM\uff09\uff0c\u4ee5\u4fbf\u5728\u63a5\u6536\u5230\u4fe1\u53f7\u65f6\u89e6\u53d1\u4f18\u96c5\u5173\u95ed\u3002</li> <li>\u542f\u52a8 Tornado \u7684 IOLoop\uff1a<code>IOLoop.start()</code>\uff08\u963b\u585e\uff0c\u76f4\u5230\u6536\u5230\u505c\u6b62\u4e8b\u4ef6\uff09\u3002</li> </ul> </li> <li> <p>\u521d\u59cb\u5316\u670d\u52a1\uff08service initialization\uff09</p> </li> <li>\u670d\u52a1\u901a\u8fc7 <code>@service</code> \u88c5\u9970\u5668\u6216\u5728\u6a21\u5757\u626b\u63cf\u65f6\u6ce8\u518c\u5230 <code>ServiceRegistry</code>\u3002</li> <li><code>ProviderRegistry</code> / <code>ServiceRegistry</code> \u8d1f\u8d23\u6309\u4f9d\u8d56\u987a\u5e8f\u5b9e\u4f8b\u5316\u670d\u52a1\u5e76\u8c03\u7528\u521d\u59cb\u5316\u94a9\u5b50\uff08\u5982 <code>on_init</code>\uff09\u3002</li> <li> <p>\u5982\u679c\u6ca1\u6709\u6ce8\u518c\u670d\u52a1\uff0c\u521d\u59cb\u5316\u9636\u6bb5\u4f1a\u8df3\u8fc7\u5b9e\u4f8b\u5316\u6b65\u9aa4\u3002</p> </li> <li> <p>\u8bf7\u6c42\u5904\u7406\u4e0e\u8bf7\u6c42\u4f5c\u7528\u57df\uff08request handling &amp; request scope\uff09</p> </li> <li>\u8bf7\u6c42\u5230\u8fbe\u65f6\uff0c\u5e94\u7528\u4f1a\u521b\u5efa\u8bf7\u6c42\u4e0a\u4e0b\u6587\uff08\u901a\u8fc7 <code>create_context()</code>\uff09\u4ee5\u652f\u6301 <code>RequestScope</code>\u3002</li> <li>\u5728\u540c\u4e00\u8bf7\u6c42\u4e0a\u4e0b\u6587\u4e2d\uff0cRequestScope \u4fdd\u8bc1\u4f5c\u7528\u57df\u5185\u7684\u5bf9\u8c61\u5728\u8be5\u8bf7\u6c42\u751f\u547d\u5468\u671f\u5185\u88ab\u590d\u7528\u3002</li> <li> <p>\u5904\u7406\u5668\uff08Handler / controller\uff09\u53ef\u901a\u8fc7\u5c5e\u6027\u6ce8\u5165\u6216\u6784\u9020\u5668\u6ce8\u5165\u62ff\u5230\u8bf7\u6c42\u4f5c\u7528\u57df\u5185\u7684\u4f9d\u8d56\u3002</p> </li> <li> <p>\u5173\u95ed\uff08shutdown\uff09</p> </li> <li>\u5f53\u5e94\u7528\u63a5\u6536\u5230\u7ec8\u6b62\u4fe1\u53f7\u6216\u624b\u52a8\u89e6\u53d1\u5173\u95ed\u65f6\uff0c\u4f1a\u8c03\u7528 <code>shutdown()</code>\uff1a<ul> <li>\u4f9d\u6b21\u6267\u884c\u6ce8\u518c\u7684\u5173\u95ed\u5904\u7406\u5668\uff08\u540c\u6b65\u6216\u5f02\u6b65\uff09\uff0c\u5904\u7406\u9519\u8bef\u65f6\u6839\u636e <code>force</code> \u6807\u5fd7\u51b3\u5b9a\u662f\u5426\u5ffd\u7565\u3002</li> <li>\u5c06 <code>_running</code> \u6807\u5fd7\u7f6e\u4e3a False \u5e76\u505c\u6b62 IOLoop\u3002</li> <li>\u8c03\u7528\u670d\u52a1\u7684\u751f\u547d\u5468\u671f\u94a9\u5b50\uff08\u5982 <code>on_shutdown</code>\uff09\u4ee5\u4fbf\u6e05\u7406\u8d44\u6e90\u3002</li> </ul> </li> </ol>"},{"location":"zh/wiki/lifecycle/#_2","title":"\u751f\u547d\u5468\u671f\u5e8f\u5217\uff08\u56fe\u793a\uff09","text":"<pre><code>CullinanApplication ProviderRegistry    ServiceRegistry Tornado IOLoop  RequestContext  Handler\n------------------- ----------------    --------------- --------------- --------------  -------\nstartup() -&gt; \u6ce8\u518c providers -&gt; \u53d1\u73b0\u5e76\u521d\u59cb\u5316\u670d\u52a1 -&gt; \u542f\u52a8 IOLoop\n                                                        |\n                                                        |-&gt; IOLoop \u63a5\u6536\u8bf7\u6c42 -&gt; \u521b\u5efa RequestContext\n                                                        |                         -&gt; \u89e3\u6790\u8bf7\u6c42\u4f5c\u7528\u57df providers\n                                                        |                         -&gt; \u5206\u53d1\u5230 Handler\uff08\u6ce8\u5165\u89e3\u6790\uff09\n                                                        |                         -&gt; Handler \u8fd4\u56de\u54cd\u5e94\n                                                        |                         -&gt; RequestContext \u6e05\u7406\nshutdown() -&gt; \u8c03\u7528\u670d\u52a1 on_shutdown -&gt; \u505c\u6b62 IOLoop\n</code></pre> <pre><code>\u5e38\u89c1\u94a9\u5b50\u4e0e\u6269\u5c55\u70b9\n\n- `CullinanApplication.add_shutdown_handler(handler)` \u2014 \u5411\u5e94\u7528\u6dfb\u52a0\u81ea\u5b9a\u4e49\u5173\u95ed\u5904\u7406\u5668\uff08\u652f\u6301 async callable\uff09\u3002\n- `LifecycleAware` \u4e0e `LifecycleManager`\uff08\u4f4d\u4e8e `cullinan/core`\uff09\u2014 \u5982\u679c\u670d\u52a1\u5b9e\u73b0\u4e86\u751f\u547d\u5468\u671f\u63a5\u53e3\uff0c\u6846\u67b6\u4f1a\u5728\u5408\u9002\u7684\u65f6\u673a\u8c03\u7528\u5176\u94a9\u5b50\u3002\n- Provider / Service \u7684 `on_init` / `on_shutdown`\uff08\u5982\u6709\uff09\u2014 \u5728\u521d\u59cb\u5316\u4e0e\u5173\u95ed\u9636\u6bb5\u88ab\u8c03\u7528\u3002\n\n\u6700\u5c0f\u793a\u4f8b\uff1a\u6ce8\u518c\u81ea\u5b9a\u4e49\u5173\u95ed\u5904\u7406\u5668\n\n```python\n# \u5feb\u901f\uff08\u63a8\u8350\uff09: \u7b80\u5355\u8fd0\u884c\u6846\u67b6\u5165\u53e3\uff08\u65e0\u9700\u5b9e\u4f8b\u5316\uff09\nfrom cullinan import application\n\n# \u5728 CLI \u6216\u5165\u53e3\u5904\u542f\u52a8\u6846\u67b6\nif __name__ == '__main__':\n    application.run()\n\n# \u9ad8\u7ea7\uff08\u53ef\u9009\uff09: \u5982\u679c\u9700\u8981\u4ee5\u7f16\u7a0b\u65b9\u5f0f\u6dfb\u52a0\u5173\u95ed\u5904\u7406\u5668\u6216\u7ec6\u7c92\u5ea6\u63a7\u5236\uff0c\u8bf7\u4f7f\u7528 create_app()\nfrom cullinan.app import create_app\nimport asyncio\n\napplication_instance = create_app()\n\ndef cleanup_sync():\n    print('Running sync cleanup')\n\nasync def cleanup_async():\n    await asyncio.sleep(0.01)\n    print('Running async cleanup')\n\napplication_instance.add_shutdown_handler(cleanup_sync)\napplication_instance.add_shutdown_handler(cleanup_async)\n\n# \u5728\u7a0b\u5e8f\u5165\u53e3\u8c03\u7528\uff1a\n# application_instance.run()\n```\n\n\u8bf7\u6c42\u4f5c\u7528\u57df\u793a\u4f8b\uff08\u4f2a\u4ee3\u7801\uff0c\u57fa\u4e8e `create_context()`\uff09\n\n```python\nfrom cullinan.core import create_context, RequestScope, ScopedProvider, ProviderRegistry\n\nprovider_registry = ProviderRegistry()\nprovider_registry.register_provider('RequestHandler', ScopedProvider(lambda: RequestHandler(), RequestScope(), 'RequestHandler'))\n\nwith create_context():\n    handler1 = provider_registry.get_instance('RequestHandler')\n    handler2 = provider_registry.get_instance('RequestHandler')\n    assert handler1 is handler2\n\n# \u79bb\u5f00\u4e0a\u4e0b\u6587\u540e\uff0cRequestScope \u4e2d\u7684\u5b9e\u4f8b\u5c06\u88ab\u9694\u79bb\uff0c\u4e0b\u6b21\u8bf7\u6c42\u4f1a\u5f97\u5230\u65b0\u7684\u5b9e\u4f8b\n```\n\n\u8c03\u8bd5\u4e0e\u6545\u969c\u6392\u67e5\n\n- \u542f\u52a8\u5931\u8d25\uff1a\u68c0\u67e5 `startup()` \u4e2d\u7684\u9519\u8bef\u65e5\u5fd7\uff08`Application startup failed`\uff09\u5e76\u67e5\u770b\u670d\u52a1\u6ce8\u518c\u6216 provider \u521d\u59cb\u5316\u5931\u8d25\u7684\u5806\u6808\u3002\n- \u6ce8\u5165/\u4f9d\u8d56\u7f3a\u5931\uff1a\u5982\u679c\u67d0\u6ce8\u5165\u70b9\u6ca1\u6709\u88ab\u89e3\u6790\uff0c\u786e\u8ba4\u5bf9\u5e94\u7684 provider \u5df2\u6ce8\u518c\u5230 `ProviderRegistry` \u4e14 `InjectionRegistry` \u5df2\u6dfb\u52a0\u8be5 registry\u3002\n- \u4f18\u96c5\u5173\u95ed\u95ee\u9898\uff1a\u5982\u679c\u67d0\u5173\u95ed\u5904\u7406\u5668\u963b\u585e\u6216\u629b\u51fa\u5f02\u5e38\uff0c\u8003\u8651\u5728\u5904\u7406\u5668\u4e2d\u6355\u83b7\u5f02\u5e38\u6216\u5728\u5173\u95ed\u65f6\u4f20 `force=True`\u3002\n\n\u53c2\u8003\u4e0e\u4e0b\u4e00\u6b65\n\n- \u6e90\u7801\u53c2\u8003\uff1a`cullinan/app.py`, `cullinan/application.py`, `cullinan/core/*`\uff08provider/registry/scope/lifecycle\uff09\u3002\n- \u63a8\u8350\u628a\u5173\u952e\u7684\u542f\u52a8/\u5173\u95ed\u5e8f\u5217\u5199\u6210\u65f6\u5e8f\u56fe\u5e76\u7eb3\u5165 `docs/wiki/lifecycle.md` \u7684\u56fe\u793a\u90e8\u5206\u4ee5\u4fbf\u5ba1\u9605\u3002\n</code></pre>"},{"location":"zh/wiki/middleware/","title":"\u4e2d\u95f4\u4ef6","text":"<p>\u8bf4\u660e\uff08v0.90\uff09\uff1a\u4e2d\u95f4\u4ef6\u7684 DI \u96c6\u6210\u5df2\u5728 0.90 \u7248\u672c\u4e2d\u66f4\u65b0\u3002 \u65b0\u7684 IoC/DI \u7cfb\u7edf\u8bf7\u53c2\u9605 \u4f9d\u8d56\u6ce8\u5165\u6307\u5357\u3002 \u4e2d\u95f4\u4ef6\u73b0\u5728\u53ef\u4ee5\u901a\u8fc7 <code>ApplicationContext</code> \u83b7\u53d6\u4f9d\u8d56\uff0c\u800c\u4e0d\u662f <code>InjectionRegistry</code>\u3002</p> <p>\u672c\u6587\u6863\u8bf4\u660e Cullinan \u4e2d\u95f4\u4ef6\u7684\u4f5c\u7528\u3001\u94fe\u8def\u6267\u884c\u987a\u5e8f\u3001\u6ce8\u518c\u65b9\u5f0f\u3001\u4e0e DI \u7684\u96c6\u6210\uff0c\u5e76\u63d0\u4f9b\u6700\u5c0f\u793a\u4f8b\u4e0e\u6545\u969c\u6392\u67e5\u5efa\u8bae\u3002\u4e2d\u95f4\u4ef6\u662f\u5904\u7406\u8bf7\u6c42\uff0f\u54cd\u5e94\u751f\u547d\u5468\u671f\u4e2d\u7684\u53ef\u63d2\u62d4\u9636\u6bb5\uff0c\u7528\u4e8e\u8ba4\u8bc1\u3001\u6388\u6743\u3001\u65e5\u5fd7\u3001\u8bf7\u6c42/\u54cd\u5e94\u53d8\u6362\u7b49\u573a\u666f\u3002</p> <p>\u6838\u5fc3\u6982\u5ff5</p> <ul> <li>\u4e2d\u95f4\u4ef6\u94fe\uff08pipeline\uff09: \u8bf7\u6c42\u5728\u8fdb\u5165\u63a7\u5236\u5668\u4e4b\u524d\u4f1a\u7ecf\u8fc7\u4e00\u7cfb\u5217\u4e2d\u95f4\u4ef6\uff0c\u6bcf\u4e2a\u4e2d\u95f4\u4ef6\u53ef\u9009\u62e9\u5904\u7406\u3001\u4fee\u6539\u6216\u77ed\u8def\u8bf7\u6c42\uff1b\u54cd\u5e94\u4e5f\u53ef\u4ee5\u5728\u8fd4\u56de\u8def\u5f84\u4e0a\u88ab\u4e2d\u95f4\u4ef6\u5904\u7406\u3002</li> <li>\u987a\u5e8f\u4e0e\u4f18\u5148\u7ea7: \u4e2d\u95f4\u4ef6\u6309\u6ce8\u518c\u987a\u5e8f\u6267\u884c\uff1b\u67d0\u4e9b\u6846\u67b6\u5141\u8bb8\u4e3a\u4e2d\u95f4\u4ef6\u6307\u5b9a\u4f18\u5148\u7ea7\u6216\u9636\u6bb5\uff08pre/post\uff09\u3002\u5728 Cullinan \u4e2d\uff0c\u6ce8\u518c\u987a\u5e8f\u51b3\u5b9a\u6267\u884c\u987a\u5e8f\uff0c\u6587\u6863\u4e2d\u793a\u4f8b\u9075\u5faa\u6b64\u60ef\u4f8b\u3002</li> <li>\u4e2d\u95f4\u4ef6\u5951\u7ea6: \u4e2d\u95f4\u4ef6\u5e94\u5b9e\u73b0\u4e00\u4e2a\u7ea6\u5b9a\u7684\u63a5\u53e3\uff08\u7c7b\u4f3c process_request / process_response\uff09\uff0c\u6216\u9075\u5faa\u9879\u76ee\u4e2d\u95f4\u4ef6\u57fa\u7c7b\uff08\u5982\u6709\uff09\u3002\u53c2\u8003 <code>cullinan/middleware</code> \u5305\u5b9e\u73b0\u3002</li> </ul> <p>\u6ce8\u518c\u4e0e\u914d\u7f6e</p> <ul> <li>\u7a0b\u5e8f\u5316\u6ce8\u518c\uff08\u63a8\u8350\uff09: \u5728\u5e94\u7528\u542f\u52a8\u9636\u6bb5\u663e\u5f0f\u6ce8\u518c\u4e2d\u95f4\u4ef6\u3002</li> <li>\u793a\u4f8b\uff08\u4f2a\u4ee3\u7801\uff09:</li> </ul> <pre><code># \u6ce8\u518c\u4e2d\u95f4\u4ef6\uff08\u4f2a\u4ee3\u7801\uff09\nfrom cullinan import application\nfrom my_middleware import MyMiddleware\n\n# \u5feb\u901f\u542f\u52a8\u5e76\u8fd0\u884c\uff08\u63a8\u8350\uff09\n# \u5728\u5165\u53e3\u811a\u672c\u4e2d\u5bfc\u5165\u6a21\u5757\u4ee5\u89e6\u53d1\u88c5\u9970\u5668/\u81ea\u52a8\u6ce8\u518c\uff0c\u7136\u540e\u8c03\u7528 application.run()\nif __name__ == '__main__':\n    application.run()\n\n# \u9ad8\u7ea7\uff08\u53ef\u9009\uff09\uff1a\u4ee5\u7f16\u7a0b\u65b9\u5f0f\u6ce8\u518c\u4e2d\u95f4\u4ef6\u5e76\u8fd0\u884c\uff08\u9700\u8981 create_app\uff09\nfrom cullinan.app import create_app\nfrom my_middleware import MyMiddleware\n\napplication_instance = create_app()\napplication_instance.add_middleware(MyMiddleware())\n# application_instance.run()\n</code></pre> <ul> <li>\u4f9d\u8d56\u6ce8\u5165\u96c6\u6210: \u4e2d\u95f4\u4ef6\u53ef\u4ee5\u4f9d\u8d56\u4e8e\u6846\u67b6\u7684 provider/registry \u7cfb\u7edf\u3002\u5efa\u8bae\u901a\u8fc7\u63d0\u4f9b\u8005\u6ce8\u518c\u9700\u8981\u7684 service\uff0c\u5e76\u5728\u4e2d\u95f4\u4ef6\u5185\u90e8\u901a\u8fc7\u6ce8\u5165\u4f7f\u7528\u5b83\u4eec\u3002</li> </ul> <p>\u4e2d\u95f4\u4ef6\u793a\u4f8b\uff08\u7ed3\u5408 DI\uff09</p> <p>\u4e0b\u9762\u793a\u4f8b\u6f14\u793a\u4e00\u4e2a\u4e2d\u95f4\u4ef6\u83b7\u53d6\u4e00\u4e2a\u6ce8\u5165\u7684\u670d\u52a1\u5e76\u5728\u6bcf\u6b21\u8bf7\u6c42\u524d\u8bb0\u5f55\u4fe1\u606f\uff1a</p> <pre><code># examples/controller_di_middleware.py (\u53c2\u8003\u793a\u4f8b)\nfrom cullinan.core import injectable, Inject, get_injection_registry\nfrom cullinan.middleware import MiddlewareBase\n\n@injectable\nclass AuditService:\n    def record(self, request):\n        print('Audit:', request.path)\n\nclass AuditMiddleware(MiddlewareBase):\n    audit: AuditService = Inject()\n\n    def process_request(self, request):\n        # \u4f7f\u7528\u6ce8\u5165\u7684 audit \u670d\u52a1\u8bb0\u5f55\u8bf7\u6c42\n        self.audit.record(request)\n\n# \u5728\u5e94\u7528\u542f\u52a8\u65f6\u6ce8\u518c\u4e2d\u95f4\u4ef6\u4e0e provider\n# registry = ProviderRegistry()...\n</code></pre> <p>\u4e2d\u95f4\u4ef6\u7684\u6267\u884c\u6a21\u578b\u4e0e\u9650\u5236</p> <ul> <li>\u4e2d\u95f4\u4ef6\u5e94\u5c3d\u91cf\u907f\u514d\u963b\u585e\u957f\u65f6\u95f4\u64cd\u4f5c\uff1b\u82e5\u9700\u8981\u8017\u65f6\u4efb\u52a1\uff0c\u4f7f\u7528\u540e\u53f0\u4efb\u52a1\u961f\u5217\u6216\u5f02\u6b65\u5904\u7406\u3002</li> <li>\u4e2d\u95f4\u4ef6\u5e94\u5bf9\u5f02\u5e38\u8fdb\u884c\u9632\u62a4\uff0c\u907f\u514d\u672a\u6355\u83b7\u5f02\u5e38\u5bfc\u81f4\u6574\u4e2a\u8bf7\u6c42\u94fe\u4e2d\u65ad\u3002</li> <li>\u5728\u4f7f\u7528 RequestScope \u6216\u4f9d\u8d56\u6ce8\u5165\u65f6\uff0c\u786e\u4fdd\u4e2d\u95f4\u4ef6\u7684\u751f\u547d\u5468\u671f\u4e0e\u8bf7\u6c42\u4e0a\u4e0b\u6587\u517c\u5bb9\uff08\u4f8b\u5982\u4e0d\u8981\u5728\u6a21\u5757\u5168\u5c40\u7f13\u5b58 request-scoped \u5bf9\u8c61\uff09\u3002</li> </ul> <p>\u6545\u969c\u6392\u67e5</p> <ul> <li>\u4e2d\u95f4\u4ef6\u4e0d\u751f\u6548\uff1a\u786e\u8ba4\u4e2d\u95f4\u4ef6\u5df2\u5728\u5e94\u7528\u542f\u52a8\u65f6\u6ce8\u518c\uff0c\u5e76\u4e14\u6ce8\u518c\u987a\u5e8f\u6b63\u786e\uff1b\u68c0\u67e5\u4e2d\u95f4\u4ef6\u662f\u5426\u88ab\u6709\u6761\u4ef6\u7684\u914d\u7f6e\u8df3\u8fc7\u3002</li> <li>\u6ce8\u5165\u5931\u8d25\uff1a\u5982\u679c\u4e2d\u95f4\u4ef6\u4e2d\u7684 Inject \u672a\u89e3\u6790\uff0c\u786e\u4fdd provider \u5df2\u5728\u6ce8\u5165 registry \u6ce8\u518c\u5e76\u5728\u4e2d\u95f4\u4ef6\u5b9e\u4f8b\u5316\u524d\u53ef\u7528\uff1b\u5bf9\u6d4b\u8bd5\u8bf7\u4f7f\u7528 <code>reset_injection_registry()</code> \u5728\u524d\u7f6e\u6b65\u9aa4\u4e2d\u521d\u59cb\u5316\u3002</li> <li>\u6027\u80fd\u95ee\u9898\uff1a\u5bf9\u4e2d\u95f4\u4ef6\u8fdb\u884c\u57fa\u51c6\u6d4b\u8bd5\uff0c\u907f\u514d\u5728\u9ad8\u9891\u8def\u5f84\u4e2d\u8c03\u7528\u5927\u91cf I/O \u6216\u963b\u585e\u4ee3\u7801\u3002</li> </ul> <p>\u6700\u4f73\u5b9e\u8df5\u4e0e\u5efa\u8bae</p> <ul> <li>\u5c06\u4e2d\u95f4\u4ef6\u4fdd\u6301\u4e3a\u8f7b\u91cf\u51fd\u6570/\u7c7b\uff0c\u6838\u5fc3\u903b\u8f91\u59d4\u6258\u7ed9\u6ce8\u5165\u7684\u670d\u52a1\u3002</li> <li>\u5728\u4e2d\u95f4\u4ef6\u4e2d\u4f7f\u7528\u6846\u67b6\u63d0\u4f9b\u7684\u65e5\u5fd7\u8bb0\u5f55\u5668\uff08logger\uff09\u800c\u4e0d\u662f\u76f4\u63a5\u6253\u5370\uff0c\u4fbf\u4e8e\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u8c03\u6574\u65e5\u5fd7\u7ea7\u522b\u548c\u6536\u96c6\u65b9\u5f0f\u3002</li> <li>\u4e3a\u4e2d\u95f4\u4ef6\u7f16\u5199\u72ec\u7acb\u5355\u5143\u6d4b\u8bd5\u5e76\u5728 CI \u4e2d\u8fd0\u884c\uff08\u53ef\u4ee5\u6a21\u62df\u8bf7\u6c42\u5bf9\u8c61\u4e0e\u6ce8\u5165 registry\uff09\u3002</li> </ul> <p>\u4e0b\u4e00\u6b65</p> <ul> <li>\u4ece <code>examples/controller_di_middleware.py</code> \u63d0\u53d6\u4e00\u4e2a\u6700\u5c0f\u53ef\u8fd0\u884c\u7684\u793a\u4f8b\u5e76\u653e\u5165 <code>examples/</code> \u76ee\u5f55\uff0c\u5e76\u786e\u4fdd\u81f3\u5c11\u7531\u4e00\u4e2a\u81ea\u52a8\u5316\u6d4b\u8bd5\u8986\u76d6\u3002</li> <li>\u5c06\u4e2d\u95f4\u4ef6\u5951\u7ea6\u6587\u6863\u5316\u4e3a\u4ee3\u7801\u63a5\u53e3\uff08\u82e5\u9879\u76ee\u4e2d\u5c1a\u672a\u6709\u57fa\u7840\u7c7b\uff09\uff0c\u5e76\u5728\u6587\u6863\u4e2d\u5f15\u7528\u5b9e\u73b0\u793a\u4f8b\u3002</li> </ul>"},{"location":"zh/wiki/middleware/#_2","title":"\u8fd0\u884c\u793a\u4f8b","text":"<p>\u786e\u4fdd\u5df2\u7ecf\u51c6\u5907\u597d\u53ef\u7528\u7684 Python \u73af\u5883\uff08virtualenv\u3001conda\u3001\u7cfb\u7edf Python \u7b49\u5747\u53ef\uff09\u3002</p> <p>\u5728 Windows\uff08PowerShell\uff09\u4e2d\uff1a</p> <pre><code>python -m pip install -U pip\npip install cullinan tornado\npython examples\\middleware_demo.py\n</code></pre> <p>\u5728 Linux / macOS \u4e2d\uff1a</p> <pre><code>python -m pip install -U pip\npip install cullinan tornado\npython examples/middleware_demo.py\n</code></pre> <p>\u5178\u578b\u8f93\u51fa\uff08\u793a\u4f8b\u8fd0\u884c\uff09\uff1a</p> <pre><code>INFO:__main__:Starting IOLoop for middleware demo\nINFO:__main__:Performing request 1\nINFO:__main__:Entered request context\nINFO:__main__:Injected dependencies into handler\nINFO:tornado.access:200 GET /middleware (127.0.0.1) 2.10ms\nINFO:__main__:Exited request context\nINFO:__main__:Response1: Hello from UserService (084297)  request_count=1\nINFO:__main__:Performing request 2\nINFO:__main__:Entered request context\nINFO:__main__:Injected dependencies into handler\nINFO:tornado.access:200 GET /middleware (127.0.0.1) 0.60ms\nINFO:__main__:Exited request context\nINFO:__main__:Response2: Hello from UserService (084297)  request_count=1\nINFO:__main__:IOLoop stopped, exiting\n</code></pre> <p>\u8bf4\u660e\uff1a<code>RequestCounter</code> \u4e3a\u8bf7\u6c42\u4f5c\u7528\u57df\u7c7b\u578b\uff0c\u6bcf\u6b21\u8bf7\u6c42\u90fd\u4f1a\u91cd\u7f6e\uff1b<code>UserService</code> \u4e3a\u5355\u4f8b\uff0c\u5176\u5b9e\u4f8b id \u5728\u4e0d\u540c\u8bf7\u6c42\u95f4\u4fdd\u6301\u4e0d\u53d8\u3002</p>"},{"location":"zh/wiki/restful_api/","title":"RESTful API \u88c5\u9970\u5668\uff08\u8be6\u7ec6\uff09","text":"<p>\u672c\u9875\u9762\u8bb0\u5f55 Cullinan \u63a7\u5236\u5668\u4e2d\u7528\u4e8e\u8def\u7531\u7ed1\u5b9a\u7684 HTTP \u52a8\u8bcd\u88c5\u9970\u5668\uff1a<code>get_api</code>\u3001<code>post_api</code>\u3001<code>patch_api</code>\u3001<code>delete_api</code>\u3001<code>put_api</code>\u3002</p> <p>\u6458\u8981 - \u6240\u6709\u88c5\u9970\u5668\u5728\u6e90\u7801\u4e2d\u5b9a\u4e49\u4e3a <code>def get_api(**kwargs)</code>\uff08\u5176\u5b83\u52a8\u8bcd\u540c\u7406\uff09\uff0c\u56e0\u6b64\u4ec5\u63a5\u53d7\u5173\u952e\u5b57\u53c2\u6570\u3002\u4f7f\u7528\u4f4d\u7f6e\u53c2\u6570\u5199\u6cd5\u5982 <code>@get_api('/user')</code> \u662f\u4e0d\u5408\u6cd5\u7684\uff0c\u4f1a\u5728\u5bfc\u5165\u65f6\u629b\u51fa TypeError\u3002\u8bf7\u59cb\u7ec8\u4f7f\u7528 <code>@get_api(url='/users/{user_id}')</code>\u3002 - URL \u6a21\u677f\u4f7f\u7528 <code>{name}</code> \u5360\u4f4d\u7b26\uff0c\u7531 <code>url_resolver</code> \u89e3\u6790\uff0c\u6309\u987a\u5e8f\u6620\u5c04\u5230\u63a7\u5236\u5668\u65b9\u6cd5\u53c2\u6570\u3002</p> <p>\u652f\u6301\u5173\u952e\u5b57\u53c2\u6570\uff08\u901a\u7528\uff09 - url\uff1a\u8def\u7531\u6a21\u677f\u5b57\u7b26\u4e32\uff0c\u4f8b\u5982 <code>'/users/{user_id}'</code>\u3002 - query_params\uff1a\u67e5\u8be2\u53c2\u6570\u540d\u7684\u53ef\u8fed\u4ee3\u5bf9\u8c61\uff08\u7531 <code>request_resolver</code> \u7684 query \u90e8\u5206\u89e3\u6790\uff09\u3002 - file_params\uff1a\u7528\u4e8e\u6587\u4ef6\u4e0a\u4f20\u7684\u5b57\u6bb5\u540d\u96c6\u5408\u3002 - headers\uff1a\u8981\u6c42\u5b58\u5728\u7684 HTTP \u8bf7\u6c42\u5934\uff0c\u7f3a\u5931\u65f6\u4f1a\u89e6\u53d1\u7f3a\u5931\u5934\u5904\u7406\u5668\u3002</p> <p>POST/PATCH \u7279\u6709 - body_params\uff1a\u9700\u8981\u4ece JSON/form body \u4e2d\u89e3\u6790\u7684\u5b57\u6bb5\u540d\u96c6\u5408\u3002 - get_request_body\uff1a\u5e03\u5c14\u503c\uff1b\u4e3a True \u65f6\uff0c\u539f\u59cb\u8bf7\u6c42\u4f53\u4f1a\u4f20\u5165\u5904\u7406\u5668\u3002</p> <p>URL \u6a21\u677f\u5982\u4f55\u5de5\u4f5c - \u4f7f\u7528 <code>{param}</code> \u5360\u4f4d\u7b26\uff0c\u4f8b\u5982 <code>'/users/{user_id}/posts/{post_id}'</code>\u3002 - <code>url_resolver</code> \u5c06\u6a21\u677f\u89e3\u6790\u4e3a\u5339\u914d\u8def\u5f84\u5e76\u8fd4\u56de\u53c2\u6570\u540d\u987a\u5e8f\u5217\u8868\uff08\u4f8b\u5982 <code>['user_id','post_id']</code>\uff09\u3002 - \u88ab\u88c5\u9970\u7684\u65b9\u6cd5\u5c06\u6309\u8be5\u987a\u5e8f\u63a5\u6536\u5230\u8def\u5f84\u53c2\u6570\u503c\uff08\u6216\u7ed3\u5408\u63a7\u5236\u5668\u7ea7\u522b\u7684 url \u53c2\u6570\u952e\u5217\u8868\uff09\u3002 - \u5360\u4f4d\u7b26\u5141\u8bb8\u7684\u5b57\u7b26\u7531\u89e3\u6790\u5668\u9650\u5236\uff08\u4f8b\u5982 <code>[a-zA-Z0-9-]+</code>\uff09\uff0c\u5e76\u5141\u8bb8\u53ef\u9009\u7684\u5c3e\u968f <code>/</code>\u3002</p> <p>\u88c5\u9970\u5668\u884c\u4e3a\u4e0e\u8bf7\u6c42\u5904\u7406\u6d41\u7a0b - \u88c5\u9970\u5668\u4f1a\u5305\u88c5\u539f\u59cb\u51fd\u6570\u5e76\u901a\u8fc7 <code>EncapsulationHandler.add_func(url=local_url, type='get')</code> \u6ce8\u518c\u4e3a Tornado \u5904\u7406\u5668\uff08\u6216\u5176\u5b83\u52a8\u8bcd\uff09\u3002 - \u8bf7\u6c42\u65f6\uff0c\u6846\u67b6\u8c03\u7528 <code>request_resolver</code> \u4e0e <code>header_resolver</code> \u6784\u5efa <code>(url_dict, query_dict, body_dict, file_dict)</code>\uff0c\u5e76\u5c06\u89e3\u6790\u7684\u6570\u636e\u4f20\u5165 <code>request_handler</code>\uff0c\u6700\u7ec8\u7531\u5176\u8c03\u7528\u4f60\u7684\u63a7\u5236\u5668\u65b9\u6cd5\u3002 - <code>get_api</code>/<code>delete_api</code>/<code>put_api</code> \u901a\u5e38\u4e0d\u5904\u7406 body\uff08\u9664\u975e\u663e\u5f0f\u914d\u7f6e\uff09\uff0c\u800c <code>post_api</code>/<code>patch_api</code> \u652f\u6301 <code>body_params</code> \u4e0e <code>get_request_body</code>\u3002</p> <p>\u793a\u4f8b</p> <p>1) \u7b80\u5355 GET\uff08\u5e26\u8def\u5f84\u53c2\u6570\uff09</p> <pre><code>@controller(url='/api/users')\nclass UserController:\n    @get_api(url='/{user_id}')\n    def get_user(self, url_param):\n        # \u4ece url_param \u5b57\u5178\u4e2d\u83b7\u53d6\u8def\u5f84\u53c2\u6570\n        user_id = url_param.get('user_id') if url_param else None\n        return {'id': user_id}\n</code></pre> <p>2) GET \u5e26\u67e5\u8be2\u53c2\u6570</p> <pre><code>@controller(url='/api/users')\nclass UserController:\n    @get_api(url='/', query_params=('page','size'))\n    def list_users(self, query_param):\n        # page \u548c size \u4ece\u67e5\u8be2\u5b57\u7b26\u4e32\u89e3\u6790\uff0c\u901a\u8fc7 query_param \u8bbf\u95ee\n        page = query_param.get('page') if query_param else None\n        size = query_param.get('size') if query_param else None\n        return {'page': page, 'size': size}\n</code></pre> <p>3) POST\uff08body + \u6587\u4ef6\uff09</p> <pre><code>@controller(url='/api/upload')\nclass UploadController:\n    @post_api(url='/', body_params=('title',), file_params=('file',))\n    def upload(self, body_param, files):\n        title = body_param.get('title') if body_param else None\n        file_obj = files.get('file') if files else None\n        return {'uploaded': bool(file_obj)}\n</code></pre> <p>\u5e38\u89c1\u9519\u8bef\u4e0e\u9677\u9631 - \u4f7f\u7528\u4f4d\u7f6e\u53c2\u6570\uff1a<code>@get_api('/user')</code> \u662f\u9519\u8bef\u7684\u3002\u8bf7\u4f7f\u7528 <code>@get_api(url='/user')</code>\u3002 - \u6a21\u677f\u4e0e\u65b9\u6cd5\u53c2\u6570\u4e0d\u5339\u914d\uff1a\u82e5 URL \u6a21\u677f\u542b <code>{user_id}</code> \u800c\u65b9\u6cd5\u7b7e\u540d\u7f3a\u5c11\u5bf9\u5e94\u53c2\u6570\uff0c\u6846\u67b6\u4f1a\u4f20\u5165 None \u6216\u5bfc\u81f4\u5f02\u5e38\uff1b\u8bf7\u4fdd\u6301\u547d\u540d\u4e0e\u987a\u5e8f\u4e00\u81f4\u3002 - \u7f3a\u5c11\u5fc5\u987b\u5934\u90e8\uff1a\u82e5\u6307\u5b9a <code>headers</code>\uff0c\u8bf7\u6c42\u672a\u5305\u542b\u65f6\u4f1a\u89e6\u53d1\u7f3a\u5931\u5934\u5904\u7406\u5668\uff0c\u53ef\u80fd\u5bfc\u81f4\u9519\u8bef\u54cd\u5e94\u3002 - body \u89e3\u6790\u5931\u8d25\uff1a\u5f53 Content-Type \u4e3a <code>application/json</code> \u65f6\u6846\u67b6\u4f1a\u5c1d\u8bd5\u89e3\u6790 JSON\uff1b\u89e3\u6790\u5931\u8d25\u4f1a\u5bfc\u81f4 body \u5b57\u6bb5\u4e3a None\u3002</p> <p>\u4f7f\u7528\u5efa\u8bae - <code>get_api</code>\uff1a\u7528\u4e8e\u5e42\u7b49\u7684\u8bfb\u53d6\u64cd\u4f5c\u3002 - <code>post_api</code>\uff1a\u7528\u4e8e\u521b\u5efa/\u4e0a\u4f20\uff0c\u652f\u6301 body \u4e0e\u6587\u4ef6\u5904\u7406\u3002 - <code>patch_api</code>\uff1a\u7528\u4e8e\u90e8\u5206\u66f4\u65b0\u3002 - <code>put_api</code>\uff1a\u7528\u4e8e\u5b8c\u6574\u66ff\u6362\uff08\u4e0e POST \u5728 body \u53c2\u6570\u5904\u7406\u4e0a\u7c7b\u4f3c\uff09\u3002</p> <p>\u6e90\u7801\u53c2\u8003 - \u5173\u952e\u5b9e\u73b0\u4f4d\u4e8e <code>cullinan/controller/core.py</code>\uff08<code>get_api</code>, <code>post_api</code>, <code>url_resolver</code>, <code>request_resolver</code>, <code>request_handler</code>\uff09\u3002 - \u53ef\u4ee5\u5728 <code>tests/</code> \u4e2d\u901a\u8fc7\u641c\u7d22 <code>@get_api(url=</code> \u627e\u5230\u5b9e\u6218\u6d4b\u8bd5\u6837\u4f8b\u3002</p> <p>\u53e6\u89c1 - <code>docs/getting_started.md</code>\uff08\u5feb\u901f\u8bf4\u660e\uff09 - <code>docs/wiki/injection.md</code>\uff08\u6ce8\u5165\u6a21\u5f0f\u8bf4\u660e\uff09</p>"}]}