{"config":{"lang":["en","zh"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Cullinan Documentation","text":"<p>Welcome \u2014 this site contains the Cullinan framework documentation.</p> <p>Use the navigation to the left to get started. Key areas:</p> <ul> <li>Getting Started \u2014 quick start and minimal app examples</li> <li>Architecture \u2014 system overview and diagrams</li> <li>Wiki \u2014 injection, lifecycle, middleware, extensions</li> <li>Modules \u2014 per-module API and examples</li> <li>Examples \u2014 runnable examples in the <code>examples/</code> directory</li> <li>API Reference \u2014 detailed API documentation</li> </ul> <p>For more information, visit our GitHub repository.</p>"},{"location":"api_reference/","title":"API Reference","text":"<p>This page provides an overview of the public API surface of Cullinan and acts as an entry point for generated or manually maintained per-module API pages. The recommended structure includes: a module index, the public symbols and signatures for each module, and a brief description of how to regenerate API documentation.</p>"},{"location":"api_reference/#module-index-example","title":"Module index (example)","text":"<p>The following module list is for illustration only. The concrete index should be derived from the actual code structure and/or automated generation results:</p> <ul> <li><code>cullinan.app</code> \u2014 Application creation and run entrypoints</li> <li><code>cullinan.application</code> \u2014 Application lifecycle and startup flow</li> <li><code>cullinan.core</code> \u2014 IoC/DI core (providers, registries, scopes, injection APIs)</li> <li><code>cullinan.controller</code> \u2014 Controllers and RESTful API decorators</li> <li><code>cullinan.service</code> \u2014 Service base class and the <code>@service</code> decorator</li> <li><code>cullinan.middleware</code> \u2014 Middleware base classes and extension points</li> </ul>"},{"location":"api_reference/#public-symbols-and-signatures-recommended-structure","title":"Public symbols and signatures (recommended structure)","text":"<p>For each module, the API reference is recommended to follow this structure:</p> <ul> <li>Module path, for example: <code>cullinan.controller</code></li> <li>Short description: primary responsibility and typical usage scenarios</li> <li>List of public classes and functions (example):</li> <li><code>@controller(...)</code> \u2014 Controller decorator, responsible for auto-registering controllers and their routes</li> <li><code>@get_api(url=..., query_params=..., body_params=..., headers=...)</code> \u2014 GET endpoint decorator</li> <li><code>@post_api(url=..., body_params=..., headers=...)</code> \u2014 POST endpoint decorator</li> <li><code>Inject</code>, <code>InjectByName</code> \u2014 Property/constructor injection markers</li> </ul> <p>A complete API reference can be populated using this structure, either via automated generation or by manual curation.</p>"},{"location":"api_reference/#regenerating-api-documentation-example-workflow","title":"Regenerating API documentation (example workflow)","text":"<p>When adding automation later, a static analysis script can be used to generate the API index and keep this page in sync with the source. A typical workflow might be:</p> <ol> <li>Maintain a script under <code>docs/work/</code> (for example <code>generate_api_reference.py</code>) that scans modules and emits Markdown fragments.</li> <li>Have the script produce a per-module API list (classes, functions, signatures, short descriptions) into <code>docs/work/api_modules.md</code> or update this page directly.</li> <li>Run the script periodically in CI or as part of local documentation build steps to ensure the API reference reflects the current codebase.</li> </ol> <p>The exact tooling and script implementation can be refined based on project conventions and the chosen documentation toolchain.</p>"},{"location":"architecture/","title":"Architecture Overview","text":"<p>This document presents a source-driven overview of Cullinan's architecture. It is based on implementation facts (source-first): component responsibilities, module interactions, and the startup/request/shutdown sequences. Diagrams are referenced as assets under <code>docs/work/architecture_assets/</code> (placeholder).</p> <p>High-level components</p> <ul> <li>Core (IoC / DI / lifecycle)</li> <li>Files: <code>cullinan/core/*</code> (injection, provider, registry, scope, lifecycle)</li> <li> <p>Responsibility: provide provider abstractions, registries, scopes, and lifecycle orchestration used by services/handlers.</p> </li> <li> <p>Service layer</p> </li> <li>Files: <code>cullinan/service/*</code></li> <li> <p>Responsibility: long-lived application services registered by <code>@service</code> and orchestrated during startup.</p> </li> <li> <p>Controller &amp; Handler</p> </li> <li>Files: <code>cullinan/controller/*</code>, <code>cullinan/handler/*</code></li> <li> <p>Responsibility: HTTP handlers, controller decorators, request/response abstractions, and access logging utilities.</p> </li> <li> <p>Application &amp; Startup</p> </li> <li>Files: <code>cullinan/app.py</code>, <code>cullinan/application.py</code></li> <li> <p>Responsibility: application lifecycle management, service discovery/initialization, IOLoop management and signal handling.</p> </li> <li> <p>Middleware &amp; Extensions</p> </li> <li>Files: <code>cullinan/middleware/*</code>, <code>cullinan/*extensions*</code></li> <li>Responsibility: pluggable request/response processing and plugin registration points.</li> </ul> <p>Module interaction and dependency flows</p> <ul> <li>The <code>app</code>/<code>application</code> module coordinates system startup. It queries registries (service, provider, controller) and initializes components in dependency order.</li> <li>Providers and registries are the glue between service definitions and injection points: <code>ProviderRegistry</code> supplies instances; <code>InjectionRegistry</code> resolves <code>Inject</code> markers and constructor injection.</li> <li>Controllers/handlers rely on InjectionRegistry to get service instances (either singleton or request-scoped via <code>RequestScope</code>).</li> </ul> <p>Startup sequence (summary)</p> <ol> <li>Application construction: <code>create_app()</code> or <code>CullinanApplication()</code> builds basic application object.</li> <li><code>startup()</code> execution:</li> <li>Configure injection: obtain/get InjectionRegistry and prepare provider registries.</li> <li>Discover services and controllers (module scanning or explicit registration).</li> <li>Initialize providers/services in dependency order (call <code>initialize_all()</code> / <code>on_init</code>).</li> <li>Register signal handlers (SIGINT/SIGTERM) to trigger graceful shutdown.</li> <li>Start the Tornado IOLoop (<code>IOLoop.start()</code>), accept requests.</li> </ol>"},{"location":"architecture/#startup-sequence-diagram","title":"Startup Sequence (diagram)","text":"<pre><code>Application ModuleScanner   ProviderRegistry    InjectionRegistry   ServiceRegistry Tornado IOLoop\n----------- -------------   ----------------    -----------------   --------------  ---------------\ncreate_app() --&gt;    scan() ----&gt;    register() ----&gt;    add_registry() --&gt;  register_services() --&gt; start()\n                                                        |\n                                                        |--dispatch--&gt; Handler (controller/handler)\n                                                        |               |\n                                                        |               |--uses--&gt; Inject/ProviderRegistry -&gt; provides instances\n\nRequest Flow (summary):\nIOLoop -&gt; create_context() -&gt; resolve request-scoped providers -&gt; Handler executes -&gt; response -&gt; context cleanup\n\nLegend:\n- register(): provider registration from discovered modules\n- add_registry(): injection registry gets provider registries to resolve inject markers\n- register_services(): service discovery and on_init sequence\n</code></pre> <p>Request flow (summary)</p> <ol> <li>Incoming request -&gt; Tornado HTTP server -&gt; registered handler lookup via controller registry.</li> <li>Request context created (<code>create_context()</code>) to provide <code>RequestScope</code> semantics.</li> <li>Injection into handler (property or constructor) resolves via <code>InjectionRegistry</code>/<code>ProviderRegistry</code>.</li> <li>Handler executes and returns response; response may be processed by middleware.</li> <li>Exit request context and cleanup request-scoped objects.</li> </ol> <p>Key design notes and constraints</p> <ul> <li>The framework centers IoC/DI in <code>cullinan/core</code>; all provider/registry/Scope interactions depend on file-level implementation details \u2014 documentation must reflect actual code behavior (not comments).</li> <li>Circular dependencies are detected and signaled via <code>CircularDependencyError</code> (see <code>cullinan/core/errors</code> / exceptions).</li> <li>The <code>ProviderRegistry</code> and <code>ServiceRegistry</code> implement ordering/duplicate policies; consult <code>docs/work/module_api_summary.json</code> for generated API summaries.</li> </ul> <p>Where to find artifacts and diagrams</p> <ul> <li>Diagram assets (placeholder): <code>docs/work/architecture_assets/</code> \u2014 add sequence and component diagrams here.</li> <li>Generated API summaries and candidates: <code>docs/work/module_api_summary.json</code>, <code>docs/work/api_cleanup_candidates.csv</code>.</li> </ul> <p>Next steps (docs work)</p> <ul> <li>Add sequence diagrams (Mermaid or PNG) illustrating startup and shutdown flows.</li> <li>Expand component pages with code references and short call graphs (using static analysis or grep results).</li> </ul>"},{"location":"build_run/","title":"Local Build &amp; Run","text":"<p>This page describes how to set up a local environment, install Cullinan in editable mode, run tests, and start example applications on Windows (PowerShell), Linux, and macOS.</p>"},{"location":"build_run/#prerequisites","title":"Prerequisites","text":"<ul> <li>Python 3.8 or newer</li> <li>Git</li> </ul>"},{"location":"build_run/#clone-the-repository","title":"Clone the repository","text":"<p>On all platforms:</p> <pre><code>git clone https://github.com/plumeink/Cullinan.git\ncd Cullinan\n</code></pre>"},{"location":"build_run/#create-and-activate-a-virtual-environment-optional-but-recommended","title":"Create and activate a virtual environment (optional but recommended)","text":"<p>On Windows (PowerShell):</p> <pre><code>python -m venv .venv\n.venv\\Scripts\\Activate.ps1\n</code></pre> <p>On Linux / macOS:</p> <pre><code>python -m venv .venv\nsource .venv/bin/activate\n</code></pre>"},{"location":"build_run/#install-dependencies-in-editable-mode","title":"Install dependencies in editable mode","text":"<p>On all platforms:</p> <pre><code>python -m pip install -U pip\npip install -e .\n</code></pre> <p>If you have additional development extras configured in <code>setup.py</code> or <code>pyproject.toml</code>, you can install them as needed, for example:</p> <pre><code>pip install -e .[dev]\n</code></pre>"},{"location":"build_run/#run-the-test-suite","title":"Run the test suite","text":"<p>On all platforms:</p> <pre><code>pytest -q\n</code></pre> <p>If your environment uses a different test runner, adapt the command accordingly (e.g. <code>python -m pytest</code>).</p>"},{"location":"build_run/#run-an-example-application","title":"Run an example application","text":""},{"location":"build_run/#hello-http-example","title":"Hello HTTP example","text":"<p>On Windows (PowerShell):</p> <pre><code>python examples\\hello_http.py\n</code></pre> <p>On Linux / macOS:</p> <pre><code>python examples/hello_http.py\n</code></pre> <p>Then open <code>http://localhost:4080/hello</code> in a browser to verify the server is running.</p>"},{"location":"build_run/#middleware-demo","title":"Middleware demo","text":"<p>On Windows (PowerShell):</p> <pre><code>python examples\\middleware_demo.py\n</code></pre> <p>On Linux / macOS:</p> <pre><code>python examples/middleware_demo.py\n</code></pre> <p>Refer to the middleware documentation for a description of the expected log output and behavior.</p>"},{"location":"contributing/","title":"Contributing","text":"<p>Placeholder: contribution guidelines, PR checklist, doc template, front-matter requirements, and review process.</p>"},{"location":"cullinan_documentation_plan/","title":"Cullinan \u6587\u6863\u7f16\u5199\u8ba1\u5212\u4e66","text":"<p>\u8bf4\u660e\uff1a\u672c\u8ba1\u5212\u57fa\u4e8e Cullinan \u6e90\u7801\uff08\u4ec5\u4ee5\u6e90\u7801\u5b9e\u73b0\u4e3a\u51c6\uff0c\u5ffd\u7565\u6ce8\u91ca\uff09\u8fdb\u884c\u8bbe\u8ba1\uff0c\u76ee\u6807\u662f\u4e3a\u9879\u76ee\u5efa\u7acb\u5b8c\u6574\u7684\u4e2d\u82f1\u53cc\u8bed\u6587\u6863\u4f53\u7cfb\uff08<code>docs/</code> \u4e0e <code>docs/zh/</code> 1:1 \u5bf9\u5e94\uff09\u3002</p>","tags":["plan","documentation"]},{"location":"cullinan_documentation_plan/#_1","title":"\u4efb\u52a1\u6536\u655b\u4e0e\u9ad8\u5c42\u8ba1\u5212","text":"<p>\u672c\u8ba1\u5212\u6587\u6863\u7528\u4e8e\u6536\u7eb3\u591a\u9636\u6bb5\u4efb\u52a1\u89c4\u5212\uff0c\u4fbf\u4e8e\u5728\u4ed3\u5e93\u4e2d\u4fdd\u7559\u89c4\u5212\u5185\u5bb9\uff0c\u4f9b\u56e2\u961f\u5ba1\u9605\u4e0e\u5206\u914d\u3002\u540e\u7eed\u64cd\u4f5c\u793a\u4f8b\uff1a</p> <ul> <li>\u521b\u5efa\u5e76\u63d0\u4ea4 Markdown \u8ba1\u5212\u6587\u4ef6\u5230 <code>docs/</code> \u76ee\u5f55\u3002</li> <li>\u8fd0\u884c\u9759\u6001\u68c0\u67e5\u4ee5\u786e\u4fdd\u6587\u4ef6\u6ca1\u6709\u8bed\u6cd5/\u683c\u5f0f\u9519\u8bef\uff08\u6587\u6863\u6587\u4ef6\u901a\u5e38\u4e0d\u4f1a\u4ea7\u751f\u4ee3\u7801\u7f16\u8bd1\u9519\u8bef\uff0c\u4f46\u4ecd\u5efa\u8bae\u8fdb\u884c\u57fa\u672c\u68c0\u67e5\uff09\u3002</li> </ul> <p>\u7b80\u8981\u9a8c\u6536\u6e05\u5355\uff08\u5728\u63d0\u4ea4\u524d\uff09\uff1a - [x] \u6587\u4ef6\u4ee5 UTF-8 \u7f16\u7801\u3001Markdown \u683c\u5f0f\u4fdd\u5b58\u3002 - [x] \u5305\u542b\u76ee\u6807\u3001\u8303\u56f4\u3001\u4efb\u52a1\u62c6\u5206\u3001\u65f6\u95f4\u9884\u4f30\u3001\u8d28\u91cf\u95e8\u4e0e\u793a\u4f8b\u547d\u4ee4\u8bf4\u660e\u3002 - [x] \u660e\u786e\u8981\u6c42 <code>docs/</code> \u4e0e <code>docs/zh/</code> \u5fc5\u987b 1:1 \u5bf9\u5e94\u3002</p> <p>TL;DR\uff1a\u4e3a Cullinan\uff08\u57fa\u4e8e Tornado \u7684 IoC/DI \u6846\u67b6\uff09\u7f16\u5199\u4e2d\u82f1\u53cc\u8bed\u6587\u6863\uff08<code>docs/</code> \u4e0e <code>docs/zh/</code> 1:1 \u5bf9\u5e94\uff09\uff0c\u5305\u62ec\u5165\u95e8\u3001\u793a\u4f8b\u3001Wiki\uff08\u67b6\u6784/\u7ec4\u4ef6/\u751f\u547d\u5468\u671f/\u6ce8\u5165/\u4e2d\u95f4\u4ef6/\u6269\u5c55\uff09\u3001API \u53c2\u8003\u3001\u8fc1\u79fb\u6307\u5357\u3001\u8d21\u732e\u6307\u5357\u3001\u6d4b\u8bd5\u4e0e\u672c\u5730\u8fd0\u884c\u8bf4\u660e\uff1b\u91c7\u7528\u6e90\u7801\u9a71\u52a8\uff08\u5ffd\u7565\u6ce8\u91ca\uff09\u7814\u7a76\u7b56\u7565\uff0c\u4fdd\u6301\u73b0\u6709 IoC/DI \u8bbe\u8ba1\u4e0d\u53d8\uff0c\u63d0\u4f9b\u5206\u5de5\u3001\u91cc\u7a0b\u7891\u3001\u8d28\u91cf\u95e8\u4e0e PowerShell \u7b49\u73af\u5883\u4e0b\u7684\u8fd0\u884c/\u9a8c\u8bc1\u547d\u4ee4\u793a\u4f8b\u3002</p>","tags":["plan","documentation"]},{"location":"cullinan_documentation_plan/#1","title":"1. \u76ee\u6807\u4e0e\u53d7\u4f17","text":"<ul> <li>\u76ee\u6807\uff1a\u4e3a Cullinan \u63d0\u4f9b\u6e05\u6670\u3001\u53ef\u6267\u884c\u3001\u53cc\u8bed\uff08\u82f1\u6587/\u4e2d\u6587\uff09\u6587\u6863\u5957\u4ef6\uff0c\u5e2e\u52a9\u65b0\u7528\u6237\u5feb\u901f\u4e0a\u624b\uff0c\u5e2e\u52a9\u8d21\u732e\u8005\u7406\u89e3\u5185\u90e8\u8bbe\u8ba1\u4e0e\u6ce8\u5165\u673a\u5236\uff0c\u63d0\u4f9b\u53ef\u8fd0\u884c\u7684\u793a\u4f8b\u4e0e\u6d4b\u8bd5\u9a8c\u8bc1\u6b65\u9aa4\u3002</li> <li>\u53d7\u4f17\uff1a\u5e93\u4f7f\u7528\u8005\uff08\u5e94\u7528\u5f00\u53d1\u8005\uff09\u3001\u6846\u67b6\u8d21\u732e\u8005/\u7ef4\u62a4\u8005\u3001\u4ee3\u7801\u5ba1\u67e5\u8005\u3001\u81ea\u52a8\u5316\u6d4b\u8bd5\u5de5\u7a0b\u5e08\u3002</li> </ul>","tags":["plan","documentation"]},{"location":"cullinan_documentation_plan/#2","title":"2. \u8303\u56f4\u4e0e\u4ea7\u7269\u6e05\u5355","text":"<p>\u5fc5\u987b\u4ea7\u51fa\uff08\u6bcf\u9879\u5747\u9700\u5728 <code>docs/</code> \u4e0e <code>docs/zh/</code> \u4e0b 1:1 \u5bf9\u5e94\uff09\uff1a</p> <ul> <li><code>Getting Started</code>\uff08\u5feb\u901f\u5165\u95e8\uff09 \u2014 <code>docs/getting_started.md</code> / <code>docs/zh/getting_started.md</code></li> <li><code>Examples</code>\uff08\u793a\u4f8b\uff09 \u2014 <code>docs/examples.md</code> / <code>docs/zh/examples.md</code>\uff08\u5e76\u5728\u4ed3\u5e93\u4fdd\u7559 <code>examples/</code> \u53ef\u8fd0\u884c\u4ee3\u7801\uff09</li> <li><code>Wiki</code>\uff08\u67b6\u6784/\u7ec4\u4ef6/\u751f\u547d\u5468\u671f/\u6ce8\u5165/\u4e2d\u95f4\u4ef6/\u6269\u5c55\uff09 \u2014 <code>docs/wiki/architecture.md</code>, <code>components.md</code>, <code>lifecycle.md</code>, <code>injection.md</code>, <code>middleware.md</code>, <code>extensions.md</code>\uff08\u548c <code>docs/zh/wiki/*</code>\uff09</li> <li><code>API Reference</code> \u2014 <code>docs/api_reference.md</code> / <code>docs/zh/api_reference.md</code>\uff08\u53ef\u9009\u62e9\u81ea\u52a8\u5316\u751f\u6210\uff09</li> <li><code>Migration Guide</code> \u2014 <code>docs/migration_guide.md</code> / <code>docs/zh/migration_guide.md</code></li> <li><code>Contributing</code> \u2014 <code>docs/contributing.md</code> / <code>docs/zh/contributing.md</code></li> <li><code>Testing &amp; Verification</code> \u2014 <code>docs/testing.md</code> / <code>docs/zh/testing.md</code></li> <li><code>Local Build &amp; Run</code> \u2014 <code>docs/build_run.md</code> / <code>docs/zh/build_run.md</code></li> <li>\u6587\u6863\u6a21\u677f\u548c\u6837\u4f8b\u9875\u9762\uff08front-matter\u3001\u793a\u4f8b\u4ee3\u7801\u7247\u6bb5\u89c4\u8303\u3001\u7ffb\u8bd1\u51c6\u5219\uff09</li> </ul> <p>\u9644\u52a0\u4ea7\u7269\uff08\u5efa\u8bae\uff09\uff1a</p> <ul> <li><code>examples/</code> \u53ef\u8fd0\u884c\u793a\u4f8b\u96c6\u5408\uff08\u8f7b\u91cf demo\uff09</li> <li>\u7b80\u8981 <code>README.md</code> \u66f4\u65b0\u94fe\u63a5 <code>docs/</code> \u9875\u9762</li> <li>\u6587\u6863 CI \u811a\u672c\uff08\u53ef\u9009\uff09</li> </ul>","tags":["plan","documentation"]},{"location":"cullinan_documentation_plan/#3","title":"3. \u7814\u7a76\u65b9\u6cd5\u4e0e\u4ee3\u7801\u9605\u8bfb\u7b56\u7565\uff08\u53ea\u8bfb\u6e90\u7801\uff0c\u5ffd\u7565\u6ce8\u91ca\uff09","text":"<p>\u7814\u7a76\u76ee\u6807\uff1a\u4ece\u6e90\u7801\u63a8\u65ad\u8bbe\u8ba1\u4e0e\u884c\u4e3a\uff08\u4e0d\u4f9d\u8d56\u6ce8\u91ca\uff09\uff0c\u5b9a\u4f4d\u5173\u952e\u6a21\u5757\u4e0e\u4f9d\u8d56\u5173\u7cfb\uff0c\u63d0\u53d6\u5916\u90e8 API\u3001\u751f\u547d\u5468\u671f\u548c\u6ce8\u5165\u884c\u4e3a\u3002</p> <p>\u7b56\u7565\u4e0e\u6b65\u9aa4\uff1a</p> <ol> <li>\u9ad8\u5c42\u76ee\u5f55\u626b\u63cf\uff1a\u5148\u786e\u8ba4\u9876\u5c42\u6a21\u5757\u4e0e\u5165\u53e3\u70b9\u3002\u4f18\u5148\u9605\u8bfb <code>cullinan/__init__.py</code>\u3001<code>app.py</code>\u3001<code>application.py</code>\u3001<code>config.py</code>\u3002</li> <li>\u6838\u5fc3\u5b50\u7cfb\u7edf\u5b9a\u4f4d\uff1a\u5b9a\u4f4d IoC/DI \u5b9e\u73b0\u4f4d\u7f6e\uff08\u901a\u5e38\u5728 <code>cullinan/core</code>\uff09\u3002\u91cd\u70b9\u9605\u8bfb <code>core/__init__.py</code>\u3001<code>core/provider.py</code>\u3001<code>core/registry.py</code>\u3001<code>core/scope.py</code> \u7b49\uff08\u5b9e\u9645\u6587\u4ef6\u540d\u8bf7\u6839\u636e <code>cullinan/core</code> \u76ee\u5f55\u6587\u4ef6\u5217\u8868\u8c03\u6574\uff09\u3002</li> <li>\u63a7\u5236\u5668/\u8def\u7531/\u4e2d\u95f4\u4ef6\uff1a\u67e5\u770b <code>controller/</code>\u3001<code>handler/</code>\u3001<code>middleware/</code> \u6587\u4ef6\uff0c\u627e\u5230\u8def\u7531\u6ce8\u518c\u3001\u5904\u7406\u6d41\u7a0b\u4e0e\u751f\u547d\u5468\u671f\u94a9\u5b50\u3002</li> <li>\u6a21\u5757\u626b\u63cf\u4e0e\u81ea\u52a8\u6ce8\u518c\uff1a\u9605\u8bfb <code>module_scanner.py</code>\u3001<code>websocket_registry.py</code> \u7b49\u4e86\u89e3\u81ea\u52a8\u53d1\u73b0\u673a\u5236\u4e0e\u6ce8\u518c\u65f6\u5e8f\u3002</li> <li>\u914d\u7f6e\u4e0e\u542f\u52a8\u6d41\u7a0b\uff1a\u8ffd\u8e2a <code>application.py</code> \u4e0e <code>app.py</code> \u4e2d\u7684 <code>main</code>\u3001<code>start</code>\u3001<code>initialize</code>\u3001<code>run</code> \u98ce\u683c\u51fd\u6570\uff0c\u5f62\u6210\u542f\u52a8\u5e8f\u5217\u56fe\uff08\u987a\u5e8f\u3001\u4f9d\u8d56\uff09\u3002</li> <li>\u6ce8\u5165\u70b9\u53d1\u73b0\uff1a\u5728\u6e90\u7801\u4e2d\u641c\u7d22\u5173\u952e\u8bcd\uff08<code>inject</code>, <code>provide</code>, <code>provider</code>, <code>register</code>, <code>scope</code>, <code>singleton</code>, <code>transient</code>\uff09\u4ee5\u5b9a\u4f4d\u6ce8\u5165 API \u4e0e\u7528\u6cd5\u3002</li> <li>\u4ee5\u6d4b\u8bd5\u4e3a\u53cd\u8bc1\uff1a\u5ba1\u9605 <code>tests/</code> \u4e0b\u5173\u952e\u6d4b\u8bd5\uff08\u5982 <code>test_core_injection.py</code>\u3001<code>test_controller_injection_fix.py</code>\u3001<code>test_registry.py</code> \u7b49\uff09\u6765\u7406\u89e3\u671f\u671b\u884c\u4e3a\u4e0e\u8fb9\u754c\u6761\u4ef6\uff08\u6d4b\u8bd5\u662f\u884c\u4e3a\u89c4\u8303\u7684\u6700\u6743\u5a01\u6765\u6e90\uff09\u3002</li> <li>\u4f9d\u8d56\u56fe\u6784\u5efa\uff1a\u4f7f\u7528\u9759\u6001\u8bfb\u53d6\uff08\u6216\u7b80\u5355\u811a\u672c\uff09\u5217\u51fa\u6a21\u5757\u4e4b\u95f4 import \u5173\u7cfb\uff0c\u7ed8\u5236\u7b80\u6613\u6a21\u5757\u4f9d\u8d56\u56fe\uff08\u5e2e\u52a9\u64b0\u5199\u67b6\u6784/\u7ec4\u4ef6\u8bf4\u660e\uff09\u3002</li> <li>\u8bb0\u5f55\u53d1\u73b0\uff1a\u4ee5\u201c\u4e8b\u5b9e\u9648\u8ff0\u201d\u8bb0\u5f55\u6bcf\u4e2a\u6a21\u5757\u7684\u804c\u8d23\u3001\u8f93\u5165\u8f93\u51fa\u3001\u751f\u547d\u5468\u671f\u3001\u9519\u8bef\u6a21\u5f0f\u3002\u4ec5\u57fa\u4e8e\u6e90\u7801\u884c\u4e3a\uff0c\u4e0d\u4f9d\u8d56\u6ce8\u91ca\u89e3\u91ca\u3002</li> </ol> <p>\u5de5\u5177\u4e0e\u65b9\u6cd5\uff1a</p> <ul> <li>\u4f7f\u7528\u4ed3\u5e93\u641c\u7d22\uff08\u901a\u8fc7 IDE \u6216 <code>rg</code>/<code>grep</code>\uff09\u5b9a\u4f4d\u7b26\u53f7\u548c\u5b57\u7b26\u4e32\u6a21\u5f0f\u3002</li> <li>\u9605\u8bfb\u5173\u952e\u6d4b\u8bd5\u7528\u4f8b\u4ee5\u8865\u5168\u7406\u89e3\u3002</li> <li>\u6784\u5efa\u5c0f\u7684\u95ee\u7b54\u5f0f\u7b14\u8bb0\uff08\u6a21\u5757 -&gt; \u8d23\u4efb -&gt; \u4e0e\u5176\u4ed6\u6a21\u5757\u7684\u4ea4\u4e92\uff09\u4f9b\u6587\u6863\u5199\u4f5c\u4f7f\u7528\u3002</li> </ul> <p>\u6ce8\u610f\uff1a\u4e0d\u8981\u5728\u6587\u6863\u4e2d\u6539\u53d8\u6216\u9f13\u52b1\u6539\u53d8\u73b0\u6709 IoC/DI \u8bbe\u8ba1\uff1b\u6587\u6863\u53ea\u63cf\u8ff0/\u8bf4\u660e\u3001\u53ef\u63d0\u51fa\u201c\u6539\u8fdb\u5efa\u8bae\u201d\u4f46\u987b\u4f5c\u4e3a\u9644\u5f55\u6216 issues\u3002</p>","tags":["plan","documentation"]},{"location":"cullinan_documentation_plan/#4","title":"4. \u4efb\u52a1\u62c6\u5206\u4e0e\u91cc\u7a0b\u7891\uff08\u4f18\u5148\u7ea7 + \u65f6\u95f4\u4f30\u7b97\uff09","text":"<p>\u603b\u4f53\u9884\u8ba1\u65f6\u957f\uff1a6 \u5468\uff08\u53ef\u6309\u8d44\u6e90\u5e76\u884c\u538b\u7f29\uff09\u3002\u65f6\u95f4\u5355\u4f4d\u4e3a\u4eba\u5929\uff08\u5de5\u4f5c\u65e5\uff09\u3002</p> <p>\u9636\u6bb5 A \u2014 \u53d1\u73b0\u4e0e\u5927\u7eb2\uff08\u4f18\u5148\u7ea7\uff1a\u9ad8\uff0c\u65f6\u957f\uff1a4 \u4eba\u65e5\uff09 - A1. \u6e90\u7801\u5feb\u901f\u626b\u63cf\u5e76\u751f\u6210\u6a21\u5757\u6620\u5c04\uff082 \u4eba\u65e5\uff09 - A2. \u57fa\u4e8e\u6620\u5c04\u8349\u62df\u6587\u6863\u603b\u7eb2\uff081 \u4eba\u65e5\uff09 - A3. \u786e\u8ba4\u8f93\u51fa\u683c\u5f0f\uff08Markdown \u7ed3\u6784\u3001\u76ee\u5f55\u3001\u7ffb\u8bd1\u6d41\u7a0b\u3001\u662f\u5426\u7528 Sphinx/ mkdocs \u7b49\uff09\uff081 \u4eba\u65e5\uff09</p> <p>\u91cc\u7a0b\u7891 A\uff1a\u63d0\u4ea4 <code>docs/outline.md</code> \u4e0e <code>docs/zh/outline.md</code>\uff0c\u5305\u542b\u6587\u4ef6\u6e05\u5355\u4e0e\u8d1f\u8d23\u4eba\u3002</p> <p>\u9636\u6bb5 B \u2014 \u5165\u95e8\u4e0e\u793a\u4f8b\uff08\u4f18\u5148\u7ea7\uff1a\u9ad8\uff0c\u65f6\u957f\uff1a6 \u4eba\u65e5\uff09 - B1. \u64b0\u5199 <code>Getting Started</code> \u82f1\u4e2d\u7248\u672c\uff082 \u4eba\u65e5\uff09 - B2. \u8bbe\u8ba1\u5e76\u5b9e\u73b0 2-3 \u4e2a\u6700\u5c0f\u53ef\u8fd0\u884c\u793a\u4f8b\u5230 <code>examples/</code>\uff083 \u4eba\u65e5\uff09 - B3. \u5c06\u793a\u4f8b\u96c6\u6210\u5230\u6587\u6863\u5e76\u9a8c\u8bc1\uff081 \u4eba\u65e5\uff09</p> <p>\u91cc\u7a0b\u7891 B\uff1a<code>docs/getting_started.md</code> \u4e0e <code>examples/</code> \u53ef\u88ab\u672c\u5730\u7528\u6237\u8fd0\u884c\u3002</p> <p>\u9636\u6bb5 C \u2014 \u6838\u5fc3 Wiki\uff08\u67b6\u6784/\u7ec4\u4ef6/\u751f\u547d\u5468\u671f/\u6ce8\u5165\u673a\u5236/\u4e2d\u95f4\u4ef6/\u6269\u5c55\uff09\uff08\u4f18\u5148\u7ea7\uff1a\u9ad8\uff0c\u65f6\u957f\uff1a10 \u4eba\u65e5\uff09 - C1. <code>architecture.md</code>\uff082 \u4eba\u65e5\uff09 - C2. <code>components.md</code>\uff082 \u4eba\u65e5\uff09 - C3. <code>lifecycle.md</code>\uff082 \u4eba\u65e5\uff09 - C4. <code>injection.md</code>\uff083 \u4eba\u65e5\uff09 - C5. <code>middleware.md</code> / <code>extensions.md</code>\uff081 \u4eba\u65e5\uff09</p> <p>\u91cc\u7a0b\u7891 C\uff1a\u6df1\u5ea6\u7406\u89e3\u5e76\u6587\u6863\u5316\u6838\u5fc3\u8bbe\u8ba1\uff0c\u540c\u884c\u8bc4\u5ba1\u901a\u8fc7\u3002</p> <p>\u9636\u6bb5 D \u2014 API \u53c2\u8003\u4e0e\u8fc1\u79fb\u6307\u5357\uff08\u4f18\u5148\u7ea7\uff1a\u4e2d\uff0c\u65f6\u957f\uff1a8 \u4eba\u65e5\uff09 - D1. \u51b3\u5b9a API \u53c2\u8003\u65b9\u5f0f\uff08\u81ea\u52a8 vs \u624b\u5de5\uff09\uff080.5 \u5929\uff09 - D2. \u751f\u6210\u6216\u624b\u5199\u6240\u6709\u516c\u5171\u6a21\u5757\u7684 API \u6458\u8981\uff085 \u4eba\u65e5\uff09 - D3. \u64b0\u5199\u8fc1\u79fb\u6307\u5357\uff08\u517c\u5bb9\u6027/\u7834\u574f\u6027\u53d8\u5316\u8bf4\u660e\uff09\uff082.5 \u4eba\u65e5\uff09</p> <p>\u91cc\u7a0b\u7891 D\uff1aAPI \u53c2\u8003\u5b8c\u6210\u5e76\u53ef\u7d22\u5f15\uff1b\u8fc1\u79fb\u6307\u5357\u8986\u76d6\u4e3b\u8981\u53d8\u66f4\u70b9\u3002</p> <p>\u9636\u6bb5 E \u2014 \u8d21\u732e/\u6d4b\u8bd5/\u8fd0\u884c\u8bf4\u660e\u4e0e\u672c\u5730\u6784\u5efa\uff08\u4f18\u5148\u7ea7\uff1a\u4e2d\uff0c\u65f6\u957f\uff1a4 \u4eba\u65e5\uff09 - E1. <code>contributing.md</code>\uff081 \u4eba\u65e5\uff09 - E2. <code>testing.md</code>\uff081 \u4eba\u65e5\uff09 \u2014 \u5305\u62ec\u5982\u4f55\u8fd0\u884c\u73b0\u6709\u6d4b\u8bd5\u3001\u5982\u4f55\u7f16\u5199\u6d4b\u8bd5\u3001CI \u8981\u6c42 - E3. <code>build_run.md</code>\uff082 \u4eba\u65e5\uff09 \u2014 \u5305\u542b Windows PowerShell \u6307\u4ee4\u548c\u865a\u62df\u73af\u5883\u6b65\u9aa4</p> <p>\u91cc\u7a0b\u7891 E\uff1a\u8d21\u732e\u6d41\u7a0b\u4e0e\u6d4b\u8bd5\u51c6\u5219\u5c31\u7eea\u3002</p> <p>\u9636\u6bb5 F \u2014 \u7ffb\u8bd1\u3001\u6821\u9a8c\u3001\u8d28\u91cf\u95e8\uff08\u4f18\u5148\u7ea7\uff1a\u9ad8\uff0c\u65f6\u957f\uff1a6 \u4eba\u65e5\uff09 - F1. \u7ffb\u8bd1\u6821\u5bf9\uff08\u82f1-&gt;\u4e2d\uff09\u5e76\u786e\u4fdd 1:1 \u6587\u4ef6\u7ed3\u6784\uff083 \u4eba\u65e5\uff09 - F2. \u6587\u6863\u5185\u90e8\u5ba1\u6821\uff08\u7ed3\u6784\u3001\u4e8b\u5b9e\u3001\u4e3e\u4f8b\u53ef\u8fd0\u884c\uff09\uff082 \u4eba\u65e5\uff09 - F3. \u6700\u7ec8\u8d28\u91cf\u95e8\uff08\u8fd0\u884c\u6d4b\u8bd5\u3001\u793a\u4f8b\u9a8c\u8bc1\u3001\u63d0\u4ea4 PR\uff09\uff081 \u4eba\u65e5\uff09</p> <p>\u91cc\u7a0b\u7891 F\uff1a\u53cc\u8bed\u6587\u6863 1:1 \u5bf9\u5e94\u901a\u8fc7 QA\u3002</p> <p>\u603b\u4f53\u91cc\u7a0b\u7891\u65f6\u95f4\u8868\uff08\u5e76\u884c\u53ef\u7f29\u77ed\uff09\uff1a - \u5468 1\uff1a\u9636\u6bb5 A \u5b8c\u6210 - \u5468 2\uff1a\u9636\u6bb5 B \u5f00\u59cb\u5e76\u5b8c\u6210 - \u5468 3-4\uff1a\u9636\u6bb5 C \u5b8c\u6210 - \u5468 5\uff1a\u9636\u6bb5 D \u4e0e E \u5b8c\u6210 - \u5468 6\uff1a\u9636\u6bb5 F \u9a8c\u6536\u3001\u53d1\u5e03</p>","tags":["plan","documentation"]},{"location":"cullinan_documentation_plan/#5","title":"5. \u4eba\u5458\u5206\u5de5\u5efa\u8bae\uff08\u793a\u4f8b\uff09","text":"<ul> <li>1 * \u6280\u672f\u4f5c\u8005\uff08\u4e3b\u6587\u6863\u64b0\u5199\uff09 \u2014 \u8d1f\u8d23\u5165\u95e8\u3001Wiki \u4e3b\u4f53\u3001\u793a\u4f8b\u6587\u672c</li> <li>1 * \u5f00\u53d1\u5de5\u7a0b\u5e08\uff08\u4ee3\u7801\u7814\u7a76\u4e0e\u793a\u4f8b\u5b9e\u73b0\uff09 \u2014 \u8d1f\u8d23\u6e90\u7801\u6620\u5c04\u3001\u53ef\u8fd0\u884c\u793a\u4f8b\u3001\u9a8c\u8bc1\u6d4b\u8bd5</li> <li>1 * \u7ffb\u8bd1/\u672c\u5730\u5316\uff08\u4e2d\u6587\u6821\u5bf9\uff09 \u2014 \u8d1f\u8d23 <code>docs/zh/</code> \u5bf9\u5e94\u7ffb\u8bd1\u4e0e\u8bed\u5883\u6821\u9a8c</li> <li>1 * \u8bc4\u5ba1/\u7ef4\u62a4\u8005\uff08\u67b6\u6784 &amp; CI \u5ba1\u6838\uff09 \u2014 \u8d1f\u8d23\u5ba1\u7a3f\u3001CI \u5408\u5e76\u3001\u8d28\u91cf\u95e8\u7b7e\u6536</li> </ul>","tags":["plan","documentation"]},{"location":"cullinan_documentation_plan/#6","title":"6. \u5199\u4f5c\u51c6\u5219\uff08\u5fc5\u9075\u5b88\uff09","text":"<ul> <li>\u6587\u4ef6\u7f16\u7801\uff1aUTF-8\u3002</li> <li>\u76ee\u5f55\u7ed3\u6784\uff1a<code>docs/</code> \u4e0e <code>docs/zh/</code> \u5fc5\u987b 1:1 \u5bf9\u5e94\uff0c\u6587\u4ef6\u540d\u4e0e\u76f8\u5bf9\u8def\u5f84\u4e00\u81f4\u3002</li> <li>\u8bed\u8a00\u4e0e\u98ce\u683c\uff1a\u7b80\u6d01\u3001\u4e8b\u5b9e\u9a71\u52a8\uff08\u4ee5\u6e90\u7801\u884c\u4e3a\u4e3a\u51c6\uff09\uff0c\u5c3d\u91cf\u63d0\u4f9b\u793a\u4f8b\u548c\u53ef\u590d\u5236\u6b65\u9aa4\u3002</li> <li>\u7981\u6b62\u5728\u65e5\u5fd7\u6216\u793a\u4f8b\u8f93\u51fa\u4e2d\u4f7f\u7528 emoji\uff08\u9879\u76ee\u89c4\u5b9a\uff09\u3002</li> <li>Windows PowerShell \u547d\u4ee4\u793a\u4f8b\u5e94\u7b26\u5408 Windows PowerShell v5.1 \u8bed\u6cd5\uff1b\u4e0d\u8981\u4f7f\u7528 <code>&amp;&amp;</code> \u8fde\u63a5\u547d\u4ee4\uff1b\u82e5\u9700\u8981\u5728\u4e00\u884c\u6267\u884c\u591a\u4e2a\u547d\u4ee4\uff0c\u4f7f\u7528\u5206\u53f7 <code>;</code>\u3002</li> <li>\u6587\u6863\u4e2d\u5f15\u7528\u6587\u4ef6\u6216\u7b26\u53f7\u65f6\u4f7f\u7528\u53cd\u5f15\u53f7\u5305\u88f9\uff08\u4f8b\u5982 <code>cullinan/core</code>\u3001<code>application.py</code>\uff09\u3002</li> <li>\u5bf9\u4e8e API \u53c2\u8003\uff0c\u660e\u786e\u6807\u6ce8\u201c\u516c\u6709 API\u201d\u4e0e\u201c\u5185\u90e8\u5b9e\u73b0\u201d\uff0c\u9f13\u52b1\u53ea\u5728\u516c\u6709 API \u4e0a\u5efa\u7acb\u4f7f\u7528\u793a\u4f8b\u3002</li> <li>\u7ffb\u8bd1\u7b56\u7565\uff1a\u5148\u5b8c\u6210\u82f1\u6587\u539f\u7a3f\u5e76\u8bc4\u5ba1\u901a\u8fc7\uff0c\u518d\u505a\u4e2d\u6587\u7ffb\u8bd1\uff1b\u59cb\u7ec8\u4fdd\u6301 1:1 \u5185\u5bb9\u4e00\u81f4\u6027\u3002</li> </ul>","tags":["plan","documentation"]},{"location":"cullinan_documentation_plan/#7-quality-gates","title":"7. \u6821\u9a8c / \u8d28\u91cf\u95e8\uff08Quality Gates\uff09","text":"<p>\u6bcf\u4e2a\u9636\u6bb5\u5fc5\u987b\u901a\u8fc7\u76f8\u5e94\u7684\u8d28\u91cf\u95e8\u624d\u80fd\u8fdb\u5165\u4e0b\u4e00\u9636\u6bb5\uff1a</p> <p>\u8d28\u91cf\u95e8\u793a\u4f8b\uff1a - \u4ee3\u7801\u7814\u7a76\u5b8c\u6210\uff1a\u63d0\u4ea4 <code>docs/outline.md</code>\uff0c\u5305\u542b\u6a21\u5757\u6620\u5c04\u4e0e\u5173\u952e\u51fd\u6570\u5217\u8868\uff1b\u81f3\u5c11\u4e24\u4f4d\u5de5\u7a0b\u5e08\u5ba1\u6838\u540c\u610f\uff08\u7b7e\u540d\u6216 PR \u8bc4\u8bba\uff09\u3002 - \u793a\u4f8b\u53ef\u8fd0\u884c\uff1a<code>examples/</code> \u4e2d\u793a\u4f8b\u53ef\u5728\u672c\u5730\u865a\u62df\u73af\u5883\u4e2d\u6210\u529f\u8fd0\u884c\uff08\u89c1\u9a8c\u8bc1\u547d\u4ee4\uff09\u3002 - \u5355\u5143/\u96c6\u6210\u6d4b\u8bd5\uff1a\u8fd0\u884c\u4ed3\u5e93\u73b0\u6709\u6d4b\u8bd5\u5e76\u786e\u4fdd\u65e0\u56de\u5f52\uff08\u89c1\u4e0b\u65b9\u547d\u4ee4\uff09\u3002\u5fc5\u987b\u81f3\u5c11\u5b9e\u73b0\u201c\u5f53\u524d\u4e3b\u5206\u652f\u76f8\u540c\u6216\u66f4\u597d\u201d\u7684\u901a\u8fc7\u7387\u3002 - \u6587\u6863\u5ba1\u6821\uff1a\u6bcf\u7bc7\u6587\u6863\u81f3\u5c11 1 \u6b21\u6280\u672f\u5ba1\u9605\u4e0e 1 \u6b21\u8bed\u8a00\u6821\u5bf9\uff08\u4e2d\u6587\uff09\u3002 - \u53d1\u5e03\u524d\uff1aCI \u901a\u8fc7\u3001\u6587\u6863\u94fe\u63a5\u5b8c\u6574\u6027\u68c0\u67e5\u3001\u793a\u4f8b\u5728 Windows PowerShell \u6d4b\u8bd5\u901a\u8fc7\u3002</p> <p>\u5173\u952e\u6821\u9a8c\u547d\u4ee4\uff08PowerShell \u8868\u793a\u6cd5\uff0c\u5355\u884c\u793a\u4f8b\u4f7f\u7528 <code>;</code> \u5206\u9694\uff09\uff1a - \u521b\u5efa\u865a\u62df\u73af\u5883\u5e76\u6fc0\u6d3b\uff08\u53ef\u9009\uff09\uff1a\u8bf7\u786e\u4fdd\u4f60\u6709\u4e00\u4e2a\u53ef\u7528\u7684 Python \u73af\u5883\uff08virtualenv/conda/system Python \u7b49\u5747\u53ef\uff09\uff0c\u65e0\u9700\u5728\u6587\u6863\u4e2d\u786c\u6027\u89c4\u5b9a\u6fc0\u6d3b\u547d\u4ee4\u3002 - \u5b89\u88c5\u5f00\u53d1\u4f9d\u8d56\u5e76\u5b89\u88c5\u672c\u5305\uff08\u53ef\u9009 extras\uff09\uff1a<code>pip install -U pip; pip install -e .[dev]</code> \u6216 <code>pip install -e .</code> - \u8fd0\u884c\u6d4b\u8bd5\uff1a<code>py -3 -m pytest -q</code>\uff08\u6216 <code>pytest -q</code>\uff09 - \u8fd0\u884c\u5355\u4e2a\u793a\u4f8b\uff08\u5728 <code>examples/</code> \u76ee\u5f55\uff09\uff1a<code>py example_script.py</code> \u6216 <code>python -m examples.demo</code>\uff08\u53d6\u51b3\u4e8e\u793a\u4f8b\u5b9e\u73b0\uff09 - \u68c0\u67e5\u6587\u6863\u94fe\u63a5/\u62fc\u5199\uff08\u82e5\u4f7f\u7528\u5de5\u5177\uff09\uff1a<code>pylint</code>/<code>flake8</code>\uff08\u4ee3\u7801\uff09\uff0c<code>markdownlint</code>\uff08\u6587\u6863\uff09\uff08\u6309\u9700\u5b89\u88c5\uff09</p>","tags":["plan","documentation"]},{"location":"cullinan_documentation_plan/#8","title":"8. \u9700\u8981\u521b\u5efa\u7684\u6587\u4ef6\u7ed3\u6784\u4e0e\u6a21\u677f\u793a\u4f8b","text":"<p>\u5efa\u8bae\u5728\u4ed3\u5e93\u4e2d\u65b0\u589e/\u586b\u5145\u4ee5\u4e0b\u6587\u4ef6\uff08<code>docs/</code> \u4e0e <code>docs/zh/</code> \u5fc5\u987b\u955c\u50cf\uff09\uff1a</p> <ul> <li><code>docs/README.md</code>\uff08\u6587\u6863\u4e3b\u9875/\u5bfc\u822a\uff09</li> <li><code>docs/getting_started.md</code>\uff08\u5feb\u901f\u5f00\u59cb - \u73af\u5883\u3001\u5b89\u88c5\u3001\u8fd0\u884c\u7b2c\u4e00\u4e2a\u5e94\u7528\uff09</li> <li><code>docs/examples.md</code>\uff08\u793a\u4f8b\u7d22\u5f15\u4e0e\u8bf4\u660e\uff09 + <code>examples/</code> \u76ee\u5f55\u653e\u793a\u4f8b\u4ee3\u7801</li> <li><code>docs/wiki/architecture.md</code>\uff08\u67b6\u6784\u603b\u89c8\uff09</li> <li><code>docs/wiki/components.md</code>\uff08\u7ec4\u4ef6\u8d23\u4efb &amp; API \u6458\u8981\uff09</li> <li><code>docs/wiki/lifecycle.md</code>\uff08\u5e94\u7528\u542f\u52a8/\u5173\u95ed/\u751f\u547d\u5468\u671f\u94a9\u5b50\uff09</li> <li><code>docs/wiki/injection.md</code>\uff08IoC/DI \u673a\u5236\u8be6\u89e3\uff09</li> <li><code>docs/wiki/middleware.md</code>\uff08\u4e2d\u95f4\u4ef6\u94fe\u4e0e\u6269\u5c55\u70b9\uff09</li> <li><code>docs/api_reference.md</code>\uff08\u6309\u6a21\u5757\u5217\u51fa\u7684\u516c\u6709 API\uff09</li> <li><code>docs/migration_guide.md</code>\uff08\u517c\u5bb9\u6027\u4e0e\u8fc1\u79fb\uff09</li> <li><code>docs/contributing.md</code>\uff08\u8d21\u732e\u8005\u6307\u5357\u3001\u4ee3\u7801\u98ce\u683c\u3001PR \u6d41\u7a0b\uff09</li> <li><code>docs/testing.md</code>\uff08\u5982\u4f55\u8fd0\u884c\u73b0\u6709 tests\u3001\u5199\u6d4b\u8bd5\u3001CI \u8981\u6c42\uff09</li> <li><code>docs/build_run.md</code>\uff08\u5728 Windows/Unix \u4e0b\u7684\u672c\u5730\u6784\u5efa/\u8fd0\u884c\u8bf4\u660e\uff09</li> <li><code>docs/templates/</code>\uff08\u9875\u9762\u6a21\u677f\uff1a\u6807\u9898\u3001\u6982\u8ff0\u3001\u793a\u4f8b\u7ed3\u6784\u3001API \u6761\u76ee\u683c\u5f0f\u3001\u7ffb\u8bd1\u5bf9\u7167\u8868\uff09</li> </ul> <p>\u6a21\u677f\u793a\u4f8b\uff08\u63cf\u8ff0\u800c\u975e\u4ee3\u7801\u5757\uff09\uff1a - \u6587\u6863\u9876\u90e8\u5e94\u5305\u542b\u7b80\u77ed \u201c\u76ee\u7684/\u8303\u56f4/\u524d\u63d0\u201d \u4e09\u6bb5\uff1b\u968f\u540e\u201c\u793a\u4f8b\u201d\u90e8\u5206\u6309\u201c\u793a\u4f8b\u8bf4\u660e / \u4ee3\u7801\u4f4d\u7f6e / \u8fd0\u884c\u6b65\u9aa4 / \u671f\u671b\u7ed3\u679c\u201d\u56db\u6bb5\u6a21\u677f\u6392\u5217\u3002 - API \u6761\u76ee\u6a21\u677f\uff1a\u6a21\u5757\u8def\u5f84 -&gt; \u7b80\u77ed\u63cf\u8ff0 -&gt; \u516c\u5f00\u7c7b/\u51fd\u6570\u5217\u8868\uff08\u6bcf\u9879\uff1a\u7b7e\u540d\u3001\u53c2\u6570\u8bf4\u660e\u3001\u8fd4\u56de\u503c\u3001\u5f02\u5e38 &amp; \u4f7f\u7528\u793a\u4f8b\u884c\u53f7\u5f15\u7528\uff09\u3002 - \u7ffb\u8bd1\u6a21\u677f\uff1a\u6bcf\u4e2a\u82f1\u6587\u6587\u4ef6\u5e94\u5e26\u6709\u4e00\u4efd\u5bf9\u7167\u6e05\u5355\u5217\u51fa\u201c\u5efa\u8bae\u672f\u8bed\u7ffb\u8bd1\u201d\uff08\u4f8b\u5982 IoC -&gt; \u63a7\u5236\u53cd\u8f6c, DI -&gt; \u4f9d\u8d56\u6ce8\u5165\uff09\u3002</p>","tags":["plan","documentation"]},{"location":"cullinan_documentation_plan/#9","title":"9. \u9a8c\u6536\u6807\u51c6\uff08\u9a8c\u6536\u68c0\u67e5\u8868\uff09","text":"<p>\u6bcf\u9879\u6587\u6863\u5728\u4ea4\u4ed8\u524d\u5fc5\u987b\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\uff1a - \u82f1\u6587\u4e0e\u4e2d\u6587\u6587\u4ef6 1:1 \u5bf9\u5e94\uff08\u8def\u5f84\u4e0e\u6587\u4ef6\u540d\u4e00\u81f4\uff0c\u5185\u5bb9\u7b49\u6548\uff09\u3002 - Getting Started\uff1a\u65b0\u7528\u6237\u6309\u6b65\u9aa4\u80fd\u5728 30 \u5206\u949f\u5185\u8fd0\u884c\u793a\u4f8b\u5e76\u8bbf\u95ee\u5e94\u7528\u3002 - Examples\uff1a\u81f3\u5c11\u5305\u542b 2 \u4e2a\u53ef\u8fd0\u884c\u793a\u4f8b\uff08\u6700\u5c0f\uff1aHello World HTTP\uff0c\u8fdb\u9636\uff1aController + DI + Middleware \u793a\u4f8b\uff09\u3002 - Wiki\uff1a\u8986\u76d6\u67b6\u6784\u56fe\u3001\u7ec4\u4ef6\u804c\u8d23\u3001\u6ce8\u5165\u751f\u547d\u5468\u671f\u4e0e\u9519\u8bef\u6a21\u578b\u3002 - API \u53c2\u8003\uff1a\u8986\u76d6\u6240\u6709\u516c\u5171\u6a21\u5757\u5e76\u63d0\u4f9b\u81f3\u5c11\u4e00\u4e2a\u4f7f\u7528\u793a\u4f8b\u3002 - Migration Guide\uff1a\u5217\u51fa\u6240\u6709\u7834\u574f\u6027\u53d8\u66f4\u4e0e\u8fc1\u79fb\u6b65\u9aa4\uff08\u82e5\u5b58\u5728\uff09\u3002 - Contributing\uff1a\u5305\u542b\u4ee3\u7801\u98ce\u683c\u3001PR \u6d41\u7a0b\u3001\u6d4b\u8bd5\u51c6\u5165\u95e8\u69db\u3002 - Testing\uff1a\u73b0\u6709\u6d4b\u8bd5\u5728\u5e72\u51c0\u73af\u5883\u4e0b <code>pytest</code> \u8fd0\u884c\u901a\u8fc7\uff08\u4e0e\u4e3b\u5206\u652f\u540c\u7b49\u6216\u66f4\u4f18\uff09\u3002 - \u6587\u6863\u5ba1\u9605\uff1a\u81f3\u5c11 2 \u540d\u6280\u672f\u8bc4\u5ba1\u4e0e 1 \u540d\u6587\u672c\u6821\u5bf9\u901a\u8fc7\u3002 - CI/\u53d1\u5e03\uff1a\u6587\u6863\u6784\u5efa\u6216\u9759\u6001\u68c0\u67e5\uff08\u82e5\u4f7f\u7528 mkdocs/sphinx\uff09\u901a\u8fc7\u3002</p>","tags":["plan","documentation"]},{"location":"cullinan_documentation_plan/#10","title":"10. \u98ce\u9669\u4e0e\u7f13\u89e3\u63aa\u65bd","text":"<p>\u98ce\u9669 1\uff1a\u6e90\u7801\u7406\u89e3\u504f\u5dee\uff08\u53ea\u8bfb\u6e90\u7801\u3001\u4e0d\u770b\u6ce8\u91ca\u53ef\u80fd\u4e22\u5931\u8bbe\u8ba1\u80cc\u666f\uff09 - \u7f13\u89e3\uff1a\u7528\u6d4b\u8bd5\u7528\u4f8b\u4f5c\u4e3a\u884c\u4e3a\u89c4\u8303\uff0c\u5fc5\u8981\u65f6\u5728\u5ba1\u9605\u9636\u6bb5\u5411\u539f\u4f5c\u8005\u786e\u8ba4\u8bbe\u8ba1\u610f\u56fe\u5e76\u8bb0\u5f55\u4e3a\u201c\u4f5c\u8005\u8bf4\u660e\u201d\u9644\u5f55\uff08\u975e\u4fee\u6539\u6e90\u7801\uff09\u3002</p> <p>\u98ce\u9669 2\uff1aIoC/DI \u8bbe\u8ba1\u590d\u6742\u3001\u96be\u4ee5\u76f4\u89c2\u8868\u8fbe - \u7f13\u89e3\uff1a\u7528\u6d41\u7a0b\u56fe\u3001\u987a\u5e8f\u56fe\u548c\u793a\u4f8b\u4ee3\u7801\u6f14\u793a\u6ce8\u5165\u65f6\u5e8f\uff1b\u5728 <code>docs/wiki/injection.md</code> \u4e2d\u589e\u52a0\u201c\u5e38\u89c1\u6a21\u5f0f/\u53cd\u6a21\u5f0f\u201d\u3002</p> <p>\u98ce\u9669 3\uff1a\u4e2d\u82f1\u7ffb\u8bd1\u4e0d\u4e00\u81f4\u6216\u672f\u8bed\u4e0d\u7edf\u4e00 - \u7f13\u89e3\uff1a\u7ef4\u62a4\u201c\u672f\u8bed\u5bf9\u7167\u8868\u201d\uff1b\u5148\u5b8c\u6210\u82f1\u6587\u5e76\u5ba1\u6821\uff0c\u518d\u7531\u7ffb\u8bd1\u8005\u5bf9\u7167\u9010\u6761\u7ffb\u8bd1\u5e76\u590d\u6838\u3002</p> <p>\u98ce\u9669 4\uff1a\u793a\u4f8b\u5728 Windows \u73af\u5883\u4e0d\u53ef\u8fd0\u884c - \u7f13\u89e3\uff1a\u5728 Windows PowerShell v5.1 \u4e0b\u6d4b\u8bd5\u6240\u6709\u793a\u4f8b\u5e76\u5728 <code>build_run.md</code> \u7ed9\u51fa PowerShell \u4e13\u7528\u547d\u4ee4\uff08\u4f7f\u7528\u5206\u53f7 <code>;</code>\uff0c\u907f\u514d <code>&amp;&amp;</code>\uff09\u3002</p> <p>\u98ce\u9669 5\uff1a\u81ea\u52a8\u751f\u6210 API \u5de5\u5177\u914d\u7f6e\u590d\u6742 - \u7f13\u89e3\uff1a\u5982\u81ea\u52a8\u5316\u6210\u672c\u8fc7\u9ad8\uff0c\u91c7\u7528\u534a\u81ea\u52a8\u5316\uff08\u811a\u672c\u63d0\u53d6\u516c\u6709\u7b26\u53f7\u5e76\u751f\u6210\u6a21\u677f\uff09\u6216\u624b\u5de5\u8865\u5168\u5173\u952e\u6a21\u5757\u3002</p>","tags":["plan","documentation"]},{"location":"cullinan_documentation_plan/#11-powershell-v51","title":"11. \u5fc5\u8981\u7684\u547d\u4ee4\u4e0e\u5de5\u5177\uff08PowerShell v5.1 \u793a\u4f8b\u8bf4\u660e\uff09","text":"<ul> <li>\u5efa\u8bae\u5f00\u53d1\u73af\u5883\u5de5\u5177\uff1aPython 3.8+\uff08\u9879\u76ee\u5f53\u524d\u8981\u6c42\u8bf7\u6838\u5bf9 <code>setup.py</code>\uff09\u3001pytest\u3001mkdocs/sphinx\u3001markdownlint\u3001typora/VSCode\uff08\u7528\u4e8e\u6821\u5bf9\uff09\u3001\u53ef\u9009\uff1agraphviz\uff08\u753b\u4f9d\u8d56\u56fe\uff09\u3002</li> <li>\u865a\u62df\u73af\u5883\uff08\u793a\u4f8b\u8bf4\u660e\uff09\uff1a\u5982\u9700\u5728\u672c\u5730\u521b\u5efa\u865a\u62df\u73af\u5883\uff0c\u8bf7\u53c2\u8003\u4f60\u7684\u5e73\u53f0\u548c\u504f\u597d\uff1b\u6587\u6863\u793a\u4f8b\u7edf\u4e00\u4f7f\u7528 <code>pip</code> \u547d\u4ee4\u5047\u5b9a\u5df2\u53ef\u7528\u7684 Python \u73af\u5883\u3002</li> <li>\u5b89\u88c5\u5f00\u53d1\u4f9d\u8d56\uff1a<code>pip install -U pip; pip install -e .[dev]</code>\uff08\u6216 <code>pip install -e .</code>\uff09</li> <li>\u8fd0\u884c\u6d4b\u8bd5\uff1a<code>py -3 -m pytest -q</code></li> <li>\u8fd0\u884c\u5355\u4e2a\u793a\u4f8b\uff08\u793a\u4f8b\u4f4d\u4e8e <code>examples/hello.py</code>\uff09\uff1a<code>py examples\\\\hello.py</code></li> <li>\u82e5\u4f7f\u7528 docs \u5de5\u5177\uff08mkdocs\uff09\u6784\u5efa\u672c\u5730\u9884\u89c8\uff1a<code>pip install mkdocs mkdocs-material; mkdocs serve</code>\uff08\u8bf7\u5728 docs \u6839\u76ee\u5f55\u6267\u884c\uff09</li> </ul>","tags":["plan","documentation"]},{"location":"cullinan_documentation_plan/#12","title":"12. \u4ea4\u4ed8\u7269\u63d0\u4ea4 / \u5408\u5e76\u6d41\u7a0b\u5efa\u8bae","text":"<ul> <li>\u6bcf\u4e2a\u9636\u6bb5\u5b8c\u6210\u540e\u63d0\u4ea4\u4e00\u4e2a\u5355\u72ec PR\uff08\u4f8b\u5982 <code>docs/getting-started</code>\u3001<code>docs/wiki-injection</code> \u7b49\uff09\uff0cPR \u5fc5\u987b\u5305\u542b\uff1a\u53d8\u66f4\u8bf4\u660e\u3001\u6d4b\u8bd5/\u793a\u4f8b\u9a8c\u8bc1\u6b65\u9aa4\u3001\u5ba1\u9605\u68c0\u67e5\u6e05\u5355\u3002</li> <li>\u5408\u5e76\u524d\u5fc5\u987b\u901a\u8fc7\u81f3\u5c11\u4e00\u540d\u4ee3\u7801/\u67b6\u6784\u5ba1\u9605\u8005\u4e0e\u4e00\u540d\u6587\u6863\u6821\u5bf9\u8005\u3002</li> <li>\u53d1\u5e03\u6587\u6863\u7248\u672c\uff08tag\uff09\u5e76\u5728 <code>README.MD</code> \u4e2d\u66f4\u65b0\u5230\u7248\u672c\u94fe\u63a5\u3002</li> </ul> <p>\u5982\u9700\u5c06\u672c\u8ba1\u5212\u62c6\u5206\u4e3a\u5177\u4f53\u7684 <code>docs/</code> \u6587\u4ef6\u6a21\u677f\u5e76\u4e3a\u6bcf\u4e2a\u6587\u4ef6\u751f\u6210\u521d\u59cb\u5360\u4f4d\u5185\u5bb9\uff08\u82f1\u6587 + \u4e2d\u6587\u5360\u4f4d\uff09\uff0c\u53ef\u7ee7\u7eed\u6267\u884c\u5e76\u521b\u5efa\u8fd9\u4e9b\u6587\u4ef6\u3002\u8bf7\u544a\u77e5\u662f\u5426\u9700\u8981\u81ea\u52a8\u521b\u5efa\u8fd9\u4e9b\u6a21\u677f\u6587\u4ef6\u4ee5\u53ca\u5bf9 API \u6587\u6863\u7684\u504f\u597d\uff08\u81ea\u52a8\u5316\u5de5\u5177 vs \u624b\u5de5\u7ef4\u62a4\uff09\u3002</p>","tags":["plan","documentation"]},{"location":"examples/","title":"Examples and Demos","text":"<p>This page lists canonical runnable examples shipped with Cullinan. Each entry includes the example path, a short description, and how to run it on common platforms.</p>"},{"location":"examples/#hello-http","title":"Hello HTTP","text":"<ul> <li>Path: <code>examples/hello_http.py</code></li> <li>Description: Minimal HTTP server returning a greeting.</li> </ul>"},{"location":"examples/#how-to-run","title":"How to run","text":"<p>On Windows (PowerShell):</p> <pre><code>python examples\\hello_http.py\n</code></pre> <p>On Linux / macOS:</p> <pre><code>python examples/hello_http.py\n</code></pre> <p>Expected behavior:</p> <ul> <li>Starts an HTTP server.</li> <li>Serves a response on <code>http://localhost:4080/hello</code>.</li> </ul>"},{"location":"examples/#controller-di-middleware-demo","title":"Controller + DI + Middleware demo","text":"<ul> <li>Path: <code>examples/controller_di_middleware.py</code></li> <li>Description: Demonstrates integration between controllers, dependency injection, and middleware.</li> </ul>"},{"location":"examples/#how-to-run_1","title":"How to run","text":"<p>On Windows (PowerShell):</p> <pre><code>python examples\\controller_di_middleware.py\n</code></pre> <p>On Linux / macOS:</p> <pre><code>python examples/controller_di_middleware.py\n</code></pre> <p>Expected behavior:</p> <ul> <li>Logs request handling through middleware.</li> <li>Shows how injected services participate in the request pipeline.</li> </ul>"},{"location":"getting_started/","title":"Getting Started with Cullinan","text":"<p>This page provides a minimal quick-start to install and run a small Cullinan application.</p>"},{"location":"getting_started/#prerequisites","title":"Prerequisites","text":"<ul> <li>Python 3.8+</li> <li>Git</li> </ul>"},{"location":"getting_started/#install","title":"Install","text":"<p>Before you start, make sure Python 3.8+ is installed and that <code>python</code> and <code>pip</code> are available on your PATH.</p> <p>On most systems, you can upgrade pip and install Cullinan with the following commands (valid on Windows, Linux, and macOS):</p> <pre><code>python -m pip install -U pip\npython -m pip install cullinan\n</code></pre>"},{"location":"getting_started/#quick-start","title":"Quick start","text":"<ol> <li>Create a new project directory and change into it:</li> </ol> <p>On all platforms:</p> <pre><code>mkdir my_cullinan_project\ncd my_cullinan_project\n</code></pre> <ol> <li>Ensure you have a Python environment (virtualenv, conda, system Python, etc.). Install the published package:</li> </ol> <pre><code>python -m pip install -U pip\npython -m pip install cullinan\n</code></pre> <ol> <li>Create a minimal application file <code>minimal_app.py</code> in your project with the following content:</li> </ol> <pre><code># minimal_app.py\nfrom cullinan import application\nfrom cullinan.controller import controller\n\n@controller(path='/hello')\ndef hello_handler(request):\n    \"\"\"Simple HTTP handler.\"\"\"\n    return {'message': 'Hello from Cullinan!'}\n\nif __name__ == '__main__':\n    # Start the framework application (no instantiation required)\n    application.run()\n</code></pre> <ol> <li>Run your app:</li> </ol> <p>On Windows (PowerShell):</p> <pre><code>python minimal_app.py\n</code></pre> <p>On Linux / macOS:</p> <pre><code>python minimal_app.py\n</code></pre> <p>Then open <code>http://localhost:4080/hello</code> in your browser to verify the server is running.</p>"},{"location":"getting_started/#sample-run-output","title":"Sample run output","text":"<p>The following log output illustrates a successful run of the example in a local environment (Windows PowerShell session). Timestamps and durations will vary between environments:</p> <pre><code>|||||||||||||||||||||||||||||||||||||||||||||||||\n|||                                           |||\n|||    _____      _ _ _                       |||\n|||   / ____|    | | (_)                      |||\n|||  | |    _   _| | |_ _ __   __ _ _ __      |||\n|||  | |   | | | | | | | '_ \\ / _` | '_ \\     |||\n|||  | |___| |_| | | | | | | | (_| | | | |    |||\n|||   \\_____\\__,_|_|_|_|_| |_|\\__,_|_| |_|    |||\n|||                                           |||\n|||||||||||||||||||||||||||||||||||||||||||||||||\n    |||\n\n2025-11-19 04:18:50,209 INFO cullinan.application: loading env...\n2025-11-19 04:18:50,210 INFO cullinan.application: \u2514---configuring dependency injection...\n2025-11-19 04:18:50,210 INFO cullinan.application: \u2514---dependency injection configured\n2025-11-19 04:18:50,210 INFO cullinan.application: \u2514---scanning services...\n2025-11-19 04:18:50,210 INFO cullinan.application: ...\n2025-11-19 04:18:50,223 INFO cullinan.application: \u2514---found 31 modules to scan\n2025-11-19 04:18:50,228 INFO cullinan.application: \u2514---scanning controllers...\n2025-11-19 04:18:50,260 INFO cullinan.application: \u2514---found 31 modules to scan\n2025-11-19 04:18:50,261 INFO cullinan.application: \u2514---initializing services...\n2025-11-19 04:18:50,261 INFO cullinan.application: \u2514---no services registered\n2025-11-19 04:18:50,261 INFO cullinan.application: \u2514---loading controller finish\n\n2025-11-19 04:18:50,261 INFO cullinan.application: loading env finish\n\n2025-11-19 04:18:50,262 INFO cullinan.application: server is starting\n2025-11-19 04:18:50,262 INFO cullinan.application: port is 4080\n</code></pre> <p>At this point, the server is running and listening on <code>http://localhost:4080</code>. Use Ctrl+C to gracefully stop the server.</p>"},{"location":"getting_started/#minimal-application-example","title":"Minimal application example","text":"<p>Here's a minimal Cullinan application that demonstrates the core framework features:</p> <pre><code># minimal_app.py\nfrom cullinan import application\nfrom cullinan.controller import controller\n\n@controller(path='/hello')\ndef hello_handler(request):\n    \"\"\"Simple HTTP handler.\"\"\"\n    return {'message': 'Hello from Cullinan!'}\n\nif __name__ == '__main__':\n    # Start the framework application (no instantiation required)\n    application.run()\n</code></pre> <p>To run this example:</p> <pre><code># Save the above code as minimal_app.py\npython minimal_app.py\n</code></pre> <p>Then visit <code>http://localhost:4080/hello</code> in your browser.</p>"},{"location":"getting_started/#understanding-the-basics","title":"Understanding the basics","text":""},{"location":"getting_started/#application-lifecycle","title":"Application lifecycle","text":"<ol> <li>Creation: <code>create_app()</code> initializes the application with default settings</li> <li>Registration: Controllers and services are discovered via module scanning or explicit registration</li> <li>Startup: <code>app.run()</code> starts the Tornado IOLoop and begins accepting requests</li> <li>Shutdown: Graceful shutdown on SIGINT/SIGTERM</li> </ol>"},{"location":"getting_started/#dependency-injection","title":"Dependency Injection","text":"<p>Cullinan provides built-in IoC/DI support. </p>"},{"location":"getting_started/#decorators-explained-injectable-vs-controller","title":"Decorators Explained: <code>@injectable</code> vs <code>@controller()</code>","text":"<p><code>@injectable</code> - General-purpose dependency injection decorator - Applicable to any class that needs dependency injection (Service, Repository, utility classes, etc.) - Must be manually applied, does not auto-register to any registry - Automatically injects marked dependencies after class instantiation - Use cases: Service layer, Repository layer, utility classes, etc.</p> <p><code>@controller()</code> - Controller-specific auto-registration decorator - Specifically for HTTP Controller classes - Automatically applies <code>@injectable</code>, no need to add manually - Auto-registers Controller and its routes to ControllerRegistry - Auto-scans methods decorated with <code>@get_api</code>, <code>@post_api</code>, etc. - Use cases: HTTP Controllers only</p> <pre><code>from cullinan.controller import controller, get_api\nfrom cullinan.service import Service, service\nfrom cullinan.core import injectable, InjectByName\n\n# Service uses @service (inherits from Service base class)\n@service\nclass UserService(Service):\n    def get_user(self, user_id):\n        return {'id': user_id, 'name': 'John'}\n\n# Repository uses @injectable\n@injectable\nclass UserRepository:\n    def find_by_id(self, user_id):\n        return {'id': user_id}\n\n# Controller uses @controller() - automatically includes @injectable\n@controller(url='/api/users')\nclass UserController:\n    # Dependency injection in Controller\n    user_service = InjectByName('UserService')\n\n    @get_api(url='/{user_id}')\n    def get_user(self, url_params):\n        # extract the path parameter from the url_params dict\n        user_id = url_params.get('user_id') if url_params else None\n        return self.user_service.get_user(user_id)\n</code></pre> <p>Important: Do not use <code>@injectable</code> on Controllers, as <code>@controller()</code> already includes it automatically.</p>"},{"location":"getting_started/#restful-api-decorators-quick-overview","title":"RESTful API decorators (quick overview)","text":"<p>Cullinan provides a set of REST-style decorators that bind controller methods to HTTP routes:</p> <ul> <li><code>get_api</code></li> <li><code>post_api</code></li> <li><code>patch_api</code></li> <li><code>delete_api</code></li> <li><code>put_api</code></li> </ul> <p>Key points:</p> <ul> <li>These decorators only accept keyword arguments (they are defined as <code>def get_api(**kwargs)</code> etc.).</li> <li><code>@get_api('/user')</code> is invalid and will raise a <code>TypeError</code> at import time.</li> <li>Always use the keyword form: <code>@get_api(url='/user')</code>.</li> <li>The <code>url</code> argument uses a lightweight template syntax with <code>{param}</code> placeholders, which are mapped to your method parameters. Use the singular dict-style parameter names in your handler to access captured values:</li> </ul> <pre><code>@controller(url='/api/users')\nclass UserController:\n    @get_api(url='/{user_id}')\n    def get_user(self, url_params):\n        user_id = url_params.get('user_id') if url_params else None\n        ...\n</code></pre> <p>Common options:</p> <ul> <li><code>url</code>: Route pattern (string). Supports <code>{param}</code> placeholders, e.g. <code>'/users/{user_id}'</code>.</li> <li><code>query_params</code>: Iterable of query parameter names, e.g. <code>('page', 'size')</code>. In handlers the query values are provided via a single <code>query_params</code> dict argument.</li> <li><code>body_params</code> (POST/PATCH only): Iterable of body field names for JSON/form parsing. In handlers the parsed fields are provided via a single <code>body_params</code> dict argument.</li> <li><code>file_params</code>: Iterable of file field names for file uploads.</li> <li><code>headers</code>: Iterable of required HTTP header names.</li> <li><code>get_request_body</code> (POST/PATCH only): If <code>True</code>, passes the raw request body to your method.</li> </ul> <p>Example combinations:</p> <pre><code>@controller(url='/api/users')\nclass UserController:\n    @get_api(url='/', query_params=('page', 'size'))\n    def list_users(self, query_params):\n        page = query_params.get('page') if query_params else None\n        size = query_params.get('size') if query_params else None\n        ...\n\n    @post_api(url='/', body_params=('name', 'email'))\n    def create_user(self, body_params):\n        name = body_params.get('name') if body_params else None\n        email = body_params.get('email') if body_params else None\n        ...\n</code></pre> <p>For a deeper dive into URL patterns and all decorator options, see <code>docs/wiki/restful_api.md</code>.</p>"},{"location":"getting_started/#recommended-dependency-injection-approaches","title":"Recommended Dependency Injection Approaches","text":"<p>Approach 1: InjectByName (Recommended, Simplest)</p> <p>Inject by name without importing dependencies, avoiding circular import issues:</p> <pre><code>from cullinan.service import Service, service\nfrom cullinan.core import injectable, InjectByName\n\n@service\nclass DatabaseService(Service):\n    def query(self, sql):\n        return f\"Results for: {sql}\"\n\n@injectable\nclass UserRepository:\n    # Recommended: InjectByName doesn't need type annotation, just use string name\n    db = InjectByName('DatabaseService')\n\n    def get_users(self):\n        return self.db.query(\"SELECT * FROM users\")\n</code></pre> <p>Approach 2: Inject + TYPE_CHECKING (IDE autocomplete support)</p> <p>If you need IDE autocomplete and type checking, use <code>Inject</code> with TYPE_CHECKING:</p> <pre><code>from typing import TYPE_CHECKING\nfrom cullinan.core import injectable, Inject\nfrom cullinan.service import Service, service\n\n# TYPE_CHECKING imports are not executed at runtime, avoiding circular imports\nif TYPE_CHECKING:\n    from cullinan.service import DatabaseService\n\n@service\nclass DatabaseService(Service):\n    def query(self, sql):\n        return f\"Results for: {sql}\"\n\n@injectable\nclass UserRepository:\n    # With TYPE_CHECKING import, you get IDE autocomplete support\n    db: 'DatabaseService' = Inject()\n\n    def get_users(self):\n        # IDE can suggest db.query method\n        return self.db.query(\"SELECT * FROM users\")\n</code></pre> <p>Approach 3: Inject + Pure String Annotation (No IDE autocomplete)</p> <p>If you don't need IDE autocomplete, use string annotations directly:</p> <pre><code>from cullinan.core import injectable, Inject\n\n@injectable\nclass UserRepository:\n    # Pure string annotation, no import needed, but no IDE autocomplete\n    db: 'DatabaseService' = Inject()\n\n    def get_users(self):\n        return self.db.query(\"SELECT * FROM users\")\n</code></pre> <p>Summary: - InjectByName: Recommended for most cases, simple and straightforward, no type annotation needed - Inject + TYPE_CHECKING: Best for development experience, provides IDE autocomplete - Inject + String annotation: Simplest but no IDE support</p> <p>For detailed information on injection patterns, see <code>docs/wiki/injection.md</code>.</p>"},{"location":"getting_started/#common-patterns","title":"Common patterns","text":""},{"location":"getting_started/#adding-middleware","title":"Adding middleware","text":"<pre><code>from cullinan.middleware import MiddlewareBase\n\nclass LoggingMiddleware(MiddlewareBase):\n    def process_request(self, request):\n        print(f\"Request: {request.method} {request.path}\")\n\n# Register during app initialization\napp.add_middleware(LoggingMiddleware())\n</code></pre>"},{"location":"getting_started/#configuration","title":"Configuration","text":"<pre><code>from cullinan.config import Config\n\nconfig = Config()\nconfig.set('database.url', 'postgresql://localhost/mydb')\nconfig.set('server.port', 8080)\n</code></pre>"},{"location":"getting_started/#troubleshooting","title":"Troubleshooting","text":"<ul> <li>If you encounter errors installing packages, ensure your Python and pip are up to date and that you have network access to PyPI.</li> </ul>"},{"location":"getting_started/#next-steps","title":"Next steps","text":"<ul> <li>Read <code>docs/wiki/injection.md</code> for IoC/DI details.</li> <li>Explore <code>examples/</code> for runnable samples.</li> </ul>"},{"location":"getting_started/#additional-resources","title":"Additional resources","text":"<ul> <li>Architecture: See <code>docs/architecture.md</code> for system design overview</li> <li>Components: Read <code>docs/wiki/components.md</code> for component responsibilities</li> <li>Lifecycle: Learn about application lifecycle in <code>docs/wiki/lifecycle.md</code></li> <li>Middleware: Understand middleware in <code>docs/wiki/middleware.md</code></li> <li>API Reference: Browse <code>docs/api_reference.md</code> for complete API documentation</li> <li>Examples: Explore <code>examples/</code> directory for more samples</li> </ul>"},{"location":"getting_started/#community-and-support","title":"Community and support","text":"<ul> <li>Issues: Report bugs at GitHub Issues</li> <li>Contributing: See <code>docs/contributing.md</code> for contribution guidelines</li> <li>Testing: Read <code>docs/testing.md</code> for testing best practices</li> </ul>"},{"location":"migration_guide/","title":"Migration Guide","text":"<p>Placeholder: document breaking changes, compatibility notes, and migration steps.</p>"},{"location":"testing/","title":"Testing &amp; Verification","text":"<p>This page describes how to run the existing test suite, add new tests, run example smoke tests, and integrate test execution into CI. Commands are shown for Windows (PowerShell), Linux, and macOS.</p>"},{"location":"testing/#prerequisites","title":"Prerequisites","text":"<ul> <li>Python 3.8 or newer</li> <li>Git</li> <li>A working Cullinan checkout (see <code>docs/build_run.md</code> for environment setup)</li> </ul>"},{"location":"testing/#running-the-test-suite","title":"Running the test suite","text":"<p>After installing Cullinan in editable mode (see <code>docs/build_run.md</code>), you can run the tests with <code>pytest</code>.</p> <p>On all platforms:</p> <pre><code>pytest -q\n</code></pre> <p>If your environment prefers invoking via the Python module interface, you can use:</p> <pre><code>python -m pytest -q\n</code></pre> <p>On Windows, it is also common to use the <code>py</code> launcher:</p> <pre><code>py -3 -m pytest -q\n</code></pre>"},{"location":"testing/#running-individual-test-modules","title":"Running individual test modules","text":"<p>To run a single test file (for example <code>tests/test_core_injection.py</code>):</p> <p>On all platforms:</p> <pre><code>pytest tests/test_core_injection.py -q\n</code></pre> <p>Or with the Python module interface:</p> <pre><code>python -m pytest tests/test_core_injection.py -q\n</code></pre>"},{"location":"testing/#adding-new-tests","title":"Adding new tests","text":"<p>When adding tests for new features or bug fixes:</p> <ol> <li>Place test files under the <code>tests/</code> directory.</li> <li>Use descriptive test names and group related tests in the same module.</li> <li>Prefer <code>pytest</code> style tests (functions and classes) to match the existing suite.</li> <li>Ensure tests are deterministic and do not depend on external services unless explicitly marked.</li> </ol>"},{"location":"testing/#smoke-tests-using-examples","title":"Smoke tests using examples","text":"<p>Cullinan includes runnable examples under the <code>examples/</code> directory that can be used as smoke tests.</p>"},{"location":"testing/#example-hello-http","title":"Example: Hello HTTP","text":"<p>On Windows (PowerShell):</p> <pre><code>python examples\\hello_http.py\n</code></pre> <p>On Linux / macOS:</p> <pre><code>python examples/hello_http.py\n</code></pre> <p>Then open <code>http://localhost:4080/hello</code> in a browser to verify that the server responds.</p>"},{"location":"testing/#example-middleware-demo","title":"Example: Middleware demo","text":"<p>On Windows (PowerShell):</p> <pre><code>python examples\\middleware_demo.py\n</code></pre> <p>On Linux / macOS:</p> <pre><code>python examples/middleware_demo.py\n</code></pre> <p>The log output illustrates how middleware and injected services participate in request handling. Exact timestamps and IDs may vary between runs.</p>"},{"location":"testing/#integrating-tests-into-ci","title":"Integrating tests into CI","text":"<p>In a CI pipeline, the following steps are typically required:</p> <ol> <li>Set up a Python environment.</li> <li>Install dependencies in editable mode (optionally with development extras).</li> <li>Run the test suite with <code>pytest</code>.</li> </ol> <p>Example sequence (bash-style, to be adapted to your CI system):</p> <pre><code>python -m pip install -U pip\npip install -e .[dev]\npytest -q\n</code></pre> <p>On Windows-based CI using PowerShell, the commands are analogous:</p> <pre><code>python -m pip install -U pip\npip install -e .[dev]\npy -3 -m pytest -q\n</code></pre> <p>Adjust the exact commands and options according to your CI provider and environment.</p>"},{"location":"modules/app/","title":"cullinan.app","text":"<p>Summary: placeholder for <code>cullinan.app</code> module documentation. Describe entry-points and how to create app instances.</p> <p>Public symbols to document: App, main (if present)</p>"},{"location":"modules/app/#public-api-auto-generated","title":"Public API (auto-generated)","text":""},{"location":"modules/app/#cullinanapp_1","title":"cullinan.app","text":"Name Kind Signature / Value <code>CullinanApplication</code> class <code>CullinanApplication(shutdown_timeout: int = 30)</code> <code>create_app</code> function <code>create_app(shutdown_timeout: int = 30) -&gt; cullinan.app.CullinanApplication</code>"},{"location":"modules/app/#example-create-and-run-an-application","title":"Example: create and run an application","text":"<pre><code># Quick (recommended): use the framework entrypoint in the process entry script\nfrom cullinan import application\n\nif __name__ == '__main__':\n    application.run()\n\n# Advanced (optional): programmatic control (e.g., tests or adding shutdown handlers)\nfrom cullinan.app import create_app\n\napplication_instance = create_app()\n# application_instance.startup()/application_instance.shutdown() or application_instance.add_shutdown_handler(...)\n# application_instance.run()  # call at the process entrypoint\n</code></pre>"},{"location":"modules/application/","title":"cullinan.application","text":"<p>Summary: placeholder for <code>cullinan.application</code> module documentation. Include public classes, typical usage, and links to related tests and examples.</p> <p>Public symbols to document (suggested): Application, start, stop</p> <p>Usage example:</p> <p>(placeholder for minimal code showing a typical Application usage)</p>"},{"location":"modules/application/#public-api-auto-generated","title":"Public API (auto-generated)","text":""},{"location":"modules/application/#cullinanapplication_1","title":"cullinan.application","text":"Name Kind Signature / Value <code>run</code> function <code>run(handlers=None)</code>"},{"location":"modules/controller/","title":"cullinan.controller","text":"<p>Summary: Controller registration, lifecycle, and injection into controller instances. Document usage patterns and common pitfalls.</p>"},{"location":"modules/controller/#public-api-auto-generated","title":"Public API (auto-generated)","text":""},{"location":"modules/controller/#cullinancontroller_1","title":"cullinan.controller","text":"Name Kind Signature / Value <code>controller</code> function <code>controller(**kwargs) -&gt; Callable</code> <code>get_controller_registry</code> function <code>get_controller_registry() -&gt; cullinan.controller.registry.ControllerRegistry</code> <code>get_header_registry</code> function <code>get_header_registry() -&gt; cullinan.controller.core.HeaderRegistry</code> <code>request_resolver</code> function <code>request_resolver(self, url_param_key_list: Optional[Sequence] = None, url_param_value_list: Optional[Sequence] = None, query_param_names: Optional[Sequence] = None, body_param_names: Optional[Sequence] = None, file_param_key_list: Optional[Sequence] = None) -&gt; Tuple[Optional[dict], Optional[dict], Optional[dict], Optional[dict]]</code> <code>reset_controller_registry</code> function <code>reset_controller_registry() -&gt; None</code> <code>response_build</code> function <code>response_build(**kwargs) -&gt; cullinan.controller.core.StatusResponse</code>"},{"location":"modules/controller/#example-register-a-simple-controller","title":"Example: register a simple controller","text":"<pre><code>from cullinan.controller import controller, get_controller_registry\n\n@controller(path='/hello')\ndef hello(request):\n    return {'status': 200, 'body': 'Hello World'}\n\n# Optionally register directly into registry (usually auto-discovered)\nregistry = get_controller_registry()\nregistry.register(r'/hello', hello)\n</code></pre> <p>Notes: - Use the <code>controller</code> decorator for route handlers; the framework supports automatic discovery via module scanning or explicit registry registration. - If handlers need DI, use <code>@injectable</code> classes or property injection and ensure providers are registered before app startup.</p>"},{"location":"modules/core/","title":"cullinan.core","text":"<p>Summary: Core IoC/DI primitives, provider, scope, registry, and lifecycle helpers. This page should reference concrete files in <code>cullinan/core/</code> and include usage examples.</p> <p>Public symbols to document: provider, registry, scope, injection APIs</p>"},{"location":"modules/core/#public-api-auto-generated","title":"Public API (auto-generated)","text":""},{"location":"modules/core/#cullinancore_1","title":"cullinan.core","text":"Name Kind Signature / Value <code>Inject</code> class <code>Inject(name: Optional[str] = None, required: bool = True)</code> <code>InjectByName</code> class <code>InjectByName(service_name: Optional[str] = None, required: bool = True)</code> <code>InjectionRegistry</code> class <code>InjectionRegistry()</code> <code>ProviderRegistry</code> class <code>ProviderRegistry()</code> <code>RequestScope</code> class <code>RequestScope(storage_key: str = '_scoped_instances')</code> <code>SingletonScope</code> class <code>SingletonScope()</code> <code>TransientScope</code> class <code>TransientScope()</code> <code>create_context</code> function <code>create_context() -&gt; cullinan.core.context.RequestContext</code> <code>destroy_context</code> function <code>destroy_context() -&gt; None</code> <code>get_context_value</code> function <code>get_context_value(key: str, default: Any = None) -&gt; Any</code> <code>get_current_context</code> function <code>get_current_context() -&gt; Optional[cullinan.core.context.RequestContext]</code> <code>get_injection_registry</code> function <code>get_injection_registry() -&gt; cullinan.core.injection.InjectionRegistry</code> <code>get_request_scope</code> function <code>get_request_scope() -&gt; cullinan.core.scope.RequestScope</code> <code>get_singleton_scope</code> function <code>get_singleton_scope() -&gt; cullinan.core.scope.SingletonScope</code> <code>get_transient_scope</code> function <code>get_transient_scope() -&gt; cullinan.core.scope.TransientScope</code> <code>inject_constructor</code> function <code>inject_constructor(cls: Optional[Type] = None)</code> <code>injectable</code> function <code>injectable(cls: Optional[Type] = None)</code> <code>reset_injection_registry</code> function <code>reset_injection_registry() -&gt; None</code> <code>set_context_value</code> function <code>set_context_value(key: str, value: Any) -&gt; None</code> <code>set_current_context</code> function <code>set_current_context(context: Optional[cullinan.core.context.RequestContext]) -&gt; None</code>"},{"location":"modules/core/#examples","title":"Examples","text":"<p>Property injection example (request-scoped provider):</p> <pre><code>from cullinan.core import (\n    ProviderRegistry, ScopedProvider, get_request_scope,\n    injectable, Inject, get_injection_registry, reset_injection_registry\n)\n\nclass Database:\n    def __init__(self):\n        self.id = object()\n\nreset_injection_registry()\nregistry = ProviderRegistry()\nrequest_scope = get_request_scope()\nregistry.register_provider('Database', ScopedProvider(lambda: Database(), request_scope, 'Database'))\nget_injection_registry().add_provider_registry(registry)\n\n@injectable\nclass Service:\n    db: Database = Inject()\n\ns = Service()\nassert s.db is not None\n</code></pre> <p>Constructor injection example:</p> <pre><code>from cullinan.core import inject_constructor, reset_injection_registry, ProviderRegistry, ScopedProvider, get_request_scope, get_injection_registry\n\nclass Config:\n    pass\n\nreset_injection_registry()\npr = ProviderRegistry()\npr.register_provider('Config', ScopedProvider(lambda: Config(), get_request_scope(), 'Config'))\nget_injection_registry().add_provider_registry(pr)\n\n@inject_constructor\nclass Controller:\n    def __init__(self, config: Config):\n        self.config = config\n\nc = Controller()\nassert c.config is not None\n</code></pre> <p>Notes: - Use <code>reset_injection_registry()</code> in tests/setup to ensure a clean injection state. - Prefer <code>@injectable</code> for property injection and <code>@inject_constructor</code> for constructor-based patterns. Ensure ProviderRegistry entries are available before resolving injections.</p>"},{"location":"modules/service/","title":"cullinan.service","text":"<p>Summary: Service registration and provider patterns. Document how services are provided, scoped, and injected.</p>"},{"location":"modules/service/#public-api-auto-generated","title":"Public API (auto-generated)","text":""},{"location":"modules/service/#cullinanservice_1","title":"cullinan.service","text":"Name Kind Signature / Value <code>Service</code> class <code>Service()</code> <code>ServiceRegistry</code> class <code>ServiceRegistry()</code> <code>get_service_registry</code> function <code>get_service_registry() -&gt; cullinan.service.registry.ServiceRegistry</code> <code>reset_service_registry</code> function <code>reset_service_registry() -&gt; None</code> <code>service</code> function <code>service(cls: Optional[Type[cullinan.service.base.Service]] = None, *, dependencies: Optional[List[str]] = None)</code>"},{"location":"modules/service/#example-register-and-use-a-service","title":"Example: register and use a service","text":"<pre><code>from cullinan.service import Service, service, get_service_registry\n\n@service\nclass DatabaseService(Service):\n    def __init__(self):\n        self.connection = \"db_connection_mock\"\n\n    def query(self, sql):\n        return f\"Result for: {sql}\"\n\n# Service is auto-registered via @service decorator\nregistry = get_service_registry()\ndb_service = registry.get('DatabaseService')\nresult = db_service.query(\"SELECT * FROM users\")\nprint(result)  # Output: Result for: SELECT * FROM users\n</code></pre> <p>Notes: - Use the <code>@service</code> decorator to register services automatically during module scanning or explicit initialization. - Services are typically long-lived (singleton-scoped by default unless configured otherwise). - Access services via <code>get_service_registry()</code> or through DI injection in controllers/handlers.</p>"},{"location":"wiki/architecture/","title":"Architecture Overview","text":"<p>This document records Cullinan's high-level architecture based on the source implementation (facts from code). It covers component responsibilities, module interactions, the startup/request/shutdown sequence, and provides a plain-text ASCII architecture diagram for environments without diagram rendering.</p>","tags":["architecture","ioc","design"]},{"location":"wiki/architecture/#key-components-quick-reference","title":"Key components (quick reference)","text":"Component Location (example) Responsibility Core (IoC/DI) <code>cullinan/core/*</code> Provides DI primitives (Provider, Registry, Scope), lifecycle hooks (<code>on_init</code>/<code>on_shutdown</code>) and context management (<code>RequestScope</code>). Service layer <code>cullinan/service/*</code> Defines long-lived services (typically singletons), implements init/shutdown hooks and provides business capabilities. Controller / Handler <code>cullinan/controller/*</code>, <code>cullinan/handler/*</code> Route registration, request parsing, response construction and access logging. Handlers obtain services via DI. Application <code>cullinan/app.py</code>, <code>cullinan/application.py</code> Coordinates startup/shutdown: registers providers, discovers services/controllers, initializes services, starts Tornado IOLoop and installs signal handlers. Middleware <code>cullinan/middleware/*</code> Pluggable request/response processing chain (logging, auth, monitoring, etc.).","tags":["architecture","ioc","design"]},{"location":"wiki/architecture/#module-interactions-brief","title":"Module interactions (brief)","text":"<ul> <li>The Application coordinates the system: it invokes the ModuleScanner to discover controllers, services and providers. Providers discovered are registered into a <code>ProviderRegistry</code>, which is then added to the <code>InjectionRegistry</code> to make injection points resolvable.</li> <li><code>ServiceRegistry</code> manages service dependency ordering and invokes <code>on_init()</code> during startup; it ensures services become available before request handling commences.</li> <li>At request time the framework creates a <code>RequestContext</code> (via <code>create_context()</code>), which enables <code>RequestScope</code>; handlers resolve dependencies (property or constructor injection) within that context and may use request-scoped or singleton instances as appropriate.</li> </ul>","tags":["architecture","ioc","design"]},{"location":"wiki/architecture/#startup-request-shutdown-sequence-summary","title":"Startup / request / shutdown sequence (summary)","text":"<ol> <li>Application constructed: <code>create_app()</code> or <code>CullinanApplication()</code>.</li> <li>Module scanning: discover controllers, services, providers (or rely on explicit registration).</li> <li>Injection setup: register <code>ProviderRegistry</code> instances and add them to the <code>InjectionRegistry</code>.</li> <li>Service initialization: <code>ServiceRegistry</code> resolves dependency order and instantiates services, calling <code>on_init</code>. Failures are logged and may abort startup.</li> <li>Start IOLoop: call <code>IOLoop.start()</code> to accept requests.</li> <li>Request handling: for each request create a <code>RequestContext</code> -&gt; resolve injections -&gt; execute handler -&gt; middleware post-processing -&gt; cleanup <code>RequestContext</code>.</li> <li>Shutdown: on SIGINT/SIGTERM or manual <code>shutdown()</code>, execute registered shutdown handlers and service <code>on_shutdown</code> hooks in order, stop the IOLoop and exit.</li> </ol>","tags":["architecture","ioc","design"]},{"location":"wiki/architecture/#architecture-interaction-diagram-ascii-tab-aligned","title":"Architecture interaction diagram (ASCII, tab-aligned)","text":"<p>Below is a plain-text diagram using tabs for column alignment so it renders sensibly in code blocks and in places without Mermaid support.</p> <pre><code>Application     ModuleScanner       ProviderRegistry    InjectionRegistry   ServiceRegistry Tornado IOLoop\n-----------     ------------        ----------------    -----------------   --------------  ---------------\ncreate_app() --&gt;     scan() ----&gt;    register() ----&gt;    add_registry() --&gt;  register_services() --&gt; start()\n                                                    |\n                                                    |--dispatch--&gt; Handler (controller/handler)\n                                                    |               |\n                                                    |               |--uses--&gt; Inject/ProviderRegistry -&gt; provides instances\n\nRequest Flow (per request):\nIOLoop -&gt; create_context() -&gt; resolve request-scoped providers -&gt; Handler executes -&gt; response -&gt; context cleanup\n\nLegend:\n- register(): provider registration from discovered modules\n- add_registry(): injection registry gets provider registries to resolve inject markers\n- register_services(): service discovery and on_init sequence\n</code></pre>","tags":["architecture","ioc","design"]},{"location":"wiki/architecture/#common-notes-and-troubleshooting","title":"Common notes and troubleshooting","text":"<ul> <li>Injection returning <code>None</code> usually indicates the provider is not registered in a <code>ProviderRegistry</code> or the <code>InjectionRegistry</code> does not include that registry.</li> <li>Circular dependencies raise <code>CircularDependencyError</code>; inspect service dependencies and consider refactoring (interfaces/events) to break cycles.</li> <li>In tests, use <code>reset_injection_registry()</code> and explicit <code>ProviderRegistry</code> setup to ensure isolation between tests.</li> </ul>","tags":["architecture","ioc","design"]},{"location":"wiki/architecture/#artifacts-next-steps","title":"Artifacts &amp; next steps","text":"<ul> <li>Diagram assets placeholder: <code>docs/work/architecture_assets/</code> (store Mermaid/PlantUML/PNG/SVG here).</li> <li>Recommendation: produce a Mermaid or PlantUML diagram from the ASCII diagram and place it under <code>docs/work/architecture_assets/</code> so MkDocs can render it on the site.</li> </ul> <p>If you want I can (A) generate a Mermaid version and insert it into this file, or (B) generate PNG/SVG via mermaid-cli/PlantUML and add the static image under <code>docs/work/architecture_assets/</code>. Tell me which option to proceed with.</p>","tags":["architecture","ioc","design"]},{"location":"wiki/components/","title":"Components","text":"<p>This page describes the primary components of Cullinan and their responsibilities, with pointers to the implementation in the <code>cullinan/</code> package. The goal is a concise reference that helps contributors and users understand where to look in the source for each subsystem.</p> <p>Components overview</p> <ul> <li>Router / URL resolver</li> <li>Responsibility: resolve URL patterns to controller handlers and dispatch requests.</li> <li>Key files: <code>cullinan/controller/core.py</code>, <code>cullinan/controller/registry.py</code>, <code>cullinan/controller/__init__.py</code>.</li> <li> <p>Public symbols: <code>controller</code> (decorator), <code>get_controller_registry</code>, <code>url_resolver</code>.</p> </li> <li> <p>Controller layer</p> </li> <li>Responsibility: define controller classes and handler methods; provide request/response abstractions and response pooling utilities.</li> <li>Key files: <code>cullinan/controller/core.py</code>, <code>cullinan/controller/registry.py</code>, <code>cullinan/controller/stateless_validator.py</code>.</li> <li> <p>Public symbols: <code>Handler</code>, <code>ControllerRegistry</code>, <code>response_build</code>, <code>request_resolver</code>.</p> </li> <li> <p>Request handler &amp; HTTP integration</p> </li> <li>Responsibility: adapt Tornado HTTPServerRequest to controller handlers, manage request parsing and header resolution.</li> <li>Key files: <code>cullinan/handler/*</code>, <code>cullinan/controller/core.py</code>.</li> <li> <p>Public symbols: <code>get_handler_registry</code>, <code>request_handler</code>.</p> </li> <li> <p>Middleware</p> </li> <li>Responsibility: provide interception points for request/response processing, such as auth, logging, or transformation.</li> <li>Key files: <code>cullinan/middleware/*</code>.</li> <li> <p>Notes: middleware is applied in a pipeline; see <code>middleware</code> folder for examples and ordering semantics.</p> </li> <li> <p>Service (business/service layer)</p> </li> <li>Responsibility: long-lived services that provide functionality to controllers (database access, caching, background jobs).</li> <li>Key files: <code>cullinan/service/*</code> (base, decorators, registry).</li> <li> <p>Public symbols: <code>Service</code>, <code>ServiceRegistry</code>, <code>service</code> (decorator), <code>get_service_registry</code>.</p> </li> <li> <p>Core (IoC / DI / lifecycle / providers / scopes)</p> </li> <li>Responsibility: dependency injection, provider registry, scopes (singleton/transient/request), lifecycle management.</li> <li>Key files: <code>cullinan/core/*</code> (<code>injection.py</code>, <code>provider.py</code>, <code>registry.py</code>, <code>scope.py</code>, <code>lifecycle*.py</code>).</li> <li> <p>Public symbols: <code>Inject</code>, <code>injectable</code>, <code>inject_constructor</code>, <code>InjectionRegistry</code>, <code>ProviderRegistry</code>, <code>SingletonScope</code>, <code>RequestScope</code>, <code>create_context</code>.</p> </li> <li> <p>Application / Startup</p> </li> <li>Responsibility: application lifecycle, service discovery and initialization, orderly startup/shutdown and signal handling.</li> <li>Key files: <code>cullinan/app.py</code>, <code>cullinan/application.py</code>.</li> <li>Public symbols: <code>create_app</code>, <code>CullinanApplication</code>, <code>run</code> (application entry points).</li> </ul> <p>Examples \u2014 quick reference</p> <p>Minimal controller registration example (conceptual):</p> <pre><code>from cullinan.controller import controller, get_controller_registry\n\n@controller(path='/hello')\ndef hello_handler(request):\n    return {'status': 200, 'body': 'Hello Cullinan'}\n\n# controllers are discovered or registered; the app will route /hello to hello_handler\n</code></pre> <p>Minimal service example (conceptual):</p> <pre><code>from cullinan.service import Service, service, get_service_registry\n\n@service\ndef MySvc():\n    # register service\n    pass\n\nsvc_registry = get_service_registry()\n</code></pre> <p>Where to look next</p> <ul> <li>Walk the tests in <code>tests/</code> (for real usage examples and expected behavior). Recommended starting points: <code>tests/test_core_injection.py</code>, <code>tests/test_controller_injection_fix.py</code>, <code>tests/test_provider_system.py</code>.</li> <li>Read <code>docs/wiki/injection.md</code> for detailed IoC/DI examples and runnable snippets.</li> </ul> <p>Next steps for documentation</p> <ul> <li>Expand each component subsection with sequence diagrams and concrete code samples extracted from tests.</li> <li>Add a small reference table mapping public symbols to file paths (for faster navigation).</li> </ul>"},{"location":"wiki/extensions/","title":"Extensions &amp; Plugins","text":"<p>This page explains how to extend Cullinan with custom plugins and extensions. It covers extension points, provider registration, typical plugin patterns, and a minimal example showing how to register a custom provider and hook it into the application lifecycle.</p> <p>Design principles</p> <ul> <li>Non-invasive: prefer registering providers, controllers, or middleware rather than patching framework internals.</li> <li>Reversible: exposed extension points should be removable/unregisterable for tests and dynamic reconfiguration.</li> <li>Discoverable: plugins should be discoverable via module scanning or explicit registration APIs.</li> </ul> <p>Extension points</p> <ol> <li>Providers and ServiceRegistry</li> <li>Use <code>ProviderRegistry</code> and provider implementations (<code>ClassProvider</code>, <code>FactoryProvider</code>, <code>InstanceProvider</code>) to provide services. Register providers and then add the provider registry into the global <code>InjectionRegistry</code> so injections resolve correctly.</li> <li> <p>Key API: <code>cullinan.core.ProviderRegistry</code>, <code>cullinan.core.ScopedProvider</code>, <code>cullinan.service.registry.ServiceRegistry</code>.</p> </li> <li> <p>Controllers</p> </li> <li>Register controller functions or classes via the <code>controller</code> decorator or via explicit registry APIs. Plugins that add routes should register controllers during application startup.</li> <li> <p>Key API: <code>cullinan.controller.controller</code>, <code>cullinan.controller.get_controller_registry()</code>.</p> </li> <li> <p>Middleware</p> </li> <li>Implement middleware classes/functions that follow the project's middleware contract and register them in the app configuration or during startup to influence request/response processing.</li> <li> <p>Key API: <code>cullinan.middleware</code> package (see examples).</p> </li> <li> <p>Lifecycle hooks</p> </li> <li>Plugins can register startup and shutdown handlers with the <code>CullinanApplication</code> via <code>add_shutdown_handler</code> or by implementing <code>LifecycleAware</code> interfaces if needed.</li> <li>Key API: <code>CullinanApplication.add_shutdown_handler</code>, <code>cullinan.core.lifecycle</code> utilities.</li> </ol> <p>Discovery and registration patterns</p> <ul> <li>Explicit registration (recommended for clarity): your plugin provides a function <code>register(app_or_registry)</code> which the application calls during startup. Example:</li> </ul> <pre><code># my_plugin.py\nfrom cullinan.service import Service, service\nfrom cullinan.core import ProviderRegistry, ScopedProvider, SingletonScope\n\nclass MyService(Service):\n    def __init__(self):\n        self.value = 'my plugin service'\n\ndef register_service(provider_registry: ProviderRegistry):\n    provider_registry.register_provider(\n        'MyService',\n        ScopedProvider(lambda: MyService(), SingletonScope(), 'MyService')\n    )\n\n# Application startup\n# from my_plugin import register_service\n# provider_registry = ProviderRegistry()\n# register_service(provider_registry)\n# injection_registry.add_provider_registry(provider_registry)\n</code></pre> <ul> <li>Auto-discovery (convenience): use module scanning (if enabled) to discover plugin packages under a well-known namespace (e.g., <code>myproject.plugins.*</code>). Prefer explicit registration for production deployments.</li> </ul> <p>Packaging and distribution</p> <ul> <li>Package your plugin as a standard Python package. Expose a <code>register()</code> entrypoint or a well-known module path for discovery.</li> <li>Optionally provide an entry_point in setup.cfg / setup.py under a custom group (e.g., <code>cullinan.plugins</code>) and use pkg_resources or importlib.metadata to discover installed plugins.</li> </ul> <p>Minimal plugin example \u2014 logging middleware</p> <pre><code># my_logging_plugin.py\nimport logging\nfrom cullinan.middleware import MiddlewareBase\n\nlogger = logging.getLogger('my_plugin')\n\nclass RequestLogger(MiddlewareBase):\n    def process_request(self, request):\n        logger.info('Incoming %s %s', request.method, request.path)\n\ndef register(app):\n    # app-specific registration, pseudocode\n    app.add_middleware(RequestLogger())\n</code></pre> <p>Testing plugins</p> <ul> <li>Unit-test your plugin in isolation, mocking provider registries and application lifecycle.</li> <li>Ensure <code>register()</code> is idempotent and can be called multiple times safely (or add guards).</li> </ul> <p>Security and compatibility notes</p> <ul> <li>Plugins run inside the application process; avoid executing untrusted code or allowing plugins to run arbitrary startup scripts.</li> <li>Document compatibility with Cullinan versions and provide upgrade notes in your plugin's package.</li> </ul> <p>Next steps</p> <ul> <li>Provide a plugin scaffold generator (cookiecutter) for easier authoring.</li> <li>Add example plugin packages to the <code>examples/</code> directory for documentation and CI tests.</li> </ul>"},{"location":"wiki/injection/","title":"IoC &amp; DI (Injection)","text":"<p>This page documents the IoC (Inversion of Control) and DI (Dependency Injection) primitives used by Cullinan, based on the source code in <code>cullinan/core</code>. The goal is to present concrete usage patterns, explain provider/registry/scope concepts, and show minimal runnable examples.</p> <p>Key concepts and components</p> <ul> <li>Provider &amp; ProviderRegistry: producers of service instances. Providers can be class-based, factory-based, or instance-based. The <code>ProviderRegistry</code> holds registered providers and is often bridged into the <code>InjectionRegistry</code> for application-wide resolution.</li> <li>Scopes: control provider lifetimes. Common scopes include <code>SingletonScope</code>, <code>TransientScope</code>, and <code>RequestScope</code>.</li> <li>Injection markers &amp; decorators:</li> <li><code>Inject</code> and <code>InjectByName</code> are used as markers for property injection.</li> <li><code>@injectable</code> marks a class to receive property injection when instantiated.</li> <li><code>@inject_constructor</code> enables constructor (parameter) injection.</li> <li>InjectionRegistry: central registry that coordinates provider registries and resolves dependencies for injection points.</li> <li>RequestContext: a context manager used with <code>create_context()</code> to scope request-local objects (used with <code>RequestScope</code>).</li> </ul> <p>Where to look in the source</p> <ul> <li><code>cullinan/core/injection.py</code> \u2014 injection registration and resolution mechanics.</li> <li><code>cullinan/core/provider.py</code> \u2014 provider implementations (ClassProvider, FactoryProvider, InstanceProvider).</li> <li><code>cullinan/core/registry.py</code> \u2014 registry patterns used by ProviderRegistry and general Registry classes.</li> <li><code>cullinan/core/scope.py</code> \u2014 scope implementations (SingletonScope, RequestScope, TransientScope).</li> <li>tests: <code>tests/test_core_injection.py</code>, <code>tests/test_core_scope_integration.py</code> \u2014 real usage examples and assertions.</li> </ul> <p>Minimal usage examples (runnable)</p> <p>Property injection (example):</p> <pre><code>from cullinan.core import (\n    SingletonScope, ScopedProvider, ProviderRegistry,\n    injectable, Inject, get_injection_registry, reset_injection_registry\n)\n\nclass Database:\n    _instance_count = 0\n    def __init__(self):\n        Database._instance_count += 1\n        self.id = Database._instance_count\n\nreset_injection_registry()\nregistry = ProviderRegistry()\nscope = SingletonScope()\nregistry.register_provider('Database', ScopedProvider(lambda: Database(), scope, 'Database'))\nget_injection_registry().add_provider_registry(registry)\n\n@injectable\nclass Service:\n    database: Database = Inject()\n\ns1 = Service()\ns2 = Service()\nassert s1.database is s2.database\n</code></pre> <p>Constructor injection (example):</p> <pre><code>from cullinan.core import (\n    SingletonScope, ScopedProvider, ProviderRegistry,\n    inject_constructor, get_injection_registry, reset_injection_registry\n)\n\nclass Database:\n    _instance_count = 0\n    def __init__(self):\n        Database._instance_count += 1\n        self.id = Database._instance_count\n\nreset_injection_registry()\nregistry = ProviderRegistry()\nscope = SingletonScope()\nregistry.register_provider('Database', ScopedProvider(lambda: Database(), scope, 'Database'))\nget_injection_registry().add_provider_registry(registry)\n\n@inject_constructor\nclass Controller:\n    def __init__(self, database: Database):\n        self.database = database\n\nc1 = Controller()\nc2 = Controller()\nassert c1.database is c2.database\n</code></pre> <p>Common patterns and tips</p> <ul> <li>Prefer <code>@injectable</code> + <code>Inject()</code> for property injection when classes are instantiated by user code; use <code>@inject_constructor</code> where constructor injection is more explicit or required.</li> <li>Register providers into a <code>ProviderRegistry</code> and add that registry to the global <code>InjectionRegistry</code> so injection points can resolve dependencies.</li> <li>Use <code>RequestScope</code> with <code>create_context()</code> when you need request-scoped lifetimes (HTTP handlers).</li> </ul> <p>Troubleshooting</p> <ul> <li>If injections are None, ensure <code>reset_injection_registry()</code> is called before registering providers during test setup.</li> <li>Verify provider keys (names) match the expected injection points (by type name or by explicit name when using <code>InjectByName</code>).</li> </ul> <p>Next steps</p> <ul> <li>Expand this page with diagrams showing provider -&gt; registry -&gt; injection resolution flow and common error modes (circular dependency, missing provider).</li> <li>Add more complex examples (provider ordering, lifecycle hooks <code>on_init</code>, <code>on_shutdown</code>).</li> </ul>"},{"location":"wiki/lifecycle/","title":"Application Lifecycle","text":"<p>This document describes the Cullinan application lifecycle: startup, service initialization, request handling, and graceful shutdown hooks and events. The content is derived from the implementation (source-first) and references <code>cullinan/app.py</code>, <code>cullinan/application.py</code> and <code>cullinan/core/lifecycle</code> related files.</p> <p>Main phases</p> <ol> <li>Startup</li> <li>Entry point: <code>CullinanApplication.run()</code> or using <code>create_app()</code> then calling <code>app.run()</code>.</li> <li> <p>Behavior (see <code>cullinan/app.py</code>):</p> <ul> <li>Calls <code>startup()</code> to perform the startup sequence: configure injection (InjectionRegistry), discover services (ServiceRegistry), and initialize services in dependency order.</li> <li>Registers signal handlers (SIGINT / SIGTERM) to trigger graceful shutdown on signals.</li> <li>Starts Tornado's IOLoop: <code>IOLoop.start()</code> (blocking until stop event).</li> </ul> </li> <li> <p>Service initialization</p> </li> <li>Services register via <code>@service</code> or during module scanning into <code>ServiceRegistry</code>.</li> <li><code>ProviderRegistry</code> / <code>ServiceRegistry</code> instantiate services in dependency order and invoke init hooks (e.g., <code>on_init</code>).</li> <li> <p>If no services registered, initialization step is skipped.</p> </li> <li> <p>Request handling &amp; request scope</p> </li> <li>On request arrival, a request context is created (via <code>create_context()</code>) to support <code>RequestScope</code>.</li> <li>Within the same request context, the RequestScope ensures instances are reused for the lifetime of the request.</li> <li> <p>Handlers (Handler / controller) can obtain request-scoped dependencies via property or constructor injection.</p> </li> <li> <p>Shutdown</p> </li> <li>When the app receives termination signals or a manual shutdown, <code>shutdown()</code> is invoked:<ul> <li>Executes registered shutdown handlers in order (sync or async); errors are controlled by the <code>force</code> flag.</li> <li>Sets <code>_running</code> to False and stops the IOLoop.</li> <li>Calls lifecycle hooks (e.g., <code>on_shutdown</code>) on services to clean up resources.</li> </ul> </li> </ol> <p>Common hooks &amp; extension points</p> <ul> <li><code>CullinanApplication.add_shutdown_handler(handler)</code> \u2014 register custom shutdown handlers (async or sync).</li> <li><code>LifecycleAware</code> and <code>LifecycleManager</code> (in <code>cullinan/core</code>) \u2014 services implementing lifecycle interfaces will be called at appropriate times.</li> <li>Provider/service <code>on_init</code> / <code>on_shutdown</code> hooks (if present) \u2014 invoked during init and shutdown phases.</li> </ul> <p>Minimal example: registering shutdown handlers</p> <pre><code># Quick (recommended): simple entrypoint using the framework module\nfrom cullinan import application\n\nif __name__ == '__main__':\n    application.run()\n\n# Advanced (optional): programmatic usage when you need to add shutdown handlers or fine-grained control\nfrom cullinan.app import create_app\nimport asyncio\n\napplication_instance = create_app()\n\ndef cleanup_sync():\n    print('Running sync cleanup')\n\nasync def cleanup_async():\n    await asyncio.sleep(0.01)\n    print('Running async cleanup')\n\napplication_instance.add_shutdown_handler(cleanup_sync)\napplication_instance.add_shutdown_handler(cleanup_async)\n\n# In process entrypoint call:\n# application_instance.run()\n</code></pre> <p>Request scope example (pseudocode)</p> <pre><code>from cullinan.core import create_context, RequestScope, ScopedProvider, ProviderRegistry\n\nprovider_registry = ProviderRegistry()\nprovider_registry.register_provider('RequestHandler', ScopedProvider(lambda: RequestHandler(), RequestScope(), 'RequestHandler'))\n\nwith create_context():\n    handler1 = provider_registry.get_instance('RequestHandler')\n    handler2 = provider_registry.get_instance('RequestHandler')\n    assert handler1 is handler2\n\n# leaving the context isolates RequestScope instances; next request gets new instances\n</code></pre> <p>Troubleshooting</p> <ul> <li>Startup failures: inspect <code>startup()</code> error logs (<code>Application startup failed</code>) and check service registration/provider initialization stacks.</li> <li>Injection/dependency missing: ensure provider is registered in the <code>ProviderRegistry</code> and the registry is added to the <code>InjectionRegistry</code>.</li> <li>Graceful shutdown issues: if a shutdown handler blocks or raises, consider catching errors or using <code>force=True</code> during shutdown.</li> </ul> <p>References &amp; next steps</p> <ul> <li>Source: <code>cullinan/app.py</code>, <code>cullinan/application.py</code>, <code>cullinan/core/*</code> (provider/registry/scope/lifecycle).</li> <li>Suggestion: add sequence diagrams illustrating startup and shutdown flows to <code>docs/wiki/lifecycle.md</code> for review.</li> </ul>"},{"location":"wiki/lifecycle/#lifecycle-sequence-diagram","title":"Lifecycle Sequence (diagram)","text":"<pre><code>CullinanApplication    ProviderRegistry    ServiceRegistry    Tornado IOLoop    RequestContext    Handler\n-------------------    ----------------    ---------------    ---------------    --------------    -------\nstartup() -&gt; register providers -&gt; discover &amp; init services -&gt; start IOLoop\n                                                        |\n                                                        |-&gt; IOLoop receives request -&gt; create RequestContext\n                                                        |                             -&gt; resolve request-scoped providers\n                                                        |                             -&gt; dispatch to Handler (injection resolves)\n                                                        |                             -&gt; Handler returns response\n                                                        |                             -&gt; RequestContext cleanup\nshutdown() -&gt; call on_shutdown on services -&gt; stop IOLoop\n</code></pre>"},{"location":"wiki/middleware/","title":"Middleware","text":"<p>This document explains Cullinan middleware: responsibilities, execution pipeline, registration, DI integration, examples, troubleshooting and best practices. Middleware is a pluggable stage in the request/response lifecycle for auth, logging, transformations, etc.</p> <p>Core concepts</p> <ul> <li>Middleware pipeline: requests pass through ordered middleware before reaching controllers; middleware may handle, mutate, or short-circuit a request. Responses may also be processed by middleware on the return path.</li> <li>Order &amp; priority: middleware are executed in registration order. Some frameworks offer priority hooks; in Cullinan the registration order determines execution order.</li> <li>Middleware contract: middleware should implement a contract (e.g., <code>process_request</code> / <code>process_response</code>) or inherit from a project base (see <code>cullinan/middleware</code>).</li> </ul> <p>Registration &amp; configuration</p> <ul> <li>Programmatic registration (recommended): register middleware during application startup.</li> </ul> <pre><code># register middleware (pseudocode)\nfrom cullinan import application\nfrom my_middleware import MyMiddleware\n\n# Quick start: run framework entrypoint (recommended)\nif __name__ == '__main__':\n    application.run()\n\n# Advanced (optional): programmatic registration\nfrom cullinan.app import create_app\nfrom my_middleware import MyMiddleware\n\napplication_instance = create_app()\napplication_instance.add_middleware(MyMiddleware())\n# application_instance.run()\n</code></pre> <ul> <li>DI integration: middleware may depend on services provided through the provider/registry system. Register services via provider registries and use injection in middleware classes.</li> </ul> <p>Middleware example (with DI)</p> <pre><code># examples/controller_di_middleware.py (reference)\nfrom cullinan.core import injectable, Inject, get_injection_registry\nfrom cullinan.middleware import MiddlewareBase\n\n@injectable\nclass AuditService:\n    def record(self, request):\n        print('Audit:', request.path)\n\nclass AuditMiddleware(MiddlewareBase):\n    audit: AuditService = Inject()\n\n    def process_request(self, request):\n        self.audit.record(request)\n\n# Register provider and middleware during application startup\n</code></pre> <p>Execution model &amp; constraints</p> <ul> <li>Avoid long-blocking operations in middleware; use background tasks or async patterns where appropriate.</li> <li>Middleware must handle exceptions to avoid breaking the request chain.</li> <li>Ensure middleware lifecycle aligns with request context when using RequestScope or DI; do not store request-scoped objects at module scope.</li> </ul> <p>Troubleshooting</p> <ul> <li>Middleware not invoked: confirm registration at startup and correct registration order; ensure no conditional config is skipping the middleware.</li> <li>Injection issues: if Inject in middleware is unresolved, confirm providers were registered to the InjectionRegistry before middleware instantiation; use <code>reset_injection_registry()</code> in tests to ensure a clean state.</li> <li>Performance: benchmark middleware to avoid expensive operations on critical paths.</li> </ul> <p>Best practices</p> <ul> <li>Keep middleware thin; delegate heavy logic to injected services.</li> <li>Use the framework logger instead of prints for production readiness.</li> <li>Unit test middleware in isolation, mocking request objects and injection registry.</li> </ul> <p>Next steps</p> <ul> <li>Extract a minimal runnable example from <code>examples/controller_di_middleware.py</code> into <code>examples/</code> and ensure it is covered by at least one automated test.</li> <li>Formalize a middleware base contract (if not present) and document the required methods and expected behaviors.</li> </ul>"},{"location":"wiki/middleware/#running-the-demo","title":"Running the demo","text":"<p>Ensure you have a working Python environment (virtualenv, conda, or system Python).</p> <p>On Windows (PowerShell):</p> <pre><code>python -m pip install -U pip\npip install cullinan tornado\npython examples\\middleware_demo.py\n</code></pre> <p>On Linux / macOS:</p> <pre><code>python -m pip install -U pip\npip install cullinan tornado\npython examples/middleware_demo.py\n</code></pre> <p>Typical output (example run):</p> <pre><code>INFO:__main__:Starting IOLoop for middleware demo\nINFO:__main__:Performing request 1\nINFO:__main__:Entered request context\nINFO:__main__:Injected dependencies into handler\nINFO:tornado.access:200 GET /middleware (127.0.0.1) 2.10ms\nINFO:__main__:Exited request context\nINFO:__main__:Response1: Hello from UserService (084297)  request_count=1\nINFO:__main__:Performing request 2\nINFO:__main__:Entered request context\nINFO:__main__:Injected dependencies into handler\nINFO:tornado.access:200 GET /middleware (127.0.0.1) 0.60ms\nINFO:__main__:Exited request context\nINFO:__main__:Response2: Hello from UserService (084297)  request_count=1\nINFO:__main__:IOLoop stopped, exiting\n</code></pre> <p>Note: <code>RequestCounter</code> is request-scoped and resets per request, while <code>UserService</code> is a singleton and retains its instance id across requests.</p>"},{"location":"wiki/restful_api/","title":"RESTful API decorators (detailed)","text":"<p>This page documents the HTTP method decorators used in Cullinan controllers: <code>get_api</code>, <code>post_api</code>, <code>patch_api</code>, <code>delete_api</code> and <code>put_api</code>.</p> <p>Summary - All decorators are defined as <code>def get_api(**kwargs)</code> (and similarly for others) and therefore accept only keyword arguments. Using a positional argument like <code>@get_api('/user')</code> is invalid and will raise a TypeError on import. Always use <code>@get_api(url='/users/{user_id}')</code>. - URL templates use <code>{name}</code> placeholders parsed by <code>url_resolver</code>. Those placeholders are mapped to controller method arguments (order-based).</p> <p>Supported keyword arguments (common) - url: string route template, e.g. <code>'/users/{user_id}'</code>. - query_params: iterable of query param names (mapped to <code>request_resolver</code>'s query section). - file_params: iterable of file field names for uploads. - headers: iterable of required HTTP header names; missing headers trigger the project's missing-header handler.</p> <p>POST/PATCH specific - body_params: iterable of body field names to parse from JSON or form body. - get_request_body: boolean; if True, the raw request body will be passed to the handler via <code>request_handler</code>.</p> <p>How URL templates work - Use <code>{param}</code> placeholders. Example: <code>'/users/{user_id}/posts/{post_id}'</code>. - <code>url_resolver</code> translates the template into a regex-like path and returns a list of parameter names in order (e.g. <code>['user_id','post_id']</code>). - The decorated method receives path parameter values as positional args in the same order as the list returned by <code>url_resolver</code> (or combined with controller-level url param keys). - Allowed characters for path captures are limited by the resolver (e.g. <code>[a-zA-Z0-9-]+</code>) and a trailing <code>/*</code> to allow an optional slash.</p> <p>Decorator behavior and request handling - Each decorator wraps the original function and registers a Tornado handler method via <code>EncapsulationHandler.add_func(url=local_url, type='get')</code> (or type='post', etc.). - At request time the framework calls <code>request_resolver</code> and <code>header_resolver</code> to build (url_dict, query_dict, body_dict, file_dict) and passes them, together with header data, into <code>request_handler</code> which invokes your controller method. - <code>get_api</code>/<code>delete_api</code>/<code>put_api</code> typically do not use <code>body_params</code>; <code>post_api</code> and <code>patch_api</code> support <code>body_params</code> and <code>get_request_body</code>.</p> <p>Examples</p> <p>1) Simple GET with path param</p> <pre><code>@controller(url='/api/users')\nclass UserController:\n    @get_api(url='/{user_id}')\n    def get_user(self, url_param):\n        # extract the path parameter from the url_param dict\n        user_id = url_param.get('user_id') if url_param else None\n        return {'id': user_id}\n</code></pre> <p>2) GET with query params</p> <pre><code>@controller(url='/api/users')\nclass UserController:\n    @get_api(url='/', query_params=('page','size'))\n    def list_users(self, query_param):\n        # page and size come from query string and are accessed via query_param\n        page = query_param.get('page') if query_param else None\n        size = query_param.get('size') if query_param else None\n        return {'page': page, 'size': size}\n</code></pre> <p>3) POST with body params and files</p> <pre><code>@controller(url='/api/upload')\nclass UploadController:\n    @post_api(url='/', body_params=('title',), file_params=('file',))\n    def upload(self, body_param, files):\n        title = body_param.get('title') if body_param else None\n        file_obj = files.get('file') if files else None\n        return {'uploaded': bool(file_obj)}\n</code></pre> <p>Errors and common pitfalls - Using positional decorator args: <code>@get_api('/user')</code> is invalid. Use <code>@get_api(url='/user')</code>. - Mismatched path names: if your URL template includes <code>{user_id}</code> but your method signature lacks the corresponding parameter, the framework will pass None or may behave unexpectedly \u2014 ensure names match and argument order aligns. - Missing required headers: if <code>headers</code> is provided and request omits them, the configured missing-header handler will be invoked (it may raise or set an error response). - Body parsing: <code>body_params</code> attempts to parse JSON when Content-Type starts with <code>application/json</code>; if parsing fails, fields will be None.</p> <p>When to use which decorator - Use <code>get_api</code> for idempotent read operations. - Use <code>post_api</code> for create operations where you need to parse body fields or accept file uploads. - Use <code>patch_api</code> for partial updates and <code>put_api</code> for full replacements; behavior mirrors POST w.r.t. body_params when provided.</p> <p>Linking to source - Implementation lives in <code>cullinan/controller/core.py</code> (<code>get_api</code>, <code>post_api</code>, <code>url_resolver</code>, <code>request_resolver</code>, and <code>request_handler</code>). Prefer reading the tests in <code>tests/</code> (search for <code>@get_api(url=</code>) for practical examples.</p> <p>See also - <code>docs/getting_started.md</code> (quick overview) - <code>docs/wiki/injection.md</code> (dependency injection patterns)</p>"},{"location":"zh/","title":"Cullinan \u6587\u6863","text":"<p>\u6b22\u8fce\u67e5\u9605 Cullinan \u6846\u67b6\u6587\u6863\u3002</p> <p>\u8bf7\u4f7f\u7528\u5de6\u4fa7\u5bfc\u822a\u680f\u5feb\u901f\u8bbf\u95ee\u4ee5\u4e0b\u4e3b\u8981\u5185\u5bb9\uff1a</p> <ul> <li>\u5feb\u901f\u5f00\u59cb \u2014 \u5feb\u901f\u5165\u95e8\u548c\u6700\u5c0f\u5e94\u7528\u793a\u4f8b</li> <li>\u67b6\u6784\u8bbe\u8ba1 \u2014 \u7cfb\u7edf\u6982\u89c8\u548c\u67b6\u6784\u56fe</li> <li>\u7ef4\u57fa \u2014 \u6ce8\u5165\u3001\u751f\u547d\u5468\u671f\u3001\u4e2d\u95f4\u4ef6\u3001\u6269\u5c55</li> <li>\u6a21\u5757 \u2014 \u5404\u6a21\u5757\u7684 API \u548c\u793a\u4f8b</li> <li>\u793a\u4f8b \u2014 <code>examples/</code> \u76ee\u5f55\u4e0b\u7684\u53ef\u8fd0\u884c\u793a\u4f8b</li> <li>API \u53c2\u8003 \u2014 \u8be6\u7ec6\u7684 API \u6587\u6863</li> </ul> <p>\u4e86\u89e3\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u8bbf\u95ee\u6211\u4eec\u7684 GitHub \u4ed3\u5e93\u3002</p>"},{"location":"zh/api_reference/","title":"API \u53c2\u8003","text":"<p>\u672c\u6587\u6863\u7528\u4e8e\u6c47\u603b Cullinan \u7684\u516c\u5171 API \u6982\u89c8\uff0c\u5e76\u4e3a\u540e\u7eed\u81ea\u52a8\u751f\u6210\u6216\u624b\u52a8\u7ef4\u62a4\u7684 API \u9875\u9762\u63d0\u4f9b\u5165\u53e3\u3002\u63a8\u8350\u7684\u7ed3\u6784\u5305\u62ec\uff1a\u6a21\u5757\u7d22\u5f15\u3001\u6bcf\u4e2a\u6a21\u5757\u7684\u516c\u6709\u7b26\u53f7\u4e0e\u7b7e\u540d\u3001\u4ee5\u53ca\u91cd\u65b0\u751f\u6210 API \u6587\u6863\u7684\u6b65\u9aa4\u8bf4\u660e\u3002</p>"},{"location":"zh/api_reference/#_1","title":"\u6a21\u5757\u7d22\u5f15\uff08\u793a\u4f8b\uff09","text":"<p>\u4ee5\u4e0b\u6a21\u5757\u5217\u8868\u4ec5\u4e3a\u793a\u4f8b\uff0c\u5177\u4f53\u5185\u5bb9\u5e94\u6839\u636e\u5b9e\u9645\u4ee3\u7801\u7ed3\u6784\u548c\u81ea\u52a8\u5316\u751f\u6210\u7ed3\u679c\u8865\u5168\uff1a</p> <ul> <li><code>cullinan.app</code> \u2014 \u5e94\u7528\u521b\u5efa\u4e0e\u8fd0\u884c\u5165\u53e3</li> <li><code>cullinan.application</code> \u2014 \u5e94\u7528\u751f\u547d\u5468\u671f\u4e0e\u542f\u52a8\u6d41\u7a0b</li> <li><code>cullinan.core</code> \u2014 IoC/DI \u6838\u5fc3\uff08Provider\u3001Registry\u3001Scope\u3001\u6ce8\u5165 API\uff09</li> <li><code>cullinan.controller</code> \u2014 \u63a7\u5236\u5668\u4e0e RESTful API \u88c5\u9970\u5668</li> <li><code>cullinan.service</code> \u2014 Service \u57fa\u7c7b\u4e0e <code>@service</code> \u88c5\u9970\u5668</li> <li><code>cullinan.middleware</code> \u2014 \u4e2d\u95f4\u4ef6\u57fa\u7c7b\u4e0e\u6269\u5c55\u70b9</li> </ul>"},{"location":"zh/api_reference/#_2","title":"\u516c\u5171\u7b26\u53f7\u4e0e\u7b7e\u540d\uff08\u5efa\u8bae\u7ed3\u6784\uff09","text":"<p>\u6bcf\u4e2a\u6a21\u5757\u5efa\u8bae\u6309\u4ee5\u4e0b\u7ed3\u6784\u5217\u51fa\u516c\u5171\u7b26\u53f7\uff1a</p> <ul> <li>\u6a21\u5757\u8def\u5f84\uff0c\u4f8b\u5982\uff1a<code>cullinan.controller</code></li> <li>\u7b80\u8981\u8bf4\u660e\uff1a\u6a21\u5757\u7684\u4e3b\u8981\u804c\u8d23\u4e0e\u4f7f\u7528\u573a\u666f</li> <li>\u516c\u6709\u7c7b\u4e0e\u51fd\u6570\u5217\u8868\uff08\u793a\u4f8b\uff09\uff1a</li> <li><code>@controller(...)</code> \u2014 \u63a7\u5236\u5668\u88c5\u9970\u5668\uff0c\u8d1f\u8d23\u81ea\u52a8\u6ce8\u518c\u63a7\u5236\u5668\u4e0e\u8def\u7531</li> <li><code>@get_api(url=..., query_params=..., body_params=..., headers=...)</code> \u2014 GET \u63a5\u53e3\u88c5\u9970\u5668</li> <li><code>@post_api(url=..., body_params=..., headers=...)</code> \u2014 POST \u63a5\u53e3\u88c5\u9970\u5668</li> <li><code>Inject</code>, <code>InjectByName</code> \u2014 \u5c5e\u6027/\u6784\u9020\u5668\u6ce8\u5165\u6807\u8bb0</li> </ul> <p>\u5b8c\u6574 API \u53c2\u8003\u53ef\u4ee5\u901a\u8fc7\u81ea\u52a8\u751f\u6210\u811a\u672c\u6216\u624b\u5de5\u6574\u7406\u7684\u65b9\u5f0f\u586b\u5145\u4e0a\u8ff0\u7ed3\u6784\u3002</p>"},{"location":"zh/api_reference/#api_1","title":"\u91cd\u65b0\u751f\u6210 API \u6587\u6863\uff08\u6b65\u9aa4\u793a\u4f8b\uff09","text":"<p>\u5728\u540e\u7eed\u5b9e\u73b0\u81ea\u52a8\u5316\u65f6\uff0c\u53ef\u4ee5\u9009\u62e9\u4f7f\u7528\u9759\u6001\u5206\u6790\u811a\u672c\u751f\u6210 API \u7d22\u5f15\u5e76\u66f4\u65b0\u672c\u9875\u9762\u3002\u5178\u578b\u6d41\u7a0b\u793a\u4f8b\uff1a</p> <ol> <li>\u5728 <code>docs/work/</code> \u76ee\u5f55\u4e0b\u7ef4\u62a4\u4e00\u4e2a\u7528\u4e8e\u626b\u63cf\u6a21\u5757\u5e76\u751f\u6210 Markdown \u7247\u6bb5\u7684\u811a\u672c\uff08\u4f8b\u5982 <code>generate_api_reference.py</code>\uff09\u3002</li> <li>\u811a\u672c\u8f93\u51fa\u6309\u6a21\u5757\u5212\u5206\u7684 API \u5217\u8868\uff08\u7c7b\u3001\u51fd\u6570\u3001\u7b7e\u540d\u3001\u7b80\u8981\u8bf4\u660e\uff09\uff0c\u5199\u5165 <code>docs/work/api_modules.md</code> \u6216\u76f4\u63a5\u66f4\u65b0\u672c\u9875\u9762\u3002</li> <li>\u5728 CI \u6216\u672c\u5730\u6784\u5efa\u6d41\u7a0b\u4e2d\u5b9a\u671f\u8fd0\u884c\u8be5\u811a\u672c\uff0c\u4fdd\u8bc1 API \u53c2\u8003\u4e0e\u6e90\u7801\u4fdd\u6301\u540c\u6b65\u3002</li> </ol> <p>\u5177\u4f53\u5b9e\u73b0\u7ec6\u8282\u53ef\u6839\u636e\u9879\u76ee\u7ea6\u5b9a\u548c\u5de5\u5177\u94fe\u9009\u62e9\u8fdb\u884c\u8865\u5145\u3002</p>"},{"location":"zh/architecture/","title":"\u67b6\u6784\u6982\u8ff0","text":"<p>\u672c\u6587\u6863\u57fa\u4e8e\u6e90\u7801\u5b9e\u73b0\uff08\u4ee5\u4ee3\u7801\u4e3a\u4e8b\u5b9e\uff09\u8bb0\u5f55 Cullinan \u7684\u9ad8\u5c42\u67b6\u6784\uff1a\u7ec4\u4ef6\u804c\u8d23\u3001\u6a21\u5757\u4ea4\u4e92\u3001\u542f\u52a8/\u8bf7\u6c42/\u5173\u95ed\u5e8f\u5217\uff0c\u4ee5\u53ca\u7b80\u5355\u7684\u67b6\u6784\u793a\u610f\u56fe\uff08\u4fbf\u4e8e\u5728\u65e0\u6e32\u67d3\u5668\u73af\u5883\u4e2d\u67e5\u770b\uff09\u3002</p>","tags":["architecture","ioc","design"]},{"location":"zh/architecture/#_2","title":"\u5173\u952e\u7ec4\u4ef6\uff08\u804c\u8d23\u901f\u67e5\u8868\uff09","text":"\u7ec4\u4ef6 \u4ee3\u7801\u4f4d\u7f6e\uff08\u793a\u4f8b\uff09 \u4e3b\u8981\u804c\u8d23 Core (IoC/DI) <code>cullinan/core/*</code> \u5b9e\u73b0\u6ce8\u5165\u539f\u8bed\uff08Provider\u3001Registry\u3001Scope\uff09\u3001\u751f\u547d\u5468\u671f hook\uff08on_init/on_shutdown\uff09\u548c\u4e0a\u4e0b\u6587\u7ba1\u7406\uff08RequestScope\uff09\u3002 Service \u5c42 <code>cullinan/service/*</code> \u5b9a\u4e49\u957f\u671f\u8fd0\u884c\u7684\u670d\u52a1\uff08\u901a\u5e38\u4e3a\u5355\u4f8b\uff09\uff0c\u63d0\u4f9b\u521d\u59cb\u5316/\u9500\u6bc1\u94a9\u5b50\uff0c\u5e76\u4f5c\u4e3a\u5e94\u7528\u4e1a\u52a1\u80fd\u529b\u7684\u8f7d\u4f53\u3002 Controller / Handler <code>cullinan/controller/*</code>, <code>cullinan/handler/*</code> \u8def\u7531\u7ed1\u5b9a\u3001\u8bf7\u6c42\u89e3\u6790\u3001\u54cd\u5e94\u6784\u5efa\u4e0e\u8bbf\u95ee\u65e5\u5fd7\u3002\u652f\u6301\u901a\u8fc7\u6ce8\u5165\u83b7\u53d6 service \u5b9e\u4f8b\u3002 Application <code>cullinan/app.py</code>, <code>cullinan/application.py</code> \u534f\u8c03\u542f\u52a8/\u5173\u95ed\u6d41\u7a0b\uff1a\u6ce8\u518c providers\u3001\u53d1\u73b0\u670d\u52a1/\u63a7\u5236\u5668\u3001\u521d\u59cb\u5316\u670d\u52a1\u3001\u542f\u52a8 Tornado IOLoop \u5e76\u6ce8\u518c\u4fe1\u53f7\u5904\u7406\u3002 Middleware <code>cullinan/middleware/*</code> \u63d2\u4ef6\u5f0f\u8bf7\u6c42/\u54cd\u5e94\u5904\u7406\u94fe\uff0c\u7528\u4e8e\u7edf\u4e00\u5904\u7406\uff08\u65e5\u5fd7\u3001\u9274\u6743\u3001\u76d1\u63a7\u7b49\uff09\u3002","tags":["architecture","ioc","design"]},{"location":"zh/architecture/#_3","title":"\u6a21\u5757\u4ea4\u4e92\uff08\u7b80\u8981\u8bf4\u660e\uff09","text":"<ul> <li>\u5e94\u7528\uff08Application\uff09\u8d1f\u8d23\u534f\u8c03\uff1a\u5b83\u89e6\u53d1\u6a21\u5757\u626b\u63cf\uff08ModuleScanner\uff09\uff0c\u628a\u53d1\u73b0\u7684 Provider \u6ce8\u518c\u5230 <code>ProviderRegistry</code>\uff0c\u5e76\u628a ProviderRegistry \u5173\u8054\u5230 <code>InjectionRegistry</code>\uff0c\u4f7f\u6240\u6709\u6ce8\u5165\u70b9\u53ef\u89e3\u6790\u3002</li> <li><code>ServiceRegistry</code> \u8d1f\u8d23\u7ba1\u7406\u670d\u52a1\u7684\u4f9d\u8d56\u987a\u5e8f\u5e76\u4f9d\u6b21\u8c03\u7528 <code>on_init()</code>\uff0c\u542f\u52a8\u65f6\u5c06\u51c6\u5907\u5c31\u7eea\u7684\u670d\u52a1\u7f6e\u4e8e\u53ef\u7528\u72b6\u6001\u3002</li> <li>\u5728\u8bf7\u6c42\u7ea7\u522b\uff0c\u6846\u67b6\u5728\u8fdb\u5165\u8bf7\u6c42\u65f6\u521b\u5efa RequestContext\uff08<code>create_context()</code>\uff09\uff0c\u4f7f <code>RequestScope</code> \u751f\u6548\uff1b\u5904\u7406\u5668\u5728\u8be5\u4e0a\u4e0b\u6587\u4e2d\u901a\u8fc7 <code>Inject</code> \u6216\u6784\u9020\u5668\u6ce8\u5165\u83b7\u5f97 request-scoped \u6216\u5355\u4f8b\u5b9e\u4f8b\u3002</li> </ul>","tags":["architecture","ioc","design"]},{"location":"zh/architecture/#_4","title":"\u542f\u52a8 / \u8bf7\u6c42 / \u5173\u95ed \u5e8f\u5217\uff08\u6982\u8981\uff09","text":"<ol> <li>\u5e94\u7528\u88ab\u521b\u5efa\uff1a<code>create_app()</code> \u6216 <code>CullinanApplication()</code>\u3002</li> <li>\u6a21\u5757\u626b\u63cf\uff1a\u53d1\u73b0 controllers\u3001services\u3001providers\uff08\u6216\u7531\u663e\u5f0f\u6ce8\u518c\u63d0\u4f9b\uff09\u3002</li> <li>\u6ce8\u5165\u914d\u7f6e\uff1a\u6ce8\u518c <code>ProviderRegistry</code> \u5e76\u628a\u5176\u6dfb\u52a0\u5230 <code>InjectionRegistry</code>\u3002</li> <li>\u670d\u52a1\u521d\u59cb\u5316\uff1a<code>ServiceRegistry</code> \u6309\u4f9d\u8d56\u987a\u5e8f\u5b9e\u4f8b\u5316\u670d\u52a1\u5e76\u6267\u884c <code>on_init</code>\u3002\u5931\u8d25\u65f6\u8bb0\u5f55\u5e76\u53ef\u9009\u62e9\u505c\u6b62\u542f\u52a8\u3002</li> <li>\u542f\u52a8 IOLoop\uff1a\u8c03\u7528 <code>IOLoop.start()</code> \u5f00\u59cb\u63a5\u53d7\u8bf7\u6c42\u3002</li> <li>\u8bf7\u6c42\u5904\u7406\uff1a\u6bcf\u6b21\u8bf7\u6c42\u521b\u5efa RequestContext -&gt; \u89e3\u6790\u6ce8\u5165 -&gt; \u6267\u884c Handler -&gt; \u4e2d\u95f4\u4ef6\u540e\u5904\u7406 -&gt; \u6e05\u7406 RequestContext\u3002</li> <li>\u89e6\u53d1\u5173\u95ed\uff1a\u63a5\u6536\u5230 SIGINT/SIGTERM \u6216\u624b\u52a8\u8c03\u7528 <code>shutdown()</code>\uff0c\u6309\u7167\u6ce8\u518c\u987a\u5e8f\u8c03\u7528 shutdown handlers \u4e0e service <code>on_shutdown</code>\uff0c\u505c\u6b62 IOLoop \u5e76\u9000\u51fa\u3002</li> </ol>","tags":["architecture","ioc","design"]},{"location":"zh/architecture/#_5","title":"\u67b6\u6784\u4ea4\u4e92\u56fe\uff08\u5236\u8868\u7b26\u5bf9\u9f50\u7684\u4ee3\u7801\u5757\uff09","text":"<p>\u4e0b\u9762\u7684\u56fe\u4f7f\u7528\u5236\u8868\u7b26\u5728\u4ee3\u7801\u5757\u4e2d\u5bf9\u9f50\uff0c\u4fbf\u4e8e\u7eaf\u6587\u672c\u73af\u5883\u67e5\u770b\u3002\u5236\u8868\u7b26\u5728\u4e0d\u540c\u7f16\u8f91\u5668\u4e2d\u663e\u793a\u7565\u6709\u5dee\u5f02\uff0c\u4f46\u5728\u7b49\u5bbd\u5b57\u4f53/\u4ee3\u7801\u5757\u4e2d\u53ef\u4fdd\u6301\u5bf9\u9f50\u3002\u4f60\u53ef\u4ee5\u628a\u5b83\u590d\u5236\u5230 Markdown \u6587\u6863\u6216 README \u4e2d\u67e5\u770b\u3002</p> <pre><code>Application     ModuleScanner       ProviderRegistry    InjectionRegistry   ServiceRegistry Tornado IOLoop\n-----------     ------------        ----------------    -----------------   --------------  ---------------\ncreate_app() --&gt;     scan() ----&gt;    register() ----&gt;    add_registry() --&gt;  register_services() --&gt; start()\n                                                    |\n                                                    |--dispatch--&gt; Handler (controller/handler)\n                                                    |               |\n                                                    |               |--uses--&gt; Inject/ProviderRegistry -&gt; provides instances\n\nRequest Flow (per request):\nIOLoop -&gt; create_context() -&gt; resolve request-scoped providers -&gt; Handler executes -&gt; response -&gt; context cleanup\n\nLegend:\n- register(): provider registration from discovered modules\n- add_registry(): injection registry gets provider registries to resolve inject markers\n- register_services(): service discovery and on_init sequence\n</code></pre>","tags":["architecture","ioc","design"]},{"location":"zh/architecture/#_6","title":"\u5e38\u89c1\u6ce8\u610f\u70b9\u4e0e\u6392\u9519\u5efa\u8bae","text":"<ul> <li>\u6ce8\u5165\u5931\u8d25\uff08None\uff09\u901a\u5e38\u662f\u56e0\u4e3a provider \u5c1a\u672a\u6ce8\u518c\u5230 ProviderRegistry\uff0c\u6216 <code>InjectionRegistry</code> \u672a\u5305\u542b\u8be5 registry\u3002</li> <li>\u5faa\u73af\u4f9d\u8d56\u4f1a\u629b\u51fa <code>CircularDependencyError</code>\uff0c\u8bf7\u68c0\u67e5\u670d\u52a1\u4f9d\u8d56\u987a\u5e8f\u5e76\u8003\u8651\u91cd\u6784\u4e3a\u63a5\u53e3/\u4e8b\u4ef6\u56de\u8c03\u6a21\u5f0f\u4ee5\u6253\u7834\u5faa\u73af\u3002</li> <li>\u5728\u6d4b\u8bd5\u4e2d\u8bf7\u4f7f\u7528 <code>reset_injection_registry()</code> \u548c\u660e\u786e\u7684 ProviderRegistry \u914d\u7f6e\u4ee5\u4fdd\u8bc1\u9694\u79bb\u6027\u3002</li> </ul>","tags":["architecture","ioc","design"]},{"location":"zh/architecture/#_7","title":"\u5de5\u4ef6\u4e0e\u540e\u7eed\u5de5\u4f5c","text":"<ul> <li>\u56fe\u793a\u5360\u4f4d\uff1a<code>docs/work/architecture_assets/</code>\uff08\u53ef\u653e Mermaid PNG/SVG \u6216\u5176\u5b83\u683c\u5f0f\uff09\u3002</li> <li>\u5efa\u8bae\uff1a\u57fa\u4e8e\u4e0a\u9762\u7684\u4ea4\u4e92\u56fe\u8865\u5145\u4e00\u5f20 Mermaid/PlantUML \u56fe\uff0c\u5e76\u5c06\u5176\u7f6e\u4e8e <code>docs/work/architecture_assets/</code> \u4ee5\u4fbf\u5728 MkDocs site \u4e2d\u6e32\u67d3\uff1b\u5982\u9700\u5728 wiki \u4e2d\u5c55\u793a\uff0c\u53ef\u5728 <code>docs/wiki/architecture.md</code> \u4e2d\u5f15\u7528\u8be5\u56fe\u6216\u5bf9\u5e94\u7684 Mermaid \u6e90\u7801\u3002</li> </ul> <p>\u540e\u7eed\u53ef\u6839\u636e\u9700\u8981\uff0c\u5c06\u5f53\u524d ASCII/\u5236\u8868\u56fe\u8f6c\u6362\u4e3a Mermaid \u56fe\u6216\u751f\u6210 PNG/SVG \u8d44\u6e90\u6587\u4ef6\uff0c\u5e76\u5728\u6587\u6863\u4e0e\u7ad9\u70b9\u6784\u5efa\u6d41\u7a0b\u4e2d\u7edf\u4e00\u7ba1\u7406\u3002</p>","tags":["architecture","ioc","design"]},{"location":"zh/build_run/","title":"\u672c\u5730\u6784\u5efa\u4e0e\u8fd0\u884c","text":"<p>\u672c\u6587\u8bf4\u660e\u5982\u4f55\u5728\u672c\u5730\u642d\u5efa Cullinan \u5f00\u53d1\u73af\u5883\u3001\u4ee5\u53ef\u7f16\u8f91\u6a21\u5f0f\u5b89\u88c5\u9879\u76ee\u3001\u8fd0\u884c\u6d4b\u8bd5\u4ee5\u53ca\u542f\u52a8\u793a\u4f8b\u5e94\u7528\uff0c\u8986\u76d6 Windows\uff08PowerShell\uff09\u3001Linux \u548c macOS\u3002</p>"},{"location":"zh/build_run/#_2","title":"\u524d\u7f6e\u6761\u4ef6","text":"<ul> <li>Python 3.8 \u6216\u66f4\u9ad8\u7248\u672c</li> <li>Git</li> </ul>"},{"location":"zh/build_run/#_3","title":"\u514b\u9686\u4ed3\u5e93","text":"<p>\u5728\u6240\u6709\u5e73\u53f0\u4e0a\u5747\u53ef\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1a</p> <pre><code>git clone https://github.com/plumeink/Cullinan.git\ncd Cullinan\n</code></pre>"},{"location":"zh/build_run/#_4","title":"\u521b\u5efa\u5e76\u6fc0\u6d3b\u865a\u62df\u73af\u5883\uff08\u53ef\u9009\u4f46\u63a8\u8350\uff09","text":"<p>\u5728 Windows\uff08PowerShell\uff09\u4e2d\uff1a</p> <pre><code>python -m venv .venv\n.venv\\Scripts\\Activate.ps1\n</code></pre> <p>\u5728 Linux / macOS \u4e2d\uff1a</p> <pre><code>python -m venv .venv\nsource .venv/bin/activate\n</code></pre>"},{"location":"zh/build_run/#_5","title":"\u4ee5\u53ef\u7f16\u8f91\u6a21\u5f0f\u5b89\u88c5\u4f9d\u8d56","text":"<p>\u5728\u6240\u6709\u5e73\u53f0\u4e0a\uff1a</p> <pre><code>python -m pip install -U pip\npip install -e .\n</code></pre> <p>\u5982\u679c\u5728 <code>setup.py</code> \u6216 <code>pyproject.toml</code> \u4e2d\u5b9a\u4e49\u4e86\u5f00\u53d1\u989d\u5916\u4f9d\u8d56\uff0c\u53ef\u6309\u9700\u5b89\u88c5\uff0c\u4f8b\u5982\uff1a</p> <pre><code>pip install -e .[dev]\n</code></pre>"},{"location":"zh/build_run/#_6","title":"\u8fd0\u884c\u6d4b\u8bd5","text":"<p>\u5728\u6240\u6709\u5e73\u53f0\u4e0a\uff1a</p> <pre><code>pytest -q\n</code></pre> <p>\u5982\u9879\u76ee\u4f7f\u7528\u4e0d\u540c\u7684\u6d4b\u8bd5\u8fd0\u884c\u65b9\u5f0f\uff0c\u53ef\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8c03\u6574\u547d\u4ee4\uff08\u4f8b\u5982\u4f7f\u7528 <code>python -m pytest</code>\uff09\u3002</p>"},{"location":"zh/build_run/#_7","title":"\u8fd0\u884c\u793a\u4f8b\u5e94\u7528","text":""},{"location":"zh/build_run/#hello-http","title":"Hello HTTP \u793a\u4f8b","text":"<p>\u5728 Windows\uff08PowerShell\uff09\u4e2d\uff1a</p> <pre><code>python examples\\hello_http.py\n</code></pre> <p>\u5728 Linux / macOS \u4e2d\uff1a</p> <pre><code>python examples/hello_http.py\n</code></pre> <p>\u7136\u540e\u5728\u6d4f\u89c8\u5668\u4e2d\u8bbf\u95ee <code>http://localhost:4080/hello</code>\uff0c\u9a8c\u8bc1\u670d\u52a1\u5df2\u6210\u529f\u542f\u52a8\u3002</p>"},{"location":"zh/build_run/#_8","title":"\u4e2d\u95f4\u4ef6\u6f14\u793a\u793a\u4f8b","text":"<p>\u5728 Windows\uff08PowerShell\uff09\u4e2d\uff1a</p> <pre><code>python examples\\middleware_demo.py\n</code></pre> <p>\u5728 Linux / macOS \u4e2d\uff1a</p> <pre><code>python examples/middleware_demo.py\n</code></pre> <p>\u5173\u4e8e\u8be5\u793a\u4f8b\u7684\u65e5\u5fd7\u8f93\u51fa\u548c\u884c\u4e3a\u8bf4\u660e\uff0c\u8bf7\u53c2\u8003\u4e2d\u95f4\u4ef6\u76f8\u5173\u6587\u6863\u3002</p>"},{"location":"zh/contributing/","title":"\u8d21\u732e\u6307\u5357","text":"<p>\u5360\u4f4d\uff1a\u8d21\u732e\u6307\u5357\u3001PR \u68c0\u67e5\u6e05\u5355\u3001\u6587\u6863\u6a21\u677f\u3001front-matter \u8981\u6c42\u4e0e\u5ba1\u9605\u6d41\u7a0b\u3002</p>"},{"location":"zh/cullinan_documentation_plan/#_1","title":"\u4efb\u52a1\u6536\u655b\u4e0e\u9ad8\u5c42\u8ba1\u5212","text":"<p>\u672c\u8ba1\u5212\u6587\u6863\u7528\u4e8e\u6536\u7eb3\u591a\u9636\u6bb5\u4efb\u52a1\u89c4\u5212\uff0c\u4fbf\u4e8e\u5728\u4ed3\u5e93\u4e2d\u4fdd\u7559\u89c4\u5212\u5185\u5bb9\uff0c\u4f9b\u56e2\u961f\u5ba1\u9605\u4e0e\u5206\u914d\u3002\u540e\u7eed\u64cd\u4f5c\u793a\u4f8b\uff1a</p> <ul> <li>\u5728 <code>docs/</code> \u76ee\u5f55\u4e0b\u7ef4\u62a4\u672c\u8ba1\u5212\u6587\u4ef6\u3002</li> <li>\u8fd0\u884c\u9759\u6001\u68c0\u67e5\u4ee5\u786e\u4fdd\u6587\u4ef6\u6ca1\u6709\u8bed\u6cd5/\u683c\u5f0f\u9519\u8bef\uff08\u6587\u6863\u6587\u4ef6\u901a\u5e38\u4e0d\u4f1a\u4ea7\u751f\u4ee3\u7801\u7f16\u8bd1\u9519\u8bef\uff0c\u4f46\u4ecd\u5efa\u8bae\u8fdb\u884c\u57fa\u672c\u68c0\u67e5\uff09\u3002</li> </ul> <p>\u7b80\u8981\u9a8c\u6536\u6e05\u5355\uff08\u5728\u63d0\u4ea4\u524d\uff09\uff1a - [x] \u6587\u4ef6\u4ee5 UTF-8 \u7f16\u7801\u3001Markdown \u683c\u5f0f\u4fdd\u5b58\u3002 - [x] \u5305\u542b\u76ee\u6807\u3001\u8303\u56f4\u3001\u4efb\u52a1\u62c6\u5206\u3001\u65f6\u95f4\u9884\u4f30\u3001\u8d28\u91cf\u95e8\u4e0e\u793a\u4f8b\u547d\u4ee4\u8bf4\u660e\u3002 - [x] \u660e\u786e\u8981\u6c42 <code>docs/</code> \u4e0e <code>docs/zh/</code> \u5fc5\u987b 1:1 \u5bf9\u5e94\u3002</p> <p>TL;DR\uff1a\u4e3a Cullinan\uff08\u57fa\u4e8e Tornado \u7684 IoC/DI \u6846\u67b6\uff09\u7f16\u5199\u4e2d\u82f1\u53cc\u8bed\u6587\u6863\uff08<code>docs/</code> \u4e0e <code>docs/zh/</code> 1:1 \u5bf9\u5e94\uff09\uff0c\u5305\u62ec\u5165\u95e8\u3001\u793a\u4f8b\u3001Wiki\uff08\u67b6\u6784/\u7ec4\u4ef6/\u751f\u547d\u5468\u671f/\u6ce8\u5165/\u4e2d\u95f4\u4ef6/\u6269\u5c55\uff09\u3001API \u53c2\u8003\u3001\u8fc1\u79fb\u6307\u5357\u3001\u8d21\u732e\u6307\u5357\u3001\u6d4b\u8bd5\u4e0e\u672c\u5730\u8fd0\u884c\u8bf4\u660e\uff1b\u91c7\u7528\u6e90\u7801\u9a71\u52a8\uff08\u5ffd\u7565\u6ce8\u91ca\uff09\u7814\u7a76\u7b56\u7565\uff0c\u4fdd\u6301\u73b0\u6709 IoC/DI \u8bbe\u8ba1\u4e0d\u53d8\uff0c\u63d0\u4f9b\u5206\u5de5\u3001\u91cc\u7a0b\u7891\u3001\u8d28\u91cf\u95e8\u4e0e PowerShell \u7b49\u73af\u5883\u4e0b\u7684\u8fd0\u884c/\u9a8c\u8bc1\u547d\u4ee4\u793a\u4f8b\u3002</p>"},{"location":"zh/cullinan_documentation_plan/#2","title":"2. \u8303\u56f4\u4e0e\u4ea7\u7269\u6e05\u5355","text":"<p>\u5fc5\u987b\u4ea7\u51fa\uff08\u6bcf\u9879\u5747\u9700\u5728 <code>docs/</code> \u4e0e <code>docs/zh/</code> \u4e0b 1:1 \u5bf9\u5e94\uff09\uff1a</p> <ul> <li><code>Getting Started</code>\uff08\u5feb\u901f\u5165\u95e8\uff09 \u2014 <code>docs/getting_started.md</code> / <code>docs/zh/getting_started.md</code></li> <li><code>Examples</code>\uff08\u793a\u4f8b\uff09 \u2014 <code>docs/examples.md</code> / <code>docs/zh/examples.md</code>\uff08\u5e76\u5728\u4ed3\u5e93\u4fdd\u7559 <code>examples/</code> \u53ef\u8fd0\u884c\u4ee3\u7801\uff09</li> <li><code>Wiki</code>\uff08\u67b6\u6784/\u7ec4\u4ef6/\u751f\u547d\u5468\u671f/\u6ce8\u5165/\u4e2d\u95f4\u4ef6/\u6269\u5c55\uff09 \u2014 <code>docs/wiki/architecture.md</code>, <code>components.md</code>, <code>lifecycle.md</code>, <code>injection.md</code>, <code>middleware.md</code>, <code>extensions.md</code>\uff08\u4e0e <code>docs/zh/wiki/*</code> \u5bf9\u5e94\uff09</li> <li><code>API Reference</code> \u2014 <code>docs/api_reference.md</code> / <code>docs/zh/api_reference.md</code>\uff08\u53ef\u9009\u62e9\u81ea\u52a8\u5316\u751f\u6210\uff09</li> <li><code>Migration Guide</code> \u2014 <code>docs/migration_guide.md</code> / <code>docs/zh/migration_guide.md</code></li> <li><code>Contributing</code> \u2014 <code>docs/contributing.md</code> / <code>docs/zh/contributing.md</code></li> <li><code>Testing &amp; Verification</code> \u2014 <code>docs/testing.md</code> / <code>docs/zh/testing.md</code></li> <li><code>Local Build &amp; Run</code> \u2014 <code>docs/build_run.md</code> / <code>docs/zh/build_run.md</code></li> <li>\u6587\u6863\u6a21\u677f\u548c\u6837\u4f8b\u9875\u9762\uff08front-matter\u3001\u793a\u4f8b\u4ee3\u7801\u7247\u6bb5\u89c4\u8303\u3001\u7ffb\u8bd1\u51c6\u5219\uff09</li> </ul> <p>\u9644\u52a0\u4ea7\u7269\uff08\u5efa\u8bae\uff09\uff1a</p> <ul> <li><code>examples/</code> \u53ef\u8fd0\u884c\u793a\u4f8b\u96c6\u5408\uff08\u8f7b\u91cf demo\uff09</li> <li>\u7b80\u8981 <code>README.md</code> \u66f4\u65b0\u94fe\u63a5 <code>docs/</code> \u9875\u9762</li> <li>\u6587\u6863 CI \u811a\u672c\uff08\u53ef\u9009\uff09</li> </ul>"},{"location":"zh/cullinan_documentation_plan/#3","title":"3. \u7814\u7a76\u65b9\u6cd5\u4e0e\u4ee3\u7801\u9605\u8bfb\u7b56\u7565\uff08\u53ea\u8bfb\u6e90\u7801\uff0c\u5ffd\u7565\u6ce8\u91ca\uff09","text":"<p>\u7814\u7a76\u76ee\u6807\uff1a\u4ece\u6e90\u7801\u63a8\u65ad\u8bbe\u8ba1\u4e0e\u884c\u4e3a\uff08\u4e0d\u4f9d\u8d56\u6ce8\u91ca\uff09\uff0c\u5b9a\u4f4d\u5173\u952e\u6a21\u5757\u4e0e\u4f9d\u8d56\u5173\u7cfb\uff0c\u63d0\u53d6\u5916\u90e8 API\u3001\u751f\u547d\u5468\u671f\u548c\u6ce8\u5165\u884c\u4e3a\u3002</p> <p>\u7b56\u7565\u4e0e\u6b65\u9aa4\uff1a</p> <ol> <li>\u9ad8\u5c42\u76ee\u5f55\u626b\u63cf\uff1a\u5148\u786e\u8ba4\u9876\u5c42\u6a21\u5757\u4e0e\u5165\u53e3\u70b9\u3002\u4f18\u5148\u9605\u8bfb <code>cullinan/__init__.py</code>\u3001<code>app.py</code>\u3001<code>application.py</code>\u3001<code>config.py</code>\u3002</li> <li>\u6838\u5fc3\u5b50\u7cfb\u7edf\u5b9a\u4f4d\uff1a\u5b9a\u4f4d IoC/DI \u5b9e\u73b0\u4f4d\u7f6e\uff08\u901a\u5e38\u5728 <code>cullinan/core</code>\uff09\u3002\u91cd\u70b9\u9605\u8bfb <code>core/__init__.py</code>\u3001<code>core/provider.py</code>\u3001<code>core/registry.py</code>\u3001<code>core/scope.py</code> \u7b49\uff08\u5b9e\u9645\u6587\u4ef6\u540d\u8bf7\u6839\u636e <code>cullinan/core</code> \u76ee\u5f55\u6587\u4ef6\u5217\u8868\u8c03\u6574\uff09\u3002</li> <li>\u63a7\u5236\u5668/\u8def\u7531/\u4e2d\u95f4\u4ef6\uff1a\u67e5\u770b <code>controller/</code>\u3001<code>handler/</code>\u3001<code>middleware/</code> \u6587\u4ef6\uff0c\u627e\u5230\u8def\u7531\u6ce8\u518c\u3001\u5904\u7406\u6d41\u7a0b\u4e0e\u751f\u547d\u5468\u671f\u94a9\u5b50\u3002</li> <li>\u6a21\u5757\u626b\u63cf\u4e0e\u81ea\u52a8\u6ce8\u518c\uff1a\u9605\u8bfb <code>module_scanner.py</code>\u3001<code>websocket_registry.py</code> \u7b49\u4e86\u89e3\u81ea\u52a8\u53d1\u73b0\u673a\u5236\u4e0e\u6ce8\u518c\u65f6\u5e8f\u3002</li> <li>\u914d\u7f6e\u4e0e\u542f\u52a8\u6d41\u7a0b\uff1a\u8ffd\u8e2a <code>application.py</code> \u4e0e <code>app.py</code> \u4e2d\u7684 <code>main</code>\u3001<code>start</code>\u3001<code>initialize</code>\u3001<code>run</code> \u98ce\u683c\u51fd\u6570\uff0c\u5f62\u6210\u542f\u52a8\u5e8f\u5217\u56fe\uff08\u987a\u5e8f\u3001\u4f9d\u8d56\uff09\u3002</li> <li>\u6ce8\u5165\u70b9\u53d1\u73b0\uff1a\u5728\u6e90\u7801\u4e2d\u641c\u7d22\u5173\u952e\u8bcd\uff08<code>inject</code>, <code>provide</code>, <code>provider</code>, <code>register</code>, <code>scope</code>, <code>singleton</code>, <code>transient</code>\uff09\u4ee5\u5b9a\u4f4d\u6ce8\u5165 API \u4e0e\u7528\u6cd5\u3002</li> <li>\u4ee5\u6d4b\u8bd5\u4e3a\u53cd\u8bc1\uff1a\u5ba1\u9605 <code>tests/</code> \u4e0b\u5173\u952e\u6d4b\u8bd5\uff08\u5982 <code>test_core_injection.py</code>\u3001<code>test_controller_injection_fix.py</code>\u3001<code>test_registry.py</code> \u7b49\uff09\u6765\u7406\u89e3\u671f\u671b\u884c\u4e3a\u4e0e\u8fb9\u754c\u6761\u4ef6\uff08\u6d4b\u8bd5\u662f\u884c\u4e3a\u89c4\u8303\u7684\u91cd\u8981\u6765\u6e90\uff09\u3002</li> <li>\u4f9d\u8d56\u56fe\u6784\u5efa\uff1a\u4f7f\u7528\u9759\u6001\u8bfb\u53d6\uff08\u6216\u7b80\u5355\u811a\u672c\uff09\u5217\u51fa\u6a21\u5757\u4e4b\u95f4 import \u5173\u7cfb\uff0c\u7ed8\u5236\u7b80\u6613\u6a21\u5757\u4f9d\u8d56\u56fe\uff08\u5e2e\u52a9\u64b0\u5199\u67b6\u6784/\u7ec4\u4ef6\u8bf4\u660e\uff09\u3002</li> <li>\u8bb0\u5f55\u53d1\u73b0\uff1a\u4ee5\u201c\u4e8b\u5b9e\u9648\u8ff0\u201d\u8bb0\u5f55\u6bcf\u4e2a\u6a21\u5757\u7684\u804c\u8d23\u3001\u8f93\u5165\u8f93\u51fa\u3001\u751f\u547d\u5468\u671f\u3001\u9519\u8bef\u6a21\u5f0f\u3002\u4ec5\u57fa\u4e8e\u6e90\u7801\u884c\u4e3a\uff0c\u4e0d\u4f9d\u8d56\u6ce8\u91ca\u89e3\u91ca\u3002</li> </ol> <p>\u5de5\u5177\u4e0e\u65b9\u6cd5\uff1a</p> <ul> <li>\u4f7f\u7528\u4ed3\u5e93\u641c\u7d22\uff08\u901a\u8fc7 IDE \u6216 <code>rg</code>/<code>grep</code>\uff09\u5b9a\u4f4d\u7b26\u53f7\u548c\u5b57\u7b26\u4e32\u6a21\u5f0f\u3002</li> <li>\u9605\u8bfb\u5173\u952e\u6d4b\u8bd5\u7528\u4f8b\u4ee5\u8865\u5168\u7406\u89e3\u3002</li> <li>\u6784\u5efa\u5c0f\u7684\u95ee\u7b54\u5f0f\u7b14\u8bb0\uff08\u6a21\u5757 -&gt; \u8d23\u4efb -&gt; \u4e0e\u5176\u4ed6\u6a21\u5757\u7684\u4ea4\u4e92\uff09\u4f9b\u6587\u6863\u5199\u4f5c\u4f7f\u7528\u3002</li> </ul> <p>\u6ce8\u610f\uff1a\u4e0d\u8981\u5728\u6587\u6863\u4e2d\u6539\u53d8\u6216\u9f13\u52b1\u6539\u53d8\u73b0\u6709 IoC/DI \u8bbe\u8ba1\uff1b\u6587\u6863\u53ea\u63cf\u8ff0/\u8bf4\u660e\uff0c\u53ef\u63d0\u51fa\u201c\u6539\u8fdb\u5efa\u8bae\u201d\u4f46\u987b\u4f5c\u4e3a\u9644\u5f55\u6216 issues\u3002</p>"},{"location":"zh/cullinan_documentation_plan/#4","title":"4. \u4efb\u52a1\u62c6\u5206\u4e0e\u91cc\u7a0b\u7891\uff08\u4f18\u5148\u7ea7 + \u65f6\u95f4\u4f30\u7b97\uff09","text":"<p>\u603b\u4f53\u9884\u8ba1\u65f6\u957f\uff1a6 \u5468\uff08\u53ef\u6309\u8d44\u6e90\u5e76\u884c\u538b\u7f29\uff09\u3002\u65f6\u95f4\u5355\u4f4d\u4e3a\u4eba\u5929\uff08\u5de5\u4f5c\u65e5\uff09\u3002</p> <p>\u9636\u6bb5 A \u2014 \u53d1\u73b0\u4e0e\u5927\u7eb2\uff08\u4f18\u5148\u7ea7\uff1a\u9ad8\uff0c\u65f6\u957f\uff1a4 \u4eba\u65e5\uff09 - A1. \u6e90\u7801\u5feb\u901f\u626b\u63cf\u5e76\u751f\u6210\u6a21\u5757\u6620\u5c04\uff082 \u4eba\u65e5\uff09 - A2. \u57fa\u4e8e\u6620\u5c04\u8349\u62df\u6587\u6863\u603b\u7eb2\uff081 \u4eba\u65e5\uff09 - A3. \u786e\u8ba4\u8f93\u51fa\u683c\u5f0f\uff08Markdown \u7ed3\u6784\u3001\u76ee\u5f55\u3001\u7ffb\u8bd1\u6d41\u7a0b\u3001\u662f\u5426\u7528 Sphinx/mkdocs \u7b49\uff09\uff081 \u4eba\u65e5\uff09</p> <p>\u91cc\u7a0b\u7891 A\uff1a\u63d0\u4ea4 <code>docs/outline.md</code> \u4e0e <code>docs/zh/outline.md</code>\uff0c\u5305\u542b\u6587\u4ef6\u6e05\u5355\u4e0e\u8d1f\u8d23\u4eba\u3002</p> <p>\u9636\u6bb5 B \u2014 \u5165\u95e8\u4e0e\u793a\u4f8b\uff08\u4f18\u5148\u7ea7\uff1a\u9ad8\uff0c\u65f6\u957f\uff1a6 \u4eba\u65e5\uff09 - B1. \u7f16\u5199 <code>Getting Started</code> \u82f1\u4e2d\u7248\u672c\uff082 \u4eba\u65e5\uff09 - B2. \u8bbe\u8ba1\u5e76\u5b9e\u73b0 2\u20133 \u4e2a\u6700\u5c0f\u53ef\u8fd0\u884c\u793a\u4f8b\u5230 <code>examples/</code>\uff083 \u4eba\u65e5\uff09 - B3. \u5c06\u793a\u4f8b\u96c6\u6210\u5230\u6587\u6863\u5e76\u9a8c\u8bc1\uff081 \u4eba\u65e5\uff09</p> <p>\u91cc\u7a0b\u7891 B\uff1a<code>docs/getting_started.md</code> \u4e0e <code>examples/</code> \u53ef\u88ab\u672c\u5730\u7528\u6237\u8fd0\u884c\u3002</p> <p>\u9636\u6bb5 C \u2014 \u6838\u5fc3 Wiki\uff08\u67b6\u6784/\u7ec4\u4ef6/\u751f\u547d\u5468\u671f/\u6ce8\u5165\u673a\u5236/\u4e2d\u95f4\u4ef6/\u6269\u5c55\uff09\uff08\u4f18\u5148\u7ea7\uff1a\u9ad8\uff0c\u65f6\u957f\uff1a10 \u4eba\u65e5\uff09 - C1. <code>architecture.md</code>\uff082 \u4eba\u65e5\uff09 - C2. <code>components.md</code>\uff082 \u4eba\u65e5\uff09 - C3. <code>lifecycle.md</code>\uff082 \u4eba\u65e5\uff09 - C4. <code>injection.md</code>\uff083 \u4eba\u65e5\uff09 - C5. <code>middleware.md</code> / <code>extensions.md</code>\uff081 \u4eba\u65e5\uff09</p> <p>\u91cc\u7a0b\u7891 C\uff1a\u5b8c\u6210\u6838\u5fc3\u8bbe\u8ba1\u7684\u68b3\u7406\u4e0e\u6587\u6863\u5316\uff0c\u5e76\u901a\u8fc7\u540c\u884c\u8bc4\u5ba1\u3002</p> <p>\u9636\u6bb5 D \u2014 API \u53c2\u8003\u4e0e\u8fc1\u79fb\u6307\u5357\uff08\u4f18\u5148\u7ea7\uff1a\u4e2d\uff0c\u65f6\u957f\uff1a8 \u4eba\u65e5\uff09 - D1. \u51b3\u5b9a API \u53c2\u8003\u65b9\u5f0f\uff08\u81ea\u52a8 vs \u624b\u5de5\uff09\uff080.5 \u4eba\u65e5\uff09 - D2. \u751f\u6210\u6216\u624b\u5199\u6240\u6709\u516c\u5171\u6a21\u5757\u7684 API \u6458\u8981\uff085 \u4eba\u65e5\uff09 - D3. \u7f16\u5199\u8fc1\u79fb\u6307\u5357\uff08\u517c\u5bb9\u6027/\u7834\u574f\u6027\u53d8\u5316\u8bf4\u660e\uff09\uff082.5 \u4eba\u65e5\uff09</p> <p>\u91cc\u7a0b\u7891 D\uff1aAPI \u53c2\u8003\u5b8c\u6210\u5e76\u53ef\u7d22\u5f15\uff1b\u8fc1\u79fb\u6307\u5357\u8986\u76d6\u4e3b\u8981\u53d8\u66f4\u70b9\u3002</p> <p>\u9636\u6bb5 E \u2014 \u8d21\u732e/\u6d4b\u8bd5/\u8fd0\u884c\u8bf4\u660e\u4e0e\u672c\u5730\u6784\u5efa\uff08\u4f18\u5148\u7ea7\uff1a\u4e2d\uff0c\u65f6\u957f\uff1a4 \u4eba\u65e5\uff09 - E1. <code>contributing.md</code>\uff081 \u4eba\u65e5\uff09 - E2. <code>testing.md</code>\uff081 \u4eba\u65e5\uff09 \u2014 \u5305\u62ec\u5982\u4f55\u8fd0\u884c\u73b0\u6709\u6d4b\u8bd5\u3001\u5982\u4f55\u7f16\u5199\u6d4b\u8bd5\u3001CI \u8981\u6c42 - E3. <code>build_run.md</code>\uff082 \u4eba\u65e5\uff09 \u2014 \u5305\u542b Windows PowerShell \u6307\u4ee4\u548c\u865a\u62df\u73af\u5883\u6b65\u9aa4</p> <p>\u91cc\u7a0b\u7891 E\uff1a\u8d21\u732e\u6d41\u7a0b\u4e0e\u6d4b\u8bd5\u51c6\u5219\u5c31\u7eea\u3002</p> <p>\u9636\u6bb5 F \u2014 \u7ffb\u8bd1\u3001\u6821\u9a8c\u3001\u8d28\u91cf\u95e8\uff08\u4f18\u5148\u7ea7\uff1a\u9ad8\uff0c\u65f6\u957f\uff1a6 \u4eba\u65e5\uff09 - F1. \u7ffb\u8bd1\u6821\u5bf9\uff08\u82f1-&gt;\u4e2d\uff09\u5e76\u786e\u4fdd 1:1 \u6587\u4ef6\u7ed3\u6784\uff083 \u4eba\u65e5\uff09 - F2. \u6587\u6863\u5185\u90e8\u5ba1\u6821\uff08\u7ed3\u6784\u3001\u4e8b\u5b9e\u3001\u793a\u4f8b\u53ef\u8fd0\u884c\uff09\uff082 \u4eba\u65e5\uff09 - F3. \u6700\u7ec8\u8d28\u91cf\u95e8\uff08\u8fd0\u884c\u6d4b\u8bd5\u3001\u793a\u4f8b\u9a8c\u8bc1\u3001\u63d0\u4ea4 PR\uff09\uff081 \u4eba\u65e5\uff09</p> <p>\u91cc\u7a0b\u7891 F\uff1a\u53cc\u8bed\u6587\u6863 1:1 \u5bf9\u5e94\u901a\u8fc7 QA\u3002</p> <p>\u603b\u4f53\u91cc\u7a0b\u7891\u65f6\u95f4\u8868\uff08\u53ef\u901a\u8fc7\u5e76\u884c\u5de5\u4f5c\u7f29\u77ed\uff09\uff1a - \u7b2c 1 \u5468\uff1a\u5b8c\u6210\u9636\u6bb5 A - \u7b2c 2 \u5468\uff1a\u5f00\u59cb\u5e76\u5b8c\u6210\u9636\u6bb5 B - \u7b2c 3\u20134 \u5468\uff1a\u5b8c\u6210\u9636\u6bb5 C - \u7b2c 5 \u5468\uff1a\u5b8c\u6210\u9636\u6bb5 D \u548c E - \u7b2c 6 \u5468\uff1a\u5b8c\u6210\u9636\u6bb5 F \u7684\u9a8c\u6536\u4e0e\u53d1\u5e03</p>"},{"location":"zh/cullinan_documentation_plan/#5","title":"5. \u4eba\u5458\u5206\u5de5\u5efa\u8bae\uff08\u793a\u4f8b\uff09","text":"<ul> <li>1 \u540d\u6280\u672f\u4f5c\u8005\uff08\u4e3b\u6587\u6863\u64b0\u5199\uff09 \u2014 \u8d1f\u8d23\u5165\u95e8\u3001Wiki \u4e3b\u4f53\u3001\u793a\u4f8b\u6587\u672c</li> <li>1 \u540d\u5f00\u53d1\u5de5\u7a0b\u5e08\uff08\u4ee3\u7801\u7814\u7a76\u4e0e\u793a\u4f8b\u5b9e\u73b0\uff09 \u2014 \u8d1f\u8d23\u6e90\u7801\u6620\u5c04\u3001\u53ef\u8fd0\u884c\u793a\u4f8b\u3001\u9a8c\u8bc1\u6d4b\u8bd5</li> <li>1 \u540d\u7ffb\u8bd1/\u672c\u5730\u5316\u4eba\u5458\uff08\u4e2d\u6587\u6821\u5bf9\uff09 \u2014 \u8d1f\u8d23 <code>docs/zh/</code> \u5bf9\u5e94\u7ffb\u8bd1\u4e0e\u8bed\u5883\u6821\u9a8c</li> <li>1 \u540d\u8bc4\u5ba1/\u7ef4\u62a4\u8005\uff08\u67b6\u6784 &amp; CI \u5ba1\u6838\uff09 \u2014 \u8d1f\u8d23\u5ba1\u7a3f\u3001CI \u5408\u5e76\u3001\u8d28\u91cf\u95e8\u7b7e\u6536</li> </ul>"},{"location":"zh/cullinan_documentation_plan/#6","title":"6. \u5199\u4f5c\u51c6\u5219\uff08\u5fc5\u9075\u5b88\uff09","text":"<ul> <li>\u6587\u4ef6\u7f16\u7801\uff1aUTF-8\u3002</li> <li>\u76ee\u5f55\u7ed3\u6784\uff1a<code>docs/</code> \u4e0e <code>docs/zh/</code> \u5fc5\u987b 1:1 \u5bf9\u5e94\uff0c\u6587\u4ef6\u540d\u4e0e\u76f8\u5bf9\u8def\u5f84\u4e00\u81f4\u3002</li> <li>\u8bed\u8a00\u4e0e\u98ce\u683c\uff1a\u7b80\u6d01\u3001\u4ee5\u4e8b\u5b9e\u4e3a\u57fa\u7840\uff08\u4ee5\u6e90\u7801\u884c\u4e3a\u4e3a\u51c6\uff09\uff0c\u5c3d\u91cf\u63d0\u4f9b\u793a\u4f8b\u548c\u53ef\u590d\u5236\u6b65\u9aa4\u3002</li> <li>\u7981\u6b62\u5728\u65e5\u5fd7\u6216\u793a\u4f8b\u8f93\u51fa\u4e2d\u4f7f\u7528 emoji\uff08\u9879\u76ee\u89c4\u5b9a\uff09\u3002</li> <li>Windows PowerShell \u547d\u4ee4\u793a\u4f8b\u5e94\u7b26\u5408 Windows PowerShell v5.1 \u8bed\u6cd5\uff1b\u4e0d\u8981\u4f7f\u7528 <code>&amp;&amp;</code> \u8fde\u63a5\u547d\u4ee4\uff1b\u82e5\u9700\u8981\u5728\u4e00\u884c\u6267\u884c\u591a\u4e2a\u547d\u4ee4\uff0c\u4f7f\u7528\u5206\u53f7 <code>;</code>\u3002</li> <li>\u6587\u6863\u4e2d\u5f15\u7528\u6587\u4ef6\u6216\u7b26\u53f7\u65f6\u4f7f\u7528\u53cd\u5f15\u53f7\u5305\u88f9\uff08\u4f8b\u5982 <code>cullinan/core</code>\u3001<code>application.py</code>\uff09\u3002</li> <li>\u5bf9\u4e8e API \u53c2\u8003\uff0c\u660e\u786e\u6807\u6ce8\u201c\u516c\u6709 API\u201d\u4e0e\u201c\u5185\u90e8\u5b9e\u73b0\u201d\uff0c\u9f13\u52b1\u53ea\u5728\u516c\u6709 API \u4e0a\u5efa\u7acb\u4f7f\u7528\u793a\u4f8b\u3002</li> <li>\u7ffb\u8bd1\u7b56\u7565\uff1a\u5148\u5b8c\u6210\u82f1\u6587\u539f\u7a3f\u5e76\u8bc4\u5ba1\u901a\u8fc7\uff0c\u518d\u505a\u4e2d\u6587\u7ffb\u8bd1\uff1b\u59cb\u7ec8\u4fdd\u6301 1:1 \u5185\u5bb9\u4e00\u81f4\u6027\u3002</li> </ul>"},{"location":"zh/cullinan_documentation_plan/#7-quality-gates","title":"7. \u6821\u9a8c / \u8d28\u91cf\u95e8\uff08Quality Gates\uff09","text":"<p>\u6bcf\u4e2a\u9636\u6bb5\u5fc5\u987b\u901a\u8fc7\u76f8\u5e94\u7684\u8d28\u91cf\u95e8\u624d\u80fd\u8fdb\u5165\u4e0b\u4e00\u9636\u6bb5\uff1a</p> <p>\u8d28\u91cf\u95e8\u793a\u4f8b\uff1a - \u4ee3\u7801\u7814\u7a76\u5b8c\u6210\uff1a\u63d0\u4ea4 <code>docs/outline.md</code>\uff0c\u5305\u542b\u6a21\u5757\u6620\u5c04\u4e0e\u5173\u952e\u51fd\u6570\u5217\u8868\uff1b\u81f3\u5c11\u4e24\u540d\u5de5\u7a0b\u5e08\u5ba1\u6838\u540c\u610f\uff08\u7b7e\u540d\u6216 PR \u8bc4\u8bba\uff09\u3002 - \u793a\u4f8b\u53ef\u8fd0\u884c\uff1a<code>examples/</code> \u4e2d\u793a\u4f8b\u53ef\u5728\u672c\u5730\u865a\u62df\u73af\u5883\u4e2d\u6210\u529f\u8fd0\u884c\uff08\u89c1\u9a8c\u8bc1\u547d\u4ee4\uff09\u3002 - \u5355\u5143/\u96c6\u6210\u6d4b\u8bd5\uff1a\u8fd0\u884c\u4ed3\u5e93\u73b0\u6709\u6d4b\u8bd5\u5e76\u786e\u4fdd\u65e0\u56de\u5f52\uff08\u89c1\u4e0b\u65b9\u547d\u4ee4\uff09\u3002\u5fc5\u987b\u81f3\u5c11\u5b9e\u73b0\u201c\u5f53\u524d\u4e3b\u5206\u652f\u76f8\u540c\u6216\u66f4\u597d\u201d\u7684\u901a\u8fc7\u7387\u3002 - \u6587\u6863\u5ba1\u6821\uff1a\u6bcf\u7bc7\u6587\u6863\u81f3\u5c11\u8fdb\u884c 1 \u6b21\u6280\u672f\u5ba1\u9605\u4e0e 1 \u6b21\u8bed\u8a00\u6821\u5bf9\u3002 - \u53d1\u5e03\u524d\uff1aCI \u901a\u8fc7\u3001\u6587\u6863\u94fe\u63a5\u5b8c\u6574\u6027\u68c0\u67e5\u3001\u793a\u4f8b\u5728 Windows PowerShell \u73af\u5883\u6d4b\u8bd5\u901a\u8fc7\u3002</p> <p>\u5173\u952e\u6821\u9a8c\u547d\u4ee4\uff08\u4ee5 PowerShell \u8868\u793a\uff0c\u5355\u884c\u793a\u4f8b\u4f7f\u7528 <code>;</code> \u5206\u9694\uff09\uff1a - \u521b\u5efa\u865a\u62df\u73af\u5883\u5e76\u6fc0\u6d3b\uff08\u53ef\u9009\uff09\uff1a\u786e\u4fdd\u5b58\u5728\u53ef\u7528\u7684 Python \u73af\u5883\uff08virtualenv/conda/system Python \u7b49\u5747\u53ef\uff09\uff0c\u65e0\u9700\u5728\u6587\u6863\u4e2d\u5f3a\u5236\u89c4\u5b9a\u6fc0\u6d3b\u547d\u4ee4\u3002 - \u5b89\u88c5\u5f00\u53d1\u4f9d\u8d56\u5e76\u5b89\u88c5\u672c\u5305\uff08\u53ef\u9009 extras\uff09\uff1a<code>pip install -U pip; pip install -e .[dev]</code> \u6216 <code>pip install -e .</code> - \u8fd0\u884c\u6d4b\u8bd5\uff1a<code>py -3 -m pytest -q</code>\uff08\u6216 <code>pytest -q</code>\uff09 - \u8fd0\u884c\u5355\u4e2a\u793a\u4f8b\uff08\u5728 <code>examples/</code> \u76ee\u5f55\uff09\uff1a<code>py example_script.py</code> \u6216 <code>python -m examples.demo</code>\uff08\u89c6\u793a\u4f8b\u5b9e\u73b0\u800c\u5b9a\uff09 - \u68c0\u67e5\u6587\u6863\u94fe\u63a5/\u62fc\u5199\uff08\u82e5\u4f7f\u7528\u5de5\u5177\uff09\uff1a<code>pylint</code>/<code>flake8</code>\uff08\u4ee3\u7801\uff09\uff0c<code>markdownlint</code>\uff08\u6587\u6863\uff09\uff08\u6309\u9700\u5b89\u88c5\uff09</p>"},{"location":"zh/cullinan_documentation_plan/#8","title":"8. \u9700\u8981\u521b\u5efa\u7684\u6587\u4ef6\u7ed3\u6784\u4e0e\u6a21\u677f\u793a\u4f8b","text":"<p>\u5efa\u8bae\u5728\u4ed3\u5e93\u4e2d\u65b0\u589e\u6216\u8865\u5145\u4ee5\u4e0b\u6587\u4ef6\uff08<code>docs/</code> \u4e0e <code>docs/zh/</code> \u5fc5\u987b\u955c\u50cf\uff09\uff1a</p> <ul> <li><code>docs/README.md</code>\uff08\u6587\u6863\u4e3b\u9875/\u5bfc\u822a\uff09</li> <li><code>docs/getting_started.md</code>\uff08\u5feb\u901f\u5f00\u59cb\uff1a\u73af\u5883\u3001\u5b89\u88c5\u3001\u8fd0\u884c\u7b2c\u4e00\u4e2a\u5e94\u7528\uff09</li> <li><code>docs/examples.md</code>\uff08\u793a\u4f8b\u7d22\u5f15\u4e0e\u8bf4\u660e\uff09 + <code>examples/</code> \u76ee\u5f55\u653e\u793a\u4f8b\u4ee3\u7801</li> <li><code>docs/wiki/architecture.md</code>\uff08\u67b6\u6784\u603b\u89c8\uff09</li> <li><code>docs/wiki/components.md</code>\uff08\u7ec4\u4ef6\u8d23\u4efb\u4e0e API \u6458\u8981\uff09</li> <li><code>docs/wiki/lifecycle.md</code>\uff08\u5e94\u7528\u542f\u52a8/\u5173\u95ed/\u751f\u547d\u5468\u671f\u94a9\u5b50\uff09</li> <li><code>docs/wiki/injection.md</code>\uff08IoC/DI \u673a\u5236\u8be6\u89e3\uff09</li> <li><code>docs/wiki/middleware.md</code>\uff08\u4e2d\u95f4\u4ef6\u94fe\u4e0e\u6269\u5c55\u70b9\uff09</li> <li><code>docs/api_reference.md</code>\uff08\u6309\u6a21\u5757\u5217\u51fa\u7684\u516c\u6709 API\uff09</li> <li><code>docs/migration_guide.md</code>\uff08\u517c\u5bb9\u6027\u4e0e\u8fc1\u79fb\u8bf4\u660e\uff09</li> <li><code>docs/contributing.md</code>\uff08\u8d21\u732e\u8005\u6307\u5357\u3001\u4ee3\u7801\u98ce\u683c\u3001PR \u6d41\u7a0b\uff09</li> <li><code>docs/testing.md</code>\uff08\u5982\u4f55\u8fd0\u884c\u73b0\u6709 tests\u3001\u7f16\u5199\u6d4b\u8bd5\u3001CI \u8981\u6c42\uff09</li> <li><code>docs/build_run.md</code>\uff08\u5728 Windows/Unix \u4e0b\u7684\u672c\u5730\u6784\u5efa\u4e0e\u8fd0\u884c\u8bf4\u660e\uff09</li> <li><code>docs/templates/</code>\uff08\u9875\u9762\u6a21\u677f\uff1a\u6807\u9898\u3001\u6982\u8ff0\u3001\u793a\u4f8b\u7ed3\u6784\u3001API \u6761\u76ee\u683c\u5f0f\u3001\u7ffb\u8bd1\u5bf9\u7167\u8868\uff09</li> </ul> <p>\u6a21\u677f\u793a\u4f8b\uff08\u63cf\u8ff0\u800c\u975e\u4ee3\u7801\u5757\uff09\uff1a - \u6587\u6863\u9876\u90e8\u5e94\u5305\u542b\u7b80\u77ed\u7684\u201c\u76ee\u7684/\u8303\u56f4/\u524d\u63d0\u201d\u4e09\u6bb5\uff0c\u968f\u540e\u201c\u793a\u4f8b\u201d\u90e8\u5206\u6309\u201c\u793a\u4f8b\u8bf4\u660e / \u4ee3\u7801\u4f4d\u7f6e / \u8fd0\u884c\u6b65\u9aa4 / \u671f\u671b\u7ed3\u679c\u201d\u56db\u6bb5\u6a21\u677f\u6392\u5217\u3002 - API \u6761\u76ee\u6a21\u677f\uff1a\u6a21\u5757\u8def\u5f84 -&gt; \u7b80\u77ed\u63cf\u8ff0 -&gt; \u516c\u5f00\u7c7b/\u51fd\u6570\u5217\u8868\uff08\u6bcf\u9879\uff1a\u7b7e\u540d\u3001\u53c2\u6570\u8bf4\u660e\u3001\u8fd4\u56de\u503c\u3001\u5f02\u5e38\u4e0e\u4f7f\u7528\u793a\u4f8b\u884c\u53f7\u5f15\u7528\uff09\u3002 - \u7ffb\u8bd1\u6a21\u677f\uff1a\u6bcf\u4e2a\u82f1\u6587\u6587\u4ef6\u5e94\u5e26\u6709\u4e00\u4efd\u5bf9\u7167\u6e05\u5355\u5217\u51fa\u201c\u5efa\u8bae\u672f\u8bed\u7ffb\u8bd1\u201d\uff08\u4f8b\u5982 IoC -&gt; \u63a7\u5236\u53cd\u8f6c\uff0cDI -&gt; \u4f9d\u8d56\u6ce8\u5165\uff09\u3002</p>"},{"location":"zh/cullinan_documentation_plan/#9","title":"9. \u9a8c\u6536\u6807\u51c6\uff08\u9a8c\u6536\u68c0\u67e5\u8868\uff09","text":"<p>\u6bcf\u9879\u6587\u6863\u5728\u4ea4\u4ed8\u524d\u5fc5\u987b\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\uff1a - \u82f1\u6587\u4e0e\u4e2d\u6587\u6587\u4ef6 1:1 \u5bf9\u5e94\uff08\u8def\u5f84\u4e0e\u6587\u4ef6\u540d\u4e00\u81f4\uff0c\u5185\u5bb9\u7b49\u6548\uff09\u3002 - Getting Started\uff1a\u65b0\u7528\u6237\u6309\u6b65\u9aa4\u80fd\u5728 30 \u5206\u949f\u5185\u8fd0\u884c\u793a\u4f8b\u5e76\u8bbf\u95ee\u5e94\u7528\u3002 - Examples\uff1a\u81f3\u5c11\u5305\u542b 2 \u4e2a\u53ef\u8fd0\u884c\u793a\u4f8b\uff08\u6700\u5c0f\uff1aHello World HTTP\uff0c\u8fdb\u9636\uff1aController + DI + Middleware \u793a\u4f8b\uff09\u3002 - Wiki\uff1a\u8986\u76d6\u67b6\u6784\u56fe\u3001\u7ec4\u4ef6\u804c\u8d23\u3001\u6ce8\u5165\u751f\u547d\u5468\u671f\u4e0e\u9519\u8bef\u6a21\u578b\u3002 - API \u53c2\u8003\uff1a\u8986\u76d6\u6240\u6709\u516c\u5171\u6a21\u5757\u5e76\u63d0\u4f9b\u81f3\u5c11\u4e00\u4e2a\u4f7f\u7528\u793a\u4f8b\u3002 - Migration Guide\uff1a\u5217\u51fa\u6240\u6709\u7834\u574f\u6027\u53d8\u66f4\u4e0e\u8fc1\u79fb\u6b65\u9aa4\uff08\u82e5\u5b58\u5728\uff09\u3002 - Contributing\uff1a\u5305\u542b\u4ee3\u7801\u98ce\u683c\u3001PR \u6d41\u7a0b\u3001\u6d4b\u8bd5\u51c6\u5165\u95e8\u69db\u3002 - Testing\uff1a\u73b0\u6709\u6d4b\u8bd5\u5728\u5e72\u51c0\u73af\u5883\u4e0b\u4f7f\u7528 <code>pytest</code> \u8fd0\u884c\u901a\u8fc7\uff08\u4e0e\u4e3b\u5206\u652f\u540c\u7b49\u6216\u66f4\u4f18\uff09\u3002 - \u6587\u6863\u5ba1\u9605\uff1a\u81f3\u5c11 2 \u540d\u6280\u672f\u8bc4\u5ba1\u4e0e 1 \u540d\u6587\u672c\u6821\u5bf9\u4eba\u5458\u901a\u8fc7\u5ba1\u9605\u3002 - CI/\u53d1\u5e03\uff1a\u6587\u6863\u6784\u5efa\u6216\u9759\u6001\u68c0\u67e5\uff08\u82e5\u4f7f\u7528 mkdocs/sphinx\uff09\u901a\u8fc7\u3002</p>"},{"location":"zh/cullinan_documentation_plan/#10","title":"10. \u98ce\u9669\u4e0e\u7f13\u89e3\u63aa\u65bd","text":"<p>\u98ce\u9669 1\uff1a\u6e90\u7801\u7406\u89e3\u504f\u5dee\uff08\u53ea\u8bfb\u6e90\u7801\u3001\u4e0d\u770b\u6ce8\u91ca\u53ef\u80fd\u4e22\u5931\u8bbe\u8ba1\u80cc\u666f\uff09 - \u7f13\u89e3\uff1a\u4ee5\u6d4b\u8bd5\u7528\u4f8b\u4e3a\u884c\u4e3a\u89c4\u8303\uff0c\u5fc5\u8981\u65f6\u5728\u5ba1\u9605\u9636\u6bb5\u5411\u539f\u4f5c\u8005\u786e\u8ba4\u8bbe\u8ba1\u610f\u56fe\uff0c\u5e76\u8bb0\u5f55\u4e3a\u201c\u4f5c\u8005\u8bf4\u660e\u201d\u9644\u5f55\uff08\u4e0d\u4fee\u6539\u6e90\u7801\uff09\u3002</p> <p>\u98ce\u9669 2\uff1aIoC/DI \u8bbe\u8ba1\u590d\u6742\uff0c\u96be\u4ee5\u76f4\u89c2\u8868\u8fbe - \u7f13\u89e3\uff1a\u4f7f\u7528\u6d41\u7a0b\u56fe\u3001\u987a\u5e8f\u56fe\u548c\u793a\u4f8b\u4ee3\u7801\u6f14\u793a\u6ce8\u5165\u65f6\u5e8f\uff1b\u5728 <code>docs/wiki/injection.md</code> \u4e2d\u589e\u52a0\u201c\u5e38\u89c1\u6a21\u5f0f/\u53cd\u6a21\u5f0f\u201d\u5c0f\u8282\u3002</p> <p>\u98ce\u9669 3\uff1a\u4e2d\u82f1\u6587\u7ffb\u8bd1\u4e0d\u4e00\u81f4\u6216\u672f\u8bed\u4e0d\u7edf\u4e00 - \u7f13\u89e3\uff1a\u7ef4\u62a4\u201c\u672f\u8bed\u5bf9\u7167\u8868\u201d\uff1b\u5148\u5b8c\u6210\u82f1\u6587\u5e76\u5ba1\u6821\uff0c\u518d\u7531\u7ffb\u8bd1\u4eba\u5458\u5bf9\u7167\u9010\u6761\u7ffb\u8bd1\u5e76\u590d\u6838\u3002</p> <p>\u98ce\u9669 4\uff1a\u793a\u4f8b\u5728 Windows \u73af\u5883\u4e0b\u4e0d\u53ef\u8fd0\u884c - \u7f13\u89e3\uff1a\u5728 Windows PowerShell v5.1 \u4e0b\u6d4b\u8bd5\u6240\u6709\u793a\u4f8b\uff0c\u5e76\u5728 <code>build_run.md</code> \u4e2d\u7ed9\u51fa PowerShell \u4e13\u7528\u547d\u4ee4\uff08\u4f7f\u7528\u5206\u53f7 <code>;</code>\uff0c\u907f\u514d <code>&amp;&amp;</code>\uff09\u3002</p> <p>\u98ce\u9669 5\uff1a\u81ea\u52a8\u751f\u6210 API \u5de5\u5177\u914d\u7f6e\u590d\u6742 - \u7f13\u89e3\uff1a\u5982\u81ea\u52a8\u5316\u6210\u672c\u8fc7\u9ad8\uff0c\u53ef\u91c7\u7528\u534a\u81ea\u52a8\u5316\u65b9\u6848\uff08\u811a\u672c\u63d0\u53d6\u516c\u6709\u7b26\u53f7\u5e76\u751f\u6210\u6a21\u677f\uff09\u6216\u624b\u5de5\u8865\u5168\u5173\u952e\u6a21\u5757\u3002</p>"},{"location":"zh/cullinan_documentation_plan/#11-powershell-v51","title":"11. \u5fc5\u8981\u7684\u547d\u4ee4\u4e0e\u5de5\u5177\uff08PowerShell v5.1 \u793a\u4f8b\u8bf4\u660e\uff09","text":"<ul> <li>\u5efa\u8bae\u5f00\u53d1\u73af\u5883\u5de5\u5177\uff1aPython 3.8+\uff08\u9879\u76ee\u5f53\u524d\u8981\u6c42\u8bf7\u6838\u5bf9 <code>setup.py</code>\uff09\uff0cpytest\uff0cmkdocs/sphinx\uff0cmarkdownlint\uff0cTypora/VSCode\uff08\u7528\u4e8e\u6821\u5bf9\uff09\uff0c\u53ef\u9009\uff1agraphviz\uff08\u7ed8\u5236\u4f9d\u8d56\u56fe\uff09\u3002</li> <li>\u865a\u62df\u73af\u5883\uff08\u793a\u4f8b\u8bf4\u660e\uff09\uff1a\u5982\u9700\u5728\u672c\u5730\u521b\u5efa\u865a\u62df\u73af\u5883\uff0c\u8bf7\u53c2\u8003\u4f7f\u7528\u7684\u5e73\u53f0\u548c\u504f\u597d\uff1b\u6587\u6863\u793a\u4f8b\u7edf\u4e00\u4f7f\u7528 <code>pip</code> \u547d\u4ee4\uff0c\u5047\u5b9a\u5df2\u6709\u53ef\u7528\u7684 Python \u73af\u5883\u3002</li> <li>\u5b89\u88c5\u5f00\u53d1\u4f9d\u8d56\uff1a<code>pip install -U pip; pip install -e .[dev]</code>\uff08\u6216 <code>pip install -e .</code>\uff09</li> <li>\u8fd0\u884c\u6d4b\u8bd5\uff1a<code>py -3 -m pytest -q</code></li> <li>\u8fd0\u884c\u5355\u4e2a\u793a\u4f8b\uff08\u793a\u4f8b\u4f4d\u4e8e <code>examples/hello.py</code>\uff09\uff1a<code>py examples\\hello.py</code></li> <li>\u82e5\u4f7f\u7528\u6587\u6863\u5de5\u5177\uff08mkdocs\uff09\u6784\u5efa\u672c\u5730\u9884\u89c8\uff1a<code>pip install mkdocs mkdocs-material; mkdocs serve</code>\uff08\u5728\u9879\u76ee\u6839\u76ee\u5f55\u6216\u5305\u542b <code>mkdocs.yml</code> \u7684\u76ee\u5f55\u6267\u884c\uff09</li> </ul>"},{"location":"zh/cullinan_documentation_plan/#12","title":"12. \u4ea4\u4ed8\u7269\u63d0\u4ea4 / \u5408\u5e76\u6d41\u7a0b\u5efa\u8bae","text":"<ul> <li>\u6bcf\u4e2a\u9636\u6bb5\u5b8c\u6210\u540e\u63d0\u4ea4\u4e00\u4e2a\u5355\u72ec\u7684 PR\uff08\u4f8b\u5982 <code>docs/getting-started</code>\u3001<code>docs/wiki-injection</code> \u7b49\uff09\uff0cPR \u5fc5\u987b\u5305\u542b\uff1a\u53d8\u66f4\u8bf4\u660e\u3001\u6d4b\u8bd5/\u793a\u4f8b\u9a8c\u8bc1\u6b65\u9aa4\u3001\u5ba1\u9605\u68c0\u67e5\u6e05\u5355\u3002</li> <li>\u5408\u5e76\u524d\u9700\u901a\u8fc7\u81f3\u5c11\u4e00\u540d\u4ee3\u7801/\u67b6\u6784\u8bc4\u5ba1\u8005\u4e0e\u4e00\u540d\u6587\u6863\u6821\u5bf9\u8005\u7684\u5ba1\u9605\u3002</li> <li>\u53d1\u5e03\u6587\u6863\u7248\u672c\uff08tag\uff09\u540e\u5728 <code>README.MD</code> \u4e2d\u66f4\u65b0\u5bf9\u5e94\u7248\u672c\u94fe\u63a5\u3002</li> </ul> <p>\u5982\u9700\u5c06\u672c\u8ba1\u5212\u8fdb\u4e00\u6b65\u62c6\u5206\u4e3a\u5177\u4f53\u7684 <code>docs/</code> \u6587\u4ef6\u6a21\u677f\uff0c\u5e76\u4e3a\u6bcf\u4e2a\u6587\u4ef6\u751f\u6210\u521d\u59cb\u5360\u4f4d\u5185\u5bb9\uff08\u82f1\u6587 + \u4e2d\u6587\u5360\u4f4d\uff09\uff0c\u53ef\u4ee5\u57fa\u4e8e\u672c\u8ba1\u5212\u7ee7\u7eed\u5b9e\u65bd\u5e76\u521b\u5efa\u8fd9\u4e9b\u6587\u4ef6\u3002</p>"},{"location":"zh/examples/","title":"\u793a\u4f8b\u4e0e\u6f14\u793a","text":"<p>\u672c\u6587\u5217\u51fa\u4e86 Cullinan \u4ed3\u5e93\u4e2d\u7ef4\u62a4\u7684\u53ef\u8fd0\u884c\u793a\u4f8b\u3002\u6bcf\u4e2a\u793a\u4f8b\u5305\u542b\uff1a\u8def\u5f84\u3001\u7b80\u8981\u8bf4\u660e\uff0c\u4ee5\u53ca\u5728\u5e38\u89c1\u5e73\u53f0\u4e0a\u7684\u8fd0\u884c\u65b9\u5f0f\u3002</p>"},{"location":"zh/examples/#hello-http","title":"Hello HTTP","text":"<ul> <li>\u8def\u5f84\uff1a<code>examples/hello_http.py</code></li> <li>\u8bf4\u660e\uff1a\u6700\u5c0f\u5316\u7684 HTTP \u670d\u52a1\uff0c\u8fd4\u56de\u7b80\u5355\u95ee\u5019\u3002</li> </ul>"},{"location":"zh/examples/#_2","title":"\u8fd0\u884c\u65b9\u5f0f","text":"<p>\u5728 Windows\uff08PowerShell\uff09\u4e2d\uff1a</p> <pre><code>python examples\\hello_http.py\n</code></pre> <p>\u5728 Linux / macOS \u4e2d\uff1a</p> <pre><code>python examples/hello_http.py\n</code></pre> <p>\u9884\u671f\u884c\u4e3a\uff1a</p> <ul> <li>\u542f\u52a8\u4e00\u4e2a HTTP \u670d\u52a1\u3002</li> <li>\u5728 <code>http://localhost:4080/hello</code> \u4e0a\u63d0\u4f9b\u54cd\u5e94\u3002</li> </ul>"},{"location":"zh/examples/#controller-di-middleware","title":"Controller + DI + Middleware \u793a\u4f8b","text":"<ul> <li>\u8def\u5f84\uff1a<code>examples/controller_di_middleware.py</code></li> <li>\u8bf4\u660e\uff1a\u6f14\u793a\u63a7\u5236\u5668\u3001\u4f9d\u8d56\u6ce8\u5165\u4e0e\u4e2d\u95f4\u4ef6\u7684\u96c6\u6210\u7528\u6cd5\u3002</li> </ul>"},{"location":"zh/examples/#_3","title":"\u8fd0\u884c\u65b9\u5f0f","text":"<p>\u5728 Windows\uff08PowerShell\uff09\u4e2d\uff1a</p> <pre><code>python examples\\controller_di_middleware.py\n</code></pre> <p>\u5728 Linux / macOS \u4e2d\uff1a</p> <pre><code>python examples/controller_di_middleware.py\n</code></pre> <p>\u9884\u671f\u884c\u4e3a\uff1a</p> <ul> <li>\u901a\u8fc7\u4e2d\u95f4\u4ef6\u8bb0\u5f55\u8bf7\u6c42\u5904\u7406\u8fc7\u7a0b\u3002</li> <li>\u5c55\u793a\u6ce8\u5165\u7684\u670d\u52a1\u5982\u4f55\u53c2\u4e0e\u8bf7\u6c42\u5904\u7406\u7ba1\u7ebf\u3002</li> </ul>"},{"location":"zh/getting_started/","title":"Cullinan \u5feb\u901f\u5f00\u59cb","text":"<p>\u672c\u9875\u63d0\u4f9b\u6700\u5c0f\u5316\u7684\u5feb\u901f\u5165\u95e8\uff0c\u8bf4\u660e\u5982\u4f55\u5b89\u88c5\u5e76\u8fd0\u884c Cullinan \u793a\u4f8b\u5e94\u7528\u3002</p>"},{"location":"zh/getting_started/#_1","title":"\u524d\u7f6e\u6761\u4ef6","text":"<ul> <li>Python 3.8+</li> <li>Git</li> </ul>"},{"location":"zh/getting_started/#_2","title":"\u5b89\u88c5","text":"<p>\u5728\u7ee7\u7eed\u4e4b\u524d\uff0c\u8bf7\u786e\u4fdd\u5df2\u7ecf\u5b89\u88c5 Python 3.8+ \u5e76\u53ef\u4ee5\u5728\u547d\u4ee4\u884c\u4e2d\u4f7f\u7528 <code>python</code> \u548c <code>pip</code>\u3002</p> <p>\u5728\u5927\u591a\u6570\u73af\u5883\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5347\u7ea7 pip \u5e76\u5b89\u88c5 Cullinan\uff08\u9002\u7528\u4e8e Windows\u3001Linux\u3001macOS\uff09\uff1a</p> <pre><code>python -m pip install -U pip\npython -m pip install cullinan\n</code></pre>"},{"location":"zh/getting_started/#_3","title":"\u5feb\u901f\u5f00\u59cb","text":"<ol> <li>\u5728\u4f60\u5e0c\u671b\u653e\u7f6e\u9879\u76ee\u7684\u76ee\u5f55\u521b\u5efa\u4e00\u4e2a\u65b0\u9879\u76ee\u76ee\u5f55\u5e76\u8fdb\u5165\uff1a</li> </ol> <p>\u5728\u6240\u6709\u5e73\u53f0\u4e0a\uff1a</p> <pre><code>mkdir my_cullinan_project\ncd my_cullinan_project\n</code></pre> <ol> <li>\u786e\u4fdd\u4f60\u5df2\u6709\u4e00\u4e2a Python \u73af\u5883\uff08virtualenv\u3001conda\u3001\u7cfb\u7edf Python \u7b49\u5747\u53ef\uff09\u3002\u7136\u540e\u5b89\u88c5\u53d1\u5e03\u7248\u672c\u7684\u5305\uff1a</li> </ol> <pre><code>python -m pip install -U pip\npython -m pip install cullinan\n</code></pre> <ol> <li>\u5728\u9879\u76ee\u6839\u76ee\u5f55\u521b\u5efa\u4e00\u4e2a\u6700\u5c0f\u5e94\u7528\u6587\u4ef6 <code>minimal_app.py</code>\uff0c\u5185\u5bb9\u5982\u4e0b\uff1a</li> </ol> <pre><code># minimal_app.py\nfrom cullinan import application\nfrom cullinan.controller import controller\n\n@controller(path='/hello')\ndef hello_handler(request):\n    \"\"\"\u7b80\u5355\u7684 HTTP \u5904\u7406\u5668\u3002\"\"\"\n    return {'message': 'Hello from Cullinan!'}\n\nif __name__ == '__main__':\n    # Start the framework application (no instantiation required)\n    application.run()\n</code></pre> <ol> <li>\u8fd0\u884c\u4f60\u7684\u5e94\u7528\uff1a</li> </ol> <p>\u5728 Windows\uff08PowerShell\uff09\u4e2d\uff1a</p> <pre><code>python minimal_app.py\n</code></pre> <p>\u5728 Linux / macOS \u4e2d\uff1a</p> <pre><code>python minimal_app.py\n</code></pre> <p>\u5728\u6d4f\u89c8\u5668\u4e2d\u6253\u5f00 <code>http://localhost:4080/hello</code> \u9a8c\u8bc1\u670d\u52a1\u5668\u662f\u5426\u542f\u52a8\u3002</p>"},{"location":"zh/getting_started/#_4","title":"\u793a\u4f8b\u8fd0\u884c\u8f93\u51fa","text":"<p>\u4e0b\u65b9\u65e5\u5fd7\u5c55\u793a\u4e86\u5728\u672c\u5730\u73af\u5883\uff08Windows PowerShell \u4f1a\u8bdd\uff09\u4e2d\u6210\u529f\u8fd0\u884c\u4e0a\u8ff0\u793a\u4f8b\u65f6\u7684\u5178\u578b\u8f93\u51fa\uff0c\u5b9e\u9645\u65f6\u95f4\u6233\u548c\u6267\u884c\u8017\u65f6\u53ef\u80fd\u56e0\u73af\u5883\u4e0d\u540c\u800c\u6709\u6240\u53d8\u5316\uff1a</p> <pre><code>|||||||||||||||||||||||||||||||||||||||||||||||||\n|||                                           |||\n|||    _____      _ _ _                       |||\n|||   / ____|    | | (_)                      |||\n|||  | |    _   _| | |_ _ __   __ _ _ __      |||\n|||  | |   | | | | | | | '_ \\ / _` | '_ \\     |||\n|||  | |___| |_| | | | | | | | (_| | | | |    |||\n|||   \\_____\\__,_|_|_|_|_| |_|\\__,_|_| |_|    |||\n|||                                           |||\n|||||||||||||||||||||||||||||||||||||||||||||||||\n    |||\n\n2025-11-19 04:18:50,209 INFO cullinan.application: loading env...\n2025-11-19 04:18:50,210 INFO cullinan.application: \u2514---configuring dependency injection...\n2025-11-19 04:18:50,210 INFO cullinan.application: \u2514---dependency injection configured\n2025-11-19 04:18:50,210 INFO cullinan.application: \u2514---scanning services...\n2025-11-19 04:18:50,210 INFO cullinan.application: ...\n2025-11-19 04:18:50,223 INFO cullinan.application: \u2514---found 31 modules to scan\n2025-11-19 04:18:50,228 INFO cullinan.application: \u2514---scanning controllers...\n2025-11-19 04:18:50,260 INFO cullinan.application: \u2514---found 31 modules to scan\n2025-11-19 04:18:50,261 INFO cullinan.application: \u2514---initializing services...\n2025-11-19 04:18:50,261 INFO cullinan.application: \u2514---no services registered\n2025-11-19 04:18:50,261 INFO cullinan.application: \u2514---loading controller finish\n\n2025-11-19 04:18:50,261 INFO cullinan.application: loading env finish\n\n2025-11-19 04:18:50,262 INFO cullinan.application: server is starting\n2025-11-19 04:18:50,262 INFO cullinan.application: port is 4080\n</code></pre> <p>\u6b64\u65f6\u670d\u52a1\u5668\u5df2\u542f\u52a8\u5e76\u4fdd\u6301\u8fd0\u884c\u72b6\u6001\uff0c\u76d1\u542c\u5728 <code>http://localhost:4080</code>\u3002\u4f7f\u7528 Ctrl+C \u53ef\u4ee5\u4f18\u96c5\u5730\u505c\u6b62\u670d\u52a1\u5668\u3002</p>"},{"location":"zh/getting_started/#_5","title":"\u6700\u5c0f\u5e94\u7528\u793a\u4f8b","text":"<p>\u8fd9\u662f\u4e00\u4e2a\u6f14\u793a Cullinan \u6838\u5fc3\u529f\u80fd\u7684\u6700\u5c0f\u5e94\u7528\uff1a</p> <pre><code># minimal_app.py\nfrom cullinan import application\nfrom cullinan.controller import controller\n\n@controller(path='/hello')\ndef hello_handler(request):\n    \"\"\"\u7b80\u5355\u7684 HTTP \u5904\u7406\u5668\u3002\"\"\"\n    return {'message': 'Hello from Cullinan!'}\n\nif __name__ == '__main__':\n    # Start the framework application (no instantiation required)\n    application.run()\n</code></pre> <p>\u8fd0\u884c\u6b64\u793a\u4f8b\uff1a</p> <pre><code># \u5c06\u4e0a\u8ff0\u4ee3\u7801\u4fdd\u5b58\u4e3a minimal_app.py\npython minimal_app.py\n</code></pre> <p>\u7136\u540e\u5728\u6d4f\u89c8\u5668\u4e2d\u8bbf\u95ee <code>http://localhost:4080/hello</code>\u3002</p>"},{"location":"zh/getting_started/#_6","title":"\u7406\u89e3\u57fa\u7840\u77e5\u8bc6","text":""},{"location":"zh/getting_started/#_7","title":"\u5e94\u7528\u751f\u547d\u5468\u671f","text":"<ol> <li>\u521b\u5efa\uff1a<code>create_app()</code> \u4f7f\u7528\u9ed8\u8ba4\u8bbe\u7f6e\u521d\u59cb\u5316\u5e94\u7528</li> <li>\u6ce8\u518c\uff1a\u901a\u8fc7\u6a21\u5757\u626b\u63cf\u6216\u663e\u5f0f\u6ce8\u518c\u53d1\u73b0\u63a7\u5236\u5668\u548c\u670d\u52a1</li> <li>\u542f\u52a8\uff1a<code>app.run()</code> \u542f\u52a8 Tornado IOLoop \u5e76\u5f00\u59cb\u63a5\u53d7\u8bf7\u6c42</li> <li>\u5173\u95ed\uff1a\u5728 SIGINT/SIGTERM \u4fe1\u53f7\u65f6\u4f18\u96c5\u5173\u95ed</li> </ol>"},{"location":"zh/getting_started/#_8","title":"\u4f9d\u8d56\u6ce8\u5165","text":"<p>Cullinan \u63d0\u4f9b\u5185\u7f6e\u7684 IoC/DI \u652f\u6301\u3002</p>"},{"location":"zh/getting_started/#injectable-vs-controller","title":"\u6ce8\u89e3\u8bf4\u660e\uff1a<code>@injectable</code> vs <code>@controller()</code>","text":"<p><code>@injectable</code> - \u901a\u7528\u4f9d\u8d56\u6ce8\u5165\u6ce8\u89e3 - \u9002\u7528\u4e8e\u4efb\u4f55\u9700\u8981\u4f9d\u8d56\u6ce8\u5165\u7684\u7c7b\uff08Service\u3001Repository\u3001\u666e\u901a\u7c7b\u7b49\uff09 - \u9700\u8981\u624b\u52a8\u4f7f\u7528\uff0c\u4e0d\u4f1a\u81ea\u52a8\u6ce8\u518c\u5230\u4efb\u4f55\u6ce8\u518c\u8868 - \u5728\u7c7b\u5b9e\u4f8b\u5316\u540e\u81ea\u52a8\u6ce8\u5165\u6807\u8bb0\u7684\u4f9d\u8d56 - \u4f7f\u7528\u573a\u666f\uff1aService \u5c42\u3001Repository \u5c42\u3001\u5de5\u5177\u7c7b\u7b49</p> <p><code>@controller()</code> - Controller \u4e13\u7528\u81ea\u6ce8\u518c\u6ce8\u89e3 - \u4e13\u95e8\u7528\u4e8e HTTP Controller \u7c7b - \u81ea\u52a8\u8c03\u7528 <code>@injectable</code>\uff0c\u65e0\u9700\u624b\u52a8\u6dfb\u52a0 - \u81ea\u52a8\u6ce8\u518c Controller \u53ca\u5176\u8def\u7531\u5230 ControllerRegistry - \u81ea\u52a8\u626b\u63cf\u7c7b\u4e2d\u7684 <code>@get_api</code>\u3001<code>@post_api</code> \u7b49\u65b9\u6cd5\u88c5\u9970\u5668 - \u4f7f\u7528\u573a\u666f\uff1a\u4ec5\u7528\u4e8e HTTP Controller</p> <pre><code>from cullinan.controller import controller, get_api\nfrom cullinan.service import Service, service\nfrom cullinan.core import injectable, InjectByName\n\n# Service \u4f7f\u7528 @service (\u7ee7\u627f\u81ea Service \u57fa\u7c7b)\n@service\nclass UserService(Service):\n    def get_user(self, user_id):\n        return {'id': user_id, 'name': 'John'}\n\n# Repository \u4f7f\u7528 @injectable\n@injectable\nclass UserRepository:\n    def find_by_id(self, user_id):\n        return {'id': user_id}\n\n# Controller \u4f7f\u7528 @controller() - \u81ea\u52a8\u5305\u542b @injectable\n@controller(url='/api/users')\nclass UserController:\n    # Controller \u4e2d\u7684\u4f9d\u8d56\u6ce8\u5165\n    user_service = InjectByName('UserService')\n\n    @get_api(url='/{user_id}')\n    def get_user(self, url_params):\n        # \u4ece url_params \u5b57\u5178\u4e2d\u83b7\u53d6\u8def\u5f84\u53c2\u6570\n        user_id = url_params.get('user_id') if url_params else None\n        return self.user_service.get_user(user_id)\n</code></pre> <p>\u91cd\u8981\uff1a \u5728 Controller \u4e2d\u4e0d\u8981\u91cd\u590d\u4f7f\u7528 <code>@injectable</code>\uff0c\u56e0\u4e3a <code>@controller()</code> \u5df2\u7ecf\u81ea\u52a8\u5305\u542b\u4e86\u5b83\u3002</p>"},{"location":"zh/getting_started/#restful-api","title":"RESTful API \u88c5\u9970\u5668\uff08\u5feb\u901f\u8bf4\u660e\uff09","text":"<p>Cullinan \u63d0\u4f9b\u4e00\u7ec4 REST \u98ce\u683c\u7684\u88c5\u9970\u5668\uff0c\u7528\u4e8e\u5c06 Controller \u65b9\u6cd5\u7ed1\u5b9a\u5230 HTTP \u8def\u7531\uff1a</p> <ul> <li><code>get_api</code></li> <li><code>post_api</code></li> <li><code>patch_api</code></li> <li><code>delete_api</code></li> <li><code>put_api</code></li> </ul> <p>\u5173\u952e\u70b9\uff1a</p> <ul> <li>\u8fd9\u4e9b\u88c5\u9970\u5668\u5728\u6e90\u7801\u4e2d\u5b9a\u4e49\u4e3a <code>def get_api(**kwargs)</code> \u7b49\uff0c\u53ea\u63a5\u53d7\u5173\u952e\u5b57\u53c2\u6570\u3002</li> <li>\u5199\u6cd5 <code>@get_api('/user')</code> \u662f\u4e0d\u5408\u6cd5\u7684\uff0c\u4f1a\u5728\u5bfc\u5165\u6a21\u5757\u65f6\u629b\u51fa <code>TypeError</code>\u3002</li> <li>\u6b63\u786e\u5199\u6cd5\u5e94\u4e3a\uff1a<code>@get_api(url='/user')</code>\u3002</li> <li><code>url</code> \u53c2\u6570\u4f7f\u7528\u8f7b\u91cf\u7ea7\u6a21\u677f\u8bed\u6cd5\uff0c\u652f\u6301 <code>{param}</code> \u5360\u4f4d\u7b26\uff0c\u5e76\u4e0e\u65b9\u6cd5\u53c2\u6570\u4e00\u4e00\u5bf9\u5e94\uff1a</li> </ul> <pre><code>@controller(url='/api/users')\nclass UserController:\n    @get_api(url='/{user_id}')\n    def get_user(self, url_params):\n        user_id = url_params.get('user_id') if url_params else None\n        ...\n</code></pre> <p>\u5e38\u7528\u53c2\u6570\uff1a</p> <ul> <li><code>url</code>\uff1a\u8def\u7531\u8def\u5f84\uff08\u5b57\u7b26\u4e32\uff09\uff0c\u652f\u6301 <code>{param}</code> \u5360\u4f4d\u7b26\uff0c\u4f8b\u5982 <code>'/users/{user_id}'</code>\u3002</li> <li><code>query_params</code>\uff1a\u67e5\u8be2\u53c2\u6570\u540d\u79f0\u5217\u8868/\u5143\u7ec4\uff0c\u4f8b\u5982 <code>('page', 'size')</code>\u3002 \u5728\u5904\u7406\u5668\u4e2d\uff0c\u8fd9\u4e9b\u67e5\u8be2\u53c2\u6570\u901a\u8fc7\u5355\u4e2a <code>query_params</code> \u5b57\u5178\u53c2\u6570\u4f20\u5165\u3002</li> <li><code>body_params</code>\uff08\u4ec5 POST/PATCH\uff09\uff1a\u9700\u8981\u4ece JSON/form body \u4e2d\u89e3\u6790\u7684\u5b57\u6bb5\u540d\u79f0\u96c6\u5408\u3002\u5728\u5904\u7406\u5668\u4e2d\uff0c\u8fd9\u4e9b\u5b57\u6bb5\u901a\u8fc7\u5355\u4e2a <code>body_params</code> \u5b57\u5178\u53c2\u6570\u4f20\u5165\u3002</li> <li><code>file_params</code>\uff1a\u4e0a\u4f20\u6587\u4ef6\u5b57\u6bb5\u540d\u79f0\u5217\u8868\u3002</li> <li><code>headers</code>\uff1a\u5fc5\u987b\u5b58\u5728\u7684 HTTP \u8bf7\u6c42\u5934\u540d\u79f0\u5217\u8868\u3002</li> <li><code>get_request_body</code>\uff08\u4ec5 POST/PATCH\uff09\uff1a\u4e3a <code>True</code> \u65f6\uff0c\u4f1a\u5c06\u539f\u59cb\u8bf7\u6c42\u4f53\u4f5c\u4e3a\u53c2\u6570\u4f20\u5165\u65b9\u6cd5\u3002</li> </ul> <p>\u5178\u578b\u7ec4\u5408\u793a\u4f8b\uff1a</p> <pre><code>@controller(url='/api/users')\nclass UserController:\n    @get_api(url='/', query_params=('page', 'size'))\n    def list_users(self, query_params):\n        page = query_params.get('page') if query_params else None\n        size = query_params.get('size') if query_params else None\n        ...\n\n    @post_api(url='/', body_params=('name', 'email'))\n    def create_user(self, body_params):\n        name = body_params.get('name') if body_params else None\n        email = body_params.get('email') if body_params else None\n        ...\n</code></pre> <p>\u5982\u9700\u4e86\u89e3 URL \u6a21\u677f\u4e0e\u5404\u88c5\u9970\u5668\u53c2\u6570\u7684\u5b8c\u6574\u8bf4\u660e\uff0c\u8bf7\u53c2\u8003 <code>docs/zh/wiki/restful_api.md</code>\u3002</p>"},{"location":"zh/getting_started/#_9","title":"\u63a8\u8350\u7684\u4f9d\u8d56\u6ce8\u5165\u65b9\u5f0f","text":"<p>\u65b9\u5f0f\u4e00\uff1aInjectByName\uff08\u63a8\u8350\uff0c\u6700\u7b80\u5355\uff09</p> <p>\u6309\u540d\u79f0\u6ce8\u5165\uff0c\u65e0\u9700\u5bfc\u5165\u4f9d\u8d56\u7c7b\uff0c\u907f\u514d\u5faa\u73af\u5bfc\u5165\u95ee\u9898\uff1a</p> <pre><code>from cullinan.service import Service, service\nfrom cullinan.core import injectable, InjectByName\n\n@service\nclass DatabaseService(Service):\n    def query(self, sql):\n        return f\"Results for: {sql}\"\n\n@injectable\nclass UserRepository:\n    # \u63a8\u8350\uff1aInjectByName \u4e0d\u9700\u8981\u7c7b\u578b\u6ce8\u89e3\uff0c\u76f4\u63a5\u4f7f\u7528\u5b57\u7b26\u4e32\u540d\u79f0\n    db = InjectByName('DatabaseService')\n\n    def get_users(self):\n        return self.db.query(\"SELECT * FROM users\")\n</code></pre> <p>\u65b9\u5f0f\u4e8c\uff1aInject + TYPE_CHECKING\uff08\u652f\u6301 IDE \u8054\u60f3\uff09</p> <p>\u5982\u679c\u9700\u8981 IDE \u81ea\u52a8\u8865\u5168\u548c\u7c7b\u578b\u68c0\u67e5\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>Inject</code> \u914d\u5408 TYPE_CHECKING\uff1a</p> <pre><code>from typing import TYPE_CHECKING\nfrom cullinan.core import injectable, Inject\nfrom cullinan.service import Service, service\n\n# TYPE_CHECKING \u5757\u4e2d\u7684\u5bfc\u5165\u4e0d\u4f1a\u5728\u8fd0\u884c\u65f6\u6267\u884c\uff0c\u907f\u514d\u5faa\u73af\u5bfc\u5165\nif TYPE_CHECKING:\n    from cullinan.service import DatabaseService\n\n@service\nclass DatabaseService(Service):\n    def query(self, sql):\n        return f\"Results for: {sql}\"\n\n@injectable\nclass UserRepository:\n    # \u4f7f\u7528 TYPE_CHECKING \u5bfc\u5165\u7c7b\u578b\u540e\uff0c\u53ef\u4ee5\u83b7\u5f97 IDE \u8054\u60f3\u652f\u6301\n    db: 'DatabaseService' = Inject()\n\n    def get_users(self):\n        # IDE \u53ef\u4ee5\u63d0\u793a db.query \u65b9\u6cd5\n        return self.db.query(\"SELECT * FROM users\")\n</code></pre> <p>\u65b9\u5f0f\u4e09\uff1aInject + \u7eaf\u5b57\u7b26\u4e32\u6ce8\u89e3\uff08\u65e0 IDE \u8054\u60f3\uff09</p> <p>\u5982\u679c\u4e0d\u9700\u8981 IDE \u8054\u60f3\uff0c\u4e5f\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u5b57\u7b26\u4e32\u6ce8\u89e3\uff1a</p> <pre><code>from cullinan.core import injectable, Inject\n\n@injectable\nclass UserRepository:\n    # \u7eaf\u5b57\u7b26\u4e32\u6ce8\u89e3\uff0c\u65e0\u9700\u5bfc\u5165\uff0c\u4f46\u4e5f\u6ca1\u6709 IDE \u8054\u60f3\n    db: 'DatabaseService' = Inject()\n\n    def get_users(self):\n        return self.db.query(\"SELECT * FROM users\")\n</code></pre> <p>\u603b\u7ed3\uff1a - InjectByName\uff1a\u63a8\u8350\u7528\u4e8e\u5927\u591a\u6570\u573a\u666f\uff0c\u7b80\u5355\u76f4\u63a5\uff0c\u65e0\u9700\u7c7b\u578b\u6ce8\u89e3 - Inject + TYPE_CHECKING\uff1a\u9002\u5408\u9700\u8981 IDE \u8054\u60f3\u7684\u573a\u666f\uff0c\u5f00\u53d1\u4f53\u9a8c\u66f4\u597d - Inject + \u5b57\u7b26\u4e32\u6ce8\u89e3\uff1a\u6700\u7b80\u5355\u4f46\u65e0 IDE \u652f\u6301</p> <p>\u6709\u5173\u6ce8\u5165\u6a21\u5f0f\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 <code>docs/wiki/injection.md</code>\u3002</p>"},{"location":"zh/getting_started/#_10","title":"\u5e38\u89c1\u6a21\u5f0f","text":""},{"location":"zh/getting_started/#_11","title":"\u6dfb\u52a0\u4e2d\u95f4\u4ef6","text":"<pre><code>from cullinan.middleware import MiddlewareBase\n\nclass LoggingMiddleware(MiddlewareBase):\n    def process_request(self, request):\n        print(f\"Request: {request.method} {request.path}\")\n\n# \u5728\u5e94\u7528\u521d\u59cb\u5316\u671f\u95f4\u6ce8\u518c\napp.add_middleware(LoggingMiddleware())\n</code></pre>"},{"location":"zh/getting_started/#_12","title":"\u914d\u7f6e","text":"<pre><code>from cullinan.config import Config\n\nconfig = Config()\nconfig.set('database.url', 'postgresql://localhost/mydb')\nconfig.set('server.port', 8080)\n</code></pre>"},{"location":"zh/getting_started/#_13","title":"\u6545\u969c\u6392\u67e5","text":"<ul> <li>\u5982\u679c\u5b89\u88c5\u5305\u65f6\u51fa\u73b0\u9519\u8bef\uff0c\u8bf7\u786e\u4fdd Python \u548c pip \u5df2\u66f4\u65b0\uff0c\u5e76\u4e14\u80fd\u8bbf\u95ee PyPI\uff08\u7f51\u7edc\u6216\u4ee3\u7406\u8bbe\u7f6e\uff09\u3002</li> <li>\u5982\u679c\u5728\u8fd0\u884c PowerShell \u547d\u4ee4\u65f6\u9047\u5230\u6743\u9650\u95ee\u9898\uff0c\u8bf7\u68c0\u67e5 PowerShell \u7684\u6267\u884c\u7b56\u7565\u6216\u4ee5\u7ba1\u7406\u5458\u6743\u9650\u8fd0\u884c\u547d\u4ee4\u3002</li> </ul>"},{"location":"zh/getting_started/#_14","title":"\u4e0b\u4e00\u6b65","text":"<ul> <li>\u9605\u8bfb <code>docs/wiki/injection.md</code> \u4e86\u89e3 IoC/DI \u7ec6\u8282\u3002</li> <li>\u6d4f\u89c8 <code>examples/</code> \u76ee\u5f55\u67e5\u770b\u53ef\u8fd0\u884c\u793a\u4f8b\u3002</li> </ul>"},{"location":"zh/getting_started/#_15","title":"\u5176\u4ed6\u8d44\u6e90","text":"<ul> <li>\u67b6\u6784\uff1a\u53c2\u9605 <code>docs/architecture.md</code> \u4e86\u89e3\u7cfb\u7edf\u8bbe\u8ba1\u6982\u89c8</li> <li>\u7ec4\u4ef6\uff1a\u9605\u8bfb <code>docs/wiki/components.md</code> \u4e86\u89e3\u7ec4\u4ef6\u804c\u8d23</li> <li>\u751f\u547d\u5468\u671f\uff1a\u5728 <code>docs/wiki/lifecycle.md</code> \u4e2d\u5b66\u4e60\u5e94\u7528\u751f\u547d\u5468\u671f</li> <li>\u4e2d\u95f4\u4ef6\uff1a\u5728 <code>docs/wiki/middleware.md</code> \u4e2d\u7406\u89e3\u4e2d\u95f4\u4ef6</li> <li>API \u53c2\u8003\uff1a\u6d4f\u89c8 <code>docs/api_reference.md</code> \u67e5\u770b\u5b8c\u6574 API \u6587\u6863</li> <li>\u793a\u4f8b\uff1a\u63a2\u7d22 <code>examples/</code> \u76ee\u5f55\u83b7\u53d6\u66f4\u591a\u793a\u4f8b</li> </ul>"},{"location":"zh/getting_started/#_16","title":"\u793e\u533a\u4e0e\u652f\u6301","text":"<ul> <li>\u95ee\u9898\u53cd\u9988\uff1a\u5728 GitHub Issues \u62a5\u544a bug</li> <li>\u8d21\u732e\uff1a\u53c2\u9605 <code>docs/contributing.md</code> \u4e86\u89e3\u8d21\u732e\u6307\u5357</li> <li>\u6d4b\u8bd5\uff1a\u9605\u8bfb <code>docs/testing.md</code> \u4e86\u89e3\u6d4b\u8bd5\u6700\u4f73\u5b9e\u8df5</li> </ul>"},{"location":"zh/migration_guide/","title":"\u8fc1\u79fb\u6307\u5357","text":"<p>\u5360\u4f4d\uff1a\u8bb0\u5f55\u7834\u574f\u6027\u53d8\u66f4\u3001\u517c\u5bb9\u6027\u8bf4\u660e\u4e0e\u8fc1\u79fb\u6b65\u9aa4\u3002</p>"},{"location":"zh/testing/","title":"\u6d4b\u8bd5\u4e0e\u9a8c\u8bc1","text":"<p>\u672c\u6587\u8bf4\u660e\u5982\u4f55\u8fd0\u884c\u73b0\u6709\u6d4b\u8bd5\u96c6\u3001\u6dfb\u52a0\u65b0\u7684\u6d4b\u8bd5\u3001\u4f7f\u7528\u793a\u4f8b\u8fdb\u884c\u70df\u96fe\u6d4b\u8bd5\uff0c\u4ee5\u53ca\u5728 CI \u4e2d\u96c6\u6210\u6d4b\u8bd5\u6267\u884c\u3002\u793a\u4f8b\u547d\u4ee4\u8986\u76d6 Windows\uff08PowerShell\uff09\u3001Linux \u548c macOS\u3002</p>"},{"location":"zh/testing/#_2","title":"\u524d\u7f6e\u6761\u4ef6","text":"<ul> <li>Python 3.8 \u6216\u66f4\u9ad8\u7248\u672c</li> <li>Git</li> <li>\u5df2\u514b\u9686\u5e76\u53ef\u7528\u7684 Cullinan \u4ed3\u5e93\uff08\u73af\u5883\u51c6\u5907\u53ef\u53c2\u8003 <code>docs/build_run.md</code>\uff09</li> </ul>"},{"location":"zh/testing/#_3","title":"\u8fd0\u884c\u6d4b\u8bd5\u96c6","text":"<p>\u5728\u4ee5\u53ef\u7f16\u8f91\u6a21\u5f0f\u5b89\u88c5 Cullinan \u4e4b\u540e\uff08\u53c2\u89c1 <code>docs/build_run.md</code>\uff09\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>pytest</code> \u8fd0\u884c\u6d4b\u8bd5\u3002</p> <p>\u5728\u6240\u6709\u5e73\u53f0\u4e0a\uff1a</p> <pre><code>pytest -q\n</code></pre> <p>\u5982\u679c\u503e\u5411\u4e8e\u901a\u8fc7 Python \u6a21\u5757\u65b9\u5f0f\u8c03\u7528\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\uff1a</p> <pre><code>python -m pytest -q\n</code></pre> <p>\u5728 Windows \u4e0a\uff0c\u5e38\u89c1\u7684\u505a\u6cd5\u662f\u4f7f\u7528 <code>py</code> \u542f\u52a8\u5668\uff1a</p> <pre><code>py -3 -m pytest -q\n</code></pre>"},{"location":"zh/testing/#_4","title":"\u8fd0\u884c\u5355\u4e2a\u6d4b\u8bd5\u6a21\u5757","text":"<p>\u8981\u8fd0\u884c\u5355\u4e2a\u6d4b\u8bd5\u6587\u4ef6\uff08\u4f8b\u5982 <code>tests/test_core_injection.py</code>\uff09\uff1a</p> <p>\u5728\u6240\u6709\u5e73\u53f0\u4e0a\uff1a</p> <pre><code>pytest tests/test_core_injection.py -q\n</code></pre> <p>\u6216\u4f7f\u7528 Python \u6a21\u5757\u65b9\u5f0f\uff1a</p> <pre><code>python -m pytest tests/test_core_injection.py -q\n</code></pre>"},{"location":"zh/testing/#_5","title":"\u6dfb\u52a0\u65b0\u6d4b\u8bd5","text":"<p>\u5728\u4e3a\u65b0\u7279\u6027\u6216\u7f3a\u9677\u4fee\u590d\u6dfb\u52a0\u6d4b\u8bd5\u65f6\uff0c\u5efa\u8bae\u9075\u5faa\u4ee5\u4e0b\u539f\u5219\uff1a</p> <ol> <li>\u5c06\u6d4b\u8bd5\u6587\u4ef6\u653e\u7f6e\u5728 <code>tests/</code> \u76ee\u5f55\u4e0b\u3002</li> <li>\u4f7f\u7528\u5177\u6709\u63cf\u8ff0\u6027\u7684\u6d4b\u8bd5\u540d\u79f0\uff0c\u5e76\u5c06\u76f8\u5173\u6d4b\u8bd5\u7ec4\u7ec7\u5728\u540c\u4e00\u6a21\u5757\u4e2d\u3002</li> <li>\u4f18\u5148\u91c7\u7528 <code>pytest</code> \u98ce\u683c\u7684\u6d4b\u8bd5\uff08\u51fd\u6570\u6216\u6d4b\u8bd5\u7c7b\uff09\uff0c\u4e0e\u73b0\u6709\u6d4b\u8bd5\u96c6\u4fdd\u6301\u4e00\u81f4\u3002</li> <li>\u786e\u4fdd\u6d4b\u8bd5\u5177\u6709\u786e\u5b9a\u6027\uff0c\u4e0d\u4f9d\u8d56\u5916\u90e8\u670d\u52a1\uff0c\u9664\u975e\u660e\u786e\u6807\u6ce8\u3002</li> </ol>"},{"location":"zh/testing/#_6","title":"\u4f7f\u7528\u793a\u4f8b\u8fdb\u884c\u70df\u96fe\u6d4b\u8bd5","text":"<p>Cullinan \u5728 <code>examples/</code> \u76ee\u5f55\u4e0b\u63d0\u4f9b\u4e86\u53ef\u8fd0\u884c\u793a\u4f8b\uff0c\u53ef\u4f5c\u4e3a\u70df\u96fe\u6d4b\u8bd5\u4f7f\u7528\u3002</p>"},{"location":"zh/testing/#hello-http","title":"\u793a\u4f8b\uff1aHello HTTP","text":"<p>\u5728 Windows\uff08PowerShell\uff09\u4e2d\uff1a</p> <pre><code>python examples\\hello_http.py\n</code></pre> <p>\u5728 Linux / macOS \u4e2d\uff1a</p> <pre><code>python examples/hello_http.py\n</code></pre> <p>\u7136\u540e\u5728\u6d4f\u89c8\u5668\u4e2d\u8bbf\u95ee <code>http://localhost:4080/hello</code>\uff0c\u9a8c\u8bc1\u670d\u52a1\u662f\u5426\u6b63\u5e38\u54cd\u5e94\u3002</p>"},{"location":"zh/testing/#_7","title":"\u793a\u4f8b\uff1a\u4e2d\u95f4\u4ef6\u6f14\u793a","text":"<p>\u5728 Windows\uff08PowerShell\uff09\u4e2d\uff1a</p> <pre><code>python examples\\middleware_demo.py\n</code></pre> <p>\u5728 Linux / macOS \u4e2d\uff1a</p> <pre><code>python examples/middleware_demo.py\n</code></pre> <p>\u65e5\u5fd7\u8f93\u51fa\u5c06\u5c55\u793a\u4e2d\u95f4\u4ef6\u548c\u6ce8\u5165\u7684\u670d\u52a1\u5982\u4f55\u53c2\u4e0e\u8bf7\u6c42\u5904\u7406\u3002\u5177\u4f53\u65f6\u95f4\u6233\u548c ID \u4f1a\u56e0\u8fd0\u884c\u73af\u5883\u4e0d\u540c\u800c\u6709\u6240\u5dee\u5f02\u3002</p>"},{"location":"zh/testing/#ci","title":"\u5728 CI \u4e2d\u96c6\u6210\u6d4b\u8bd5","text":"<p>\u5728 CI \u6d41\u6c34\u7ebf\u4e2d\uff0c\u901a\u5e38\u9700\u8981\u6267\u884c\u4ee5\u4e0b\u6b65\u9aa4\uff1a</p> <ol> <li>\u51c6\u5907 Python \u8fd0\u884c\u73af\u5883\u3002</li> <li>\u4ee5\u53ef\u7f16\u8f91\u6a21\u5f0f\u5b89\u88c5\u4f9d\u8d56\uff08\u53ef\u9009\u5b89\u88c5\u5f00\u53d1\u989d\u5916\u4f9d\u8d56\uff09\u3002</li> <li>\u4f7f\u7528 <code>pytest</code> \u8fd0\u884c\u6d4b\u8bd5\u96c6\u3002</li> </ol> <p>bash \u98ce\u683c\u7684\u5178\u578b\u547d\u4ee4\u5e8f\u5217\uff08\u53ef\u6839\u636e CI \u7cfb\u7edf\u8fdb\u884c\u8c03\u6574\uff09\uff1a</p> <pre><code>python -m pip install -U pip\npip install -e .[dev]\npytest -q\n</code></pre> <p>\u5728\u57fa\u4e8e Windows \u7684 CI \u73af\u5883\u4e2d\u4f7f\u7528 PowerShell \u65f6\uff0c\u53ef\u4f7f\u7528\u7c7b\u4f3c\u547d\u4ee4\uff1a</p> <pre><code>python -m pip install -U pip\npip install -e .[dev]\npy -3 -m pytest -q\n</code></pre> <p>\u53ef\u6839\u636e CI \u63d0\u4f9b\u5546\u4e0e\u5177\u4f53\u73af\u5883\u8c03\u6574\u547d\u4ee4\u4e0e\u9009\u9879\u3002</p>"},{"location":"zh/modules/app/","title":"cullinan.app","text":"<p>\u6458\u8981\uff1a<code>cullinan.app</code> \u6a21\u5757\u6587\u6863\u5360\u4f4d\u3002\u63cf\u8ff0\u5165\u53e3\u70b9\u4ee5\u53ca\u5982\u4f55\u521b\u5efa\u5e94\u7528\u5b9e\u4f8b\u3002</p> <p>\u5efa\u8bae\u8bb0\u5f55\u7684\u516c\u6709\u7b26\u53f7\uff1aApp\uff0cmain\uff08\u5982\u5b58\u5728\uff09</p>"},{"location":"zh/modules/app/#api","title":"\u516c\u5171 API\uff08\u81ea\u52a8\u751f\u6210\uff09","text":""},{"location":"zh/modules/app/#cullinanapp_1","title":"cullinan.app","text":"\u540d\u79f0 \u7c7b\u578b \u7b7e\u540d / \u503c <code>CullinanApplication</code> class <code>CullinanApplication(shutdown_timeout: int = 30)</code> <code>create_app</code> function <code>create_app(shutdown_timeout: int = 30) -&gt; cullinan.app.CullinanApplication</code>"},{"location":"zh/modules/app/#_1","title":"\u793a\u4f8b\uff1a\u521b\u5efa\u5e76\u8fd0\u884c\u5e94\u7528","text":"<pre><code># \u5feb\u901f\uff08\u63a8\u8350\uff09: \u5728\u5165\u53e3\u811a\u672c\u4f7f\u7528 framework \u5165\u53e3\u51fd\u6570\nfrom cullinan import application\n\nif __name__ == '__main__':\n    application.run()\n\n# \u9ad8\u7ea7\uff08\u53ef\u9009\uff09: \u7f16\u7a0b\u5316\u63a7\u5236\uff08\u4f8b\u5982\u5728\u6d4b\u8bd5\u6216\u9700\u8981\u6dfb\u52a0\u5173\u95ed\u5904\u7406\u5668\u65f6\uff09\nfrom cullinan.app import create_app\n\napplication_instance = create_app()\n# \u73b0\u5728\u53ef\u4ee5\u4ee5\u7f16\u7a0b\u65b9\u5f0f\u8c03\u7528 application_instance.startup()/application_instance.shutdown() \u6216 application_instance.add_shutdown_handler(...)\n# application_instance.run()  # \u5728 CLI \u5165\u53e3\u8c03\u7528\n</code></pre> <p>\u8bf4\u660e\uff1a<code>CullinanApplication.run()</code> \u4f1a\u6ce8\u518c\u4fe1\u53f7\u5904\u7406\u5668\u5e76\u542f\u52a8 Tornado \u7684 IOLoop\uff1b\u5728 CLI \u5165\u53e3\u8c03\u7528\u3002\u6d4b\u8bd5\u6216\u7a0b\u5e8f\u5316\u63a7\u5236\u8bf7\u7528 <code>create_app()</code> \u521b\u5efa\u5b9e\u4f8b\u3002</p>"},{"location":"zh/modules/application/","title":"cullinan.application","text":"<p>\u6458\u8981\uff1a<code>cullinan.application</code> \u6a21\u5757\u6587\u6863\u5360\u4f4d\u3002\u5305\u542b\u516c\u6709\u7c7b\u3001\u5178\u578b\u7528\u6cd5\uff0c\u53ca\u76f8\u5173\u6d4b\u8bd5/\u793a\u4f8b\u94fe\u63a5\u3002</p> <p>\u5efa\u8bae\u8bb0\u5f55\u7684\u516c\u6709\u7b26\u53f7\uff1aApplication\uff0cstart\uff0cstop</p> <p>\u793a\u4f8b\u7528\u6cd5\uff1a</p> <p>\uff08\u5360\u4f4d\uff1a\u5c55\u793a\u5178\u578b Application \u4f7f\u7528\u7684\u6700\u5c0f\u4ee3\u7801\u7247\u6bb5\uff09</p>"},{"location":"zh/modules/application/#_1","title":"\u793a\u4f8b","text":""},{"location":"zh/modules/application/#hello-http","title":"Hello HTTP\uff08\u70df\u96fe\u6d4b\u8bd5\u793a\u4f8b\uff09","text":"<p>\u4ed3\u5e93\u5305\u542b\u4e00\u4e2a\u6700\u5c0f\u793a\u4f8b <code>examples/hello_http.py</code>\uff0c\u7528\u4e8e\u6587\u6863\u4e2d\u7684\u70df\u96fe\u6d4b\u8bd5\u3002\u8be5\u793a\u4f8b\u4e0d\u4f7f\u7528 <code>application.run()</code>\uff0c\u800c\u662f\u76f4\u63a5\u901a\u8fc7 Cullinan \u7684 handler registry \u6ce8\u518c\u4e00\u4e2a\u7b80\u5355\u7684 Tornado \u5904\u7406\u5668\uff0c\u542f\u52a8\u4e00\u4e2a\u77ed\u65f6 HTTP \u670d\u52a1\u5668\uff0c\u53d1\u8d77\u4e00\u6b21\u9a8c\u8bc1\u8bf7\u6c42\uff0c\u7136\u540e\u9000\u51fa\u3002</p> <p>\u6ce8\u610f\uff1a\u6b64\u793a\u4f8b\u7684\u8f93\u51fa\u4e0e\u4f7f\u7528 <code>application.run()</code> \u542f\u52a8\u7684\u5e38\u89c4\u5e94\u7528\u4e0d\u540c\u3002<code>application.run()</code> \u4f1a\u663e\u793a Cullinan \u6846\u67b6 banner\u3001\u626b\u63cf\u670d\u52a1\u548c\u63a7\u5236\u5668\uff0c\u5e76\u4fdd\u6301\u670d\u52a1\u5668\u8fd0\u884c\u76f4\u5230\u624b\u52a8\u505c\u6b62\uff08Ctrl+C\uff09\u3002</p> <p>PowerShell\uff08Windows\uff09\u8fd0\u884c\u547d\u4ee4\uff1a</p> <pre><code>pip install -U pip\npip install cullinan tornado\npython examples\\hello_http.py\n</code></pre> <p>\u89c2\u5bdf\u5230\u7684\u8f93\u51fa\uff08\u8282\u9009\uff09\uff1a</p> <pre><code>INFO:__main__:Starting IOLoop... (will stop after one verification request)\nINFO:__main__:Async Requesting http://127.0.0.1:4080/hello\nINFO:tornado.access:200 GET /hello (127.0.0.1) 0.50ms\nINFO:__main__:Response status: 200\nINFO:__main__:Response body: Hello Cullinan\nINFO:__main__:IOLoop stopped, exiting\n</code></pre> <p>\u8bf4\u660e\uff1a\u8be5\u793a\u4f8b\u9002\u5408\u7528\u4f5c\u6587\u6863\u6216 CI \u7684\u70df\u96fe\u6d4b\u8bd5\uff08\u542f\u52a8\u3001\u9a8c\u8bc1\u8bf7\u6c42\u3001\u9000\u51fa\uff09\uff0c\u4f46\u4e0d\u4ee3\u8868 <code>application.run()</code> \u7684\u5b9e\u9645\u884c\u4e3a\u3002</p>"},{"location":"zh/modules/controller/","title":"cullinan.controller","text":"<p>\u6458\u8981\uff1a\u63a7\u5236\u5668\u6ce8\u518c\u3001\u751f\u547d\u5468\u671f\u4e0e\u6ce8\u5165\u5230\u63a7\u5236\u5668\u5b9e\u4f8b\u7684\u673a\u5236\u3002\u8bb0\u5f55\u4f7f\u7528\u6a21\u5f0f\u4e0e\u5e38\u89c1\u9677\u9631\u3002</p>"},{"location":"zh/modules/controller/#api","title":"\u516c\u5171 API\uff08\u81ea\u52a8\u751f\u6210\uff09","text":""},{"location":"zh/modules/controller/#cullinancontroller_1","title":"cullinan.controller","text":"\u540d\u79f0 \u7c7b\u578b \u7b7e\u540d / \u503c <code>ControllerRegistry</code> class <code>ControllerRegistry()</code> <code>EncapsulationHandler</code> class <code>EncapsulationHandler()</code> <code>Handler</code> class <code>Handler(application: 'Application', request: tornado.httputil.HTTPServerRequest, **kwargs: Any) -&gt; None</code> <code>HeaderRegistry</code> class <code>HeaderRegistry()</code> <code>HttpResponse</code> class <code>HttpResponse() -&gt; None</code> <code>ResponsePool</code> class <code>ResponsePool(size: int = 100)</code> <code>StatusResponse</code> class <code>StatusResponse(**kwargs) -&gt; None</code> <code>controller</code> function <code>controller(**kwargs) -&gt; Callable</code> <code>delete_api</code> function <code>delete_api(**kwargs: Any) -&gt; Callable</code> <code>disable_response_pooling</code> function <code>disable_response_pooling() -&gt; None</code> <code>emit_access_log</code> function <code>emit_access_log(request: Any, resp_obj: Optional[Any], status_code: Optional[int], duration: float) -&gt; None</code> <code>enable_response_pooling</code> function <code>enable_response_pooling(pool_size: int = 100) -&gt; None</code> <code>get_api</code> function <code>get_api(**kwargs: Any) -&gt; Callable</code> <code>get_controller_registry</code> function <code>get_controller_registry() -&gt; cullinan.controller.registry.ControllerRegistry</code> <code>get_header_registry</code> function <code>get_header_registry() -&gt; cullinan.controller.core.HeaderRegistry</code> <code>get_missing_header_handler</code> function <code>get_missing_header_handler() -&gt; Callable[[Any, str], NoneType]</code> <code>get_pooled_response</code> function <code>get_pooled_response() -&gt; cullinan.controller.core.HttpResponse</code> <code>get_response_pool_stats</code> function <code>get_response_pool_stats() -&gt; Optional[dict]</code> <code>header_resolver</code> function <code>header_resolver(self, header_names: Optional[Sequence] = None) -&gt; Optional[dict]</code> <code>patch_api</code> function <code>patch_api(**kwargs: Any) -&gt; Callable</code> <code>post_api</code> function <code>post_api(**kwargs: Any) -&gt; Callable</code> <code>put_api</code> function <code>put_api(**kwargs: Any) -&gt; Callable</code> <code>request_handler</code> function <code>request_handler(self, func: Callable, params: Tuple, headers: Optional[dict], type: str, get_request_body: bool = False) -&gt; None</code> <code>request_resolver</code> function <code>request_resolver(self, url_param_key_list: Optional[Sequence] = None, url_param_value_list: Optional[Sequence] = None, query_param_names: Optional[Sequence] = None, body_param_names: Optional[Sequence] = None, file_param_key_list: Optional[Sequence] = None) -&gt; Tuple[Optional[dict], Optional[dict], Optional[dict], Optional[dict]]</code> <code>reset_controller_registry</code> function <code>reset_controller_registry() -&gt; None</code> <code>response</code> class <code>response()</code> <code>response_build</code> function <code>response_build(**kwargs) -&gt; cullinan.controller.core.StatusResponse</code> <code>return_pooled_response</code> function <code>return_pooled_response(resp: cullinan.controller.core.HttpResponse) -&gt; None</code> <code>set_missing_header_handler</code> function <code>set_missing_header_handler(handler: Callable[[Any, str], NoneType])</code> <code>url_resolver</code> function <code>url_resolver(url: str) -&gt; Tuple[str, list]</code>"},{"location":"zh/modules/controller/#_1","title":"\u793a\u4f8b\uff1a\u6ce8\u518c\u4e00\u4e2a\u7b80\u5355\u63a7\u5236\u5668","text":"<pre><code>from cullinan.controller import controller, get_controller_registry\n\n@controller(path='/hello')\ndef hello(request):\n    return {'status': 200, 'body': 'Hello World'}\n\n# \u53ef\u9009\uff1a\u76f4\u63a5\u6ce8\u518c\u5230 registry\uff08\u901a\u5e38\u7531\u6a21\u5757\u626b\u63cf\u81ea\u52a8\u53d1\u73b0\uff09\nregistry = get_controller_registry()\nregistry.register(r'/hello', hello)\n</code></pre> <p>\u8bf4\u660e\uff1a - \u4f7f\u7528 <code>controller</code> \u88c5\u9970\u5668\u6ce8\u518c\u8def\u7531\u5904\u7406\u5668\uff1b\u6846\u67b6\u652f\u6301\u6a21\u5757\u626b\u63cf\u81ea\u52a8\u53d1\u73b0\u6216\u663e\u5f0f\u6ce8\u518c\u3002 - \u82e5\u5904\u7406\u5668\u9700\u8981\u4f9d\u8d56\u6ce8\u5165\uff0c\u8bf7\u4f7f\u7528 <code>@injectable</code> \u7c7b\u6216\u5c5e\u6027\u6ce8\u5165\u5e76\u786e\u4fdd\u5728\u5e94\u7528\u542f\u52a8\u524d\u5df2\u6ce8\u518c\u76f8\u5e94 provider\u3002</p>"},{"location":"zh/modules/core/","title":"cullinan.core","text":"<p>\u6458\u8981\uff1a\u6838\u5fc3 IoC/DI \u539f\u8bed\uff0cprovider\u3001scope\u3001registry \u4e0e\u751f\u547d\u5468\u671f\u5e2e\u52a9\u5668\u3002\u672c\u9875\u5e94\u5f15\u7528 <code>cullinan/core/</code> \u4e0b\u7684\u5177\u4f53\u6587\u4ef6\u5e76\u5305\u542b\u4f7f\u7528\u793a\u4f8b\u3002</p> <p>\u5efa\u8bae\u8bb0\u5f55\u7684\u516c\u6709\u7b26\u53f7\uff1aprovider\u3001registry\u3001scope\u3001\u6ce8\u5165\u76f8\u5173 API</p>"},{"location":"zh/modules/core/#_1","title":"\u793a\u4f8b","text":"<p>\u5c5e\u6027\u6ce8\u5165\u793a\u4f8b\uff08\u8bf7\u6c42\u4f5c\u7528\u57df\u7684 provider\uff09\uff1a</p> <pre><code>from cullinan.core import (\n    ProviderRegistry, ScopedProvider, get_request_scope,\n    injectable, Inject, get_injection_registry, reset_injection_registry\n)\n\nclass Database:\n    def __init__(self):\n        self.id = object()\n\nreset_injection_registry()\nregistry = ProviderRegistry()\nrequest_scope = get_request_scope()\nregistry.register_provider('Database', ScopedProvider(lambda: Database(), request_scope, 'Database'))\nget_injection_registry().add_provider_registry(registry)\n\n@injectable\nclass Service:\n    db: Database = Inject()\n\ns = Service()\nassert s.db is not None\n</code></pre> <p>\u6784\u9020\u5668\u6ce8\u5165\u793a\u4f8b\uff1a</p> <pre><code>from cullinan.core import inject_constructor, reset_injection_registry, ProviderRegistry, ScopedProvider, get_request_scope, get_injection_registry\n\nclass Config:\n    pass\n\nreset_injection_registry()\npr = ProviderRegistry()\npr.register_provider('Config', ScopedProvider(lambda: Config(), get_request_scope(), 'Config'))\nget_injection_registry().add_provider_registry(pr)\n\n@inject_constructor\nclass Controller:\n    def __init__(self, config: Config):\n        self.config = config\n\nc = Controller()\nassert c.config is not None\n</code></pre> <p>\u8bf4\u660e\uff1a - \u5728\u6d4b\u8bd5/\u8bbe\u7f6e\u4e2d\u4f7f\u7528 <code>reset_injection_registry()</code> \u4ee5\u786e\u4fdd\u6ce8\u5165\u72b6\u6001\u5e72\u51c0\u3002 - \u5bf9\u4e8e\u5c5e\u6027\u6ce8\u5165\u4f18\u5148\u4f7f\u7528 <code>@injectable</code>\uff0c\u9700\u8981\u6784\u9020\u5668\u6ce8\u5165\u65f6\u4f7f\u7528 <code>@inject_constructor</code>\u3002\u786e\u4fdd\u5728\u89e3\u6790\u6ce8\u5165\u524d ProviderRegistry \u4e2d\u5df2\u6ce8\u518c\u76f8\u5e94\u63d0\u4f9b\u8005\u3002</p>"},{"location":"zh/modules/service/","title":"cullinan.service","text":"<p>\u6458\u8981\uff1a\u670d\u52a1\u6ce8\u518c\u4e0e\u63d0\u4f9b\u8005\u6a21\u5f0f\u3002\u8bb0\u5f55\u670d\u52a1\u5982\u4f55\u88ab\u63d0\u4f9b\u3001\u4f5c\u7528\u57df\u53ca\u6ce8\u5165\u65b9\u5f0f\u3002</p>"},{"location":"zh/modules/service/#api","title":"\u516c\u5171 API\uff08\u81ea\u52a8\u751f\u6210\uff09","text":""},{"location":"zh/modules/service/#cullinanservice_1","title":"cullinan.service","text":"\u540d\u79f0 \u7c7b\u578b \u7b7e\u540d / \u503c <code>Service</code> class <code>Service()</code> <code>ServiceRegistry</code> class <code>ServiceRegistry()</code> <code>get_service_registry</code> function <code>get_service_registry() -&gt; cullinan.service.registry.ServiceRegistry</code> <code>reset_service_registry</code> function <code>reset_service_registry() -&gt; None</code> <code>service</code> function <code>service(cls: Optional[Type[cullinan.service.base.Service]] = None, *, dependencies: Optional[List[str]] = None)</code>"},{"location":"zh/modules/service/#_1","title":"\u8bf4\u660e\u4e0e\u793a\u4f8b","text":"<p>\u5360\u4f4d\uff1a\u63cf\u8ff0 Service \u7684\u6ce8\u518c\u3001\u5178\u578b <code>@service</code> \u7528\u6cd5\uff0c\u4ee5\u53ca\u5982\u4f55\u4ece registry \u83b7\u53d6\u6216\u91cd\u7f6e service registry\uff1b\u7ed9\u51fa\u6700\u5c0f\u793a\u4f8b\u8bf4\u660e\u5982\u4f55\u58f0\u660e\u4e00\u4e2a Service \u5e76\u4ece registry \u4e2d\u68c0\u7d22\u5b83\u3002</p>"},{"location":"zh/modules/service/#_2","title":"\u793a\u4f8b\uff1a\u6ce8\u518c\u5e76\u4f7f\u7528\u670d\u52a1","text":"<pre><code>from cullinan.service import Service, service, get_service_registry\n\n@service\nclass DatabaseService(Service):\n    def __init__(self):\n        self.connection = \"db_connection_mock\"\n\n    def query(self, sql):\n        return f\"Result for: {sql}\"\n\n# \u670d\u52a1\u901a\u8fc7 @service \u88c5\u9970\u5668\u81ea\u52a8\u6ce8\u518c\nregistry = get_service_registry()\ndb_service = registry.get('DatabaseService')\nresult = db_service.query(\"SELECT * FROM users\")\nprint(result)  # \u8f93\u51fa: Result for: SELECT * FROM users\n</code></pre> <p>\u8bf4\u660e\uff1a - \u4f7f\u7528 <code>@service</code> \u88c5\u9970\u5668\u5728\u6a21\u5757\u626b\u63cf\u6216\u663e\u5f0f\u521d\u59cb\u5316\u65f6\u81ea\u52a8\u6ce8\u518c\u670d\u52a1\u3002 - \u670d\u52a1\u901a\u5e38\u4e3a\u957f\u671f\u8fd0\u884c\uff08\u9ed8\u8ba4\u5355\u4f8b\u4f5c\u7528\u57df\uff0c\u9664\u975e\u53e6\u884c\u914d\u7f6e\uff09\u3002 - \u901a\u8fc7 <code>get_service_registry()</code> \u8bbf\u95ee\u670d\u52a1\uff0c\u6216\u5728 controller/handler \u4e2d\u901a\u8fc7 DI \u6ce8\u5165\u4f7f\u7528\u3002</p>"},{"location":"zh/templates/front_matter_example/","title":"Front-matter \u793a\u4f8b\uff08\u6a21\u677f\uff09","text":"<p>\u5c06\u4ee5\u4e0b\u5757\u653e\u5728\u6bcf\u4e2a\u516c\u5f00\u6587\u6863\u7684\u9876\u90e8\uff08\u66ff\u6362\u503c\uff09\uff1a</p> <pre><code>title: \"&lt;\u7b80\u77ed\u6807\u9898&gt;\"\nslug: \"&lt;\u8def\u5f84\u53cb\u597d slug&gt;\"\nmodule: [\"cullinan.core\"]\ntags: [\"getting-started\", \"ioc\"]\nauthor: \"\u59d3\u540d &lt;github&gt;\"\nreviewers: [\"\u59d3\u540d &lt;github&gt;\"]\nstatus: draft\nlocale: zh\ntranslation_pair: \"docs/&lt;file&gt;.md\"\nrelated_tests: [\"tests/test_real_app_startup.py\"]\nrelated_examples: [\"examples/hello_http.py\"]\nestimate_pd: 2.0\nlast_updated: \"2025-11-18T00:00:00Z\"\npr_links: []\n</code></pre> <p>\u8bf4\u660e\uff1a\u4fdd\u6301\u8be5\u5757\u7b80\u6d01\uff0c\u4fbf\u4e8e\u673a\u5668\u89e3\u6790\u3002</p>"},{"location":"zh/templates/front_matter_example/#front-matter-example","title":"Front matter example","text":"<pre><code>title: \"Front matter example\"\nslug: \"front-matter-example\"\nmodule: []\ntags: [\"template\"]\nauthor: \"Plumeink\"\nreviewers: []\nstatus: draft\nlocale: zh\ntranslation_pair: \"docs/templates/front_matter_example.md\"\nrelated_tests: []\nrelated_examples: []\nestimate_pd: 0.1\nlast_updated: \"2025-11-18T00:00:00Z\"\npr_links: []\n</code></pre>"},{"location":"zh/templates/page_template/","title":"&lt;\u7b80\u77ed\u6807\u9898&gt;","text":"<p>\u76ee\u7684\uff1a\u7b80\u8981\u8bf4\u660e\u6b64\u6587\u6863\u8986\u76d6\u7684\u5185\u5bb9\u3002</p> <p>\u524d\u7f6e\u6761\u4ef6\uff1a - \u5217\u51fa\u524d\u7f6e\u5de5\u5177\u4e0e\u7248\u672c\u3002</p> <p>\u5feb\u901f\u793a\u4f8b\uff1a</p> <pre><code># \u6700\u5c0f\u793a\u4f8b\uff0c\u5c55\u793a\u5e38\u7528\u7528\u6cd5\n</code></pre> <p>\u7ae0\u8282\u5efa\u8bae\uff1a - \u6458\u8981 - \u516c\u5171 API\uff08\u5982\u9002\u7528\uff09 - \u793a\u4f8b - \u6545\u969c\u6392\u67e5 - \u4e0b\u4e00\u6b65 / \u76f8\u5173\u6587\u6863</p>"},{"location":"zh/wiki/architecture/","title":"\u67b6\u6784\u6982\u8ff0","text":"<p>\u5360\u4f4d\uff1a\u67b6\u6784\u56fe\u3001\u7ec4\u4ef6\u804c\u8d23\u3001\u542f\u52a8\u4e0e\u8bf7\u6c42\u751f\u547d\u5468\u671f\u3001\u6a21\u5757\u4ea4\u4e92\u5730\u56fe\u3002</p> <p>\u8bf7\u53c2\u89c1 <code>docs/wiki/architecture.md</code>\uff08\u82f1\u6587\uff09\u83b7\u53d6\u5b8c\u6574\u7ec6\u8282\u3002</p>","tags":["architecture","ioc","design"]},{"location":"zh/wiki/components/","title":"\u7ec4\u4ef6","text":"<p>\u672c\u6587\u4ecb\u7ecd Cullinan \u7684\u4e3b\u8981\u7ec4\u4ef6\u53ca\u5176\u804c\u8d23\uff0c\u5e76\u7ed9\u51fa\u5b9e\u73b0\u4ee3\u7801\u7684\u6307\u5411\uff08<code>cullinan/</code> \u5305\uff09\u3002\u76ee\u6807\u662f\u4e3a\u8d21\u732e\u8005\u4e0e\u4f7f\u7528\u8005\u63d0\u4f9b\u4e00\u4e2a\u7b80\u660e\u7d22\u5f15\uff0c\u65b9\u4fbf\u5b9a\u4f4d\u6e90\u7801\u5b50\u7cfb\u7edf\u3002</p> <p>\u7ec4\u4ef6\u6982\u89c8</p> <ul> <li>\u8def\u7531 / URL \u89e3\u6790\u5668</li> <li>\u804c\u8d23\uff1a\u5c06 URL \u6a21\u5f0f\u89e3\u6790\u4e3a\u63a7\u5236\u5668\u5904\u7406\u51fd\u6570\u5e76\u5206\u53d1\u8bf7\u6c42\u3002</li> <li>\u5173\u952e\u6587\u4ef6\uff1a<code>cullinan/controller/core.py</code>\u3001<code>cullinan/controller/registry.py</code>\u3001<code>cullinan/controller/__init__.py</code>\u3002</li> <li> <p>\u516c\u6709\u7b26\u53f7\uff1a<code>controller</code>\uff08\u88c5\u9970\u5668\uff09\u3001<code>get_controller_registry</code>\u3001<code>url_resolver</code>\u3002</p> </li> <li> <p>\u63a7\u5236\u5668\u5c42</p> </li> <li>\u804c\u8d23\uff1a\u5b9a\u4e49\u63a7\u5236\u5668\u7c7b\u4e0e\u5904\u7406\u5668\u65b9\u6cd5\uff1b\u63d0\u4f9b\u8bf7\u6c42/\u54cd\u5e94\u62bd\u8c61\u4e0e\u54cd\u5e94\u6c60\u5de5\u5177\u3002</li> <li>\u5173\u952e\u6587\u4ef6\uff1a<code>cullinan/controller/core.py</code>\u3001<code>cullinan/controller/registry.py</code>\u3001<code>cullinan/controller/stateless_validator.py</code>\u3002</li> <li> <p>\u516c\u6709\u7b26\u53f7\uff1a<code>Handler</code>\u3001<code>ControllerRegistry</code>\u3001<code>response_build</code>\u3001<code>request_resolver</code>\u3002</p> </li> <li> <p>\u8bf7\u6c42\u5904\u7406\u4e0e HTTP \u96c6\u6210</p> </li> <li>\u804c\u8d23\uff1a\u628a Tornado \u7684 <code>HTTPServerRequest</code> \u9002\u914d\u4e3a\u63a7\u5236\u5668\u5904\u7406\u5668\uff0c\u7ba1\u7406\u8bf7\u6c42\u89e3\u6790\u4e0e\u5934\u90e8\u89e3\u6790\u3002</li> <li>\u5173\u952e\u6587\u4ef6\uff1a<code>cullinan/handler/*</code>\u3001<code>cullinan/controller/core.py</code>\u3002</li> <li> <p>\u516c\u6709\u7b26\u53f7\uff1a<code>get_handler_registry</code>\u3001<code>request_handler</code>\u3002</p> </li> <li> <p>\u4e2d\u95f4\u4ef6</p> </li> <li>\u804c\u8d23\uff1a\u63d0\u4f9b\u8bf7\u6c42/\u54cd\u5e94\u5904\u7406\u7684\u62e6\u622a\u70b9\uff0c\u5982\u8ba4\u8bc1\u3001\u65e5\u5fd7\u6216\u53d8\u6362\u3002</li> <li>\u5173\u952e\u6587\u4ef6\uff1a<code>cullinan/middleware/*</code>\u3002</li> <li> <p>\u8bf4\u660e\uff1a\u4e2d\u95f4\u4ef6\u6309\u6d41\u6c34\u7ebf\u5e94\u7528\uff1b\u8be6\u89c1 <code>middleware</code> \u76ee\u5f55\u4e2d\u7684\u6837\u4f8b\u4e0e\u987a\u5e8f\u8bed\u4e49\u3002</p> </li> <li> <p>\u670d\u52a1\uff08\u4e1a\u52a1\u5c42\uff09</p> </li> <li>\u804c\u8d23\uff1a\u4e3a\u63a7\u5236\u5668\u63d0\u4f9b\u957f\u671f\u8fd0\u884c\u7684\u670d\u52a1\uff08\u6570\u636e\u5e93\u8bbf\u95ee\u3001\u7f13\u5b58\u3001\u540e\u53f0\u4efb\u52a1\u7b49\uff09\u3002</li> <li>\u5173\u952e\u6587\u4ef6\uff1a<code>cullinan/service/*</code>\uff08base\u3001decorators\u3001registry\uff09\u3002</li> <li> <p>\u516c\u6709\u7b26\u53f7\uff1a<code>Service</code>\u3001<code>ServiceRegistry</code>\u3001<code>service</code>\uff08\u88c5\u9970\u5668\uff09\u3001<code>get_service_registry</code>\u3002</p> </li> <li> <p>\u6838\u5fc3\uff08IoC / DI / \u751f\u547d\u5468\u671f / provider / scope\uff09</p> </li> <li>\u804c\u8d23\uff1a\u4f9d\u8d56\u6ce8\u5165\u3001\u63d0\u4f9b\u8005\u6ce8\u518c\u3001\u4f5c\u7528\u57df\uff08singleton/transient/request\uff09\u3001\u751f\u547d\u5468\u671f\u7ba1\u7406\u3002</li> <li>\u5173\u952e\u6587\u4ef6\uff1a<code>cullinan/core/*</code>\uff08<code>injection.py</code>\u3001<code>provider.py</code>\u3001<code>registry.py</code>\u3001<code>scope.py</code>\u3001<code>lifecycle*.py</code>\uff09\u3002</li> <li> <p>\u516c\u6709\u7b26\u53f7\uff1a<code>Inject</code>\u3001<code>injectable</code>\u3001<code>inject_constructor</code>\u3001<code>InjectionRegistry</code>\u3001<code>ProviderRegistry</code>\u3001<code>SingletonScope</code>\u3001<code>RequestScope</code>\u3001<code>create_context</code>\u3002</p> </li> <li> <p>\u5e94\u7528 / \u542f\u52a8</p> </li> <li>\u804c\u8d23\uff1a\u5e94\u7528\u751f\u547d\u5468\u671f\u3001\u670d\u52a1\u53d1\u73b0\u4e0e\u521d\u59cb\u5316\u3001\u6709\u5e8f\u7684\u542f\u52a8/\u5173\u95ed\u4e0e\u4fe1\u53f7\u5904\u7406\u3002</li> <li>\u5173\u952e\u6587\u4ef6\uff1a<code>cullinan/app.py</code>\u3001<code>cullinan/application.py</code>\u3002</li> <li>\u516c\u6709\u7b26\u53f7\uff1a<code>create_app</code>\u3001<code>CullinanApplication</code>\u3001<code>run</code>\uff08\u5e94\u7528\u5165\u53e3\uff09\u3002</li> </ul> <p>\u793a\u4f8b \u2014 \u5feb\u901f\u53c2\u8003</p> <p>\u6700\u5c0f\u7684\u63a7\u5236\u5668\u6ce8\u518c\u793a\u4f8b\uff08\u6982\u5ff5\u6027\uff09\uff1a</p> <pre><code>from cullinan.controller import controller, get_controller_registry\n\n@controller(path='/hello')\ndef hello_handler(request):\n    return {'status': 200, 'body': 'Hello Cullinan'}\n\n# \u63a7\u5236\u5668\u88ab\u626b\u63cf\u6216\u6ce8\u518c\uff1b\u5e94\u7528\u4f1a\u5c06 /hello \u8def\u7531\u5230 hello_handler\n</code></pre> <p>\u6700\u5c0f\u7684\u670d\u52a1\u793a\u4f8b\uff08\u6982\u5ff5\u6027\uff09\uff1a</p> <pre><code>from cullinan.service import Service, service, get_service_registry\n\n@service\ndef MySvc():\n    # \u6ce8\u518c\u670d\u52a1\n    pass\n\nsvc_registry = get_service_registry()\n</code></pre> <p>\u63a5\u4e0b\u6765\u5e94\u67e5\u770b\u7684\u5730\u65b9</p> <ul> <li>\u9605\u8bfb <code>tests/</code> \u4e0b\u7684\u6d4b\u8bd5\u4ee5\u83b7\u53d6\u771f\u5b9e\u7528\u6cd5\u4e0e\u671f\u671b\u884c\u4e3a\uff1a\u63a8\u8350\u8d77\u70b9 <code>tests/test_core_injection.py</code>\u3001<code>tests/test_controller_injection_fix.py</code>\u3001<code>tests/test_provider_system.py</code>\u3002</li> <li>\u9605\u8bfb <code>docs/wiki/injection.md</code> \u4ee5\u83b7\u53d6 IoC/DI \u7684\u8be6\u7ec6\u793a\u4f8b\u4e0e\u53ef\u8fd0\u884c\u7247\u6bb5\u3002</li> </ul> <p>\u6587\u6863\u4e0b\u4e00\u6b65</p> <ul> <li>\u6269\u5c55\u6bcf\u4e2a\u7ec4\u4ef6\u5c0f\u8282\uff0c\u52a0\u5165\u65f6\u5e8f\u56fe\u4e0e\u4ece\u6d4b\u8bd5\u4e2d\u63d0\u53d6\u7684\u5177\u4f53\u4ee3\u7801\u6837\u4f8b\u3002</li> <li>\u589e\u52a0\u4e00\u4e2a\u516c\u6709\u7b26\u53f7\u5230\u6587\u4ef6\u8def\u5f84\u7684\u6620\u5c04\u8868\uff0c\u4fbf\u4e8e\u5feb\u901f\u5bfc\u822a\u6e90\u7801\u3002</li> </ul>"},{"location":"zh/wiki/extensions/","title":"\u6269\u5c55\u4e0e\u63d2\u4ef6","text":"<p>\u672c\u6587\u6863\u8bf4\u660e\u5982\u4f55\u901a\u8fc7\u81ea\u5b9a\u4e49\u63d2\u4ef6\u6269\u5c55 Cullinan\u3002\u5185\u5bb9\u5305\u62ec\u6269\u5c55\u70b9\u3001\u63d0\u4f9b\u8005\u6ce8\u518c\u3001\u5178\u578b\u63d2\u4ef6\u6a21\u5f0f\uff0c\u4ee5\u53ca\u4e00\u4e2a\u6700\u5c0f\u793a\u4f8b\uff08\u5c55\u793a\u5982\u4f55\u6ce8\u518c\u81ea\u5b9a\u4e49 provider \u5e76\u6302\u63a5\u5230\u5e94\u7528\u751f\u547d\u5468\u671f\uff09\u3002</p> <p>\u8bbe\u8ba1\u539f\u5219</p> <ul> <li>\u975e\u4fb5\u5165\u5f0f\uff1a\u4f18\u5148\u901a\u8fc7\u6ce8\u518c provider\u3001controller \u6216 middleware \u6269\u5c55\uff0c\u800c\u4e0d\u662f\u4fee\u6539\u6846\u67b6\u5185\u90e8\u3002</li> <li>\u53ef\u64a4\u9500\uff1a\u66b4\u9732\u7684\u6269\u5c55\u70b9\u5e94\u53ef\u79fb\u9664/\u53d6\u6d88\u6ce8\u518c\uff0c\u4fbf\u4e8e\u6d4b\u8bd5\u4e0e\u8fd0\u884c\u65f6\u91cd\u65b0\u914d\u7f6e\u3002</li> <li>\u53ef\u53d1\u73b0\u6027\uff1a\u63d2\u4ef6\u5e94\u53ef\u901a\u8fc7\u6a21\u5757\u626b\u63cf\u6216\u663e\u5f0f\u6ce8\u518c API \u88ab\u53d1\u73b0\u3002</li> </ul> <p>\u6269\u5c55\u70b9</p> <ol> <li>Provider \u4e0e ServiceRegistry</li> <li>\u4f7f\u7528 <code>ProviderRegistry</code> \u4e0e\u63d0\u4f9b\u8005\u5b9e\u73b0\uff08<code>ClassProvider</code>\u3001<code>FactoryProvider</code>\u3001<code>InstanceProvider</code>\uff09\u6765\u63d0\u4f9b\u670d\u52a1\u3002\u5148\u6ce8\u518c provider\uff0c\u7136\u540e\u628a provider registry \u6dfb\u52a0\u5230\u5168\u5c40\u7684 <code>InjectionRegistry</code>\uff0c\u8fd9\u6837\u6ce8\u5165\u70b9\u624d\u80fd\u89e3\u6790\u4f9d\u8d56\u3002</li> <li> <p>\u5173\u952e API\uff1a<code>cullinan.core.ProviderRegistry</code>\u3001<code>cullinan.core.ScopedProvider</code>\u3001<code>cullinan.service.registry.ServiceRegistry</code>\u3002</p> </li> <li> <p>\u63a7\u5236\u5668</p> </li> <li>\u4f7f\u7528 <code>controller</code> \u88c5\u9970\u5668\u6216\u663e\u5f0f\u6ce8\u518c API \u6ce8\u518c controller \u51fd\u6570/\u7c7b\u3002\u6dfb\u52a0\u8def\u7531\u7684\u63d2\u4ef6\u5e94\u5728\u5e94\u7528\u542f\u52a8\u9636\u6bb5\u6ce8\u518c\u63a7\u5236\u5668\u3002</li> <li> <p>\u5173\u952e API\uff1a<code>cullinan.controller.controller</code>\u3001<code>cullinan.controller.get_controller_registry()</code>\u3002</p> </li> <li> <p>\u4e2d\u95f4\u4ef6</p> </li> <li>\u5b9e\u73b0\u9075\u5faa\u9879\u76ee\u4e2d\u95f4\u4ef6\u7ea6\u5b9a\u7684\u4e2d\u95f4\u4ef6\u7c7b/\u51fd\u6570\uff0c\u5e76\u5728\u5e94\u7528\u914d\u7f6e\u6216\u542f\u52a8\u671f\u95f4\u6ce8\u518c\uff0c\u4ee5\u5f71\u54cd\u8bf7\u6c42/\u54cd\u5e94\u5904\u7406\u3002</li> <li> <p>\u5173\u952e API\uff1a<code>cullinan.middleware</code> \u5305\uff08\u53c2\u89c1\u793a\u4f8b\uff09\u3002</p> </li> <li> <p>\u751f\u547d\u5468\u671f\u94a9\u5b50</p> </li> <li>\u63d2\u4ef6\u53ef\u4ee5\u901a\u8fc7 <code>CullinanApplication.add_shutdown_handler</code> \u6ce8\u518c\u542f\u52a8/\u5173\u95ed\u5904\u7406\u5668\uff0c\u4e5f\u53ef\u4ee5\u5b9e\u73b0 <code>LifecycleAware</code> \u63a5\u53e3\u4ee5\u96c6\u6210\u751f\u547d\u5468\u671f\u7ba1\u7406\u3002</li> <li>\u5173\u952e API\uff1a<code>CullinanApplication.add_shutdown_handler</code>\u3001<code>cullinan.core.lifecycle</code> \u5de5\u5177\u51fd\u6570\u3002</li> </ol> <p>\u53d1\u73b0\u4e0e\u6ce8\u518c\u6a21\u5f0f</p> <ul> <li>\u663e\u5f0f\u6ce8\u518c\uff08\u63a8\u8350\uff09\uff1a\u63d2\u4ef6\u63d0\u4f9b <code>register(app_or_registry)</code> \u51fd\u6570\uff0c\u5e94\u7528\u5728\u542f\u52a8\u65f6\u8c03\u7528\u8be5\u51fd\u6570\u8fdb\u884c\u6ce8\u518c\u3002\u793a\u4f8b\uff1a</li> </ul> <pre><code># my_plugin.py\nfrom cullinan.service import Service, service\nfrom cullinan.core import ProviderRegistry, ScopedProvider, SingletonScope\n\nclass MyService(Service):\n    def __init__(self):\n        self.value = 'my plugin service'\n\ndef register_service(provider_registry: ProviderRegistry):\n    provider_registry.register_provider(\n        'MyService',\n        ScopedProvider(lambda: MyService(), SingletonScope(), 'MyService')\n    )\n\n# \u5e94\u7528\u542f\u52a8\uff1a\n# provider_registry = ProviderRegistry()\n# register_service(provider_registry)\n# injection_registry.add_provider_registry(provider_registry)\n</code></pre> <ul> <li>\u81ea\u52a8\u53d1\u73b0\uff08\u4fbf\u6377\uff09\uff1a\u542f\u7528\u6a21\u5757\u626b\u63cf\u65f6\u53ef\u4ee5\u5728\u9884\u5b9a\u4e49\u547d\u540d\u7a7a\u95f4\u4e0b\u53d1\u73b0\u63d2\u4ef6\u5305\uff08\u4f8b\u5982 <code>myproject.plugins.*</code>\uff09\u3002\u751f\u4ea7\u73af\u5883\u5efa\u8bae\u4f7f\u7528\u663e\u5f0f\u6ce8\u518c\u3002</li> </ul> <p>\u6253\u5305\u4e0e\u5206\u53d1</p> <ul> <li>\u5c06\u63d2\u4ef6\u6253\u5305\u4e3a\u6807\u51c6 Python \u5305\uff0c\u66b4\u9732 <code>register()</code> \u5165\u53e3\u6216\u7ea6\u5b9a\u6a21\u5757\u8def\u5f84\u4ee5\u4f9b\u53d1\u73b0\u3002</li> <li>\u53ef\u9009\uff1a\u5728 <code>setup.cfg</code> / <code>setup.py</code> \u4e2d\u4f7f\u7528 <code>entry_points</code>\uff08\u4f8b\u5982 <code>cullinan.plugins</code>\uff09\u5e76\u901a\u8fc7 <code>pkg_resources</code> \u6216 <code>importlib.metadata</code> \u53d1\u73b0\u5df2\u5b89\u88c5\u63d2\u4ef6\u3002</li> </ul> <p>\u6700\u5c0f\u63d2\u4ef6\u793a\u4f8b \u2014 \u65e5\u5fd7\u4e2d\u95f4\u4ef6</p> <pre><code># my_logging_plugin.py\nimport logging\nfrom cullinan.middleware import MiddlewareBase\n\nlogger = logging.getLogger('my_plugin')\n\nclass RequestLogger(MiddlewareBase):\n    def process_request(self, request):\n        logger.info('Incoming %s %s', request.method, request.path)\n\ndef register(app):\n    # app-specific registration, pseudocode\n    app.add_middleware(RequestLogger())\n</code></pre> <p>\u63d2\u4ef6\u6d4b\u8bd5</p> <ul> <li>\u5728\u9694\u79bb\u73af\u5883\u4e2d\u5355\u5143\u6d4b\u8bd5\u63d2\u4ef6\uff0c\u6a21\u62df provider registry \u4e0e\u5e94\u7528\u751f\u547d\u5468\u671f\u3002</li> <li>\u786e\u4fdd <code>register()</code> \u662f\u5e42\u7b49\u7684\uff0c\u6216\u5728\u51fd\u6570\u5185\u52a0\u5165\u9632\u91cd\u590d\u6ce8\u518c\u7684\u4fdd\u62a4\u903b\u8f91\u3002</li> </ul> <p>\u5b89\u5168\u4e0e\u517c\u5bb9\u6027\u6ce8\u610f</p> <ul> <li>\u63d2\u4ef6\u5728\u5e94\u7528\u8fdb\u7a0b\u4e2d\u8fd0\u884c\uff1b\u907f\u514d\u6267\u884c\u4e0d\u53d7\u4fe1\u4efb\u7684\u4ee3\u7801\u6216\u5141\u8bb8\u63d2\u4ef6\u8fd0\u884c\u4efb\u610f\u542f\u52a8\u811a\u672c\u3002</li> <li>\u5728\u63d2\u4ef6\u5305\u4e2d\u8bb0\u5f55\u5bf9 Cullinan \u7248\u672c\u7684\u517c\u5bb9\u6027\u4e0e\u5347\u7ea7\u8bf4\u660e\u3002</li> </ul> <p>\u4e0b\u4e00\u6b65</p> <ul> <li>\u63d0\u4f9b\u63d2\u4ef6\u811a\u624b\u67b6\uff08cookiecutter\uff09\u4ee5\u7b80\u5316\u63d2\u4ef6\u5f00\u53d1\u3002</li> <li>\u5728 <code>examples/</code> \u76ee\u5f55\u6dfb\u52a0\u63d2\u4ef6\u793a\u4f8b\u5305\uff0c\u5e76\u5728 CI \u4e2d\u8fd0\u884c\u8fd9\u4e9b\u793a\u4f8b\u4ee5\u505a\u9a8c\u8bc1\u3002</li> </ul>"},{"location":"zh/wiki/injection/","title":"IoC \u4e0e DI\uff08\u6ce8\u5165\uff09","text":"<p>\u672c\u6587\u6863\u57fa\u4e8e <code>cullinan/core</code> \u6e90\u7801\uff08\u4ee5\u6e90\u7801\u5b9e\u73b0\u4e3a\u51c6\uff09\u4ecb\u7ecd Cullinan \u7684 IoC\uff08\u63a7\u5236\u53cd\u8f6c\uff09\u4e0e DI\uff08\u4f9d\u8d56\u6ce8\u5165\uff09\u539f\u8bed\u3002\u76ee\u6807\uff1a\u5c55\u793a\u5e38\u89c1\u7528\u6cd5\u3001provider/registry/scope \u6982\u5ff5\uff0c\u5e76\u63d0\u4f9b\u6700\u5c0f\u53ef\u8fd0\u884c\u793a\u4f8b\u3002</p> <p>\u5173\u952e\u6982\u5ff5\u4e0e\u7ec4\u4ef6</p> <ul> <li>Provider \u4e0e ProviderRegistry\uff1a\u7528\u4e8e\u751f\u6210\u670d\u52a1\u5b9e\u4f8b\u7684\u63d0\u4f9b\u8005\u3002\u63d0\u4f9b\u8005\u53ef\u4ee5\u662f\u7c7b\u63d0\u4f9b\u8005\u3001\u5de5\u5382\u63d0\u4f9b\u8005\u6216\u5b9e\u4f8b\u63d0\u4f9b\u8005\u3002<code>ProviderRegistry</code> \u4fdd\u5b58\u5df2\u6ce8\u518c\u7684\u63d0\u4f9b\u8005\uff0c\u5e76\u5e38\u901a\u8fc7 <code>InjectionRegistry</code> \u8fdb\u884c\u534f\u8c03\u89e3\u6790\u3002</li> <li>Scope\uff1a\u63a7\u5236\u63d0\u4f9b\u8005\u7684\u751f\u547d\u5468\u671f\u3002\u5e38\u7528\u7684\u4f5c\u7528\u57df\u5305\u62ec <code>SingletonScope</code>\u3001<code>TransientScope</code> \u4e0e <code>RequestScope</code>\u3002</li> <li>\u6ce8\u5165\u6807\u8bb0\u4e0e\u88c5\u9970\u5668\uff1a</li> <li>\u4f7f\u7528 <code>Inject</code> \u4e0e <code>InjectByName</code> \u8fdb\u884c\u5c5e\u6027\u6ce8\u5165\u6807\u8bb0\u3002</li> <li>\u4f7f\u7528 <code>@injectable</code> \u6807\u8bb0\u7c7b\u4ee5\u542f\u7528\u5c5e\u6027\u6ce8\u5165\u3002</li> <li>\u4f7f\u7528 <code>@inject_constructor</code> \u542f\u7528\u6784\u9020\u5668\u6ce8\u5165\uff08\u53c2\u6570\u6ce8\u5165\uff09\u3002</li> <li>InjectionRegistry\uff1a\u8d1f\u8d23\u534f\u8c03 provider registry \u5e76\u89e3\u6790\u6ce8\u5165\u70b9\u7684\u4e2d\u5fc3\u6ce8\u518c\u8868\u3002</li> <li>RequestContext\uff1a\u4e0e <code>create_context()</code> \u914d\u5408\u4f7f\u7528\u7684\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\uff0c\u7528\u4e8e\u8bf7\u6c42\u8303\u56f4\u7684\u5bf9\u8c61\uff08\u914d\u5408 <code>RequestScope</code>\uff09\u3002</li> </ul> <p>\u6e90\u7801\u4f4d\u7f6e\u5efa\u8bae\u9605\u8bfb</p> <ul> <li><code>cullinan/core/injection.py</code> \u2014 \u6ce8\u5165\u6ce8\u518c\u4e0e\u89e3\u6790\u5b9e\u73b0\u3002</li> <li><code>cullinan/core/provider.py</code> \u2014 \u63d0\u4f9b\u8005\u5b9e\u73b0\uff08ClassProvider\u3001FactoryProvider\u3001InstanceProvider\uff09\u3002</li> <li><code>cullinan/core/registry.py</code> \u2014 ProviderRegistry \u4e0e\u901a\u7528 Registry \u6a21\u5f0f\u5b9e\u73b0\u3002</li> <li><code>cullinan/core/scope.py</code> \u2014 Scope \u5b9e\u73b0\uff08SingletonScope\u3001RequestScope\u3001TransientScope\uff09\u3002</li> <li>\u6d4b\u8bd5\u793a\u4f8b\uff1a<code>tests/test_core_injection.py</code>, <code>tests/test_core_scope_integration.py</code>\u3002</li> </ul> <p>\u6700\u5c0f\u53ef\u8fd0\u884c\u793a\u4f8b\uff08\u53ef\u6267\u884c\uff09</p> <p>\u5c5e\u6027\u6ce8\u5165\uff1a</p> <pre><code>from cullinan.core import (\n    SingletonScope, ScopedProvider, ProviderRegistry,\n    injectable, Inject, get_injection_registry, reset_injection_registry\n)\n\nclass Database:\n    _instance_count = 0\n    def __init__(self):\n        Database._instance_count += 1\n        self.id = Database._instance_count\n\nreset_injection_registry()\nregistry = ProviderRegistry()\nscope = SingletonScope()\nregistry.register_provider('Database', ScopedProvider(lambda: Database(), scope, 'Database'))\nget_injection_registry().add_provider_registry(registry)\n\n@injectable\nclass Service:\n    database: Database = Inject()\n\ns1 = Service()\ns2 = Service()\nassert s1.database is s2.database\n</code></pre> <p>\u6784\u9020\u5668\u6ce8\u5165\uff1a</p> <pre><code>from cullinan.core import (\n    SingletonScope, ScopedProvider, ProviderRegistry,\n    inject_constructor, get_injection_registry, reset_injection_registry\n)\n\nclass Database:\n    _instance_count = 0\n    def __init__(self):\n        Database._instance_count += 1\n        self.id = Database._instance_count\n\nreset_injection_registry()\nregistry = ProviderRegistry()\nscope = SingletonScope()\nregistry.register_provider('Database', ScopedProvider(lambda: Database(), scope, 'Database'))\nget_injection_registry().add_provider_registry(registry)\n\n@inject_constructor\nclass Controller:\n    def __init__(self, database: Database):\n        self.database = database\n\nc1 = Controller()\nc2 = Controller()\nassert c1.database is c2.database\n</code></pre> <p>\u5e38\u89c1\u6a21\u5f0f\u4e0e\u5efa\u8bae</p> <ul> <li>\u5f53\u7c7b\u7531\u4f7f\u7528\u8005\u76f4\u63a5\u5b9e\u4f8b\u5316\u65f6\uff0c\u4f18\u5148\u4f7f\u7528 <code>@injectable</code> + <code>Inject()</code> \u505a\u5c5e\u6027\u6ce8\u5165\uff1b\u9700\u8981\u66f4\u663e\u5f0f\u7684\u6ce8\u5165\u6216\u66f4\u4e25\u683c\u7684\u63a7\u5236\u65f6\u4f7f\u7528 <code>@inject_constructor</code>\u3002</li> <li>\u5c06\u63d0\u4f9b\u8005\u6ce8\u518c\u8fdb <code>ProviderRegistry</code>\uff0c\u5e76\u5728\u5168\u5c40 <code>InjectionRegistry</code> \u4e2d\u6ce8\u518c ProviderRegistry\uff0c\u4ee5\u4fbf\u6ce8\u5165\u70b9\u80fd\u591f\u89e3\u6790\u4f9d\u8d56\u3002</li> <li>\u5728\u9700\u8981\u8bf7\u6c42\u8303\u56f4\u751f\u547d\u5468\u671f\u65f6\uff0c\u4f7f\u7528 <code>RequestScope</code> \u4e0e <code>create_context()</code>\u3002</li> </ul> <p>\u6545\u969c\u6392\u67e5</p> <ul> <li>\u82e5\u6ce8\u5165\u4e3a None\uff0c\u786e\u4fdd\u5728\u6d4b\u8bd5\u8bbe\u7f6e\u4e2d\u8c03\u7528 <code>reset_injection_registry()</code> \u5e76\u5728\u6ce8\u518c provider \u4e4b\u540e\u5b9e\u4f8b\u5316\u76ee\u6807\u7c7b\u3002</li> <li>\u4f7f\u7528 <code>InjectByName</code> \u65f6\u786e\u8ba4\u63d0\u4f9b\u8005\u540d\u79f0\u4e0e\u6ce8\u5165\u70b9\u540d\u79f0\u5339\u914d\u3002</li> </ul> <p>\u4e0b\u4e00\u6b65</p> <ul> <li>\u4e3a\u8be5\u9875\u6dfb\u52a0\u6ce8\u5165\u89e3\u6790\u65f6\u5e8f\u56fe\u3001\u5faa\u73af\u4f9d\u8d56\u9519\u8bef\u793a\u4f8b\u4e0e\u751f\u547d\u5468\u671f hook \u7684\u5b8c\u6574\u793a\u4f8b\uff08on_init/on_shutdown\uff09\u3002</li> </ul>"},{"location":"zh/wiki/lifecycle/","title":"\u5e94\u7528\u751f\u547d\u5468\u671f","text":"<p>\u672c\u6587\u6863\u63cf\u8ff0 Cullinan \u5e94\u7528\u7684\u751f\u547d\u5468\u671f\uff1a\u542f\u52a8\uff08startup\uff09\u3001\u521d\u59cb\u5316\u670d\u52a1\uff08initialize\uff09\u3001\u8bf7\u6c42\u5904\u7406\uff08request handling\uff09\u3001\u4ee5\u53ca\u4f18\u96c5\u5173\u95ed\uff08shutdown\uff09\u94a9\u5b50\u4e0e\u4e8b\u4ef6\u3002\u5185\u5bb9\u57fa\u4e8e\u6e90\u7801\uff08\u4ee5\u5b9e\u73b0\u4e3a\u51c6\uff09\uff0c\u4e3b\u8981\u53c2\u8003\uff1a<code>cullinan/app.py</code>\u3001<code>cullinan/application.py</code> \u4e0e <code>cullinan/core/lifecycle</code> \u76f8\u5173\u5b9e\u73b0\u3002</p> <p>\u4e3b\u8981\u9636\u6bb5</p> <ol> <li>\u542f\u52a8\uff08startup\uff09</li> <li>\u5165\u53e3\uff1a<code>CullinanApplication.run()</code> \u6216 <code>create_app()</code> \u4e4b\u540e\u8c03\u7528 <code>app.run()</code>\u3002</li> <li> <p>\u884c\u4e3a\uff08\u89c1 <code>cullinan/app.py</code>\uff09:</p> <ul> <li>\u8c03\u7528 <code>startup()</code> \u6267\u884c\u542f\u52a8\u5e8f\u5217\uff1a\u914d\u7f6e\u6ce8\u5165\uff08InjectionRegistry\uff09\u3001\u53d1\u73b0\u670d\u52a1\uff08ServiceRegistry\uff09\u3001\u6309\u4f9d\u8d56\u987a\u5e8f\u521d\u59cb\u5316\u670d\u52a1\uff08initialize_all\uff09\u3002</li> <li>\u6ce8\u518c\u4fe1\u53f7\u5904\u7406\uff08SIGINT / SIGTERM\uff09\uff0c\u4ee5\u4fbf\u5728\u63a5\u6536\u5230\u4fe1\u53f7\u65f6\u89e6\u53d1\u4f18\u96c5\u5173\u95ed\u3002</li> <li>\u542f\u52a8 Tornado \u7684 IOLoop\uff1a<code>IOLoop.start()</code>\uff08\u963b\u585e\uff0c\u76f4\u5230\u6536\u5230\u505c\u6b62\u4e8b\u4ef6\uff09\u3002</li> </ul> </li> <li> <p>\u521d\u59cb\u5316\u670d\u52a1\uff08service initialization\uff09</p> </li> <li>\u670d\u52a1\u901a\u8fc7 <code>@service</code> \u88c5\u9970\u5668\u6216\u5728\u6a21\u5757\u626b\u63cf\u65f6\u6ce8\u518c\u5230 <code>ServiceRegistry</code>\u3002</li> <li><code>ProviderRegistry</code> / <code>ServiceRegistry</code> \u8d1f\u8d23\u6309\u4f9d\u8d56\u987a\u5e8f\u5b9e\u4f8b\u5316\u670d\u52a1\u5e76\u8c03\u7528\u521d\u59cb\u5316\u94a9\u5b50\uff08\u5982 <code>on_init</code>\uff09\u3002</li> <li> <p>\u5982\u679c\u6ca1\u6709\u6ce8\u518c\u670d\u52a1\uff0c\u521d\u59cb\u5316\u9636\u6bb5\u4f1a\u8df3\u8fc7\u5b9e\u4f8b\u5316\u6b65\u9aa4\u3002</p> </li> <li> <p>\u8bf7\u6c42\u5904\u7406\u4e0e\u8bf7\u6c42\u4f5c\u7528\u57df\uff08request handling &amp; request scope\uff09</p> </li> <li>\u8bf7\u6c42\u5230\u8fbe\u65f6\uff0c\u5e94\u7528\u4f1a\u521b\u5efa\u8bf7\u6c42\u4e0a\u4e0b\u6587\uff08\u901a\u8fc7 <code>create_context()</code>\uff09\u4ee5\u652f\u6301 <code>RequestScope</code>\u3002</li> <li>\u5728\u540c\u4e00\u8bf7\u6c42\u4e0a\u4e0b\u6587\u4e2d\uff0cRequestScope \u4fdd\u8bc1\u4f5c\u7528\u57df\u5185\u7684\u5bf9\u8c61\u5728\u8be5\u8bf7\u6c42\u751f\u547d\u5468\u671f\u5185\u88ab\u590d\u7528\u3002</li> <li> <p>\u5904\u7406\u5668\uff08Handler / controller\uff09\u53ef\u901a\u8fc7\u5c5e\u6027\u6ce8\u5165\u6216\u6784\u9020\u5668\u6ce8\u5165\u62ff\u5230\u8bf7\u6c42\u4f5c\u7528\u57df\u5185\u7684\u4f9d\u8d56\u3002</p> </li> <li> <p>\u5173\u95ed\uff08shutdown\uff09</p> </li> <li>\u5f53\u5e94\u7528\u63a5\u6536\u5230\u7ec8\u6b62\u4fe1\u53f7\u6216\u624b\u52a8\u89e6\u53d1\u5173\u95ed\u65f6\uff0c\u4f1a\u8c03\u7528 <code>shutdown()</code>\uff1a<ul> <li>\u4f9d\u6b21\u6267\u884c\u6ce8\u518c\u7684\u5173\u95ed\u5904\u7406\u5668\uff08\u540c\u6b65\u6216\u5f02\u6b65\uff09\uff0c\u5904\u7406\u9519\u8bef\u65f6\u6839\u636e <code>force</code> \u6807\u5fd7\u51b3\u5b9a\u662f\u5426\u5ffd\u7565\u3002</li> <li>\u5c06 <code>_running</code> \u6807\u5fd7\u7f6e\u4e3a False \u5e76\u505c\u6b62 IOLoop\u3002</li> <li>\u8c03\u7528\u670d\u52a1\u7684\u751f\u547d\u5468\u671f\u94a9\u5b50\uff08\u5982 <code>on_shutdown</code>\uff09\u4ee5\u4fbf\u6e05\u7406\u8d44\u6e90\u3002</li> </ul> </li> </ol>"},{"location":"zh/wiki/lifecycle/#_2","title":"\u751f\u547d\u5468\u671f\u5e8f\u5217\uff08\u56fe\u793a\uff09","text":"<pre><code>CullinanApplication ProviderRegistry    ServiceRegistry Tornado IOLoop  RequestContext  Handler\n------------------- ----------------    --------------- --------------- --------------  -------\nstartup() -&gt; \u6ce8\u518c providers -&gt; \u53d1\u73b0\u5e76\u521d\u59cb\u5316\u670d\u52a1 -&gt; \u542f\u52a8 IOLoop\n                                                        |\n                                                        |-&gt; IOLoop \u63a5\u6536\u8bf7\u6c42 -&gt; \u521b\u5efa RequestContext\n                                                        |                         -&gt; \u89e3\u6790\u8bf7\u6c42\u4f5c\u7528\u57df providers\n                                                        |                         -&gt; \u5206\u53d1\u5230 Handler\uff08\u6ce8\u5165\u89e3\u6790\uff09\n                                                        |                         -&gt; Handler \u8fd4\u56de\u54cd\u5e94\n                                                        |                         -&gt; RequestContext \u6e05\u7406\nshutdown() -&gt; \u8c03\u7528\u670d\u52a1 on_shutdown -&gt; \u505c\u6b62 IOLoop\n</code></pre> <pre><code>\u5e38\u89c1\u94a9\u5b50\u4e0e\u6269\u5c55\u70b9\n\n- `CullinanApplication.add_shutdown_handler(handler)` \u2014 \u5411\u5e94\u7528\u6dfb\u52a0\u81ea\u5b9a\u4e49\u5173\u95ed\u5904\u7406\u5668\uff08\u652f\u6301 async callable\uff09\u3002\n- `LifecycleAware` \u4e0e `LifecycleManager`\uff08\u4f4d\u4e8e `cullinan/core`\uff09\u2014 \u5982\u679c\u670d\u52a1\u5b9e\u73b0\u4e86\u751f\u547d\u5468\u671f\u63a5\u53e3\uff0c\u6846\u67b6\u4f1a\u5728\u5408\u9002\u7684\u65f6\u673a\u8c03\u7528\u5176\u94a9\u5b50\u3002\n- Provider / Service \u7684 `on_init` / `on_shutdown`\uff08\u5982\u6709\uff09\u2014 \u5728\u521d\u59cb\u5316\u4e0e\u5173\u95ed\u9636\u6bb5\u88ab\u8c03\u7528\u3002\n\n\u6700\u5c0f\u793a\u4f8b\uff1a\u6ce8\u518c\u81ea\u5b9a\u4e49\u5173\u95ed\u5904\u7406\u5668\n\n```python\n# \u5feb\u901f\uff08\u63a8\u8350\uff09: \u7b80\u5355\u8fd0\u884c\u6846\u67b6\u5165\u53e3\uff08\u65e0\u9700\u5b9e\u4f8b\u5316\uff09\nfrom cullinan import application\n\n# \u5728 CLI \u6216\u5165\u53e3\u5904\u542f\u52a8\u6846\u67b6\nif __name__ == '__main__':\n    application.run()\n\n# \u9ad8\u7ea7\uff08\u53ef\u9009\uff09: \u5982\u679c\u9700\u8981\u4ee5\u7f16\u7a0b\u65b9\u5f0f\u6dfb\u52a0\u5173\u95ed\u5904\u7406\u5668\u6216\u7ec6\u7c92\u5ea6\u63a7\u5236\uff0c\u8bf7\u4f7f\u7528 create_app()\nfrom cullinan.app import create_app\nimport asyncio\n\napplication_instance = create_app()\n\ndef cleanup_sync():\n    print('Running sync cleanup')\n\nasync def cleanup_async():\n    await asyncio.sleep(0.01)\n    print('Running async cleanup')\n\napplication_instance.add_shutdown_handler(cleanup_sync)\napplication_instance.add_shutdown_handler(cleanup_async)\n\n# \u5728\u7a0b\u5e8f\u5165\u53e3\u8c03\u7528\uff1a\n# application_instance.run()\n```\n\n\u8bf7\u6c42\u4f5c\u7528\u57df\u793a\u4f8b\uff08\u4f2a\u4ee3\u7801\uff0c\u57fa\u4e8e `create_context()`\uff09\n\n```python\nfrom cullinan.core import create_context, RequestScope, ScopedProvider, ProviderRegistry\n\nprovider_registry = ProviderRegistry()\nprovider_registry.register_provider('RequestHandler', ScopedProvider(lambda: RequestHandler(), RequestScope(), 'RequestHandler'))\n\nwith create_context():\n    handler1 = provider_registry.get_instance('RequestHandler')\n    handler2 = provider_registry.get_instance('RequestHandler')\n    assert handler1 is handler2\n\n# \u79bb\u5f00\u4e0a\u4e0b\u6587\u540e\uff0cRequestScope \u4e2d\u7684\u5b9e\u4f8b\u5c06\u88ab\u9694\u79bb\uff0c\u4e0b\u6b21\u8bf7\u6c42\u4f1a\u5f97\u5230\u65b0\u7684\u5b9e\u4f8b\n```\n\n\u8c03\u8bd5\u4e0e\u6545\u969c\u6392\u67e5\n\n- \u542f\u52a8\u5931\u8d25\uff1a\u68c0\u67e5 `startup()` \u4e2d\u7684\u9519\u8bef\u65e5\u5fd7\uff08`Application startup failed`\uff09\u5e76\u67e5\u770b\u670d\u52a1\u6ce8\u518c\u6216 provider \u521d\u59cb\u5316\u5931\u8d25\u7684\u5806\u6808\u3002\n- \u6ce8\u5165/\u4f9d\u8d56\u7f3a\u5931\uff1a\u5982\u679c\u67d0\u6ce8\u5165\u70b9\u6ca1\u6709\u88ab\u89e3\u6790\uff0c\u786e\u8ba4\u5bf9\u5e94\u7684 provider \u5df2\u6ce8\u518c\u5230 `ProviderRegistry` \u4e14 `InjectionRegistry` \u5df2\u6dfb\u52a0\u8be5 registry\u3002\n- \u4f18\u96c5\u5173\u95ed\u95ee\u9898\uff1a\u5982\u679c\u67d0\u5173\u95ed\u5904\u7406\u5668\u963b\u585e\u6216\u629b\u51fa\u5f02\u5e38\uff0c\u8003\u8651\u5728\u5904\u7406\u5668\u4e2d\u6355\u83b7\u5f02\u5e38\u6216\u5728\u5173\u95ed\u65f6\u4f20 `force=True`\u3002\n\n\u53c2\u8003\u4e0e\u4e0b\u4e00\u6b65\n\n- \u6e90\u7801\u53c2\u8003\uff1a`cullinan/app.py`, `cullinan/application.py`, `cullinan/core/*`\uff08provider/registry/scope/lifecycle\uff09\u3002\n- \u63a8\u8350\u628a\u5173\u952e\u7684\u542f\u52a8/\u5173\u95ed\u5e8f\u5217\u5199\u6210\u65f6\u5e8f\u56fe\u5e76\u7eb3\u5165 `docs/wiki/lifecycle.md` \u7684\u56fe\u793a\u90e8\u5206\u4ee5\u4fbf\u5ba1\u9605\u3002\n</code></pre>"},{"location":"zh/wiki/middleware/","title":"\u4e2d\u95f4\u4ef6","text":"<p>\u672c\u6587\u6863\u8bf4\u660e Cullinan \u4e2d\u95f4\u4ef6\u7684\u4f5c\u7528\u3001\u94fe\u8def\u6267\u884c\u987a\u5e8f\u3001\u6ce8\u518c\u65b9\u5f0f\u3001\u4e0e DI \u7684\u96c6\u6210\uff0c\u5e76\u63d0\u4f9b\u6700\u5c0f\u793a\u4f8b\u4e0e\u6545\u969c\u6392\u67e5\u5efa\u8bae\u3002\u4e2d\u95f4\u4ef6\u662f\u5904\u7406\u8bf7\u6c42\uff0f\u54cd\u5e94\u751f\u547d\u5468\u671f\u4e2d\u7684\u53ef\u63d2\u62d4\u9636\u6bb5\uff0c\u7528\u4e8e\u8ba4\u8bc1\u3001\u6388\u6743\u3001\u65e5\u5fd7\u3001\u8bf7\u6c42/\u54cd\u5e94\u53d8\u6362\u7b49\u573a\u666f\u3002</p> <p>\u6838\u5fc3\u6982\u5ff5</p> <ul> <li>\u4e2d\u95f4\u4ef6\u94fe\uff08pipeline\uff09: \u8bf7\u6c42\u5728\u8fdb\u5165\u63a7\u5236\u5668\u4e4b\u524d\u4f1a\u7ecf\u8fc7\u4e00\u7cfb\u5217\u4e2d\u95f4\u4ef6\uff0c\u6bcf\u4e2a\u4e2d\u95f4\u4ef6\u53ef\u9009\u62e9\u5904\u7406\u3001\u4fee\u6539\u6216\u77ed\u8def\u8bf7\u6c42\uff1b\u54cd\u5e94\u4e5f\u53ef\u4ee5\u5728\u8fd4\u56de\u8def\u5f84\u4e0a\u88ab\u4e2d\u95f4\u4ef6\u5904\u7406\u3002</li> <li>\u987a\u5e8f\u4e0e\u4f18\u5148\u7ea7: \u4e2d\u95f4\u4ef6\u6309\u6ce8\u518c\u987a\u5e8f\u6267\u884c\uff1b\u67d0\u4e9b\u6846\u67b6\u5141\u8bb8\u4e3a\u4e2d\u95f4\u4ef6\u6307\u5b9a\u4f18\u5148\u7ea7\u6216\u9636\u6bb5\uff08pre/post\uff09\u3002\u5728 Cullinan \u4e2d\uff0c\u6ce8\u518c\u987a\u5e8f\u51b3\u5b9a\u6267\u884c\u987a\u5e8f\uff0c\u6587\u6863\u4e2d\u793a\u4f8b\u9075\u5faa\u6b64\u60ef\u4f8b\u3002</li> <li>\u4e2d\u95f4\u4ef6\u5951\u7ea6: \u4e2d\u95f4\u4ef6\u5e94\u5b9e\u73b0\u4e00\u4e2a\u7ea6\u5b9a\u7684\u63a5\u53e3\uff08\u7c7b\u4f3c process_request / process_response\uff09\uff0c\u6216\u9075\u5faa\u9879\u76ee\u4e2d\u95f4\u4ef6\u57fa\u7c7b\uff08\u5982\u6709\uff09\u3002\u53c2\u8003 <code>cullinan/middleware</code> \u5305\u5b9e\u73b0\u3002</li> </ul> <p>\u6ce8\u518c\u4e0e\u914d\u7f6e</p> <ul> <li>\u7a0b\u5e8f\u5316\u6ce8\u518c\uff08\u63a8\u8350\uff09: \u5728\u5e94\u7528\u542f\u52a8\u9636\u6bb5\u663e\u5f0f\u6ce8\u518c\u4e2d\u95f4\u4ef6\u3002</li> <li>\u793a\u4f8b\uff08\u4f2a\u4ee3\u7801\uff09:</li> </ul> <pre><code># \u6ce8\u518c\u4e2d\u95f4\u4ef6\uff08\u4f2a\u4ee3\u7801\uff09\nfrom cullinan import application\nfrom my_middleware import MyMiddleware\n\n# \u5feb\u901f\u542f\u52a8\u5e76\u8fd0\u884c\uff08\u63a8\u8350\uff09\n# \u5728\u5165\u53e3\u811a\u672c\u4e2d\u5bfc\u5165\u6a21\u5757\u4ee5\u89e6\u53d1\u88c5\u9970\u5668/\u81ea\u52a8\u6ce8\u518c\uff0c\u7136\u540e\u8c03\u7528 application.run()\nif __name__ == '__main__':\n    application.run()\n\n# \u9ad8\u7ea7\uff08\u53ef\u9009\uff09\uff1a\u4ee5\u7f16\u7a0b\u65b9\u5f0f\u6ce8\u518c\u4e2d\u95f4\u4ef6\u5e76\u8fd0\u884c\uff08\u9700\u8981 create_app\uff09\nfrom cullinan.app import create_app\nfrom my_middleware import MyMiddleware\n\napplication_instance = create_app()\napplication_instance.add_middleware(MyMiddleware())\n# application_instance.run()\n</code></pre> <ul> <li>\u4f9d\u8d56\u6ce8\u5165\u96c6\u6210: \u4e2d\u95f4\u4ef6\u53ef\u4ee5\u4f9d\u8d56\u4e8e\u6846\u67b6\u7684 provider/registry \u7cfb\u7edf\u3002\u5efa\u8bae\u901a\u8fc7\u63d0\u4f9b\u8005\u6ce8\u518c\u9700\u8981\u7684 service\uff0c\u5e76\u5728\u4e2d\u95f4\u4ef6\u5185\u90e8\u901a\u8fc7\u6ce8\u5165\u4f7f\u7528\u5b83\u4eec\u3002</li> </ul> <p>\u4e2d\u95f4\u4ef6\u793a\u4f8b\uff08\u7ed3\u5408 DI\uff09</p> <p>\u4e0b\u9762\u793a\u4f8b\u6f14\u793a\u4e00\u4e2a\u4e2d\u95f4\u4ef6\u83b7\u53d6\u4e00\u4e2a\u6ce8\u5165\u7684\u670d\u52a1\u5e76\u5728\u6bcf\u6b21\u8bf7\u6c42\u524d\u8bb0\u5f55\u4fe1\u606f\uff1a</p> <pre><code># examples/controller_di_middleware.py (\u53c2\u8003\u793a\u4f8b)\nfrom cullinan.core import injectable, Inject, get_injection_registry\nfrom cullinan.middleware import MiddlewareBase\n\n@injectable\nclass AuditService:\n    def record(self, request):\n        print('Audit:', request.path)\n\nclass AuditMiddleware(MiddlewareBase):\n    audit: AuditService = Inject()\n\n    def process_request(self, request):\n        # \u4f7f\u7528\u6ce8\u5165\u7684 audit \u670d\u52a1\u8bb0\u5f55\u8bf7\u6c42\n        self.audit.record(request)\n\n# \u5728\u5e94\u7528\u542f\u52a8\u65f6\u6ce8\u518c\u4e2d\u95f4\u4ef6\u4e0e provider\n# registry = ProviderRegistry()...\n</code></pre> <p>\u4e2d\u95f4\u4ef6\u7684\u6267\u884c\u6a21\u578b\u4e0e\u9650\u5236</p> <ul> <li>\u4e2d\u95f4\u4ef6\u5e94\u5c3d\u91cf\u907f\u514d\u963b\u585e\u957f\u65f6\u95f4\u64cd\u4f5c\uff1b\u82e5\u9700\u8981\u8017\u65f6\u4efb\u52a1\uff0c\u4f7f\u7528\u540e\u53f0\u4efb\u52a1\u961f\u5217\u6216\u5f02\u6b65\u5904\u7406\u3002</li> <li>\u4e2d\u95f4\u4ef6\u5e94\u5bf9\u5f02\u5e38\u8fdb\u884c\u9632\u62a4\uff0c\u907f\u514d\u672a\u6355\u83b7\u5f02\u5e38\u5bfc\u81f4\u6574\u4e2a\u8bf7\u6c42\u94fe\u4e2d\u65ad\u3002</li> <li>\u5728\u4f7f\u7528 RequestScope \u6216\u4f9d\u8d56\u6ce8\u5165\u65f6\uff0c\u786e\u4fdd\u4e2d\u95f4\u4ef6\u7684\u751f\u547d\u5468\u671f\u4e0e\u8bf7\u6c42\u4e0a\u4e0b\u6587\u517c\u5bb9\uff08\u4f8b\u5982\u4e0d\u8981\u5728\u6a21\u5757\u5168\u5c40\u7f13\u5b58 request-scoped \u5bf9\u8c61\uff09\u3002</li> </ul> <p>\u6545\u969c\u6392\u67e5</p> <ul> <li>\u4e2d\u95f4\u4ef6\u4e0d\u751f\u6548\uff1a\u786e\u8ba4\u4e2d\u95f4\u4ef6\u5df2\u5728\u5e94\u7528\u542f\u52a8\u65f6\u6ce8\u518c\uff0c\u5e76\u4e14\u6ce8\u518c\u987a\u5e8f\u6b63\u786e\uff1b\u68c0\u67e5\u4e2d\u95f4\u4ef6\u662f\u5426\u88ab\u6709\u6761\u4ef6\u7684\u914d\u7f6e\u8df3\u8fc7\u3002</li> <li>\u6ce8\u5165\u5931\u8d25\uff1a\u5982\u679c\u4e2d\u95f4\u4ef6\u4e2d\u7684 Inject \u672a\u89e3\u6790\uff0c\u786e\u4fdd provider \u5df2\u5728\u6ce8\u5165 registry \u6ce8\u518c\u5e76\u5728\u4e2d\u95f4\u4ef6\u5b9e\u4f8b\u5316\u524d\u53ef\u7528\uff1b\u5bf9\u6d4b\u8bd5\u8bf7\u4f7f\u7528 <code>reset_injection_registry()</code> \u5728\u524d\u7f6e\u6b65\u9aa4\u4e2d\u521d\u59cb\u5316\u3002</li> <li>\u6027\u80fd\u95ee\u9898\uff1a\u5bf9\u4e2d\u95f4\u4ef6\u8fdb\u884c\u57fa\u51c6\u6d4b\u8bd5\uff0c\u907f\u514d\u5728\u9ad8\u9891\u8def\u5f84\u4e2d\u8c03\u7528\u5927\u91cf I/O \u6216\u963b\u585e\u4ee3\u7801\u3002</li> </ul> <p>\u6700\u4f73\u5b9e\u8df5\u4e0e\u5efa\u8bae</p> <ul> <li>\u5c06\u4e2d\u95f4\u4ef6\u4fdd\u6301\u4e3a\u8f7b\u91cf\u51fd\u6570/\u7c7b\uff0c\u6838\u5fc3\u903b\u8f91\u59d4\u6258\u7ed9\u6ce8\u5165\u7684\u670d\u52a1\u3002</li> <li>\u5728\u4e2d\u95f4\u4ef6\u4e2d\u4f7f\u7528\u6846\u67b6\u63d0\u4f9b\u7684\u65e5\u5fd7\u8bb0\u5f55\u5668\uff08logger\uff09\u800c\u4e0d\u662f\u76f4\u63a5\u6253\u5370\uff0c\u4fbf\u4e8e\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u8c03\u6574\u65e5\u5fd7\u7ea7\u522b\u548c\u6536\u96c6\u65b9\u5f0f\u3002</li> <li>\u4e3a\u4e2d\u95f4\u4ef6\u7f16\u5199\u72ec\u7acb\u5355\u5143\u6d4b\u8bd5\u5e76\u5728 CI \u4e2d\u8fd0\u884c\uff08\u53ef\u4ee5\u6a21\u62df\u8bf7\u6c42\u5bf9\u8c61\u4e0e\u6ce8\u5165 registry\uff09\u3002</li> </ul> <p>\u4e0b\u4e00\u6b65</p> <ul> <li>\u4ece <code>examples/controller_di_middleware.py</code> \u63d0\u53d6\u4e00\u4e2a\u6700\u5c0f\u53ef\u8fd0\u884c\u7684\u793a\u4f8b\u5e76\u653e\u5165 <code>examples/</code> \u76ee\u5f55\uff0c\u5e76\u786e\u4fdd\u81f3\u5c11\u7531\u4e00\u4e2a\u81ea\u52a8\u5316\u6d4b\u8bd5\u8986\u76d6\u3002</li> <li>\u5c06\u4e2d\u95f4\u4ef6\u5951\u7ea6\u6587\u6863\u5316\u4e3a\u4ee3\u7801\u63a5\u53e3\uff08\u82e5\u9879\u76ee\u4e2d\u5c1a\u672a\u6709\u57fa\u7840\u7c7b\uff09\uff0c\u5e76\u5728\u6587\u6863\u4e2d\u5f15\u7528\u5b9e\u73b0\u793a\u4f8b\u3002</li> </ul>"},{"location":"zh/wiki/middleware/#_2","title":"\u8fd0\u884c\u793a\u4f8b","text":"<p>\u786e\u4fdd\u5df2\u7ecf\u51c6\u5907\u597d\u53ef\u7528\u7684 Python \u73af\u5883\uff08virtualenv\u3001conda\u3001\u7cfb\u7edf Python \u7b49\u5747\u53ef\uff09\u3002</p> <p>\u5728 Windows\uff08PowerShell\uff09\u4e2d\uff1a</p> <pre><code>python -m pip install -U pip\npip install cullinan tornado\npython examples\\middleware_demo.py\n</code></pre> <p>\u5728 Linux / macOS \u4e2d\uff1a</p> <pre><code>python -m pip install -U pip\npip install cullinan tornado\npython examples/middleware_demo.py\n</code></pre> <p>\u5178\u578b\u8f93\u51fa\uff08\u793a\u4f8b\u8fd0\u884c\uff09\uff1a</p> <pre><code>INFO:__main__:Starting IOLoop for middleware demo\nINFO:__main__:Performing request 1\nINFO:__main__:Entered request context\nINFO:__main__:Injected dependencies into handler\nINFO:tornado.access:200 GET /middleware (127.0.0.1) 2.10ms\nINFO:__main__:Exited request context\nINFO:__main__:Response1: Hello from UserService (084297)  request_count=1\nINFO:__main__:Performing request 2\nINFO:__main__:Entered request context\nINFO:__main__:Injected dependencies into handler\nINFO:tornado.access:200 GET /middleware (127.0.0.1) 0.60ms\nINFO:__main__:Exited request context\nINFO:__main__:Response2: Hello from UserService (084297)  request_count=1\nINFO:__main__:IOLoop stopped, exiting\n</code></pre> <p>\u8bf4\u660e\uff1a<code>RequestCounter</code> \u4e3a\u8bf7\u6c42\u4f5c\u7528\u57df\u7c7b\u578b\uff0c\u6bcf\u6b21\u8bf7\u6c42\u90fd\u4f1a\u91cd\u7f6e\uff1b<code>UserService</code> \u4e3a\u5355\u4f8b\uff0c\u5176\u5b9e\u4f8b id \u5728\u4e0d\u540c\u8bf7\u6c42\u95f4\u4fdd\u6301\u4e0d\u53d8\u3002</p>"},{"location":"zh/wiki/restful_api/","title":"RESTful API \u88c5\u9970\u5668\uff08\u8be6\u7ec6\uff09","text":"<p>\u672c\u9875\u9762\u8bb0\u5f55 Cullinan \u63a7\u5236\u5668\u4e2d\u7528\u4e8e\u8def\u7531\u7ed1\u5b9a\u7684 HTTP \u52a8\u8bcd\u88c5\u9970\u5668\uff1a<code>get_api</code>\u3001<code>post_api</code>\u3001<code>patch_api</code>\u3001<code>delete_api</code>\u3001<code>put_api</code>\u3002</p> <p>\u6458\u8981 - \u6240\u6709\u88c5\u9970\u5668\u5728\u6e90\u7801\u4e2d\u5b9a\u4e49\u4e3a <code>def get_api(**kwargs)</code>\uff08\u5176\u5b83\u52a8\u8bcd\u540c\u7406\uff09\uff0c\u56e0\u6b64\u4ec5\u63a5\u53d7\u5173\u952e\u5b57\u53c2\u6570\u3002\u4f7f\u7528\u4f4d\u7f6e\u53c2\u6570\u5199\u6cd5\u5982 <code>@get_api('/user')</code> \u662f\u4e0d\u5408\u6cd5\u7684\uff0c\u4f1a\u5728\u5bfc\u5165\u65f6\u629b\u51fa TypeError\u3002\u8bf7\u59cb\u7ec8\u4f7f\u7528 <code>@get_api(url='/users/{user_id}')</code>\u3002 - URL \u6a21\u677f\u4f7f\u7528 <code>{name}</code> \u5360\u4f4d\u7b26\uff0c\u7531 <code>url_resolver</code> \u89e3\u6790\uff0c\u6309\u987a\u5e8f\u6620\u5c04\u5230\u63a7\u5236\u5668\u65b9\u6cd5\u53c2\u6570\u3002</p> <p>\u652f\u6301\u5173\u952e\u5b57\u53c2\u6570\uff08\u901a\u7528\uff09 - url\uff1a\u8def\u7531\u6a21\u677f\u5b57\u7b26\u4e32\uff0c\u4f8b\u5982 <code>'/users/{user_id}'</code>\u3002 - query_params\uff1a\u67e5\u8be2\u53c2\u6570\u540d\u7684\u53ef\u8fed\u4ee3\u5bf9\u8c61\uff08\u7531 <code>request_resolver</code> \u7684 query \u90e8\u5206\u89e3\u6790\uff09\u3002 - file_params\uff1a\u7528\u4e8e\u6587\u4ef6\u4e0a\u4f20\u7684\u5b57\u6bb5\u540d\u96c6\u5408\u3002 - headers\uff1a\u8981\u6c42\u5b58\u5728\u7684 HTTP \u8bf7\u6c42\u5934\uff0c\u7f3a\u5931\u65f6\u4f1a\u89e6\u53d1\u7f3a\u5931\u5934\u5904\u7406\u5668\u3002</p> <p>POST/PATCH \u7279\u6709 - body_params\uff1a\u9700\u8981\u4ece JSON/form body \u4e2d\u89e3\u6790\u7684\u5b57\u6bb5\u540d\u96c6\u5408\u3002 - get_request_body\uff1a\u5e03\u5c14\u503c\uff1b\u4e3a True \u65f6\uff0c\u539f\u59cb\u8bf7\u6c42\u4f53\u4f1a\u4f20\u5165\u5904\u7406\u5668\u3002</p> <p>URL \u6a21\u677f\u5982\u4f55\u5de5\u4f5c - \u4f7f\u7528 <code>{param}</code> \u5360\u4f4d\u7b26\uff0c\u4f8b\u5982 <code>'/users/{user_id}/posts/{post_id}'</code>\u3002 - <code>url_resolver</code> \u5c06\u6a21\u677f\u89e3\u6790\u4e3a\u5339\u914d\u8def\u5f84\u5e76\u8fd4\u56de\u53c2\u6570\u540d\u987a\u5e8f\u5217\u8868\uff08\u4f8b\u5982 <code>['user_id','post_id']</code>\uff09\u3002 - \u88ab\u88c5\u9970\u7684\u65b9\u6cd5\u5c06\u6309\u8be5\u987a\u5e8f\u63a5\u6536\u5230\u8def\u5f84\u53c2\u6570\u503c\uff08\u6216\u7ed3\u5408\u63a7\u5236\u5668\u7ea7\u522b\u7684 url \u53c2\u6570\u952e\u5217\u8868\uff09\u3002 - \u5360\u4f4d\u7b26\u5141\u8bb8\u7684\u5b57\u7b26\u7531\u89e3\u6790\u5668\u9650\u5236\uff08\u4f8b\u5982 <code>[a-zA-Z0-9-]+</code>\uff09\uff0c\u5e76\u5141\u8bb8\u53ef\u9009\u7684\u5c3e\u968f <code>/</code>\u3002</p> <p>\u88c5\u9970\u5668\u884c\u4e3a\u4e0e\u8bf7\u6c42\u5904\u7406\u6d41\u7a0b - \u88c5\u9970\u5668\u4f1a\u5305\u88c5\u539f\u59cb\u51fd\u6570\u5e76\u901a\u8fc7 <code>EncapsulationHandler.add_func(url=local_url, type='get')</code> \u6ce8\u518c\u4e3a Tornado \u5904\u7406\u5668\uff08\u6216\u5176\u5b83\u52a8\u8bcd\uff09\u3002 - \u8bf7\u6c42\u65f6\uff0c\u6846\u67b6\u8c03\u7528 <code>request_resolver</code> \u4e0e <code>header_resolver</code> \u6784\u5efa <code>(url_dict, query_dict, body_dict, file_dict)</code>\uff0c\u5e76\u5c06\u89e3\u6790\u7684\u6570\u636e\u4f20\u5165 <code>request_handler</code>\uff0c\u6700\u7ec8\u7531\u5176\u8c03\u7528\u4f60\u7684\u63a7\u5236\u5668\u65b9\u6cd5\u3002 - <code>get_api</code>/<code>delete_api</code>/<code>put_api</code> \u901a\u5e38\u4e0d\u5904\u7406 body\uff08\u9664\u975e\u663e\u5f0f\u914d\u7f6e\uff09\uff0c\u800c <code>post_api</code>/<code>patch_api</code> \u652f\u6301 <code>body_params</code> \u4e0e <code>get_request_body</code>\u3002</p> <p>\u793a\u4f8b</p> <p>1) \u7b80\u5355 GET\uff08\u5e26\u8def\u5f84\u53c2\u6570\uff09</p> <pre><code>@controller(url='/api/users')\nclass UserController:\n    @get_api(url='/{user_id}')\n    def get_user(self, url_param):\n        # \u4ece url_param \u5b57\u5178\u4e2d\u83b7\u53d6\u8def\u5f84\u53c2\u6570\n        user_id = url_param.get('user_id') if url_param else None\n        return {'id': user_id}\n</code></pre> <p>2) GET \u5e26\u67e5\u8be2\u53c2\u6570</p> <pre><code>@controller(url='/api/users')\nclass UserController:\n    @get_api(url='/', query_params=('page','size'))\n    def list_users(self, query_param):\n        # page \u548c size \u4ece\u67e5\u8be2\u5b57\u7b26\u4e32\u89e3\u6790\uff0c\u901a\u8fc7 query_param \u8bbf\u95ee\n        page = query_param.get('page') if query_param else None\n        size = query_param.get('size') if query_param else None\n        return {'page': page, 'size': size}\n</code></pre> <p>3) POST\uff08body + \u6587\u4ef6\uff09</p> <pre><code>@controller(url='/api/upload')\nclass UploadController:\n    @post_api(url='/', body_params=('title',), file_params=('file',))\n    def upload(self, body_param, files):\n        title = body_param.get('title') if body_param else None\n        file_obj = files.get('file') if files else None\n        return {'uploaded': bool(file_obj)}\n</code></pre> <p>\u5e38\u89c1\u9519\u8bef\u4e0e\u9677\u9631 - \u4f7f\u7528\u4f4d\u7f6e\u53c2\u6570\uff1a<code>@get_api('/user')</code> \u662f\u9519\u8bef\u7684\u3002\u8bf7\u4f7f\u7528 <code>@get_api(url='/user')</code>\u3002 - \u6a21\u677f\u4e0e\u65b9\u6cd5\u53c2\u6570\u4e0d\u5339\u914d\uff1a\u82e5 URL \u6a21\u677f\u542b <code>{user_id}</code> \u800c\u65b9\u6cd5\u7b7e\u540d\u7f3a\u5c11\u5bf9\u5e94\u53c2\u6570\uff0c\u6846\u67b6\u4f1a\u4f20\u5165 None \u6216\u5bfc\u81f4\u5f02\u5e38\uff1b\u8bf7\u4fdd\u6301\u547d\u540d\u4e0e\u987a\u5e8f\u4e00\u81f4\u3002 - \u7f3a\u5c11\u5fc5\u987b\u5934\u90e8\uff1a\u82e5\u6307\u5b9a <code>headers</code>\uff0c\u8bf7\u6c42\u672a\u5305\u542b\u65f6\u4f1a\u89e6\u53d1\u7f3a\u5931\u5934\u5904\u7406\u5668\uff0c\u53ef\u80fd\u5bfc\u81f4\u9519\u8bef\u54cd\u5e94\u3002 - body \u89e3\u6790\u5931\u8d25\uff1a\u5f53 Content-Type \u4e3a <code>application/json</code> \u65f6\u6846\u67b6\u4f1a\u5c1d\u8bd5\u89e3\u6790 JSON\uff1b\u89e3\u6790\u5931\u8d25\u4f1a\u5bfc\u81f4 body \u5b57\u6bb5\u4e3a None\u3002</p> <p>\u4f7f\u7528\u5efa\u8bae - <code>get_api</code>\uff1a\u7528\u4e8e\u5e42\u7b49\u7684\u8bfb\u53d6\u64cd\u4f5c\u3002 - <code>post_api</code>\uff1a\u7528\u4e8e\u521b\u5efa/\u4e0a\u4f20\uff0c\u652f\u6301 body \u4e0e\u6587\u4ef6\u5904\u7406\u3002 - <code>patch_api</code>\uff1a\u7528\u4e8e\u90e8\u5206\u66f4\u65b0\u3002 - <code>put_api</code>\uff1a\u7528\u4e8e\u5b8c\u6574\u66ff\u6362\uff08\u4e0e POST \u5728 body \u53c2\u6570\u5904\u7406\u4e0a\u7c7b\u4f3c\uff09\u3002</p> <p>\u6e90\u7801\u53c2\u8003 - \u5173\u952e\u5b9e\u73b0\u4f4d\u4e8e <code>cullinan/controller/core.py</code>\uff08<code>get_api</code>, <code>post_api</code>, <code>url_resolver</code>, <code>request_resolver</code>, <code>request_handler</code>\uff09\u3002 - \u53ef\u4ee5\u5728 <code>tests/</code> \u4e2d\u901a\u8fc7\u641c\u7d22 <code>@get_api(url=</code> \u627e\u5230\u5b9e\u6218\u6d4b\u8bd5\u6837\u4f8b\u3002</p> <p>\u53e6\u89c1 - <code>docs/getting_started.md</code>\uff08\u5feb\u901f\u8bf4\u660e\uff09 - <code>docs/wiki/injection.md</code>\uff08\u6ce8\u5165\u6a21\u5f0f\u8bf4\u660e\uff09</p>"}]}